;/* module-key = 'com.atlassian.streams:streamsGadgetResources', location = '/js/external/jquery.waitforimages.js' */
(function(A){A.waitForImages={hasImageProperties:["backgroundImage","listStyleImage","borderImage","borderCornerImage"]};A.expr[":"].uncached=function(B){return A(B).is('img[src!=""]')&&!B.complete};A.fn.waitForImages=function(D,B,C){if(A.isPlainObject(arguments[0])){B=D.each;C=D.waitForAll;D=D.finished}D=D||A.noop;B=B||A.noop;C=!!C;if(!A.isFunction(D)||!A.isFunction(B)){throw new TypeError("An invalid callback was supplied.")}return this.each(function(){var I=A(this),J=[];if(C){var E=A.waitForImages.hasImageProperties||[],H=/url\((['"]?)(.*?)\1\)/g;I.find("*").each(function(){var K=A(this);if(K.is("img:uncached")){J.push({src:K.attr("src"),element:K[0]})}A.each(E,function(N,O){var L=K.css(O);if(!L){return true}var M;while(M=H.exec(L)){J.push({src:M[2],element:K[0]})}})})}else{I.find("img:uncached").each(function(){J.push({src:this.src,element:this})})}var G=J.length,F=0;if(G==0){D.call(I[0])}A.each(J,function(L,K){var M=new Image;A(M).bind("load error",function(N){F++;B.call(K.element,F,G,N.type=="load");if(F==G){D.call(I[0]);return false}});M.src=K.src})})}})(jQuery);;
;/* module-key = 'com.atlassian.streams:streamsGadgetResources', location = '/js/activity-stream.gadget.js' */
ActivityStreams=ActivityStreams||{};ActivityStreams.gadget=(function(){var E=new gadgets.Prefs(),C=false,B=E.getBool("titleRequired"),G;if(B){gadgets.window.setTitle(E.getMsg("gadget.activity.stream.title"))}function F(H){return E.getMsg(H)}function A(L,J,K){if(G&&G.update){G.update()}else{var I=L.getView(),H=J.dateLocaleUrl.replace("date-default","date-"+E.getLang()+"-"+E.getCountry());AJS.$.ajax({type:"get",url:K+"/rest/activity-stream/1.0/preferences",global:false,dataType:"json",success:function(N,M){ActivityStreams.setDatePrefs(N);AJS.$(document).trigger("preferencesLoaded.streams")},complete:function(){if(!C){AJS.$.ajax({type:"get",url:H,dataType:"jsonp",jsonp:"callback",jsonpCallback:"ActivityStreams.loadDateJs",global:false,success:function(M){C=true;AJS.$(document).trigger("dateLocalizationLoaded.streams")}})}}});L.getView().empty();if(L.getPrefs().getString("isConfigurable")==="false"){L.getFooter().hide()}L.showLoading();ActivityStreams.hijackGadgetConfig(L);G=ActivityStreams.stream({id:L.getPrefs().getModuleId(),baseUrl:K,maxResults:L.getPref("numofentries"),isConfigurable:!!L.getConfig,container:I,title:gadgets.util.unescapeString(L.getPref("title")),hideHeader:L.getViewMode()==="issueTab"||!B,loaded:function(){L.hideLoading()},resized:function(){L.resize()}})}}function D(J,H,I){return{action:I+"/rest/activity-stream/1.0/validate",theme:"gdt",fields:[]}}return{getMsg:F,template:A,descriptor:D}})();;
