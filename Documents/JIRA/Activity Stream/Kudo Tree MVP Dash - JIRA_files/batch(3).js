;/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTip.js' */
(function(e){function a(){return false}function c(){return true}var j=0,f=new Date().getTime();function g(l){l=""+(l||"");return l.replace(/\./g,"-")}function i(m,l){if(AJS.EventQueue&&l&&l.attributes.id){var o={};var n=g(l.attributes.id);var p="";if(l.attributes.eventPrefix){p=l.attributes.eventPrefix;if(p.charAt(p.length-1)!=="."){p+="."}}o.name=p+"helptips."+n+"."+m;o.properties={};AJS.EventQueue.push(o)}}function b(){return"c"+f+(j++)}var d=AJS.HelpTip=function(l){var m;this.attributes=e.extend({},l);this.attributes.id||(this.attributes.id=false);this.attributes.callbacks||(this.attributes.callbacks={});if(this.attributes.isSequence){if(!this.attributes.weight){this.attributes.weight=Number.MAX_VALUE}AJS.HelpTip.Manager.sequences.push(this)}if(this.attributes.body){this.attributes.bodyHtml=this.attributes.body;delete this.attributes.body}this.cid=b();m=this.attributes.anchor;delete this.attributes.anchor;this.view=(m)?new h(this,m):new k(this);this.view.$el.addClass("jira-help-tip aui-help")};e.extend(d.prototype,{show:function(n){n=n||{};var m=this;var o=e.Deferred();if(this.attributes.callbacks.beforeShow){var l=this.attributes.callbacks.beforeShow();if(l&&_.isFunction(l.done)){l.done(o.resolve)}else{o.resolve()}}else{o.resolve()}o.done(function(){AJS.HelpTip.Manager.show(function(){if(!m.isDismissed()){if(!n.force&&AJS.Popups&&AJS.Popups.DisplayController){AJS.Popups.DisplayController.request({name:m.id,weight:1000,show:function(){m.view.show()}})}else{m.view.show()}i("shown",m)}})})},dismiss:function(){var l=g(arguments[0]||"programmatically");this.view.dismiss();if(l==="close-button"&&this.attributes.isSequence){AJS.HelpTip.Manager.clearSequences()}if(!this.isDismissed()){AJS.HelpTip.Manager.dismiss(this);i("dismissed."+l,this)}},isVisible:function(){return this.view.$el.is(":visible")},isDismissed:function(){return AJS.HelpTip.Manager.isDismissed(this)}});var h=function(m,l){this.initialize(m,l)};e.extend(h.prototype,{initialize:function(n,m){var l=this;this.model=n;this.beforeHide=a;this.popup=AJS.InlineDialog(m,n.cid,_.bind(this._createDialog,this),_.extend({container:"#content",noBind:true,preHideCallback:function(){return l.beforeHide()},calculatePositions:function(o,r,u,q){var p=AJS.InlineDialog.opts.calculatePositions(o,r,u,q);var t=e(this.container);var s=t.offset();p.popupCss.top-=s.top;p.popupCss.left-=s.left;return p},addActiveClass:false,initCallback:n.attributes.callbacks.init,hideCallback:n.attributes.callbacks.hide},n.attributes.inlineDialogOpts));this._popupHide=this.popup.hide;this.popup.hide=a;this.$el=e(this.popup[0]);AJS.$(document).bind("showLayer",function(q,p,o){if(p==="inlineDialog"&&o.id===n.cid){AJS.InlineDialog.current=null;AJS.$(document.body).unbind("click."+n.cid+".inline-dialog-check");o._validateClickToClose=a;o.hide=a}})},show:function(){this.popup.show()},dismiss:function(){this.beforeHide=c;this._popupHide()},_createDialog:function(q,o,n){var m=this;var p=AJS.HelpTip.Manager.sequences;var l=this.model.attributes.position;q.removeClass("contents");q.html(e(AJS.Templates.HelpTip.tipContent(_.extend({hasSequence:(p.length>1&&(l+1<p.length)),length:p.length,position:l},this.model.attributes))));q.unbind("mouseover mouseout");q.find(".helptip-link").click(function(){i("learn-more.clicked",m.model)});q.find(".helptip-close").click(function(r){r.preventDefault();m.model.dismiss("close-button")});q.find(".helptip-next").click(function(s){s.preventDefault();m.model.dismiss("next-button");var r=l+1;p[r]&&(p[r].show({force:true}))});n()}});var k=function(l){this.initialize(l)};e.extend(k.prototype,{initialize:function(){this.$el=e("<div></div>")},show:function(){},dismiss:function(){}})})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'js/HelpTipManager.js' */
(function(d){var b=AJS.contextPath()+"/rest/helptips/1.0/tips";var c=undefined;if(WRM&&WRM.data){c=WRM.data.claim("com.atlassian.plugins.helptips.jira-help-tips:common.JiraHelpTipData")}var a={dismissedTipIds:[],sequences:[],loaded:d.Deferred(),url:function(){return b},sync:function(g,f){var e=d.Deferred();g||(g="get");f||(f=null);if(g==="get"&&c&&c.dismissed){e.resolve(c.dismissed)}else{d.ajax(this.url(),{type:g,dataType:"json",contentType:"application/json",data:f&&JSON.stringify(f),processData:false}).done(function(h){e.resolve(h)}).fail(function(){e.reject()})}return e.promise()},fetch:function(){var e=this.sync();e.done(d.proxy(function(f){d.merge(this.dismissedTipIds,f);this.loaded.resolve()},this));return e.promise()},show:function(e){this.loaded.done(e)},dismiss:function(e){var f=e.attributes.id;if(!f){e._dismissed=true}else{this.dismissedTipIds.push(f);this.sync("post",{id:f})}},undismiss:function(e){var f=e.attributes.id;if(!f){e._dismissed=false}else{this.dismissedTipIds.splice(d.inArray(f,this.dismissedTipIds),1);this.sync("delete",{id:f})}},isDismissed:function(e){var f=e.attributes.id;return(f)?d.inArray(f,this.dismissedTipIds)>=0:e._dismissed},clearSequences:function(){this.sequences=[]},hideSequences:function(){_.each(this.sequences,function(e){e.view.dismiss()})},showSequences:function(){if(!this._showStarted){var e=this;var f=0;this._showStarted=true;d.when(this.loaded).done(function(){e.sequences.sort(function(h,g){return h.attributes.weight-g.attributes.weight});e.sequences=_.filter(e.sequences,function(h){var g=_.indexOf(e.dismissedTipIds,h.attributes.id)===-1;if(g){h.attributes.position=f++}return g});if(e.sequences.length>0){e.sequences[0].show({force:true})}e._showStarted=false})}}};if(!JIRA.Users.LoggedInUser.isAnonymous()){AJS.HelpTip.Manager=a;a.fetch()}})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.helptips.jira-help-tips:common', location = 'templates/HelpTip.soy' */
// This file was automatically generated from HelpTip.soy.
// Please don't edit this file by hand.

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Templates == 'undefined') { AJS.Templates = {}; }
if (typeof AJS.Templates.HelpTip == 'undefined') { AJS.Templates.HelpTip = {}; }


AJS.Templates.HelpTip.tipContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.title) ? '<h2 class="helptip-title">' + soy.$$escapeHtml(opt_data.title) + '</h2>' : '', '<p class="helptip-body">', opt_data.bodyHtml, '</p>', (opt_data.url) ? '<p><a class="helptip-link" href="' + soy.$$escapeHtml(opt_data.url) + '" target="_blank">' + ((opt_data.linkText) ? soy.$$escapeHtml(opt_data.linkText) : soy.$$escapeHtml("Learn more")) + '</a></p>' : '');
  AJS.Templates.HelpTip.tipFooter(opt_data, output);
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.tipFooter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="tip-footer">');
  AJS.Templates.HelpTip.nextButton(opt_data, output);
  AJS.Templates.HelpTip.closeButton(opt_data, output);
  AJS.Templates.HelpTip.sequencePaging(opt_data, output);
  output.append('</form>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.nextButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.hasSequence) ? '<button class="aui-button helptip-next" type="button">' + soy.$$escapeHtml("Next") + '</button>' : '');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.closeButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button ', (opt_data.hasSequence) ? ' aui-button-link ' : '', ' helptip-close" type="button">', soy.$$escapeHtml("Close"), '</button>');
  return opt_sb ? '' : output.toString();
};


AJS.Templates.HelpTip.sequencePaging = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.length > 1) ? '<span class="helptip-sequence-paging">' + soy.$$escapeHtml(opt_data.position + 1) + '/' + soy.$$escapeHtml(opt_data.length) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/moment.js' */
(function(undefined){var moment,VERSION="2.6.0",globalScope=typeof global!=="undefined"?global:this,oldGlobalMoment,round=Math.round,i,YEAR=0,MONTH=1,DATE=2,HOUR=3,MINUTE=4,SECOND=5,MILLISECOND=6,languages={},momentProperties={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_isUTC:null,_offset:null,_pf:null,_lang:null},hasModule=(typeof module!=="undefined"&&module.exports),aspNetJsonRegex=/^\/?Date\((\-?\d+)/i,aspNetTimeSpanJsonRegex=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,isoDurationRegex=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,formattingTokens=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,localFormattingTokens=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,parseTokenOneOrTwoDigits=/\d\d?/,parseTokenOneToThreeDigits=/\d{1,3}/,parseTokenOneToFourDigits=/\d{1,4}/,parseTokenOneToSixDigits=/[+\-]?\d{1,6}/,parseTokenDigits=/\d+/,parseTokenWord=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,parseTokenTimezone=/Z|[\+\-]\d\d:?\d\d/gi,parseTokenT=/T/i,parseTokenTimestampMs=/[\+\-]?\d+(\.\d{1,3})?/,parseTokenOrdinal=/\d{1,2}/,parseTokenOneDigit=/\d/,parseTokenTwoDigits=/\d\d/,parseTokenThreeDigits=/\d{3}/,parseTokenFourDigits=/\d{4}/,parseTokenSixDigits=/[+-]?\d{6}/,parseTokenSignedNumber=/[+-]?\d+/,isoRegex=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,isoFormat="YYYY-MM-DDTHH:mm:ssZ",isoDates=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],isoTimes=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],parseTimezoneChunker=/([\+\-]|\d\d)/gi,proxyGettersAndSetters="Date|Hours|Minutes|Seconds|Milliseconds".split("|"),unitMillisecondFactors={"Milliseconds":1,"Seconds":1000,"Minutes":60000,"Hours":3600000,"Days":86400000,"Months":2592000000,"Years":31536000000},unitAliases={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},camelFunctions={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},formatFunctions={},ordinalizeTokens="DDD w W M D d".split(" "),paddedTokens="M D H h m s w W".split(" "),formatTokenFunctions={M:function(){return this.month()+1},MMM:function(format){return this.lang().monthsShort(this,format)},MMMM:function(format){return this.lang().months(this,format)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(format){return this.lang().weekdaysMin(this,format)},ddd:function(format){return this.lang().weekdaysShort(this,format)},dddd:function(format){return this.lang().weekdays(this,format)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return leftZeroFill(this.year()%100,2)},YYYY:function(){return leftZeroFill(this.year(),4)},YYYYY:function(){return leftZeroFill(this.year(),5)},YYYYYY:function(){var y=this.year(),sign=y>=0?"+":"-";return sign+leftZeroFill(Math.abs(y),6)},gg:function(){return leftZeroFill(this.weekYear()%100,2)},gggg:function(){return leftZeroFill(this.weekYear(),4)},ggggg:function(){return leftZeroFill(this.weekYear(),5)},GG:function(){return leftZeroFill(this.isoWeekYear()%100,2)},GGGG:function(){return leftZeroFill(this.isoWeekYear(),4)},GGGGG:function(){return leftZeroFill(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),true)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),false)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return toInt(this.milliseconds()/100)},SS:function(){return leftZeroFill(toInt(this.milliseconds()/10),2)},SSS:function(){return leftZeroFill(this.milliseconds(),3)},SSSS:function(){return leftZeroFill(this.milliseconds(),3)},Z:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(toInt(a/60),2)+":"+leftZeroFill(toInt(a)%60,2)},ZZ:function(){var a=-this.zone(),b="+";if(a<0){a=-a;b="-"}return b+leftZeroFill(toInt(a/60),2)+leftZeroFill(toInt(a)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},lists=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];function defaultParsingFlags(){return{empty:false,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:false,invalidMonth:null,invalidFormat:false,userInvalidated:false,iso:false}}function deprecate(msg,fn){var firstTime=true;function printMsg(){if(moment.suppressDeprecationWarnings===false&&typeof console!=="undefined"&&console.warn){console.warn("Deprecation warning: "+msg)}}return extend(function(){if(firstTime){printMsg();firstTime=false}return fn.apply(this,arguments)},fn)}function padToken(func,count){return function(a){return leftZeroFill(func.call(this,a),count)}}function ordinalizeToken(func,period){return function(a){return this.lang().ordinal(func.call(this,a),period)}}while(ordinalizeTokens.length){i=ordinalizeTokens.pop();formatTokenFunctions[i+"o"]=ordinalizeToken(formatTokenFunctions[i],i)}while(paddedTokens.length){i=paddedTokens.pop();formatTokenFunctions[i+i]=padToken(formatTokenFunctions[i],2)}formatTokenFunctions.DDDD=padToken(formatTokenFunctions.DDD,3);function Language(){}function Moment(config){checkOverflow(config);extend(this,config)}function Duration(duration){var normalizedInput=normalizeObjectUnits(duration),years=normalizedInput.year||0,quarters=normalizedInput.quarter||0,months=normalizedInput.month||0,weeks=normalizedInput.week||0,days=normalizedInput.day||0,hours=normalizedInput.hour||0,minutes=normalizedInput.minute||0,seconds=normalizedInput.second||0,milliseconds=normalizedInput.millisecond||0;this._milliseconds=+milliseconds+seconds*1000+minutes*60000+hours*3600000;this._days=+days+weeks*7;this._months=+months+quarters*3+years*12;this._data={};this._bubble()}function extend(a,b){for(var i in b){if(b.hasOwnProperty(i)){a[i]=b[i]}}if(b.hasOwnProperty("toString")){a.toString=b.toString}if(b.hasOwnProperty("valueOf")){a.valueOf=b.valueOf}return a}function cloneMoment(m){var result={},i;for(i in m){if(m.hasOwnProperty(i)&&momentProperties.hasOwnProperty(i)){result[i]=m[i]}}return result}function absRound(number){if(number<0){return Math.ceil(number)}else{return Math.floor(number)}}function leftZeroFill(number,targetLength,forceSign){var output=""+Math.abs(number),sign=number>=0;while(output.length<targetLength){output="0"+output}return(sign?(forceSign?"+":""):"-")+output}function addOrSubtractDurationFromMoment(mom,duration,isAdding,updateOffset){var milliseconds=duration._milliseconds,days=duration._days,months=duration._months;updateOffset=updateOffset==null?true:updateOffset;if(milliseconds){mom._d.setTime(+mom._d+milliseconds*isAdding)}if(days){rawSetter(mom,"Date",rawGetter(mom,"Date")+days*isAdding)}if(months){rawMonthSetter(mom,rawGetter(mom,"Month")+months*isAdding)}if(updateOffset){moment.updateOffset(mom,days||months)}}function isArray(input){return Object.prototype.toString.call(input)==="[object Array]"}function isDate(input){return Object.prototype.toString.call(input)==="[object Date]"||input instanceof Date}function compareArrays(array1,array2,dontConvert){var len=Math.min(array1.length,array2.length),lengthDiff=Math.abs(array1.length-array2.length),diffs=0,i;for(i=0;i<len;i++){if((dontConvert&&array1[i]!==array2[i])||(!dontConvert&&toInt(array1[i])!==toInt(array2[i]))){diffs++}}return diffs+lengthDiff}function normalizeUnits(units){if(units){var lowered=units.toLowerCase().replace(/(.)s$/,"$1");units=unitAliases[units]||camelFunctions[lowered]||lowered}return units}function normalizeObjectUnits(inputObject){var normalizedInput={},normalizedProp,prop;for(prop in inputObject){if(inputObject.hasOwnProperty(prop)){normalizedProp=normalizeUnits(prop);if(normalizedProp){normalizedInput[normalizedProp]=inputObject[prop]}}}return normalizedInput}function makeList(field){var count,setter;if(field.indexOf("week")===0){count=7;setter="day"}else{if(field.indexOf("month")===0){count=12;setter="month"}else{return }}moment[field]=function(format,index){var i,getter,method=moment.fn._lang[field],results=[];if(typeof format==="number"){index=format;format=undefined}getter=function(i){var m=moment().utc().set(setter,i);return method.call(moment.fn._lang,m,format||"")};if(index!=null){return getter(index)}else{for(i=0;i<count;i++){results.push(getter(i))}return results}}}function toInt(argumentForCoercion){var coercedNumber=+argumentForCoercion,value=0;if(coercedNumber!==0&&isFinite(coercedNumber)){if(coercedNumber>=0){value=Math.floor(coercedNumber)}else{value=Math.ceil(coercedNumber)}}return value}function daysInMonth(year,month){return new Date(Date.UTC(year,month+1,0)).getUTCDate()}function weeksInYear(year,dow,doy){return weekOfYear(moment([year,11,31+dow-doy]),dow,doy).week}function daysInYear(year){return isLeapYear(year)?366:365}function isLeapYear(year){return(year%4===0&&year%100!==0)||year%400===0}function checkOverflow(m){var overflow;if(m._a&&m._pf.overflow===-2){overflow=m._a[MONTH]<0||m._a[MONTH]>11?MONTH:m._a[DATE]<1||m._a[DATE]>daysInMonth(m._a[YEAR],m._a[MONTH])?DATE:m._a[HOUR]<0||m._a[HOUR]>23?HOUR:m._a[MINUTE]<0||m._a[MINUTE]>59?MINUTE:m._a[SECOND]<0||m._a[SECOND]>59?SECOND:m._a[MILLISECOND]<0||m._a[MILLISECOND]>999?MILLISECOND:-1;if(m._pf._overflowDayOfYear&&(overflow<YEAR||overflow>DATE)){overflow=DATE}m._pf.overflow=overflow}}function isValid(m){if(m._isValid==null){m._isValid=!isNaN(m._d.getTime())&&m._pf.overflow<0&&!m._pf.empty&&!m._pf.invalidMonth&&!m._pf.nullInput&&!m._pf.invalidFormat&&!m._pf.userInvalidated;if(m._strict){m._isValid=m._isValid&&m._pf.charsLeftOver===0&&m._pf.unusedTokens.length===0}}return m._isValid}function normalizeLanguage(key){return key?key.toLowerCase().replace("_","-"):key}function makeAs(input,model){return model._isUTC?moment(input).zone(model._offset||0):moment(input).local()}extend(Language.prototype,{set:function(config){var prop,i;for(i in config){prop=config[i];if(typeof prop==="function"){this[i]=prop}else{this["_"+i]=prop}}},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(m){return this._months[m.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(m){return this._monthsShort[m.month()]},monthsParse:function(monthName){var i,mom,regex;if(!this._monthsParse){this._monthsParse=[]}for(i=0;i<12;i++){if(!this._monthsParse[i]){mom=moment.utc([2000,i]);regex="^"+this.months(mom,"")+"|^"+this.monthsShort(mom,"");this._monthsParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._monthsParse[i].test(monthName)){return i}}},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(m){return this._weekdays[m.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(m){return this._weekdaysShort[m.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(m){return this._weekdaysMin[m.day()]},weekdaysParse:function(weekdayName){var i,mom,regex;if(!this._weekdaysParse){this._weekdaysParse=[]}for(i=0;i<7;i++){if(!this._weekdaysParse[i]){mom=moment([2000,1]).day(i);regex="^"+this.weekdays(mom,"")+"|^"+this.weekdaysShort(mom,"")+"|^"+this.weekdaysMin(mom,"");this._weekdaysParse[i]=new RegExp(regex.replace(".",""),"i")}if(this._weekdaysParse[i].test(weekdayName)){return i}}},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(key){var output=this._longDateFormat[key];if(!output&&this._longDateFormat[key.toUpperCase()]){output=this._longDateFormat[key.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(val){return val.slice(1)});this._longDateFormat[key]=output}return output},isPM:function(input){return((input+"").toLowerCase().charAt(0)==="p")},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(hours,minutes,isLower){if(hours>11){return isLower?"pm":"PM"}else{return isLower?"am":"AM"}},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(key,mom){var output=this._calendar[key];return typeof output==="function"?output.apply(mom):output},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(number,withoutSuffix,string,isFuture){var output=this._relativeTime[string];return(typeof output==="function")?output(number,withoutSuffix,string,isFuture):output.replace(/%d/i,number)},pastFuture:function(diff,output){var format=this._relativeTime[diff>0?"future":"past"];return typeof format==="function"?format(output):format.replace(/%s/i,output)},ordinal:function(number){return this._ordinal.replace("%d",number)},_ordinal:"%d",preparse:function(string){return string},postformat:function(string){return string},week:function(mom){return weekOfYear(mom,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}});function loadLang(key,values){values.abbr=key;if(!languages[key]){languages[key]=new Language()}languages[key].set(values);return languages[key]}function unloadLang(key){delete languages[key]}function getLangDefinition(key){var i=0,j,lang,next,split,get=function(k){if(!languages[k]&&hasModule){try{require("./lang/"+k)}catch(e){}}return languages[k]};if(!key){return moment.fn._lang}if(!isArray(key)){lang=get(key);if(lang){return lang}key=[key]}while(i<key.length){split=normalizeLanguage(key[i]).split("-");j=split.length;next=normalizeLanguage(key[i+1]);next=next?next.split("-"):null;while(j>0){lang=get(split.slice(0,j).join("-"));if(lang){return lang}if(next&&next.length>=j&&compareArrays(split,next,true)>=j-1){break}j--}i++}return moment.fn._lang}function removeFormattingTokens(input){if(input.match(/\[[\s\S]/)){return input.replace(/^\[|\]$/g,"")}return input.replace(/\\/g,"")}function makeFormatFunction(format){var array=format.match(formattingTokens),i,length;for(i=0,length=array.length;i<length;i++){if(formatTokenFunctions[array[i]]){array[i]=formatTokenFunctions[array[i]]}else{array[i]=removeFormattingTokens(array[i])}}return function(mom){var output="";for(i=0;i<length;i++){output+=array[i] instanceof Function?array[i].call(mom,format):array[i]}return output}}function formatMoment(m,format){if(!m.isValid()){return m.lang().invalidDate()}format=expandFormat(format,m.lang());if(!formatFunctions[format]){formatFunctions[format]=makeFormatFunction(format)}return formatFunctions[format](m)}function expandFormat(format,lang){var i=5;function replaceLongDateFormatTokens(input){return lang.longDateFormat(input)||input}localFormattingTokens.lastIndex=0;while(i>=0&&localFormattingTokens.test(format)){format=format.replace(localFormattingTokens,replaceLongDateFormatTokens);localFormattingTokens.lastIndex=0;i-=1}return format}function getParseRegexForToken(token,config){var a,strict=config._strict;switch(token){case"Q":return parseTokenOneDigit;case"DDDD":return parseTokenThreeDigits;case"YYYY":case"GGGG":case"gggg":return strict?parseTokenFourDigits:parseTokenOneToFourDigits;case"Y":case"G":case"g":return parseTokenSignedNumber;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return strict?parseTokenSixDigits:parseTokenOneToSixDigits;case"S":if(strict){return parseTokenOneDigit}case"SS":if(strict){return parseTokenTwoDigits}case"SSS":if(strict){return parseTokenThreeDigits}case"DDD":return parseTokenOneToThreeDigits;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return parseTokenWord;case"a":case"A":return getLangDefinition(config._l)._meridiemParse;case"X":return parseTokenTimestampMs;case"Z":case"ZZ":return parseTokenTimezone;case"T":return parseTokenT;case"SSSS":return parseTokenDigits;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return strict?parseTokenTwoDigits:parseTokenOneOrTwoDigits;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return parseTokenOneOrTwoDigits;case"Do":return parseTokenOrdinal;default:a=new RegExp(regexpEscape(unescapeFormat(token.replace("\\","")),"i"));return a}}function timezoneMinutesFromString(string){string=string||"";var possibleTzMatches=(string.match(parseTokenTimezone)||[]),tzChunk=possibleTzMatches[possibleTzMatches.length-1]||[],parts=(tzChunk+"").match(parseTimezoneChunker)||["-",0,0],minutes=+(parts[1]*60)+toInt(parts[2]);return parts[0]==="+"?-minutes:minutes}function addTimeToArrayFromToken(token,input,config){var a,datePartArray=config._a;switch(token){case"Q":if(input!=null){datePartArray[MONTH]=(toInt(input)-1)*3}break;case"M":case"MM":if(input!=null){datePartArray[MONTH]=toInt(input)-1}break;case"MMM":case"MMMM":a=getLangDefinition(config._l).monthsParse(input);if(a!=null){datePartArray[MONTH]=a}else{config._pf.invalidMonth=input}break;case"D":case"DD":if(input!=null){datePartArray[DATE]=toInt(input)}break;case"Do":if(input!=null){datePartArray[DATE]=toInt(parseInt(input,10))}break;case"DDD":case"DDDD":if(input!=null){config._dayOfYear=toInt(input)}break;case"YY":datePartArray[YEAR]=moment.parseTwoDigitYear(input);break;case"YYYY":case"YYYYY":case"YYYYYY":datePartArray[YEAR]=toInt(input);break;case"a":case"A":config._isPm=getLangDefinition(config._l).isPM(input);break;case"H":case"HH":case"h":case"hh":datePartArray[HOUR]=toInt(input);break;case"m":case"mm":datePartArray[MINUTE]=toInt(input);break;case"s":case"ss":datePartArray[SECOND]=toInt(input);break;case"S":case"SS":case"SSS":case"SSSS":datePartArray[MILLISECOND]=toInt(("0."+input)*1000);break;case"X":config._d=new Date(parseFloat(input)*1000);break;case"Z":case"ZZ":config._useUTC=true;config._tzm=timezoneMinutesFromString(input);break;case"w":case"ww":case"W":case"WW":case"d":case"dd":case"ddd":case"dddd":case"e":case"E":token=token.substr(0,1);case"gg":case"gggg":case"GG":case"GGGG":case"GGGGG":token=token.substr(0,2);if(input){config._w=config._w||{};config._w[token]=input}break}}function dateFromConfig(config){var i,date,input=[],currentDate,yearToUse,fixYear,w,temp,lang,weekday,week;if(config._d){return }currentDate=currentDateArray(config);if(config._w&&config._a[DATE]==null&&config._a[MONTH]==null){fixYear=function(val){var intVal=parseInt(val,10);return val?(val.length<3?(intVal>68?1900+intVal:2000+intVal):intVal):(config._a[YEAR]==null?moment().weekYear():config._a[YEAR])};w=config._w;if(w.GG!=null||w.W!=null||w.E!=null){temp=dayOfYearFromWeeks(fixYear(w.GG),w.W||1,w.E,4,1)}else{lang=getLangDefinition(config._l);weekday=w.d!=null?parseWeekday(w.d,lang):(w.e!=null?parseInt(w.e,10)+lang._week.dow:0);week=parseInt(w.w,10)||1;if(w.d!=null&&weekday<lang._week.dow){week++}temp=dayOfYearFromWeeks(fixYear(w.gg),week,weekday,lang._week.doy,lang._week.dow)}config._a[YEAR]=temp.year;config._dayOfYear=temp.dayOfYear}if(config._dayOfYear){yearToUse=config._a[YEAR]==null?currentDate[YEAR]:config._a[YEAR];if(config._dayOfYear>daysInYear(yearToUse)){config._pf._overflowDayOfYear=true}date=makeUTCDate(yearToUse,0,config._dayOfYear);config._a[MONTH]=date.getUTCMonth();config._a[DATE]=date.getUTCDate()}for(i=0;i<3&&config._a[i]==null;++i){config._a[i]=input[i]=currentDate[i]}for(;i<7;i++){config._a[i]=input[i]=(config._a[i]==null)?(i===2?1:0):config._a[i]}input[HOUR]+=toInt((config._tzm||0)/60);input[MINUTE]+=toInt((config._tzm||0)%60);config._d=(config._useUTC?makeUTCDate:makeDate).apply(null,input)}function dateFromObject(config){var normalizedInput;if(config._d){return }normalizedInput=normalizeObjectUnits(config._i);config._a=[normalizedInput.year,normalizedInput.month,normalizedInput.day,normalizedInput.hour,normalizedInput.minute,normalizedInput.second,normalizedInput.millisecond];dateFromConfig(config)}function currentDateArray(config){var now=new Date();if(config._useUTC){return[now.getUTCFullYear(),now.getUTCMonth(),now.getUTCDate()]}else{return[now.getFullYear(),now.getMonth(),now.getDate()]}}function makeDateFromStringAndFormat(config){config._a=[];config._pf.empty=true;var lang=getLangDefinition(config._l),string=""+config._i,i,parsedInput,tokens,token,skipped,stringLength=string.length,totalParsedInputLength=0;tokens=expandFormat(config._f,lang).match(formattingTokens)||[];for(i=0;i<tokens.length;i++){token=tokens[i];parsedInput=(string.match(getParseRegexForToken(token,config))||[])[0];if(parsedInput){skipped=string.substr(0,string.indexOf(parsedInput));if(skipped.length>0){config._pf.unusedInput.push(skipped)}string=string.slice(string.indexOf(parsedInput)+parsedInput.length);totalParsedInputLength+=parsedInput.length}if(formatTokenFunctions[token]){if(parsedInput){config._pf.empty=false}else{config._pf.unusedTokens.push(token)}addTimeToArrayFromToken(token,parsedInput,config)}else{if(config._strict&&!parsedInput){config._pf.unusedTokens.push(token)}}}config._pf.charsLeftOver=stringLength-totalParsedInputLength;if(string.length>0){config._pf.unusedInput.push(string)}if(config._isPm&&config._a[HOUR]<12){config._a[HOUR]+=12}if(config._isPm===false&&config._a[HOUR]===12){config._a[HOUR]=0}dateFromConfig(config);checkOverflow(config)}function unescapeFormat(s){return s.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(matched,p1,p2,p3,p4){return p1||p2||p3||p4})}function regexpEscape(s){return s.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function makeDateFromStringAndArray(config){var tempConfig,bestMoment,scoreToBeat,i,currentScore;if(config._f.length===0){config._pf.invalidFormat=true;config._d=new Date(NaN);return }for(i=0;i<config._f.length;i++){currentScore=0;tempConfig=extend({},config);tempConfig._pf=defaultParsingFlags();tempConfig._f=config._f[i];makeDateFromStringAndFormat(tempConfig);if(!isValid(tempConfig)){continue}currentScore+=tempConfig._pf.charsLeftOver;currentScore+=tempConfig._pf.unusedTokens.length*10;tempConfig._pf.score=currentScore;if(scoreToBeat==null||currentScore<scoreToBeat){scoreToBeat=currentScore;bestMoment=tempConfig}}extend(config,bestMoment||tempConfig)}function makeDateFromString(config){var i,l,string=config._i,match=isoRegex.exec(string);if(match){config._pf.iso=true;for(i=0,l=isoDates.length;i<l;i++){if(isoDates[i][1].exec(string)){config._f=isoDates[i][0]+(match[6]||" ");break}}for(i=0,l=isoTimes.length;i<l;i++){if(isoTimes[i][1].exec(string)){config._f+=isoTimes[i][0];break}}if(string.match(parseTokenTimezone)){config._f+="Z"}makeDateFromStringAndFormat(config)}else{moment.createFromInputFallback(config)}}function makeDateFromInput(config){var input=config._i,matched=aspNetJsonRegex.exec(input);if(input===undefined){config._d=new Date()}else{if(matched){config._d=new Date(+matched[1])}else{if(typeof input==="string"){makeDateFromString(config)}else{if(isArray(input)){config._a=input.slice(0);dateFromConfig(config)}else{if(isDate(input)){config._d=new Date(+input)}else{if(typeof (input)==="object"){dateFromObject(config)}else{if(typeof (input)==="number"){config._d=new Date(input)}else{moment.createFromInputFallback(config)}}}}}}}}function makeDate(y,m,d,h,M,s,ms){var date=new Date(y,m,d,h,M,s,ms);if(y<1970){date.setFullYear(y)}return date}function makeUTCDate(y){var date=new Date(Date.UTC.apply(null,arguments));if(y<1970){date.setUTCFullYear(y)}return date}function parseWeekday(input,language){if(typeof input==="string"){if(!isNaN(input)){input=parseInt(input,10)}else{input=language.weekdaysParse(input);if(typeof input!=="number"){return null}}}return input}function substituteTimeAgo(string,number,withoutSuffix,isFuture,lang){return lang.relativeTime(number||1,!!withoutSuffix,string,isFuture)}function relativeTime(milliseconds,withoutSuffix,lang){var seconds=round(Math.abs(milliseconds)/1000),minutes=round(seconds/60),hours=round(minutes/60),days=round(hours/24),years=round(days/365),args=seconds<45&&["s",seconds]||minutes===1&&["m"]||minutes<45&&["mm",minutes]||hours===1&&["h"]||hours<22&&["hh",hours]||days===1&&["d"]||days<=25&&["dd",days]||days<=45&&["M"]||days<345&&["MM",round(days/30)]||years===1&&["y"]||["yy",years];args[2]=withoutSuffix;args[3]=milliseconds>0;args[4]=lang;return substituteTimeAgo.apply({},args)}function weekOfYear(mom,firstDayOfWeek,firstDayOfWeekOfYear){var end=firstDayOfWeekOfYear-firstDayOfWeek,daysToDayOfWeek=firstDayOfWeekOfYear-mom.day(),adjustedMoment;if(daysToDayOfWeek>end){daysToDayOfWeek-=7}if(daysToDayOfWeek<end-7){daysToDayOfWeek+=7}adjustedMoment=moment(mom).add("d",daysToDayOfWeek);return{week:Math.ceil(adjustedMoment.dayOfYear()/7),year:adjustedMoment.year()}}function dayOfYearFromWeeks(year,week,weekday,firstDayOfWeekOfYear,firstDayOfWeek){var d=makeUTCDate(year,0,1).getUTCDay(),daysToAdd,dayOfYear;weekday=weekday!=null?weekday:firstDayOfWeek;daysToAdd=firstDayOfWeek-d+(d>firstDayOfWeekOfYear?7:0)-(d<firstDayOfWeek?7:0);dayOfYear=7*(week-1)+(weekday-firstDayOfWeek)+daysToAdd+1;return{year:dayOfYear>0?year:year-1,dayOfYear:dayOfYear>0?dayOfYear:daysInYear(year-1)+dayOfYear}}function makeMoment(config){var input=config._i,format=config._f;if(input===null||(format===undefined&&input==="")){return moment.invalid({nullInput:true})}if(typeof input==="string"){config._i=input=getLangDefinition().preparse(input)}if(moment.isMoment(input)){config=cloneMoment(input);config._d=new Date(+input._d)}else{if(format){if(isArray(format)){makeDateFromStringAndArray(config)}else{makeDateFromStringAndFormat(config)}}else{makeDateFromInput(config)}}return new Moment(config)}moment=function(input,format,lang,strict){var c;if(typeof (lang)==="boolean"){strict=lang;lang=undefined}c={};c._isAMomentObject=true;c._i=input;c._f=format;c._l=lang;c._strict=strict;c._isUTC=false;c._pf=defaultParsingFlags();return makeMoment(c)};moment.suppressDeprecationWarnings=false;moment.createFromInputFallback=deprecate("moment construction falls back to js Date. This is "+"discouraged and will be removed in upcoming major "+"release. Please refer to "+"https://github.com/moment/moment/issues/1407 for more info.",function(config){config._d=new Date(config._i)});moment.utc=function(input,format,lang,strict){var c;if(typeof (lang)==="boolean"){strict=lang;lang=undefined}c={};c._isAMomentObject=true;c._useUTC=true;c._isUTC=true;c._l=lang;c._i=input;c._f=format;c._strict=strict;c._pf=defaultParsingFlags();return makeMoment(c).utc()};moment.unix=function(input){return moment(input*1000)};moment.duration=function(input,key){var duration=input,match=null,sign,ret,parseIso;if(moment.isDuration(input)){duration={ms:input._milliseconds,d:input._days,M:input._months}}else{if(typeof input==="number"){duration={};if(key){duration[key]=input}else{duration.milliseconds=input}}else{if(!!(match=aspNetTimeSpanJsonRegex.exec(input))){sign=(match[1]==="-")?-1:1;duration={y:0,d:toInt(match[DATE])*sign,h:toInt(match[HOUR])*sign,m:toInt(match[MINUTE])*sign,s:toInt(match[SECOND])*sign,ms:toInt(match[MILLISECOND])*sign}}else{if(!!(match=isoDurationRegex.exec(input))){sign=(match[1]==="-")?-1:1;parseIso=function(inp){var res=inp&&parseFloat(inp.replace(",","."));return(isNaN(res)?0:res)*sign};duration={y:parseIso(match[2]),M:parseIso(match[3]),d:parseIso(match[4]),h:parseIso(match[5]),m:parseIso(match[6]),s:parseIso(match[7]),w:parseIso(match[8])}}}}}ret=new Duration(duration);if(moment.isDuration(input)&&input.hasOwnProperty("_lang")){ret._lang=input._lang}return ret};moment.version=VERSION;moment.defaultFormat=isoFormat;moment.momentProperties=momentProperties;moment.updateOffset=function(){};moment.lang=function(key,values){var r;if(!key){return moment.fn._lang._abbr}if(values){loadLang(normalizeLanguage(key),values)}else{if(values===null){unloadLang(key);key="en"}else{if(!languages[key]){getLangDefinition(key)}}}r=moment.duration.fn._lang=moment.fn._lang=getLangDefinition(key);return r._abbr};moment.langData=function(key){if(key&&key._lang&&key._lang._abbr){key=key._lang._abbr}return getLangDefinition(key)};moment.isMoment=function(obj){return obj instanceof Moment||(obj!=null&&obj.hasOwnProperty("_isAMomentObject"))};moment.isDuration=function(obj){return obj instanceof Duration};for(i=lists.length-1;i>=0;--i){makeList(lists[i])}moment.normalizeUnits=function(units){return normalizeUnits(units)};moment.invalid=function(flags){var m=moment.utc(NaN);if(flags!=null){extend(m._pf,flags)}else{m._pf.userInvalidated=true}return m};moment.parseZone=function(){return moment.apply(null,arguments).parseZone()};moment.parseTwoDigitYear=function(input){return toInt(input)+(toInt(input)>68?1900:2000)};extend(moment.fn=Moment.prototype,{clone:function(){return moment(this)},valueOf:function(){return +this._d+((this._offset||0)*60000)},unix:function(){return Math.floor(+this/1000)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var m=moment(this).utc();if(0<m.year()&&m.year()<=9999){return formatMoment(m,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}else{return formatMoment(m,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")}},toArray:function(){var m=this;return[m.year(),m.month(),m.date(),m.hours(),m.minutes(),m.seconds(),m.milliseconds()]},isValid:function(){return isValid(this)},isDSTShifted:function(){if(this._a){return this.isValid()&&compareArrays(this._a,(this._isUTC?moment.utc(this._a):moment(this._a)).toArray())>0}return false},parsingFlags:function(){return extend({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){this.zone(0);this._isUTC=false;return this},format:function(inputString){var output=formatMoment(this,inputString||moment.defaultFormat);return this.lang().postformat(output)},add:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,1);return this},subtract:function(input,val){var dur;if(typeof input==="string"){dur=moment.duration(+val,input)}else{dur=moment.duration(input,val)}addOrSubtractDurationFromMoment(this,dur,-1);return this},diff:function(input,units,asFloat){var that=makeAs(input,this),zoneDiff=(this.zone()-that.zone())*60000,diff,output;units=normalizeUnits(units);if(units==="year"||units==="month"){diff=(this.daysInMonth()+that.daysInMonth())*43200000;output=((this.year()-that.year())*12)+(this.month()-that.month());output+=((this-moment(this).startOf("month"))-(that-moment(that).startOf("month")))/diff;output-=((this.zone()-moment(this).startOf("month").zone())-(that.zone()-moment(that).startOf("month").zone()))*60000/diff;if(units==="year"){output=output/12}}else{diff=(this-that);output=units==="second"?diff/1000:units==="minute"?diff/60000:units==="hour"?diff/3600000:units==="day"?(diff-zoneDiff)/86400000:units==="week"?(diff-zoneDiff)/604800000:diff}return asFloat?output:absRound(output)},from:function(time,withoutSuffix){return moment.duration(this.diff(time)).lang(this.lang()._abbr).humanize(!withoutSuffix)},fromNow:function(withoutSuffix){return this.from(moment(),withoutSuffix)},calendar:function(){var sod=makeAs(moment(),this).startOf("day"),diff=this.diff(sod,"days",true),format=diff<-6?"sameElse":diff<-1?"lastWeek":diff<0?"lastDay":diff<1?"sameDay":diff<2?"nextDay":diff<7?"nextWeek":"sameElse";return this.format(this.lang().calendar(format,this))},isLeapYear:function(){return isLeapYear(this.year())},isDST:function(){return(this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone())},day:function(input){var day=this._isUTC?this._d.getUTCDay():this._d.getDay();if(input!=null){input=parseWeekday(input,this.lang());return this.add({d:input-day})}else{return day}},month:makeAccessor("Month",true),startOf:function(units){units=normalizeUnits(units);switch(units){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}if(units==="week"){this.weekday(0)}else{if(units==="isoWeek"){this.isoWeekday(1)}}if(units==="quarter"){this.month(Math.floor(this.month()/3)*3)}return this},endOf:function(units){units=normalizeUnits(units);return this.startOf(units).add((units==="isoWeek"?"week":units),1).subtract("ms",1)},isAfter:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)>+moment(input).startOf(units)},isBefore:function(input,units){units=typeof units!=="undefined"?units:"millisecond";return +this.clone().startOf(units)<+moment(input).startOf(units)},isSame:function(input,units){units=units||"ms";return +this.clone().startOf(units)===+makeAs(input,this).startOf(units)},min:function(other){other=moment.apply(null,arguments);return other<this?this:other},max:function(other){other=moment.apply(null,arguments);return other>this?this:other},zone:function(input,keepTime){var offset=this._offset||0;if(input!=null){if(typeof input==="string"){input=timezoneMinutesFromString(input)}if(Math.abs(input)<16){input=input*60}this._offset=input;this._isUTC=true;if(offset!==input){if(!keepTime||this._changeInProgress){addOrSubtractDurationFromMoment(this,moment.duration(offset-input,"m"),1,false)}else{if(!this._changeInProgress){this._changeInProgress=true;moment.updateOffset(this,true);this._changeInProgress=null}}}}else{return this._isUTC?offset:this._d.getTimezoneOffset()}return this},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){if(this._tzm){this.zone(this._tzm)}else{if(typeof this._i==="string"){this.zone(this._i)}}return this},hasAlignedHourOffset:function(input){if(!input){input=0}else{input=moment(input).zone()}return(this.zone()-input)%60===0},daysInMonth:function(){return daysInMonth(this.year(),this.month())},dayOfYear:function(input){var dayOfYear=round((moment(this).startOf("day")-moment(this).startOf("year"))/86400000)+1;return input==null?dayOfYear:this.add("d",(input-dayOfYear))},quarter:function(input){return input==null?Math.ceil((this.month()+1)/3):this.month((input-1)*3+this.month()%3)},weekYear:function(input){var year=weekOfYear(this,this.lang()._week.dow,this.lang()._week.doy).year;return input==null?year:this.add("y",(input-year))},isoWeekYear:function(input){var year=weekOfYear(this,1,4).year;return input==null?year:this.add("y",(input-year))},week:function(input){var week=this.lang().week(this);return input==null?week:this.add("d",(input-week)*7)},isoWeek:function(input){var week=weekOfYear(this,1,4).week;return input==null?week:this.add("d",(input-week)*7)},weekday:function(input){var weekday=(this.day()+7-this.lang()._week.dow)%7;return input==null?weekday:this.add("d",input-weekday)},isoWeekday:function(input){return input==null?this.day()||7:this.day(this.day()%7?input:input-7)},isoWeeksInYear:function(){return weeksInYear(this.year(),1,4)},weeksInYear:function(){var weekInfo=this._lang._week;return weeksInYear(this.year(),weekInfo.dow,weekInfo.doy)},get:function(units){units=normalizeUnits(units);return this[units]()},set:function(units,value){units=normalizeUnits(units);if(typeof this[units]==="function"){this[units](value)}return this},lang:function(key){if(key===undefined){return this._lang}else{this._lang=getLangDefinition(key);return this}}});function rawMonthSetter(mom,value){var dayOfMonth;if(typeof value==="string"){value=mom.lang().monthsParse(value);if(typeof value!=="number"){return mom}}dayOfMonth=Math.min(mom.date(),daysInMonth(mom.year(),value));mom._d["set"+(mom._isUTC?"UTC":"")+"Month"](value,dayOfMonth);return mom}function rawGetter(mom,unit){return mom._d["get"+(mom._isUTC?"UTC":"")+unit]()}function rawSetter(mom,unit,value){if(unit==="Month"){return rawMonthSetter(mom,value)}else{return mom._d["set"+(mom._isUTC?"UTC":"")+unit](value)}}function makeAccessor(unit,keepTime){return function(value){if(value!=null){rawSetter(this,unit,value);moment.updateOffset(this,keepTime);return this}else{return rawGetter(this,unit)}}}moment.fn.millisecond=moment.fn.milliseconds=makeAccessor("Milliseconds",false);moment.fn.second=moment.fn.seconds=makeAccessor("Seconds",false);moment.fn.minute=moment.fn.minutes=makeAccessor("Minutes",false);moment.fn.hour=moment.fn.hours=makeAccessor("Hours",true);moment.fn.date=makeAccessor("Date",true);moment.fn.dates=deprecate("dates accessor is deprecated. Use date instead.",makeAccessor("Date",true));moment.fn.year=makeAccessor("FullYear",true);moment.fn.years=deprecate("years accessor is deprecated. Use year instead.",makeAccessor("FullYear",true));moment.fn.days=moment.fn.day;moment.fn.months=moment.fn.month;moment.fn.weeks=moment.fn.week;moment.fn.isoWeeks=moment.fn.isoWeek;moment.fn.quarters=moment.fn.quarter;moment.fn.toJSON=moment.fn.toISOString;extend(moment.duration.fn=Duration.prototype,{_bubble:function(){var milliseconds=this._milliseconds,days=this._days,months=this._months,data=this._data,seconds,minutes,hours,years;data.milliseconds=milliseconds%1000;seconds=absRound(milliseconds/1000);data.seconds=seconds%60;minutes=absRound(seconds/60);data.minutes=minutes%60;hours=absRound(minutes/60);data.hours=hours%24;days+=absRound(hours/24);data.days=days%30;months+=absRound(days/30);data.months=months%12;years=absRound(months/12);data.years=years},weeks:function(){return absRound(this.days()/7)},valueOf:function(){return this._milliseconds+this._days*86400000+(this._months%12)*2592000000+toInt(this._months/12)*31536000000},humanize:function(withSuffix){var difference=+this,output=relativeTime(difference,!withSuffix,this.lang());if(withSuffix){output=this.lang().pastFuture(difference,output)}return this.lang().postformat(output)},add:function(input,val){var dur=moment.duration(input,val);this._milliseconds+=dur._milliseconds;this._days+=dur._days;this._months+=dur._months;this._bubble();return this},subtract:function(input,val){var dur=moment.duration(input,val);this._milliseconds-=dur._milliseconds;this._days-=dur._days;this._months-=dur._months;this._bubble();return this},get:function(units){units=normalizeUnits(units);return this[units.toLowerCase()+"s"]()},as:function(units){units=normalizeUnits(units);return this["as"+units.charAt(0).toUpperCase()+units.slice(1)+"s"]()},lang:moment.fn.lang,toIsoString:function(){var years=Math.abs(this.years()),months=Math.abs(this.months()),days=Math.abs(this.days()),hours=Math.abs(this.hours()),minutes=Math.abs(this.minutes()),seconds=Math.abs(this.seconds()+this.milliseconds()/1000);if(!this.asSeconds()){return"P0D"}return(this.asSeconds()<0?"-":"")+"P"+(years?years+"Y":"")+(months?months+"M":"")+(days?days+"D":"")+((hours||minutes||seconds)?"T":"")+(hours?hours+"H":"")+(minutes?minutes+"M":"")+(seconds?seconds+"S":"")}});function makeDurationGetter(name){moment.duration.fn[name]=function(){return this._data[name]}}function makeDurationAsGetter(name,factor){moment.duration.fn["as"+name]=function(){return +this/factor}}for(i in unitMillisecondFactors){if(unitMillisecondFactors.hasOwnProperty(i)){makeDurationAsGetter(i,unitMillisecondFactors[i]);makeDurationGetter(i.toLowerCase())}}makeDurationAsGetter("Weeks",604800000);moment.duration.fn.asMonths=function(){return(+this-this.years()*31536000000)/2592000000+this.years()*12};moment.lang("en",{ordinal:function(number){var b=number%10,output=(toInt(number%100/10)===1)?"th":(b===1)?"st":(b===2)?"nd":(b===3)?"rd":"th";return number+output}});function makeGlobal(shouldDeprecate){if(typeof ender!=="undefined"){return }oldGlobalMoment=globalScope.moment;if(shouldDeprecate){globalScope.moment=deprecate("Accessing Moment through the global scope is "+"deprecated, and will be removed in an upcoming "+"release.",moment)}else{globalScope.moment=moment}}if(hasModule){module.exports=moment}else{if(typeof define==="function"&&define.amd){define("moment",function(require,exports,module){if(module.config&&module.config()&&module.config().noGlobal===true){globalScope.moment=oldGlobalMoment}return moment});makeGlobal(true)}else{makeGlobal()}}}).call(this);;
;/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/moment.jira.i18n.js' */
(function(moment){var timeUnits=WRM.data.claim("jira.webresources:dateFormatProvider.dateFormat");var map={d:"D",y:"Y",a:"A",E:"d",u:"d",Z:"ZZ",z:"[GMT]ZZ",XX:"ZZ",XXX:"Z"};JIRA.translateSimpleDateFormat=function(pattern){var inQuote=false,skip=false,tmpBuffer="",actuallyTranslate=function(tmpBuffer){return map[tmpBuffer]||_.reduce(tmpBuffer,function(memo,value){return memo+(map[value]||value)},"")},reduction=_.reduce(pattern,function(memo,value,index,list){if(skip){skip=false}else{if(value==="'"){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}if(list[index+1]==="'"){memo+=value;skip=true}else{memo+=!inQuote?"[":"]";inQuote=!inQuote}}else{if(inQuote){memo+=value}else{if(!/[a-zA-Z]/.test(value)){if(tmpBuffer){memo+=actuallyTranslate(tmpBuffer);tmpBuffer=""}memo+=value}else{if(!tmpBuffer||tmpBuffer[tmpBuffer.length-1]===value){tmpBuffer+=value}else{memo+=actuallyTranslate(tmpBuffer);tmpBuffer=value}}}}}return memo},"");if(tmpBuffer){reduction+=actuallyTranslate(tmpBuffer)}return reduction};moment.lang("jira",{months:timeUnits.months,monthsShort:timeUnits.monthsShort,weekdays:timeUnits.weekdays,weekdaysShort:timeUnits.weekdaysShort,weekdaysMin:timeUnits.weekdaysShort,longDateFormat:{LT:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-time")),L:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-day")),LL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-dmy")),LLL:JIRA.translateSimpleDateFormat(AJS.Meta.get("date-complete"))},meridiem:function(hours){return timeUnits.meridiem[+(hours>11)]},calendar:{sameDay:"LLL",nextDay:"LLL",nextWeek:"LLL",lastDay:"LLL",lastWeek:"LLL",sameElse:"LLL"},relativeTime:{future:AJS.format("in {0}","%s"),past:AJS.format("{0} ago","%s"),s:"a few seconds",m:"a minute",mm:AJS.format("{0} minutes","%d"),h:"an hour",hh:AJS.format("{0} hours","%d"),d:"a day",dd:AJS.format("{0} days","%d"),M:"a month",MM:AJS.format("{0} months","%d"),y:"a year",yy:AJS.format("{0} years","%d")}})}(moment));;
;/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/time.js' */
(function($,moment){JIRA.Time={};function Type(str,isAge){this.key=str;this.isAge=isAge}var relativize=AJS.Meta.getBoolean("date-relativize");Type.types={};for(var a=["shortAge","longAge","fullAge","short","long","full","timestamp"],i=0,l=a.length,t;i<l;i++){t=a[i];Type.types[t]=new Type(t,t.toLowerCase().indexOf("age")!==-1)}JIRA.Time.FormatType=Type;function getTextForRelativeAge(age,type,param){switch(age){case"inAMoment":return "Now";case"inOneMinute":return "In 1 minute";case"inXMinutes":return AJS.format("In {0} minutes",param);case"inOneHour":return "In 1 hour";case"inXHours":return AJS.format("In {0} hours",param);case"inOneDay":return "Tomorrow";case"inXDays":return AJS.format("In {0} days",param);case"inOneWeek":return "In 1 week";case"aMomentAgo":return "Just now";case"oneMinuteAgo":return "1 minute ago";case"xMinutesAgo":return AJS.format("{0} minutes ago",param);case"oneHourAgo":return "1 hour ago";case"xHoursAgo":return AJS.format("{0} hours ago",param);case"oneDayAgo":return "Yesterday";case"xDaysAgo":return AJS.format("{0} days ago",param);case"oneWeekAgo":return "1 week ago";default:return null}}function getFormatString(type){switch(type.key){case"short":case"shortAge":return"ll";case"long":case"longAge":return"LL";case"full":case"fullAge":return"LLL";case"timestamp":return"LLL";default:return null}}function beginningOfDay(time){return time.clone().hours(0).minutes(0).seconds(0).milliseconds(0)}function isYesterday(now,date){var end=beginningOfDay(now);var start=end.clone().subtract("d",1);return start<=date&&date<end}function isTomorrow(now,date){var start=beginningOfDay(now).add("d",1);var end=start.clone().add("d",1);return start<=date&&date<end}function getMinutesBetween(start,end){return Math.floor(end.diff(start,"minutes",true))}function getHoursBetween(start,end){var hourDiff=end.diff(start,"hours",true);return Math.round(hourDiff)}function getDaysBetween(start,end){return Math.floor(end.diff(start,"days",true))}function formatDateWithFormatString(date,type){var formatString=getFormatString(type);return date.format(formatString)}function formatDateWithRelativeAge(date,type,now){now=now||moment();if(date<=now){if(date>now.clone().subtract("m",1)){return getTextForRelativeAge("aMomentAgo",type)}else{if(date>now.clone().subtract("m",2)){return getTextForRelativeAge("oneMinuteAgo",type)}else{if(date>now.clone().subtract("m",50)){return getTextForRelativeAge("xMinutesAgo",type,getMinutesBetween(date,now))}else{if(date>now.clone().subtract("m",90)){return getTextForRelativeAge("oneHourAgo",type)}else{if(isYesterday(now,date)&&date<now.clone().subtract("h",5)){return getTextForRelativeAge("oneDayAgo",type)}else{if(date>now.clone().subtract("d",1)){return getTextForRelativeAge("xHoursAgo",type,getHoursBetween(date,now))}else{if(date>now.clone().subtract("d",7)){return getTextForRelativeAge("xDaysAgo",type,Math.max(getDaysBetween(date,now),2))}else{if(date>now.clone().subtract("d",8)){return getTextForRelativeAge("oneWeekAgo",type)}}}}}}}}}else{if(date<now.clone().add("m",1)){return getTextForRelativeAge("inAMoment",type)}else{if(date<now.clone().add("m",2)){return getTextForRelativeAge("inOneMinute",type)}else{if(date<now.clone().add("m",50)){return getTextForRelativeAge("inXMinutes",type,getMinutesBetween(now,date))}else{if(date<now.clone().add("m",90)){return getTextForRelativeAge("inOneHour",type)}else{if(isTomorrow(now,date)&&date>now.clone().add("h",5)){return getTextForRelativeAge("inOneDay",type)}else{if(date<now.clone().add("d",1)){return getTextForRelativeAge("inXHours",type,getHoursBetween(now,date))}else{if(date<now.clone().add("d",7)){return getTextForRelativeAge("inXDays",type,Math.max(getDaysBetween(now,date),2))}else{if(date<now.clone().add("d",8)){return getTextForRelativeAge("inOneWeek",type)}}}}}}}}}return formatDateWithFormatString(date,type)}JIRA.Time.formatDate=function formatDate(momentDate,type,forceRelativize){if(momentDate&&type){if((relativize||forceRelativize)&&type.isAge){return formatDateWithRelativeAge(momentDate,type)}else{return formatDateWithFormatString(momentDate,type)}}else{return null}};JIRA.Time.formatDateWithRelativeAge=formatDateWithRelativeAge;JIRA.Time.formatDateWithFormatString=formatDateWithFormatString}(jQuery,moment));;
;/* module-key = 'jira.webresources:jquery-livestamp', location = '/includes/jquery/plugins/livestamp/livestamp.js' */
(function($,moment){var timeout,updateInterval=6000,relativize=AJS.Meta.getBoolean("date-relativize"),livestamps=[],prep=function($el,timestamp){$el.data("livestampdata",timestamp);livestamps.push($el)},run=function(){clearTimeout(timeout);update();timeout=setTimeout(run,updateInterval)},update=function(){livestamps=$.grep(livestamps,function($el){var timestamp=$el.data("livestampdata"),forceRelativize=$el.data("relativize"),from,to;if(!moment.isMoment(timestamp)||!$el.closest("html").length){$el.removeData("livestampdata")}else{from=$el.text();var tsFormat=$el.data("datetime-format");tsFormat=tsFormat?tsFormat:"fullAge";if(!(relativize||forceRelativize)){tsFormat=tsFormat.replace("Age","")}to=JIRA.Time.formatDate(timestamp,JIRA.Time.FormatType.types[tsFormat],forceRelativize);if(from!==to){$el.text(to)}}return !!$el.data("livestampdata")})},add=function($el){$el.each(function(){var $this=$(this),timestamp=$this.attr("datetime");if(timestamp){var timestampMoment=isNaN(timestamp)?moment(timestamp).zone(timestamp):moment(parseInt(timestamp,10));prep($this,timestampMoment)}});run();return $el};$.fn.livestamp=function(){return add(this)}}(jQuery,moment));;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-expander', location = 'js/aui-experimental-expander.js' */
(function(D){var E=D(document),C=function(G){var F={};F.$trigger=D(G.currentTarget);F.$content=E.find("#"+F.$trigger.attr("aria-controls"));F.triggerIsParent=F.$content.parent().filter(F.$trigger).length!==0;F.$shortContent=F.triggerIsParent?F.$trigger.find(".aui-expander-short-content"):null;F.height=F.$content.css("min-height");F.isCollapsible=F.$trigger.data("collapsible")!==false;F.replaceText=F.$trigger.attr("data-replace-text");F.replaceSelector=F.$trigger.data("replace-selector");return F},B=function(G){if(G.replaceText){var F=G.replaceSelector?G.$trigger.find(G.replaceSelector):G.$trigger;G.$trigger.attr("data-replace-text",F.text());F.text(G.replaceText)}};var A={"aui-expander-invoke":function(I){var F=D(I.currentTarget);var H=E.find("#"+F.attr("aria-controls"));var G=F.data("collapsible")!==false;if(H.attr("aria-expanded")==="true"&&G){F.trigger("aui-expander-collapse")}else{F.trigger("aui-expander-expand")}},"aui-expander-expand":function(G){var F=C(G);F.$content.attr("aria-expanded","true");F.$trigger.attr("aria-expanded","true");if(F.$content.outerHeight()>0){F.$content.attr("aria-hidden","false")}B(F);if(F.triggerIsParent){F.$shortContent.hide()}F.$trigger.trigger("aui-expander-expanded")},"aui-expander-collapse":function(G){var F=C(G);B(F);F.$content.attr("aria-expanded","false");F.$trigger.attr("aria-expanded","false");if(F.triggerIsParent){F.$shortContent.show()}if(F.$content.outerHeight()===0){F.$content.attr("aria-hidden","true")}F.$trigger.trigger("aui-expander-collapsed")},"click.aui-expander":function(G){var F=D(G.currentTarget);F.trigger("aui-expander-invoke",G.currentTarget)}};E.on(A,".aui-expander-trigger")})(jQuery);;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-public', location = 'js/applinks.public.js' */
var ApplinksUtils=ApplinksUtils||(function(f){var c={},b={};var p="com_atlassian_applinks_authentication";function o(r){var q=f('<span class="aui-icon icon-close"></span>').click(function(){r.trigger("messageClose",[this]).remove()});r.append(q)}function g(){if(window===parent.window){return null}var r=null,q=window;f("iframe",parent.document.body).each(function(s){if(this.contentWindow.window===q){r=this}});return r}function d(r,w,v,q,s){if(w in c){var t=c[w];if(v){t.authAdminUri=q;delete c[w]}j(t,v)}if(!s&&parent&&(parent!==window)){var u=window;f("iframe",parent.document.body).each(function(x,z){var y=z.contentWindow;if(y!==u){if(y.AJS&&y.AJS.$){y.AJS.$(y.document).trigger("applinks.auth.completion",[w,v,q,true])}}})}}function j(q,t){var s=f(document);if(t){var r=function(u){if(u.isDefaultPrevented()){m(q)}else{h(q);document.location.reload(true)}};s.bind("applinks.auth.approved",r);s.trigger("applinks.auth.approved",q);s.unbind("applinks.auth.approved",r)}else{s.trigger("applinks.auth.denied",q)}}function k(r,q){var s=r.find("a.applink-authenticate");if(r.hasClass("aui-message")){o(r)}s.click(function(t){window.open(q.authUri,p);t.preventDefault()});c[q.id]=q;return r}function n(){f(".applinks-auth-request").each(function(t){var s=f(this),v=s.find(".applinkId").val(),q=s.find(".appName").val(),r=s.find(".appUri").val(),u=s.find(".authUri").val();if(v&&u){k(s,{id:v,appName:q,appUri:r,authUri:u})}})}function i(q){var r=f('<div class="aui-message warning closeable applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');r.append(AJS.format("Additional information may be available, please \u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",AJS.escapeHtml(q.authUri),AJS.escapeHtml(q.appUri),AJS.escapeHtml(q.appName)));k(r,q);return r}function e(u,r){var q=f('<span class="applinks-auth-request"></span>'),s=f('<span class="applinks-request-description"></span>'),t=AJS.format("\u003ca class=\"applink-authenticate\" href=\"{0}\"\u003eAuthenticate\u003c/a\u003e to see additional information.",AJS.escapeHtml(r.authUri));if(u){s.append(u);s.append(" - ")}s.append(t);q.append(s);k(q,r);return q}function h(q){var r=g();if((!r)||(!r.id)){return}if(!parent.ApplinksUtils.pendingConfirmations){parent.ApplinksUtils.pendingConfirmations={}}if(!(r.id in parent.ApplinksUtils.pendingConfirmations)){parent.ApplinksUtils.pendingConfirmations[r.id]=[]}parent.ApplinksUtils.pendingConfirmations[r.id].push(q);return}function l(){if(parent&&parent.ApplinksUtils&&parent.ApplinksUtils.pendingConfirmations){var r=g();if(r){if(r.id in parent.ApplinksUtils.pendingConfirmations){var s=parent.ApplinksUtils.pendingConfirmations[r.id];delete parent.ApplinksUtils.pendingConfirmations[r.id];for(var q=0,t=s.length;q<t;q++){m(s[q])}}}}}function m(s){var t=f(document),r=f('<div class="aui-message success closeable applinks-auth-confirmation"><p><span class="aui-icon icon-applinks-key-success"></span></p></div>'),q=t.find("div.applinks-auth-confirmation-container");if(!q.length){q=t.find("body")}r.append(AJS.format("This application is now using \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e\'\'s credentials. Revoke access at any time by going to \u003ca href=\"{2}\"\u003eOAuth access tokens\u003c/a\u003e.",AJS.escapeHtml(s.appUri),AJS.escapeHtml(s.appName),AJS.escapeHtml(s.authAdminUri)));o(r);q.prepend(r);setTimeout(function(){r.fadeOut(1000,function(){f(this).remove()})},5000)}function a(){if(parent&&!(parent===window)){if(!parent.ApplinksUtils){parent.ApplinksUtils={}}}f(document).bind("applinks.auth.completion",d);n();l()}f(document).ready(a);return{createAuthRequestBanner:i,createAuthRequestInline:e}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.plugins.jira-transition-triggers-plugin:dev-status-common-resources', location = 'js/workflow/TriggersPluginBackboneDefine.js' */
if(Backbone&&!Backbone.define){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-transition-triggers-plugin:dev-status-common-resources', location = 'js/devstatus/FeedbackDialog.js' */
Backbone.define("JIRA.DevStatus.FeedbackDialog",Backbone.Model.extend({properties:["collectorId","summary"],defaults:{summary:"Tell us what you think.",collectorId:"effe8b72"},show:function(){var a=this.get("collectorId");window.ATL_JQ_PAGE_PROPS=window.ATL_JQ_PAGE_PROPS||{};window.ATL_JQ_PAGE_PROPS[a]={fieldValues:{summary:this.get("summary")},triggerFunction:function(b){_.defer(function(){b()})}};AJS.$.getScript(this._collectorUrlFor(a))},_collectorUrlFor:function(a){return"https://jira.atlassian.com/s/d41d8cd98f00b204e9800998ecf8427e/en_UK-7m3tmj-1988229788/6307/131/1.4.8/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector.js?collectorId="+a}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DevStatusBackboneDefine.js' */
if(Backbone&&!Backbone.define){Backbone.define=function(name,ctor){eval("Backbone['Class: "+name+"'] = function() { Backbone['Class: "+name+"'].__ctor.apply(this, arguments); }");var cls=Backbone["Class: "+name];cls.__ctor=ctor;ctor.prototype.name=name;cls.prototype=ctor.prototype;_.extend(cls,ctor);_.each(ctor.prototype,function(fn,fnName){if(typeof fn==="function"){fn.displayName=name+"."+fnName}});var context=window;var parts=name.split(".");_.each(parts,function(part,i){if(i===parts.length-1){context[part]=cls}else{context=context[part]==null?(context[part]={}):context[part]}});return cls}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DateUtils.js' */
(function(a){AJS.namespace("JIRA.DevStatus.Date");JIRA.DevStatus.Date={addTooltip:function(c){var b=c.find("time.livestamp");b.livestamp();b.each(function(){var f=a(this);var e=f.attr("datetime");var g=isNaN(e)?e:+e;var d=moment(g).zone(g);if(!d.isValid()){d=moment(g)}f.attr("title",d.format(JIRA.DevStatus.Date.format))})},format:"LLL"}}(AJS.$));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/Listeners.js' */
Backbone.define("JIRA.DevStatus.Util.Listeners",Class.extend({init:function(){this._listening=[]},startListening:function(a,c,e,b){var d={start:function(){a.on(c,e,b);return this},stop:function(){a.off(c,e,b);return this}};this._listening.push(d.start())},stopListening:function(){_.each(this._listening,function(a){a.stop()});this._listening=[]}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:utils', location = 'js/util/DevStatusURLUtils.js' */
(function(a){AJS.namespace("JIRA.DevStatus.URL");JIRA.DevStatus.URL={getDetailDialogParam:function(){var b=this._removeKickAssIHashFromUrl(JIRA.DevStatus.Navigate.getUrl());var c=parseUri(b);return c&&c.queryKey&&c.queryKey.devStatusDetailDialog},getUrlWithDetailDialogParam:function(d){var b=this._removeKickAssIHashFromUrl(JIRA.DevStatus.Navigate.getUrl());var c=parseUri(b);c.queryKey.devStatusDetailDialog=encodeURIComponent(d);return this.createUrlFromParsedUri(c)},getCreateReviewDetailUrl:function(b){return this.getUrlWithDetailDialogParam("create-review-"+b)},isCreateReviewDetailDialogLink:function(b){return b&&b.lastIndexOf&&b.lastIndexOf("create-review-",0)===0},getCreateReviewDetailDialogApplicationType:function(b){return b.substring("create-review-".length)},_removeKickAssIHashFromUrl:function(b){return b.replace("i#","")},createUrlFromParsedUri:function(c){var d=[];AJS.$.each(c.queryKey,function(e,f){if(_.isObject(f)){AJS.$.each(f,function(g,h){d.push(e+"="+h)})}else{d.push(e+"="+f)}});var b="";if(c.protocol){b+=c.protocol+"://"}if(c.authority){b+=c.authority}if(c.path){b+=c.path}if(d.length>0){b+="?"+d.join("&")}if(c.anchor){b+="#"+c.anchor}return b}}}(AJS.$));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:fusion-widget-common-clientside', location = 'templates/fusion-widget/fusion-widget-common.soy' */
// This file was automatically generated from fusion-widget-common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.FusionWidget == 'undefined') { JIRA.Templates.FusionWidget = {}; }
if (typeof JIRA.Templates.FusionWidget.Common == 'undefined') { JIRA.Templates.FusionWidget.Common = {}; }


JIRA.Templates.FusionWidget.Common.branches = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("{0}{1}{2} {1,choice,1#branch|1\x3cbranches}",'<span class="count">',opt_data.count,'</span>'));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.buildsText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var tagStart__soy6 = '<span class="count">';
  var tagEnd__soy7 = '</span>';
  output.append((opt_data.successfulBuildCount > 0) ? (opt_data.failedBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",tagStart__soy6,opt_data.failedBuildCount,tagEnd__soy7) : (opt_data.unknownBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds}",tagStart__soy6,opt_data.successfulBuildCount,tagEnd__soy7) : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds}",tagStart__soy6,opt_data.count,tagEnd__soy7) : (opt_data.failedBuildCount > 0) ? (opt_data.unknownBuildCount > 0) ? AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",tagStart__soy6,opt_data.failedBuildCount,tagEnd__soy7) : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} failing",tagStart__soy6,opt_data.count,tagEnd__soy7) : AJS.format("{0}{1}{2} {1,choice,1#build|1\x3cbuilds} incomplete",tagStart__soy6,opt_data.count,tagEnd__soy7));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.buildsIconClass = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.failedBuildCount > 0) ? 'aui-iconfont-error' : (opt_data.successfulBuildCount > 0) ? 'aui-iconfont-approve' : (opt_data.unknownBuildCount > 0) ? 'aui-iconfont-devtools-task-cancelled' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.commits = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("{0}{1}{2} {1,choice,1#commit|1\x3ccommits}",'<span class="count">',opt_data.count,'</span>'));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.deployments = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var instanceOne__soy43 = new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.deploymentsInstance({environment: opt_data.topEnvironments[0], showProjects: opt_data.showProjects}, instanceOne__soy43);
  instanceOne__soy43 = instanceOne__soy43.toString();
  var instanceTwo__soy47 = new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.deploymentsInstance({environment: opt_data.topEnvironments[1], showProjects: opt_data.showProjects}, instanceTwo__soy47);
  instanceTwo__soy47 = instanceTwo__soy47.toString();
  var instanceThree__soy51 = new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.deploymentsInstance({environment: opt_data.topEnvironments[2], showProjects: opt_data.showProjects}, instanceThree__soy51);
  instanceThree__soy51 = instanceThree__soy51.toString();
  output.append(AJS.format("{5}Deployed{6} to {0,choice,1#{1}|2#{1} and {2}|3#{1}, {2} and {3}|3\x3c{1}, {2}, {3}, and {4} more}",opt_data.successfulCount,instanceOne__soy43,instanceTwo__soy47,instanceThree__soy51,opt_data.successfulCount - 3,opt_data.anchorStart,opt_data.anchorEnd));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.deploymentsInstance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.environment) ? '<span class="environment" ' + ((opt_data.showProjects) ? 'title="' + soy.$$escapeHtml(AJS.format("Project: {0}",opt_data.environment.project)) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.environment.title) + '</span>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.pullRequestsText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("{0}{1}{2} {1,choice,1#pull request|1\x3cpull requests}",'<span class="count">',opt_data.stateCount,'</span>'));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.reviewsText = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("{0}{1}{2} {1,choice,1#review|1\x3creviews}",'<span class="count">',opt_data.stateCount,'</span>'));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.reviewsState = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.stateLozenge({isSubtle: opt_data.isSubtle, lozengeClass: opt_data.stateClasses[opt_data.state], text: opt_data.stateText[opt_data.state], classes: opt_data.classes, tooltip: opt_data.tooltip, tooltipClass: opt_data.tooltipClass, tooltipText: opt_data.tooltipText}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.pullRequestsStateViewIssue = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: true, state: opt_data.state, stateClasses: {'OPEN': 'aui-lozenge-complete', 'MERGED': 'aui-lozenge-success', 'DECLINED': 'aui-lozenge-error'}, stateText: {'OPEN': "OPEN", 'MERGED': "MERGED", 'DECLINED': "DECLINED"}, classes: 'pullrequest-state'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.pullRequestsStateReleaseReport = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: true, state: opt_data.state, stateClasses: {'OPEN': 'aui-lozenge-complete', 'MERGED': 'aui-lozenge-success', 'DECLINED': 'aui-lozenge-error'}, stateText: {'OPEN': "Under Review", 'MERGED': "MERGED", 'DECLINED': "DECLINED"}, tooltip: true, tooltipClass: 'fusion-widget-tooltip', tooltipText: opt_data.tooltipText}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: true, state: opt_data.state, stateClasses: {'REVIEW': 'aui-lozenge-current', 'CLOSED': 'aui-lozenge-success', 'DRAFT': 'aui-lozenge-complete', 'DEAD': 'aui-lozenge-error', 'REJECTED': 'aui-lozenge-error', 'UNKNOWN': 'aui-lozenge-error', 'APPROVAL': '', 'SUMMARIZE': ''}, stateText: {'REVIEW': "Review", 'CLOSED': "Closed", 'DRAFT': "Draft", 'DEAD': "Abandoned", 'REJECTED': "Rejected", 'UNKNOWN': "Unknown", 'APPROVAL': "Approval", 'SUMMARIZE': "Summarize"}}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.reviewsStateReleaseReport = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: true, state: opt_data.state, stateClasses: {'REVIEW': 'aui-lozenge-complete', 'CLOSED': 'aui-lozenge-success', 'DRAFT': 'aui-lozenge-complete', 'DEAD': 'aui-lozenge-error', 'REJECTED': 'aui-lozenge-error', 'UNKNOWN': 'aui-lozenge-error', 'APPROVAL': 'aui-lozenge-complete', 'SUMMARIZE': 'aui-lozenge-complete'}, stateText: {'REVIEW': "Under Review", 'CLOSED': "Closed", 'DRAFT': "Draft", 'DEAD': "Abandoned", 'REJECTED': "Rejected", 'UNKNOWN': "Unknown", 'APPROVAL': "Under Review", 'SUMMARIZE': "Under Review"}, tooltip: true, tooltipClass: 'fusion-widget-tooltip', tooltipText: opt_data.tooltipText}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.FusionWidget.Common.stateLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-lozenge aui-lozenge-overflow ', (opt_data.isSubtle) ? 'aui-lozenge-subtle' : '', ' ', soy.$$escapeHtml(opt_data.lozengeClass), ' ', (opt_data.tooltip) ? soy.$$escapeHtml(opt_data.tooltipClass) : '', ' ', (opt_data.classes) ? soy.$$escapeHtml(opt_data.classes) : '', '"', (opt_data.tooltip) ? 'data-tooltip="' + soy.$$escapeHtml(opt_data.tooltipText) + '"' : '', '>', soy.$$escapeHtml(opt_data.text), '</span>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/common/devstatus-common.soy' */
// This file was automatically generated from devstatus-common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Common == 'undefined') { JIRA.Templates.DevStatus.Common = {}; }


JIRA.Templates.DevStatus.Common.learnMoreLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(' <a href="https://www.atlassian.com/software-development" class="learn-more-link" target="_blank">', soy.$$escapeHtml("Learn more"), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-cta-dialog.soy' */
// This file was automatically generated from devstatus-cta-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Dialog == 'undefined') { JIRA.Templates.DevStatus.Dialog = {}; }


JIRA.Templates.DevStatus.Dialog.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading">', (opt_data.prompt) ? '<h2>' + soy.$$escapeHtml(opt_data.prompt) + '</h2>' : '', '</div><div class="jira-dialog-content"><ul class="targets">');
  var remoteAppList10 = opt_data.remoteApps;
  var remoteAppListLen10 = remoteAppList10.length;
  for (var remoteAppIndex10 = 0; remoteAppIndex10 < remoteAppListLen10; remoteAppIndex10++) {
    var remoteAppData10 = remoteAppList10[remoteAppIndex10];
    output.append('<li>');
    JIRA.Templates.DevStatus.Dialog.remoteApp(remoteAppData10, output);
    output.append('</li>');
  }
  output.append('</ul><div class="buttons-container"><div class="buttons"><button class="aui-button aui-button-link cancel" id="aui-dialog-close">', soy.$$escapeHtml("Cancel"), '</button></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Dialog.remoteApp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="target ', (opt_data.primary) ? 'primary' : '', '" data-application-type="', soy.$$escapeHtml(opt_data.applicationType), '" href="', soy.$$escapeHtml(opt_data.url), '">', (opt_data.iconUrl) ? '<img class="application-icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '">' : '<span class="application-icon ' + soy.$$escapeHtml(opt_data.iconClass) + '"></span>', '<div class="title" title="', soy.$$escapeHtml(opt_data.name), '">', soy.$$escapeHtml(opt_data.name), '</div><div class="base-url" title="', soy.$$escapeHtml(opt_data.baseUrl), '">', soy.$$escapeHtml(opt_data.baseUrl), '</div></a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-panel.soy' */
// This file was automatically generated from devstatus-panel.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }


JIRA.Templates.DevStatus.connectionProblemAsInfoWithoutIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages({errorInstances: opt_data.instances, notConfiguredInstances: opt_data.notConfiguredInstances, showContactAdminForm: opt_data.showContactAdminForm}, param3);
  aui.message.info({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemAsWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param10 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages({errorInstances: opt_data.instances, notConfiguredInstances: opt_data.notConfiguredInstances, showContactAdminForm: opt_data.showContactAdminForm}, param10);
  aui.message.warning({content: param10.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionAndConfigErrorsMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if ((! opt_data.errorInstances || opt_data.errorInstances.length == 0) && (! opt_data.notConfiguredInstances || opt_data.notConfiguredInstances.length == 0)) {
    output.append('<p class="connection-error">', "JIRA is having difficulty contacting the applications that supply development status information.", ' ');
    JIRA.Templates.DevStatus.contactAdmin(opt_data, output);
    output.append('</p>');
  } else {
    if (opt_data.errorInstances.length > 0) {
      output.append('<p class="connection-error">');
      JIRA.Templates.DevStatus.connectionProblemMultipleInstances({instances: opt_data.errorInstances}, output);
      output.append(' ');
      JIRA.Templates.DevStatus.contactAdmin(opt_data, output);
      output.append('</p>');
    }
    if (opt_data.notConfiguredInstances && opt_data.notConfiguredInstances.length > 0) {
      output.append('<p class="config-errors">');
      JIRA.Templates.DevStatus.configProblem(opt_data, output);
      output.append('</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.contactAdmin = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(AJS.format("If this condition persists, please contact your {0}JIRA administrators{1}.",opt_data.showContactAdminForm ? '<a id="contact-admin" href="' + "" + '/secure/ContactAdministrators!default.jspa">' : '',opt_data.showContactAdminForm ? '</a>' : ''));
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p class="connection-error">');
  if (! opt_data.instances || opt_data.instances.length == 0) {
    output.append("JIRA is having difficulty contacting the applications that supply development status information.");
  } else {
    JIRA.Templates.DevStatus.connectionProblemMultipleInstances(opt_data, output);
  }
  output.append(' ', AJS.format("If this condition persists, please contact your {0}JIRA administrators{1}.",opt_data.showContactAdminForm ? '<a id="contact-admin" href="' + "" + '/secure/ContactAdministrators!default.jspa">' : '',opt_data.showContactAdminForm ? '</a>' : ''), '</p>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.configProblem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var servers__soy56 = opt_data.notConfiguredInstances;
  output.append('<span class="description">');
  var server0__soy58 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy56[0]}, server0__soy58);
  server0__soy58 = server0__soy58.toString();
  if (servers__soy56.length == 1) {
    output.append(AJS.format("Couldn\x27\x27t read data from {0}.",server0__soy58));
  } else {
    var server1__soy66 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy56[1]}, server1__soy66);
    server1__soy66 = server1__soy66.toString();
    if (servers__soy56.length == 2) {
      output.append(AJS.format("Couldn\x27\x27t read data from {0} and {1}.",server0__soy58,server1__soy66));
    } else {
      var server2__soy74 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: servers__soy56[2]}, server2__soy74);
      server2__soy74 = server2__soy74.toString();
      output.append((servers__soy56.length == 3) ? AJS.format("Couldn\x27\x27t read data from {0}, {1}, and {2}.",server0__soy58,server1__soy66,server2__soy74) : AJS.format("Couldn\x27\x27t read data from {0}, {1}, {2}, and {3} other {3,choice,1#application|1\x3capplications}.",server0__soy58,server1__soy66,server2__soy74,servers__soy56.length - 3));
    }
  }
  output.append('</span> <span class="hints">');
  var aOpenLearnMore__soy85 = new soy.StringBuilder('<a href="https://confluence.atlassian.com/x/OQNwGg" target="_blank">');
  aOpenLearnMore__soy85 = aOpenLearnMore__soy85.toString();
  var aOpenApplinks__soy87 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(""), '/plugins/servlet/applinks/listApplicationLinks">');
  aOpenApplinks__soy87 = aOpenApplinks__soy87.toString();
  var aClose__soy91 = new soy.StringBuilder('</a>');
  aClose__soy91 = aClose__soy91.toString();
  output.append(AJS.format("Learn {0}about this issue{1} or go to {2}application links{3} to fix it.",aOpenLearnMore__soy85,aClose__soy91,aOpenApplinks__soy87,aClose__soy91), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemMultipleInstances = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var instance0__soy97 = new soy.StringBuilder();
  JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[0]}, instance0__soy97);
  instance0__soy97 = instance0__soy97.toString();
  if (opt_data.instances.length == 1) {
    output.append(AJS.format("JIRA is having difficulty contacting {0}.",instance0__soy97));
  } else {
    var instance1__soy105 = new soy.StringBuilder();
    JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[1]}, instance1__soy105);
    instance1__soy105 = instance1__soy105.toString();
    if (opt_data.instances.length == 2) {
      output.append(AJS.format("JIRA is having difficulty contacting {0} and {1}.",instance0__soy97,instance1__soy105));
    } else {
      var instance2__soy113 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.connectionProblemSingleInstance({instance: opt_data.instances[2]}, instance2__soy113);
      instance2__soy113 = instance2__soy113.toString();
      output.append(AJS.format("JIRA is having difficulty contacting {0}, {1}, {3,choice,0#and {2}|1#{2}, and another application|1\x3c{2}, and {3} more applications}.",instance0__soy97,instance1__soy105,instance2__soy113,opt_data.instances.length - 3));
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.connectionProblemSingleInstance = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="instance" data-name="', soy.$$escapeHtml(opt_data.instance.name), '"><a href="', soy.$$escapeHtml(opt_data.instance.baseUrl), '" title="', soy.$$escapeHtml(opt_data.instance.name), '">', soy.$$escapeHtml(opt_data.instance.name), '</a></span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.labsOnOff = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((! opt_data.isOptedInByAdmin && ! opt_data.isOptedIn) ? '<div class="on-off-panel aui-message closeable"><h2 class="title">' + soy.$$escapeHtml("JIRA Labs") + '</h2><p>' + soy.$$escapeHtml("The new way to see your related commits and pull requests as they occur.") + '</p><span class="aui-icon icon-close labs-close" role="button" tabindex="0" title="' + soy.$$escapeHtml("Close the JIRA Labs panel") + '"></span><div class="aui-group"><div class="aui-item"><button class="toggle-labs aui-button" title="' + soy.$$escapeHtml("Enable JIRA Labs for development panel") + '">' + soy.$$escapeHtml("Enable Labs") + '</button></div></div>' : '<div class="on-off-panel opted-in"><span class="feedback-link"><a href="#" title="' + soy.$$escapeHtml("Give Atlassian feedback about the JIRA development panel") + '">' + soy.$$escapeHtml("Feedback") + '</a></span>' + ((! opt_data.isOptedInByAdmin) ? ' | <span class="disable-labs"><a class="toggle-labs" href="#" title="' + soy.$$escapeHtml("Disable JIRA Labs for the development panel") + '">' + soy.$$escapeHtml("Disable Labs") + '</span></span>' : '') + '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.tryLabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span href="#" class="try-labs" title="', soy.$$escapeHtml("Show the JIRA Labs panel"), '">', soy.$$escapeHtml("Try Labs"), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.lastUpdated = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.lastUpdated) {
    output.append('<dd class="sub-text', (opt_data.extraClass) ? ' ' + soy.$$escapeHtml(opt_data.extraClass) : '', '">');
    JIRA.Templates.DevStatus.transitionContainer({content: '<div>' + soy.$$escapeHtml(opt_data.text) + ' <time class="livestamp date user-tz allow-future" ' + ((opt_data.datetimeFormat) ? 'data-datetime-format="' + soy.$$escapeHtml(opt_data.datetimeFormat) + '" ' : '') + 'datetime="' + soy.$$escapeHtml(opt_data.lastUpdated) + '">$' + soy.$$escapeHtml(opt_data.lastUpdated) + '</time></div>'}, output);
    output.append('</dd>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.transitionContainer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="rolling-container sliding-container"><div class="rolling-content">', opt_data.content, '</div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog.soy' */
// This file was automatically generated from devstatus-detail-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.frame = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-dialog-heading devstatus-dialog-heading ', (opt_data.tabs.length > 1) ? 'borderless' : '', '"><h2>', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="jira-dialog-content devstatus-dialog-content">');
  JIRA.Templates.DevStatus.DetailDialog.applicationTabs(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.applicationTabs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-tabs horizontal-tabs"><ul class="tabs-menu ', (opt_data.tabs.length == 1) ? 'hidden' : '', '" >');
  var tabList18 = opt_data.tabs;
  var tabListLen18 = tabList18.length;
  for (var tabIndex18 = 0; tabIndex18 < tabListLen18; tabIndex18++) {
    var tabData18 = tabList18[tabIndex18];
    output.append('<li id="tab-menu-', soy.$$escapeHtml(tabData18.type), '" data-application-type=', soy.$$escapeHtml(tabData18.type), ' class="menu-item ', (! opt_data.initialTab && tabIndex18 == 0 || tabData18.type == opt_data.initialTab) ? ' active-tab' : '', '"><a  href="#tab-content-', soy.$$escapeHtml(tabData18.type), '"><strong>', soy.$$escapeHtml(tabData18.name), '</strong><span class="aui-badge devstatus-tab-count">', soy.$$escapeHtml(tabData18.count), '</span></a></li>');
  }
  output.append('</ul><div class="form-body">');
  var tabList36 = opt_data.tabs;
  var tabListLen36 = tabList36.length;
  for (var tabIndex36 = 0; tabIndex36 < tabListLen36; tabIndex36++) {
    var tabData36 = tabList36[tabIndex36];
    output.append('<div class="tabs-pane ', (tabIndex36 == 0) ? 'active-pane' : '', '" id="tab-content-', soy.$$escapeHtml(tabData36.type), '"><div class="status-loading"></div><div class="detail-content-container"></div></div>');
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.repositoryHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="repository-header', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '"><div class="aui-group aui-group-split repository-header-group"><div class="aui-item project-space">');
  JIRA.Templates.DevStatus.DetailDialog.projectInfo(opt_data, output);
  output.append('</div>', (opt_data.extraContent) ? '<div class="aui-item action-space">' + opt_data.extraContent + '</div>' : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectInfo = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-avatar" ', (opt_data.repository.avatarDescription) ? 'title="' + soy.$$escapeHtml(opt_data.repository.avatarDescription) + '"' : '', '><span class="aui-avatar aui-avatar-small aui-avatar-project ', (opt_data.repository.avatar) ? 'fusion-avatar-project' : 'default-avatar-project', '">', (opt_data.repository.avatar) ? '<span class="aui-avatar-inner"><img src="' + soy.$$escapeHtml(opt_data.repository.avatar) + '" /></span>' : '<span class="aui-avatar-inner aui-icon aui-icon-small aui-iconfont-devtools-repository"></span>', '</span></div><div class="project-info">', (opt_data.repository.url) ? '<a class="repository-link" href="' + soy.$$escapeHtml(opt_data.repository.url) + '"' + ((opt_data.showTooltip) ? ' title="' + soy.$$escapeHtml(opt_data.repository.name) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.repository.name) + '</a>' : '<span class="repository-link" ' + ((opt_data.showTooltip) ? ' title="' + soy.$$escapeHtml(opt_data.repository.name) + '"' : '') + '>' + soy.$$escapeHtml(opt_data.repository.name) + '</span>', '</div><div class="extra-project-info">', (opt_data.showParent && opt_data.repository.parent && opt_data.repository.parent.name && opt_data.repository.parent.url) ? '<a class="fork-off" href="' + soy.$$escapeHtml(opt_data.repository.parent.url) + '"><span class="fork-name" title="' + soy.$$escapeHtml(AJS.format("Fork of {0}",opt_data.repository.parent.name)) + '">' + soy.$$escapeHtml(AJS.format("Fork of {0}",opt_data.repository.parent.name)) + '</span></a>' : '', (opt_data.extraProjectInfo) ? opt_data.extraProjectInfo : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.oauthStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-info" /> ', soy.$$escapeHtml(opt_data.message), ' ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.authenticationScreen = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="authentication-problem"><div class="image"></div><h2>', soy.$$escapeHtml(opt_data.title), '</h2><p>', soy.$$escapeHtml(AJS.format("Please log in to approve {0,choice,1#this application|1\x3cthese applications}:",opt_data.unauthInstances.length)), ' <span class="instances"></span></p>');
  if (opt_data.otherInstances.length > 0) {
    JIRA.Templates.DevStatus.connectionProblemAsWarning({instances: opt_data.otherInstances, showContactAdminForm: opt_data.showContactAdminForm}, output);
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.connectionProblemScreen = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="connection-problem"><div class="image"></div><h2>', soy.$$escapeHtml(opt_data.title), '</h2>');
  JIRA.Templates.DevStatus.connectionProblem(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.noPermissionToViewAll = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="no-permission-to-view-all"><div class="lock-image"></div><span>', soy.$$escapeHtml(opt_data.message), '</span>', (opt_data.secondaryMessage) ? ' <span>' + soy.$$escapeHtml(opt_data.secondaryMessage) + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.timestamp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.timestamp) ? '<time class="livestamp date user-tz" datetime="' + soy.$$escapeHtml(opt_data.timestamp) + '" data-datetime-format="longAge">' + soy.$$escapeHtml(opt_data.timestamp) + '</time>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.vcsUser = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span><div class="vcs-user"><span class="extra-content-in-title ', (opt_data.approved) ? 'fade' : '', '" title="', soy.$$escapeHtml(opt_data.name), '"><img class="author-avatar" src="', soy.$$escapeHtml(opt_data.avatar), '"/></span>', (opt_data.approved) ? '<span class="approved">✓</span>' : '', '</div></span>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/build/devstatus-detail-dialog-build.soy' */
// This file was automatically generated from devstatus-detail-dialog-build.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.build = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var projectList3 = opt_data.projects;
  var projectListLen3 = projectList3.length;
  for (var projectIndex3 = 0; projectIndex3 < projectListLen3; projectIndex3++) {
    var projectData3 = projectList3[projectIndex3];
    JIRA.Templates.DevStatus.DetailDialog.projectContent({project: projectData3, projectIndex: projectIndex3, withArtifactColumn: opt_data.hasArtifacts, applicationType: opt_data.applicationType}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-builds-container">');
  JIRA.Templates.DevStatus.DetailDialog.projectHeader(opt_data, output);
  output.append('<div class="devstatus-detail-table builds-table', (opt_data.withArtifactColumn) ? ' builds-table-with-artifact-column' : '', '"><table class="aui"><thead><tr><th class="plan">', soy.$$escapeHtml("Plan"), '</th><th class="build cell-type-collapsed">', soy.$$escapeHtml("Latest build"), '</th><th class="result cell-type-collapsed">', soy.$$escapeHtml("Result"), '</th><th class="timestamp cell-type-collapsed">', soy.$$escapeHtml("Completed"), '</th>', (opt_data.withArtifactColumn) ? '<th class="actions cell-type-collapsed"></th>' : '', '</tr></thead><tbody>');
  var planList30 = opt_data.project.plans;
  var planListLen30 = planList30.length;
  for (var planIndex30 = 0; planIndex30 < planListLen30; planIndex30++) {
    var planData30 = planList30[planIndex30];
    var planHasArtifacts__soy31 = planData30.build.artifacts && planData30.build.artifacts.length;
    var uniqueIdSuffix__soy32 = opt_data.projectIndex + '-' + planIndex30;
    output.append('<tr class="plan-row', (planHasArtifacts__soy31) ? ' merge' : '', '"><td class="plan">');
    JIRA.Templates.DevStatus.DetailDialog.planName({plan: planData30}, output);
    output.append('</td><td class="build">');
    JIRA.Templates.DevStatus.DetailDialog.buildIcon({build: planData30.build}, output);
    output.append(' <a class="build-link" href="', soy.$$escapeHtml(planData30.build.url), '">', soy.$$escapeHtml(AJS.format("#{0}",planData30.build.buildNumber)), '</a></td><td class="result">');
    JIRA.Templates.DevStatus.DetailDialog.buildResult({build: planData30.build}, output);
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: planData30.build.finishedDate}, output);
    output.append('</td>');
    if (opt_data.withArtifactColumn) {
      output.append('<td class="actions">');
      if (planHasArtifacts__soy31) {
        aui.expander.trigger({id: 'detail-dialog-build-show-artifacts-trigger-' + uniqueIdSuffix__soy32, contentId: 'detail-dialog-build-show-artifacts-content-' + uniqueIdSuffix__soy32, tag: 'a', content: "Show artifacts", replaceText: "Hide artifacts"}, output);
      }
      output.append('</td>');
    }
    output.append('</tr>');
    if (planHasArtifacts__soy31) {
      output.append('<tr class="artifacts"><td colspan="5">');
      var param71 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.DetailDialog.artifactsTable({build: planData30.build}, param71);
      aui.expander.content({id: 'detail-dialog-build-show-artifacts-content-' + uniqueIdSuffix__soy32, content: param71.toString()}, output);
      output.append('</td></tr>');
    }
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.projectHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="builds-header"><div class="project-info"><h2 class="ellipsis"><a class="project-link" href="', soy.$$escapeHtml(opt_data.project.url), '" title="', soy.$$escapeHtml(opt_data.project.name), '">', soy.$$escapeHtml(opt_data.project.name), '</a></h2></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.planName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><span class="plan-name">', (opt_data.plan.isBranch) ? '<a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + ' &rsaquo; ' + soy.$$escapeHtml(opt_data.plan.branchName) + '">' + soy.$$escapeHtml(opt_data.plan.name) + '</a> &rsaquo; <span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small">' + soy.$$escapeHtml(opt_data.plan.branchName) + '</span><a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + ' &rsaquo; ' + soy.$$escapeHtml(opt_data.plan.branchName) + '">' + soy.$$escapeHtml(opt_data.plan.branchName) + '</a>' : '<a class="plan-link" href="' + soy.$$escapeHtml(opt_data.plan.url) + '" title="' + soy.$$escapeHtml(opt_data.plan.name) + '">' + soy.$$escapeHtml(opt_data.plan.name) + '</a>', '</span>', (opt_data.plan.disabled) ? '<span class="aui-lozenge aui-lozenge-subtle disabled" title="' + soy.$$escapeHtml("This plan is disabled") + '">' + soy.$$escapeHtml("Disabled") + '</span>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.build.buildState == 'SUCCESS' || opt_data.build.buildState == 'FAILED') {
    if (opt_data.build.testSummary) {
      var duration__soy131 = new soy.StringBuilder();
      JIRA.Templates.DevStatus.DetailDialog.buildDuration(opt_data, duration__soy131);
      duration__soy131 = duration__soy131.toString();
      output.append('<span>', (opt_data.build.testSummary.failedTestCount > 0) ? (opt_data.build.testSummary.successfulTestCount) ? soy.$$escapeHtml(AJS.format("{0} of {1} tests failed in {2}",opt_data.build.testSummary.failedTestCount,opt_data.build.testSummary.totalTestCount,duration__soy131)) : soy.$$escapeHtml(AJS.format("{0} {0,choice,1#test|1\x3ctests} failed in {1}",opt_data.build.testSummary.failedTestCount,duration__soy131)) : (opt_data.build.testSummary.successfulTestCount > 0) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#test|1\x3ctests} passed in {1}",opt_data.build.testSummary.successfulTestCount,duration__soy131)) : (opt_data.build.buildState == 'SUCCESS') ? soy.$$escapeHtml(AJS.format("Passed in {0}",duration__soy131)) : soy.$$escapeHtml(AJS.format("Failed in {0}",duration__soy131)), '</span>');
    }
  } else {
    output.append(soy.$$escapeHtml("Build incomplete"));
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildDuration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.build) ? (opt_data.build.durationInSeconds < 1) ? soy.$$escapeHtml("under 1 second") : (opt_data.build.durationInSeconds < 90) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#second|1\x3cseconds}",opt_data.build.durationInSeconds)) : (opt_data.build.durationInSeconds < 5400) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#minute|1\x3cminutes}",Math.floor(opt_data.build.durationInSeconds / 60))) : soy.$$escapeHtml(AJS.format("{0} {0,choice,1#hour|1\x3chours}",Math.floor(opt_data.build.durationInSeconds / 60 / 60))) : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.buildIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var iconClass__soy167 = new soy.StringBuilder((opt_data.build.buildState == 'SUCCESS') ? 'aui-iconfont-approve' : (opt_data.build.buildState == 'FAILED') ? 'aui-iconfont-error' : 'aui-iconfont-devtools-task-cancelled');
  iconClass__soy167 = iconClass__soy167.toString();
  output.append('<span class="aui-icon aui-icon-small ', soy.$$escapeHtml(iconClass__soy167), '">', soy.$$escapeHtml(opt_data.build.buildState), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.artifactsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var column1Height__soy181 = Math.ceil(opt_data.build.artifacts.length / 3);
  var column2Height__soy182 = Math.ceil((opt_data.build.artifacts.length - 1) / 3);
  var column3Height__soy183 = Math.ceil((opt_data.build.artifacts.length - 2) / 3);
  output.append('<div class="build-artifacts-table"><table class="aui"><tbody>');
  var artifactIndexLimit185 = column1Height__soy181;
  for (var artifactIndex185 = 0; artifactIndex185 < artifactIndexLimit185; artifactIndex185++) {
    output.append('<tr><td>');
    JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185]}, output);
    output.append('</td><td>');
    if (artifactIndex185 < column2Height__soy182) {
      JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185 + column1Height__soy181]}, output);
    }
    output.append('</td><td>');
    if (artifactIndex185 < column3Height__soy183) {
      JIRA.Templates.DevStatus.DetailDialog.artifactName({artifact: opt_data.build.artifacts[artifactIndex185 + column1Height__soy181 + column2Height__soy182]}, output);
    }
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.artifactName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.artifact && opt_data.artifact.name) ? (opt_data.artifact.url) ? '<a class="artifact-link" href="' + soy.$$escapeHtml(opt_data.artifact.url) + '">' + soy.$$escapeHtml(opt_data.artifact.name) + '</a>' : soy.$$escapeHtml(opt_data.artifact.name) : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/deployment/devstatus-detail-dialog-deployment.soy' */
// This file was automatically generated from devstatus-detail-dialog-deployment.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Deployment == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Deployment = {}; }


JIRA.Templates.DevStatus.DetailDialog.Deployment.deployment = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var projectList3 = opt_data.deploymentProjects;
  var projectListLen3 = projectList3.length;
  for (var projectIndex3 = 0; projectIndex3 < projectListLen3; projectIndex3++) {
    var projectData3 = projectList3[projectIndex3];
    JIRA.Templates.DevStatus.DetailDialog.Deployment.projectContent({project: projectData3, applicationType: opt_data.applicationType}, output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.projectContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-deployments-container">');
  JIRA.Templates.DevStatus.DetailDialog.Deployment.projectHeader(opt_data, output);
  output.append('<div class="devstatus-detail-table deployments-table"><table class="aui"><thead><tr><th class="environment">', soy.$$escapeHtml("Environment"), '</th><th class="status cell-type-collapsed">', soy.$$escapeHtml("Status"), '</th><th class="release cell-type-collapsed">', soy.$$escapeHtml("Latest release"), '</th><th class="timestamp cell-type-collapsed">', soy.$$escapeHtml("Last deployed"), '</th></tr></thead><tbody>');
  var environmentList20 = opt_data.project.environments;
  var environmentListLen20 = environmentList20.length;
  for (var environmentIndex20 = 0; environmentIndex20 < environmentListLen20; environmentIndex20++) {
    var environmentData20 = environmentList20[environmentIndex20];
    output.append('<tr class="environment-row"><td class="environment">');
    JIRA.Templates.DevStatus.DetailDialog.Deployment.environmentName({environment: environmentData20}, output);
    output.append('</td><td class="status cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.Deployment.statusLozenge({environment: environmentData20}, output);
    output.append('</td><td class="release">');
    if (environmentData20.deployedVersion) {
      JIRA.Templates.DevStatus.DetailDialog.Deployment.release({release: environmentData20.deployedVersion}, output);
    }
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: environmentData20.lastDeployed}, output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.projectHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="deployments-header"><div class="project-info"><h2 class="ellipsis"><a class="project-link" href="', soy.$$escapeHtml(opt_data.project.url), '" title="', (opt_data.project.description) ? soy.$$escapeHtml(opt_data.project.description) : soy.$$escapeHtml(opt_data.project.name), '">', soy.$$escapeHtml(opt_data.project.name), '</a></h2><div class="ellipsis"><strong class="commit-info">', soy.$$escapeHtml(AJS.format("Commits were in release {0}",opt_data.project.latestVersions[0].name)), '</strong></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.environmentName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="environment-link" href="', soy.$$escapeHtml(opt_data.environment.url), '" title="', (opt_data.environment.description) ? soy.$$escapeHtml(opt_data.environment.description) : soy.$$escapeHtml(opt_data.environment.name), '">', soy.$$escapeHtml(opt_data.environment.name), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.statusLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.environment.status == 'DEPLOYED') ? '<span class="aui-lozenge aui-lozenge-subtle aui-lozenge-success">' + soy.$$escapeHtml("Deployed") + '</span>' : (opt_data.environment.status == 'FAILED') ? '<span class="aui-lozenge aui-lozenge-subtle aui-lozenge-error">' + soy.$$escapeHtml("Failed") + '</span>' : (opt_data.environment.status == 'NOT_DEPLOYED') ? '<span class="aui-lozenge aui-lozenge-subtle">' + soy.$$escapeHtml("Not deployed") + '</span>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Deployment.release = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.release.url) ? '<a class="release-link" href="' + soy.$$escapeHtml(opt_data.release.url) + '" title="' + soy.$$escapeHtml(opt_data.release.name) + '">' + soy.$$escapeHtml(opt_data.release.name) + '</a>' : soy.$$escapeHtml(opt_data.release.name));
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-commit.soy' */
// This file was automatically generated from devstatus-detail-dialog-commit.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.commit = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.canCreateReview) ? '<div class="aui-group aui-group-split"><div class="aui-item"></div><div class="aui-item"><div class="create-review-instance"><a href="#">' + soy.$$escapeHtml("Create review for all commits") + '</a></div></div></div>' : '');
  var repoList8 = opt_data.repositories;
  var repoListLen8 = repoList8.length;
  for (var repoIndex8 = 0; repoIndex8 < repoListLen8; repoIndex8++) {
    var repoData8 = repoList8[repoIndex8];
    JIRA.Templates.DevStatus.DetailDialog.commitContent(soy.$$augmentData(opt_data, {repository: repoData8, repositoryIndex: repoIndex8}), output);
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.commitContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-commits-container', (opt_data.repository.showReviews) ? ' has-reviews' : '', (opt_data.repository.showBranches) ? ' has-branches' : '', (opt_data.repository.showFiles) ? ' has-files' : '', ' ', (opt_data.repository.showCreateReview) ? 'has-actions' : '', '" data-repository-index="', soy.$$escapeHtml(opt_data.repositoryIndex), '" >');
  JIRA.Templates.DevStatus.DetailDialog.repositoryHeader(soy.$$augmentData(opt_data, {showParent: true, extraProjectInfo: (opt_data.repository.showInstance && opt_data.repository.instance) ? '<div class="repository-instance" title="' + soy.$$escapeHtml(opt_data.repository.instance.name) + '">(' + soy.$$escapeHtml(opt_data.repository.instance.name) + ')</div>' : '', extraContent: (opt_data.repository.showFiles) ? '<div class="file-expand"><a href="#">' + soy.$$escapeHtml("Show all files") + '</a></div>' : ''}), output);
  output.append('<div class="devstatus-detail-table commits-table"><table class="aui"><thead><tr><th class="author cell-type-collapsed">', soy.$$escapeHtml("Author"), '</th><th class="changeset cell-type-collapsed">', soy.$$escapeHtml("Commit"), '</th><th class="message">', soy.$$escapeHtml("Message"), '</th>', (opt_data.repository.showBranches) ? '<th class="branches"></th>' : '', (opt_data.repository.showReviews) ? '<th class="reviews">' + soy.$$escapeHtml("Reviews") + '</th>' : '', '<th class="timestamp">', soy.$$escapeHtml("Date"), '</th>', (opt_data.repository.showFiles) ? '<th class="filecount">' + soy.$$escapeHtml("Files") + '</th>' : '', (opt_data.repository.showCreateReview) ? '<th class="commit-actions">' + soy.$$escapeHtml("Actions") + '</th>' : '', '</tr></thead><tbody>');
  var commitList76 = opt_data.repository.commits;
  var commitListLen76 = commitList76.length;
  for (var commitIndex76 = 0; commitIndex76 < commitListLen76; commitIndex76++) {
    var commitData76 = commitList76[commitIndex76];
    output.append('<tr data-changesetid="', soy.$$escapeHtml(commitData76.id), '" class="commitrow', (commitData76.merge) ? ' merge' : '', '" data-commit-index="', soy.$$escapeHtml(commitIndex76), '"><td class="author">');
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(commitData76.author, output);
    output.append('</td><td class="changeset">', (commitData76.url) ? '<a class="changesetid" href="' + soy.$$escapeHtml(commitData76.url) + '">' + soy.$$escapeHtml(commitData76.displayId) + '</a>' : '<span class="changesetid">' + soy.$$escapeHtml(commitData76.displayId) + '</span>');
    if (commitData76.merge) {
      JIRA.Templates.DevStatus.DetailDialog.mergeLozenge(null, output);
    }
    output.append('</td><td class="message"><span class="ellipsis" title="', soy.$$escapeHtml(commitData76.message), '">', soy.$$truncate(soy.$$escapeHtml(commitData76.message), 500, true), '</span></td>');
    JIRA.Templates.DevStatus.DetailDialog.branchesColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    JIRA.Templates.DevStatus.DetailDialog.reviewColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    output.append('<td class="timestamp"><time class="livestamp" datetime="', soy.$$escapeHtml(commitData76.authorTimestamp), '" data-datetime-format="longAge"> ', soy.$$escapeHtml(commitData76.authorTimestamp), '</time></td>');
    if (opt_data.repository.showFiles) {
      JIRA.Templates.DevStatus.DetailDialog.filesColumn({count: commitData76.fileCount}, output);
    }
    if (opt_data.repository.showCreateReview) {
      JIRA.Templates.DevStatus.DetailDialog.actionsColumn(soy.$$augmentData(opt_data, {commit: commitData76}), output);
    }
    output.append('</tr>');
    if (opt_data.repository.showFiles) {
      JIRA.Templates.DevStatus.DetailDialog.filesRow(soy.$$augmentData(opt_data, {repository: opt_data.repository, commit: commitData76}), output);
    }
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.mergeLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-lozenge merge" title="', soy.$$escapeHtml("This commit is a merge"), '">', soy.$$escapeHtml("M"), '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchesColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.repository.showBranches) ? '<td class="branches">' + ((opt_data.commit.branches && opt_data.commit.branches.totalCount > 0) ? '<span class="branches-link aui-lozenge ref-lozenge"><span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small">Branch</span></button>' + ((opt_data.commit.branches.totalCount > 1) ? '<span class="branch-count">' + soy.$$escapeHtml(opt_data.commit.branches.totalCount) + '</span>' : '') + '</span>' : '') + '</td>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchesTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="branch-tooltip">');
  var branchList155 = opt_data.branchData.branches;
  var branchListLen155 = branchList155.length;
  for (var branchIndex155 = 0; branchIndex155 < branchListLen155; branchIndex155++) {
    var branchData155 = branchList155[branchIndex155];
    output.append('<div class="branch-name-tooltip">', soy.$$escapeHtml(branchData155.name), '</div>');
  }
  output.append((opt_data.branchData.totalCount > opt_data.branchData.branches.length) ? '<div class="branch-tooltip-summary">' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.branchData.totalCount - opt_data.branchData.branches.length)) + '</div>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.repository.showReviews) {
    output.append('<td class="reviews">');
    if (opt_data.commit.reviews && opt_data.commit.reviews.totalCount > 0) {
      output.append('<a class="reviews-link">');
      JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue({state: opt_data.commit.reviews.reviews[0].state}, output);
      output.append('</a>');
    }
    output.append('</td>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.actionsColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="commit-actions">', (opt_data.commit.createReviewUrl) ? '<div class="create-review-commit"><a href="' + soy.$$escapeHtml(opt_data.commit.createReviewUrl) + '">' + soy.$$escapeHtml("Create review") + '</a></div>' : '', '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.filesColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="filecount">', (opt_data.count > 0) ? '<a href="#" class="extra-content-in-title" title="' + soy.$$escapeHtml("Click to show files") + '">' + ((opt_data.count < 100) ? soy.$$escapeHtml(AJS.format("{0} {0,choice,1#file|1\x3cfiles}",opt_data.count)) : soy.$$escapeHtml(AJS.format("{0}+ files",100))) + '</a>' : '', '</td>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.filesRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="hidden ', soy.$$escapeHtml(opt_data.commit.fileCount > 0 && opt_data.commit.files ? 'filerow' : ''), '"><td colspan="5">');
  JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileRow({files: opt_data.commit.files, max: 5}, output);
  JIRA.Templates.DevStatus.DetailDialog.Commit.Files.moreFiles({files: opt_data.commit.files, fileCount: opt_data.commit.fileCount, instanceName: opt_data.repository.name, moreFilesUrl: opt_data.commit.url}, output);
  output.append('</td></tr>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewsInlineDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table><tbody>');
  var reviewList216 = opt_data.reviewData.reviews;
  var reviewListLen216 = reviewList216.length;
  for (var reviewIndex216 = 0; reviewIndex216 < reviewListLen216; reviewIndex216++) {
    var reviewData216 = reviewList216[reviewIndex216];
    output.append('<tr class="inline-review-row"><td class="inline-review-id"><a href="', soy.$$escapeHtml(reviewData216.url), '">', soy.$$escapeHtml(reviewData216.id), '</a></td><td class="inline-review-state">');
    JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue({state: reviewData216.state}, output);
    output.append('</td></tr>');
  }
  output.append((opt_data.reviewData.totalCount > opt_data.reviewData.reviews.length) ? '<tr><td class="inline-review-summary" colspan="2"><a href="' + soy.$$escapeHtml(opt_data.reviewData.url) + '">' + soy.$$escapeHtml(AJS.format("and {0} more",opt_data.reviewData.totalCount - opt_data.reviewData.reviews.length)) + '</a></td></tr>' : '', '</tbody></table>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/commit/devstatus-detail-dialog-commit-files.soy' */
// This file was automatically generated from devstatus-detail-dialog-commit-files.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Commit == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Commit = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog.Commit.Files == 'undefined') { JIRA.Templates.DevStatus.DetailDialog.Commit.Files = {}; }


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var fileList3 = opt_data.files;
  var fileListLen3 = fileList3.length;
  for (var fileIndex3 = 0; fileIndex3 < fileListLen3; fileIndex3++) {
    var fileData3 = fileList3[fileIndex3];
    if (fileIndex3 < opt_data.max) {
      output.append('<div class="file"><div class="change">');
      if (fileData3.linesAdded != null && fileData3.linesRemoved != null) {
        output.append('<div class="lines">', (fileData3.changeType == 'ADDED') ? '<span class="aui-lozenge added">' + soy.$$escapeHtml("Added") + '</span>' : (fileData3.changeType == 'DELETED') ? '<span class="aui-lozenge removed">' + soy.$$escapeHtml("Deleted") + '</span>' : '<span class="aui-lozenge added count">+' + soy.$$escapeHtml(fileData3.linesAdded) + '</span><span class="aui-lozenge removed count">-' + soy.$$escapeHtml(fileData3.linesRemoved) + '</span>', '</div>');
      } else {
        output.append('<div class="changetype">');
        JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileChangeLozenge({changeType: fileData3.changeType}, output);
        output.append('</div>');
      }
      output.append('</div><div class="filename ellipsis">', (fileData3.url) ? '<a href="' + soy.$$escapeHtml(fileData3.url) + '" title="' + soy.$$escapeHtml(fileData3.path) + '">' + soy.$$escapeHtml(fileData3.path) + '</a>' : soy.$$escapeHtml(fileData3.path), '</div></div>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.moreFiles = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.files.length < opt_data.fileCount) {
    if (opt_data.moreFilesUrl) {
      output.append('<a class="more-files-info" href="', soy.$$escapeHtml(opt_data.moreFilesUrl), '">', soy.$$escapeHtml(AJS.format("See more files in {0}",opt_data.instanceName)), '</a>');
    } else {
      var notShownFileCount__soy56 = opt_data.fileCount - opt_data.files.length;
      output.append('<span class="more-files-info">', soy.$$escapeHtml(AJS.format("and {0} more",notShownFileCount__soy56)), '</span>');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.Commit.Files.fileChangeLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var text__soy61 = new soy.StringBuilder();
  switch (opt_data.changeType) {
    case 'ADDED':
      text__soy61.append(soy.$$escapeHtml("Added"));
      break;
    case 'COPIED':
      text__soy61.append(soy.$$escapeHtml("Copied"));
      break;
    case 'DELETED':
      text__soy61.append(soy.$$escapeHtml("Deleted"));
      break;
    case 'MOVED':
      text__soy61.append(soy.$$escapeHtml("Moved"));
      break;
    default:
      text__soy61.append(soy.$$escapeHtml("Modified"));
  }
  text__soy61 = text__soy61.toString();
  var class__soy73 = new soy.StringBuilder();
  switch (opt_data.changeType) {
    case 'ADDED':
      class__soy73.append('success');
      break;
    case 'COPIED':
      class__soy73.append('current');
      break;
    case 'DELETED':
      class__soy73.append('error');
      break;
    case 'MOVED':
      class__soy73.append('moved');
      break;
    default:
      class__soy73.append('complete');
  }
  class__soy73 = class__soy73.toString();
  output.append('<span class="aui-lozenge aui-lozenge-', soy.$$escapeHtml(class__soy73), ' aui-lozenge-subtle">', soy.$$escapeHtml(text__soy61), '</span>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-branch-pullrequest.soy' */
// This file was automatically generated from devstatus-detail-dialog-branch-pullrequest.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.pullRequest = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-pullrequests-container"><div class="devstatus-detail-table pullrequests-table"><table class="aui"><thead><tr><th class="pullrequest-id">', soy.$$escapeHtml("ID"), '</th><th class="title">', soy.$$escapeHtml("Title"), '</th><th class="state">', soy.$$escapeHtml("Status"), '</th><th class="author">', soy.$$escapeHtml("Author"), '</th><th class="reviewer">', soy.$$escapeHtml("Reviewer"), '</th><th class="comment cell-type-collapsed"></th><th class="last-updated">', soy.$$escapeHtml("Updated"), '</th></tr></thead><tbody>');
  JIRA.Templates.DevStatus.DetailDialog.pullRequestEntry(opt_data, output);
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var pullRequestList19 = opt_data.pullRequests;
  var pullRequestListLen19 = pullRequestList19.length;
  for (var pullRequestIndex19 = 0; pullRequestIndex19 < pullRequestListLen19; pullRequestIndex19++) {
    var pullRequestData19 = pullRequestList19[pullRequestIndex19];
    output.append('<tr class="pullrequest-row"><td class="pullrequest-id"><a class="pullrequest-link" href="', soy.$$escapeHtml(pullRequestData19.url), '">', soy.$$escapeHtml(pullRequestData19.id), '</a></td><td class="title"><a class="pullrequest-link ellipsis" title="', soy.$$escapeHtml(pullRequestData19.name), '" href="', soy.$$escapeHtml(pullRequestData19.url), '">', soy.$$escapeHtml(pullRequestData19.name), '</a></td><td class="state">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: pullRequestData19.status, isSubtle: true}, output);
    output.append('</td><td class="author"><img class="author-avatar extra-content-in-title" src="', soy.$$escapeHtml(pullRequestData19.author.avatar), '" title="', soy.$$escapeHtml(pullRequestData19.author.name), '"/></td><td class="reviewer">');
    if (pullRequestData19.reviewers && pullRequestData19.reviewers.length != 0) {
      JIRA.Templates.DevStatus.DetailDialog.reviewersList(soy.$$augmentData(pullRequestData19, {countThreshold: opt_data.reviewersThreshold}), output);
    }
    output.append('</td><td class="comment cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.commentCount({pullRequest: pullRequestData19}, output);
    output.append('</td><td class="last-updated"><time class="livestamp" data-datetime-format="longAge" datetime="', soy.$$escapeHtml(pullRequestData19.lastUpdate), '">', soy.$$escapeHtml(pullRequestData19.lastUpdate), '</time></td></tr>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.commentCount = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.pullRequest.commentCount) ? '<div class="comment-container"><a class="comment-link" href="' + soy.$$escapeHtml(opt_data.pullRequest.url) + '" title="' + soy.$$escapeHtml("Comments") + '"><span class="aui-icon aui-icon-small aui-iconfont-comment">Comments</span></a><span class="count">' + soy.$$escapeHtml(opt_data.pullRequest.commentCount) + '</span></div>' : '');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.reviewersList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="reviewer-container">');
  var showThreshold__soy64 = opt_data.countThreshold + 1;
  var indexLimit65 = Math.min(opt_data.countThreshold, opt_data.reviewers.length);
  for (var index65 = 0; index65 < indexLimit65; index65++) {
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(opt_data.reviewers[index65], output);
  }
  if (opt_data.reviewers.length == showThreshold__soy64) {
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(opt_data.reviewers[opt_data.countThreshold], output);
  } else if (opt_data.reviewers.length > showThreshold__soy64) {
    output.append('<span class="aui-badge extrareviewers-tooltip reviewers-link" data-reviewers="', soy.$$escapeHtml(opt_data.extraReviewers), '">', soy.$$escapeHtml(opt_data.reviewers.length - opt_data.countThreshold), '</span>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="detail-branches-container"><div class="devstatus-detail-table branches-table"><table class="aui"><thead><tr><th class="repository">', soy.$$escapeHtml("Repository"), '</th><th class="branch">', soy.$$escapeHtml("Branch"), '</th>', (opt_data.features.pullRequests) ? '<th class="pullrequest">' + soy.$$escapeHtml("Pull request") + '</th><th class="action">' + soy.$$escapeHtml("Action") + '</th>' : '', (opt_data.features.lastCommitId) ? '<th class="changeset cell-type-collapsed">' + soy.$$escapeHtml("Last commit") + '</th>' : '', (opt_data.features.lastCommitTimestamp) ? '<th class="last-updated cell-type-collapsed">' + soy.$$escapeHtml("Last modified") + '</th>' : '', '</tr></thead><tbody>');
  JIRA.Templates.DevStatus.DetailDialog.branchEntry(opt_data, output);
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchEntry = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var branchList105 = opt_data.branches;
  var branchListLen105 = branchList105.length;
  for (var branchIndex105 = 0; branchIndex105 < branchListLen105; branchIndex105++) {
    var branchData105 = branchList105[branchIndex105];
    output.append('<tr class="branch-row"><td class="repository">');
    JIRA.Templates.DevStatus.DetailDialog.repositoryHeader(soy.$$augmentData(opt_data, {repository: branchData105.repository, showTooltip: true}), output);
    output.append('</td><td class="branch">');
    JIRA.Templates.DevStatus.DetailDialog.branchLozenge(branchData105, output);
    output.append('</td>');
    if (opt_data.features.pullRequests) {
      output.append('<td class="pullrequest">');
      JIRA.Templates.DevStatus.DetailDialog.pullRequestStatusForBranch(branchData105.pullRequestState, output);
      output.append('</td><td class="action">', (branchData105.createPullRequestUrl && branchData105.createPullRequestUrl.length > 0) ? '<a class="create-pullrequest-link" href="' + soy.$$escapeHtml(branchData105.createPullRequestUrl) + '">' + soy.$$escapeHtml("Create pull request") + '</a>' : '', '</td>');
    }
    output.append((opt_data.features.lastCommitId) ? '<td class="changeset cell-type-collapsed">' + ((branchData105.lastCommit && branchData105.lastCommit.displayId) ? (branchData105.lastCommit.url) ? '<a class="changeset-link changesetid" href="' + soy.$$escapeHtml(branchData105.lastCommit.url) + '">' + soy.$$escapeHtml(branchData105.lastCommit.displayId) + '</a>' : '<span class="changeset-link changesetid">' + soy.$$escapeHtml(branchData105.lastCommit.displayId) + '</span>' : '') + '</td>' : '');
    if (opt_data.features.lastCommitTimestamp) {
      output.append('<td class="last-updated cell-type-collapsed">');
      if (branchData105.lastCommit && branchData105.lastCommit.authorTimestamp) {
        JIRA.Templates.DevStatus.DetailDialog.timestamp({timestamp: branchData105.lastCommit.authorTimestamp}, output);
      }
      output.append('</td>');
    }
    output.append('</tr>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestStatusForBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.total > 0) {
    output.append('<a href="#" class="pullrequest-tooltip pullrequest-link pullrequest-status" data-detail="', soy.$$escapeHtml(opt_data.data), '">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: opt_data.status, isSubtle: true}, output);
    output.append('</a>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestSingle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="pullrequest-link', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '" href="', soy.$$escapeHtml(opt_data.url), '" ><span>', soy.$$escapeHtml(opt_data.id), ' ', soy.$$escapeHtml(opt_data.name), '</span></a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="reviewer"><div class="reviewer-container"><table class="aui"><tbody>');
  var reviewerList178 = opt_data.reviewers;
  var reviewerListLen178 = reviewerList178.length;
  for (var reviewerIndex178 = 0; reviewerIndex178 < reviewerListLen178; reviewerIndex178++) {
    var reviewerData178 = reviewerList178[reviewerIndex178];
    output.append('<tr><td class="reviewer-avatar">');
    JIRA.Templates.DevStatus.DetailDialog.vcsUser(reviewerData178, output);
    output.append('</td><td class="reviewer-name"><span title="', soy.$$escapeHtml(reviewerData178.name), '">', soy.$$escapeHtml(reviewerData178.name), '</span></td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestToolTip = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table class="aui"><tbody>');
  var pullRequestList190 = opt_data.pullRequests;
  var pullRequestListLen190 = pullRequestList190.length;
  for (var pullRequestIndex190 = 0; pullRequestIndex190 < pullRequestListLen190; pullRequestIndex190++) {
    var pullRequestData190 = pullRequestList190[pullRequestIndex190];
    output.append('<tr><td class="pullrequest-name">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestSingle(pullRequestData190, output);
    output.append('</td><td class="lozenge">');
    JIRA.Templates.DevStatus.DetailDialog.pullRequestState({status: pullRequestData190.status, isSubtle: false}, output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.pullRequestState = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.FusionWidget.Common.reviewsState({isSubtle: opt_data.isSubtle, state: opt_data.status, stateClasses: {'OPEN': 'aui-lozenge-complete', 'MERGED': 'aui-lozenge-success', 'DECLINED': 'aui-lozenge-error'}, stateText: {'OPEN': "OPEN", 'MERGED': "MERGED", 'DECLINED': "DECLINED"}, classes: 'pullrequest-state'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.DetailDialog.branchLozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="branch-name"><span class="aui-icon aui-icon-small aui-iconfont-devtools-branch-small"></span>', (opt_data.url) ? '<a class="branch-link' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '</a>' : '<span class="branch-link' + ((opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '') + '" title="' + soy.$$escapeHtml(opt_data.name) + '">' + soy.$$escapeHtml(opt_data.name) + '</span>', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'templates/viewissue/devstatus-detail-dialog-review.soy' */
// This file was automatically generated from devstatus-detail-dialog-review.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.DetailDialog == 'undefined') { JIRA.Templates.DevStatus.DetailDialog = {}; }


JIRA.Templates.DevStatus.DetailDialog.review = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="devstatus-detail-table detail-reviews-container"><div class="devstatus-detail-table reviews-table"><table class="aui"><thead><tr><th class="review cell-type-collapsed">', soy.$$escapeHtml("ID"), '</th><th class="title">', soy.$$escapeHtml("Title"), '</th><th class="state cell-type-collapsed">', soy.$$escapeHtml("Status"), '</th><th class="author cell-type-collapsed">', soy.$$escapeHtml("Author"), '</th><th class="reviewer cell-type-collapsed">', soy.$$escapeHtml("Reviewers"), '</th><th class="comment cell-type-collapsed"></th><th class="timestamp">', soy.$$escapeHtml("Date"), '</th></tr></thead><tbody>');
  var reviewList16 = opt_data.reviews;
  var reviewListLen16 = reviewList16.length;
  for (var reviewIndex16 = 0; reviewIndex16 < reviewListLen16; reviewIndex16++) {
    var reviewData16 = reviewList16[reviewIndex16];
    output.append('<tr data-id="', soy.$$escapeHtml(reviewData16.id), '"><td class="review"><a href="', soy.$$escapeHtml(reviewData16.url), '" class="review-link">', soy.$$escapeHtml(reviewData16.id), '</a></td><td class="title"><span class="ellipsis" title="', soy.$$escapeHtml(reviewData16.title), '">', soy.$$escapeHtml(reviewData16.title), '</span></td><td class="state">');
    JIRA.Templates.FusionWidget.Common.reviewsStateViewIssue({state: reviewData16.state}, output);
    output.append('</td><td class="author">');
    if (reviewData16.author) {
      JIRA.Templates.DevStatus.DetailDialog.vcsUser(reviewData16.author, output);
    }
    output.append('</td><td class="reviewer">');
    JIRA.Templates.DevStatus.DetailDialog.reviewersList(soy.$$augmentData(reviewData16, {countThreshold: opt_data.reviewersThreshold, extraReviewers: reviewData16.extraReviewers}), output);
    output.append('</td><td class="comment cell-type-collapsed">');
    JIRA.Templates.DevStatus.DetailDialog.commentCount({pullRequest: {'commentCount': reviewData16.commentCount, 'url': reviewData16.url}}, output);
    output.append('</td><td class="timestamp">');
    JIRA.Templates.DevStatus.Review.reviewDate(soy.$$augmentData(reviewData16, {lastUpdated: reviewData16.lastModified, datetimeFormat: 'longAge', showUpdatedText: false}), output);
    output.append('</td></tr>');
  }
  output.append('</tbody></table></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/util/DevStatusNavigation.js' */
if(!JIRA.DevStatus){AJS.namespace("JIRA.DevStatus")}JIRA.DevStatus.Navigate={getUrl:function(){return window.location.href},reload:function(){_.defer(function(){window.location.reload()})},navigate:function(a){_.defer(function(){window.location=a})},redirectToLogin:function(){this.navigate(AJS.contextPath()+"/login.jsp?permissionViolation=true&os_destination="+encodeURIComponent(window.location.href))}};define("jira-development-status/util/navigate",function(){return JIRA.DevStatus.Navigate});;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/analytics/AnalyticsModel.js' */
Backbone.define("JIRA.DevStatus.AnalyticsModel",Backbone.Model.extend({TO_ANALYTIC_KEY_OVERRIDE:{repository:"commit"},properties:["issue","summary"],initialize:function(a){this.devStatusContainer=a.devStatusContainer;this.devStatusData=a.devStatusData;this._getAllAnalyticData()},getIssue:function(){return this.get("issue")},getSummary:function(){return this.get("summary")},_getAllAnalyticData:function(){this.set("issue",this._getAnalyticIssueData());this._initListenerToData()},_getAnalyticIssueData:function(){return{isAssignee:this.devStatusContainer.data("is-assignee"),isAssignable:this.devStatusContainer.data("is-assignable"),issueStatus:this.devStatusContainer.data("issue-status"),issueType:this.devStatusContainer.data("issue-type")}},_getAnalyticSummaryData:function(c){var a=this;var b={};_.each(c.summary,function(e,d){b[a.TO_ANALYTIC_KEY_OVERRIDE[d]||d]=e.overall.count>0});return b},_initListenerToData:function(){var a=this;this.devStatusData.on("requestSuccess",function(){a.set("summary",a._getAnalyticSummaryData(a.devStatusData.get("aggregatedData")))})}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/CreateReviewFormDialog.js' */
Backbone.define("JIRA.DevStatus.CreateReviewFormDialog",Backbone.View.extend({initialize:function(a){this.linkSelector=a.linkSelector;this.applicationType=a.applicationType;this.instances=a.instances;this.issueId=a.issueId;this.dialog.instance=this},renderSuccess:function(){AJS.$(".create-review-instance a").attr("href",JIRA.DevStatus.URL.getCreateReviewDetailUrl(this.applicationType))},_processTargets:function(b){var c=this,a=_.map(b,function(e){var d=_.find(c.instances,function(f){return f.applicationLinkId===e.applicationLinkId});if(!d){return null}return _.extend({},e,d)});return _.sortBy(_.filter(a,_.identity),"name")},dialog:new JIRA.FormDialog({id:"devstatus-cta-create-review-dialog",trigger:".create-review-instance a",width:560,content:function(c){var a=this.instance,b=this;this.pickerView=new JIRA.DevStatus.InstancePickerView({el:this.$popup,activeTrigger:this.$activeTrigger,cta:"devstatus.cta.createreview",issueId:this.instance.issueId,processTargets:function(d){return b.instance._processTargets.call(b.instance,d)},uniqueResultAction:function(d){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(a.applicationType,true);JIRA.DevStatus.Navigate.navigate(d.url)}});this.pickerView.render().always(function(d){c(d);AJS.$(b.$popup).find(".primary.target").eq(0).focus();AJS.$(".target").click(function(f){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(a.applicationType,true)})})},autoClose:true})}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/InstancePickerView.js' */
Backbone.define("JIRA.DevStatus.InstancePickerView",Backbone.View.extend({ARROW_KEY_UP_CODE:38,ARROW_KEY_DOWN_CODE:40,template:JIRA.Templates.DevStatus.Dialog.content,events:{"keydown .jira-dialog-content":"_onTargetKeyboardSelect","focus .target":"_onTargetFocus"},initialize:function(a){this.currentSelected=null;this.link=a.activeTrigger;this.cta=a.cta;this.processTargets=a.processTargets;this.issueId=a.issueId;this.uniqueResultAction=a.uniqueResultAction||function(b){JIRA.DevStatus.Navigate.navigate(b.url)}},render:function(){var b=this._getIssueId(this.link),a=AJS.$.Deferred();this._fetchTargets(this.cta,b).done(_.bind(function(c){if(this.processTargets){c.remoteApps=this.processTargets(c.remoteApps)}var e=this._isUniqueResult(c);if(e){this.uniqueResultAction(e)}else{var d=AJS.$(this.template(c));a.resolve(d)}},this)).fail(function(c){a.resolve(c)});return a.promise()},_fetchTargets:function(b,c){var a=AJS.$.Deferred();AJS.$.ajax({url:contextPath+"/rest/dev-status/1.0/issue/targets?cta="+encodeURIComponent(b)+"&issueId="+encodeURIComponent(c)}).done(function(d){a.resolve(d)}).fail(function(e,d){a.reject(JIRA.SmartAjax.buildDialogErrorContent(e).html())});return a.promise()},_getIssueId:function(a){return(this.issueId||(a&&a.data("issueid")))||JIRA.Issue.getIssueId()},_isUniqueResult:function(a){return a.remoteApps.length===1&&a.remoteApps[0]},_toggleEntry:function(d,b,a){var c=d.eq(b);a&&c.focus();c.addClass("selected");this.currentSelected=c},_removeSelected:function(){if(this.currentSelected){this.currentSelected.removeClass("selected");this.currentSelected=null}},_onTargetKeyboardSelect:function(d){if(d.type==="keydown"){var c=0;if(d.keyCode===this.ARROW_KEY_UP_CODE){c=-1}else{if(d.keyCode===this.ARROW_KEY_DOWN_CODE){c=1}}if(c!==0){d.preventDefault();var b=this.$el.find(".target");var a=b.index(this.$el.find(".selected"));if(a!==-1){b.eq((a+c)%b.size()).focus()}}}},_onTargetFocus:function(a){this._removeSelected();this._toggleEntry(AJS.$(a.target),0,false)}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/BaseDetailDialogView.js' */
Backbone.define("JIRA.DevStatus.BaseDetailDialogView",Backbone.View.extend({frameEvents:{"click .menu-item":"_doTabClick"},frameTemplate:JIRA.Templates.DevStatus.DetailDialog.frame,oauthStatusTemplate:JIRA.Templates.DevStatus.DetailDialog.oauthStatus,authenticationTemplate:JIRA.Templates.DevStatus.DetailDialog.authenticationScreen,connectionProblemTemplate:JIRA.Templates.DevStatus.DetailDialog.connectionProblemScreen,connectionProblemWarningTemplate:JIRA.Templates.DevStatus.connectionProblemAsWarning,noPermissionToViewAllTemplate:JIRA.Templates.DevStatus.DetailDialog.noPermissionToViewAll,initialize:function(a){this.options=_.defaults({},a,{width:560,model:new JIRA.DevStatus.BaseDetailDialogModel(a)});this.model=this.options.model;this._initFetchHandlers();this._initFormDialog()},renderSuccess:function(b,a){return this},shouldRefreshOnTabSwitch:function(a){return false},getTitle:function(b,a){console.warn("Unimplemented getTitle() function",this);return a},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more information by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related development information"},getConnectionMessageInCanvas:function(){return "Unable to retrieve development information"},getNoPermissionToViewAllMessageInCanvas:function(){return "Unable to retrieve development information"},getContactAdmistratorsOrLoginMessageInCanvas:function(){if(JIRA.Users.LoggedInUser.isAnonymous()){return "You might be able to view more by authenticating with JIRA."}else{return "Please contact your administrator."}},hasData:function(a){return a.length>0},show:function(){this.dialog.show()},hide:function(){this.dialog.hide()},_getPane:function(a){return a?this.$el.find("#tab-content-"+a.replace(/(:|\.|\[|\])/g,"\\$1")):AJS.$()},getContentContainer:function(a){return this._getPane(a||this._getActiveApplicationType()).find(".detail-content-container")},_doTabClick:function(b){b.preventDefault();var a=this._getActiveApplicationType();this.model.switchTab(a,this.shouldRefreshOnTabSwitch(a));this.analytics&&this.analytics.fireDetailTabClicked(a)},_redirectToLoginIf401:function(a){if(a&&a.status===401){JIRA.DevStatus.Navigate.redirectToLogin();return true}return false},_initFetchHandlers:function(){this.model.on("fetchRequested",this._showLoadingIndicator,this);this.model.on("fetchSucceeded",this._handleFetchSucceeded,this);this.model.on("fetchFailed",this._handleFetchFailed,this)},_handleFetchSucceeded:function(c,a){this._hideLoadingIndicator(c);var b=a.detail&&this.hasData(a.detail);if(b){this.renderSuccess(c,a.detail)}this._renderError(c,a.errors,b);this._postRender()},_handleFetchFailed:function(b,a){this._hideLoadingIndicator(b);if(!this._redirectToLoginIf401(a)){this._renderError(b,[],false,true)}},_initAuthenticationCallbacks:function(){this._patchAJSIconsForAppLinks();var a=this;var d=function(g,f){a.model.oauthStatusChanged(f.appType);a.model.fetchAuthenticationStatuses();g.preventDefault()};var c=function(g,f){AJS.$.ajax(AJS.contextPath()+"/rest/auth/1/session").promise().fail(function(e){a._redirectToLoginIf401(e)})};var b=AJS.$(document);b.bind("applinks.auth.approved",d);b.bind("applinks.auth.denied",c);AJS.$(this.dialog).bind("Dialog.beforeHide",function(){b.unbind("applinks.auth.approved",d);b.unbind("applinks.auth.denied",c);a.instanceListPopup&&a.instanceListPopup.remove()});AJS.$('<div class="applinks-auth-confirmation-container hidden"></div>').appendTo(this.$el)},_initFetchAuthenticationHandlers:function(){this.model.on("fetchAuthRequested",this._showLoadingIndicator,this);this.model.on("fetchAuthSucceeded",this._handleAuthSucceeded,this);this.model.on("fetchAuthFailed",this._handleAuthFailed,this)},_handleAuthSucceeded:function(b){var a=this;var d=_.filter(b,function(e){return e.configured&&!e.authenticated&&e.source&&e.source.applicationLinkId});var c=this._getOAuthStatusDiv();if(d.length>0&&!JIRA.Users.LoggedInUser.isAnonymous()){c.html(this.oauthStatusTemplate({message:this.getOAuthMessageInFooter(d)}));this._renderUnauthInstancesInFooter(d);c.show()}else{c.hide()}},_handleAuthFailed:function(a){this._redirectToLoginIf401(a);this._getOAuthStatusDiv().hide()},_renderUnauthInstancesInFooter:function(c){var b=this._getOAuthStatusDiv();var d=_.map(_.pluck(c,"source"),this._createOAuthInstanceDiv);if(d.length>0){b.append(d[0]);if(d.length>1){b.append(", ");b.append(d[1]);if(d.length>2){b.append(" ");var e=AJS.$('<span class="more-instances"><a href="#">'+"... more"+"</a></span>");b.append(e);var a=AJS.$('<ul class="instance-list"></ul>');_.each(d.slice(2),function(f){a.append(AJS.$('<li class="instance-in-popup"></li>').append(f))});AJS.InlineDialog(e,"instance-list-popup",function(g,f,h){g.html(a);h();return false},{width:150,offsetX:-100,onTop:true})}}}},_createOAuthInstanceDiv:function(a){var b=ApplinksUtils.createAuthRequestInline(null,{id:a.applicationLinkId,authUri:AJS.contextPath()+"/plugins/servlet/applinks/oauth/login-dance/authorize?applicationLinkID="+encodeURIComponent(a.applicationLinkId),appUri:a.baseUrl,appName:a.name,appType:a.type});return AJS.$('<span class="instance"></span>').append(b.find("a.applink-authenticate").text(a.name))},_patchAJSIconsForAppLinks:function(){AJS.icons=AJS.icons||{};AJS.icons.addIcon=AJS.icons.addIcon||{};AJS.icons.addIcon.init=AJS.icons.addIcon.init||function(){}},_getOAuthStatusDiv:function(){var a=this.$el.find(".buttons-container .oauth-status");if(a.length){return a}else{return AJS.$('<div class="oauth-status" />').appendTo(this.$el.find(".buttons-container.form-footer"))}},_renderError:function(f,g,d,c){var a=_.groupBy(g,function(h){var i=h.error;if(i==="unauthorized"||i==="incapable"){return i}else{return"others"}});var b=_.pluck(a.unauthorized,"instance");var e=_.pluck(a.others,"instance");if(b.length>0){this.model.fetchAuthenticationStatuses()}if(d){if(e.length>0){this._renderConnectionErrorBeforeData(f,e)}}else{if(b.length>0){this._renderAuthenticationError(f,b,e)}else{if(c||e.length>0){this._renderConnectionError(f,e)}else{this._renderNoPermissionToViewAllWarning(f)}}}},_renderConnectionErrorBeforeData:function(b,a){this.getContentContainer(b).prepend(this.connectionProblemWarningTemplate({instances:a,showContactAdminForm:this.options.showContactAdminForm}))},_renderConnectionError:function(b,a){this.getContentContainer(b).html(this.connectionProblemTemplate({instances:a,title:this.getConnectionMessageInCanvas(),showContactAdminForm:this.options.showContactAdminForm}))},renderNoPermissionToViewAllWarningAtBottom:function(c,d){var a=this.model.get("tabs")[c]||{};var b=this.model.get("contentMap")[c]||{};if(d<a.count){if((b.errors||[]).length===0||JIRA.Users.LoggedInUser.isAnonymous()){this.getContentContainer(c).append(this._getNoPermissionToViewAllHtml())}}},_getNoPermissionToViewAllHtml:function(){return this.noPermissionToViewAllTemplate({message:this.getNoPermissionToViewAllMessageInCanvas(),secondaryMessage:this.getContactAdmistratorsOrLoginMessageInCanvas()})},_renderNoPermissionToViewAllWarning:function(a){this.getContentContainer(a).html(this._getNoPermissionToViewAllHtml())},_renderAuthenticationError:function(f,c,e){var a=this.getContentContainer(f);a.html(this.authenticationTemplate({unauthInstances:c,title:this.getOAuthMessageInCanvas(),otherInstances:e,showContactAdminForm:this.options.showContactAdminForm}));var d=_.map(c,this._createOAuthInstanceDiv);var b=a.find(".instances");_.each(d,function(h,g){if(g!==0){b.append(", ")}b.append(h)})},_initFormDialog:function(){var a=this;this.dialog=new JIRA.FormDialog({id:this.options.id,width:this.options.width,content:function(b){a.setElement(this.$popup);a.delegateEvents(_.extend({},a.frameEvents,a.events));a._renderFrame();a._initAuthenticationCallbacks();a._initFetchAuthenticationHandlers();a.model.fetchAuthenticationStatuses();a.model.switchTab(a._getActiveApplicationType());b()},autoClose:true})},_postRender:function(){this.$el.find(".extra-content-in-title").tooltip();this.dialog._positionInCenter();this.$el.find(".active-pane a:eq(0)").focus()},_getActiveApplicationType:function(){return this.$el.find(".menu-item.active-tab").data("applicationType")},_showLoadingIndicator:function(c){var a=this._getPane(c);a._removeClass("ready");a.addClass("loading");var b=a.find(".status-loading");b.spin("large");b.show()},_hideLoadingIndicator:function(c){var a=this._getPane(c);a.addClass("ready");var b=a.find(".status-loading");if(b){a.removeClass("loading");b.hide();b.spinStop()}},_renderFrame:function(){this.$el.html(this.frameTemplate({title:this.getTitle(this.options.count,this.options.issueKey),tabs:this._convertTabsForSoy(),initialTab:this.options.initialTab}));if(this.options.height){this.$el.find(".form-body").css("min-height",this.options.height)}},_convertTabsForSoy:function(){return _.chain(this.model.get("tabs")).map(function(b,a){return _.extend({type:a},b)}).sortBy(function(a){return a.type}).value()},_createReviewersInlineDialog:function(){this.reviewerInlineDialogView=new JIRA.DevStatus.ReviewerInlineDialogView({el:this.$el.find(".extrareviewers-tooltip"),});return this.reviewerInlineDialogView},_removeInlineDialog:function(a){if(this[a]){this[a].hide();this[a].remove();this[a]=undefined}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/BaseDetailDialogModel.js' */
Backbone.define("JIRA.DevStatus.BaseDetailDialogModel",Backbone.Model.extend({TAB_PREFIX:"#tab-menu-",PANE_PREFIX:"#tab-content-",properties:["tabs","contentMap","oauthStatuses","selectedTab","selectedPane"],namedEvents:["fetchRequested","fetchFailed","fetchSucceeded","fetchAuthRequested","fetchAuthFailed","fetchAuthSucceeded"],initialize:function(a){this.issueKey=a.issueKey;this.issueId=a.issueId;this.type=a.dataType;this.set("contentMap",{});this.set("tabs",a.tabs)},switchTab:function(b,a){this.set("selectedTab",this.TAB_PREFIX+b);this.set("selectedPane",this.PANE_PREFIX+b);if(this.get("contentMap")[b]==null||a){this._fetchContents(b)}},_fetchContents:function(a){this.trigger("fetchRequested",a);this._handleFetch(a,AJS.$.ajax({url:AJS.contextPath()+"/rest/dev-status/1.0/issue/detail",data:{issueId:this.issueId,applicationType:a,dataType:this.type}}).promise())},_handleFetch:function(c,b){var a=this;b.done(function(d){a._fireSuccessResult(c,d)}).fail(function(e,d){a._fireFailResult(c,e)})},_fireSuccessResult:function(b,a){this._updateContents(b,a);this.trigger("fetchSucceeded",b,a)},_fireFailResult:function(b,a){this._updateContents(b);this.trigger("fetchFailed",b,a)},_updateContents:function(b,a){this.get("contentMap")[b]=a},fetchAuthenticationStatuses:function(){var b=_.keys(this.get("tabs")||{});if(!_.isEmpty(b)){var a=this;AJS.$.ajax({url:AJS.contextPath()+"/rest/dev-status/1.0/provider/auth-status",data:{applicationType:b}}).promise().done(function(c){if(c&&c.data){a._updateOAuthStatuses(c.data);a.trigger("fetchAuthSucceeded",c.data)}else{a._updateOAuthStatuses();a.trigger("fetchAuthFailed",null,c)}}).fail(function(d,c){a._updateOAuthStatuses();a.trigger("fetchAuthFailed",d)})}},oauthStatusChanged:function(b){if(_.has(this.get("tabs"),b)){var a=this._getCurrentApplicationType();if(a===b){this._fetchContents(a)}else{this.get("contentMap")[b]=null}}},_getCurrentApplicationType:function(){var a=this.get("selectedTab");if(a){return a.slice(this.TAB_PREFIX.length)}return null},_updateOAuthStatuses:function(a){this.set("oauthStatuses",a)}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/ReviewerInlineDialogView.js' */
Backbone.define("JIRA.DevStatus.ReviewerInlineDialogView",JIRA.DevStatus.BaseDetailDialogView.extend({extraReviewersToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip,events:{mouseenter:"_onHoverExtraReviewersToolTip",click:"_onClickExtraReviewersToolTip"},_onHoverExtraReviewersToolTip:function(c){c.preventDefault();var a=this;var b=AJS.$(c.target);var d="extrareviewers-tooltip";this.activeExtraReviewersToolTip=AJS.InlineDialog(b,d,function(h,f,i){var e=AJS.$(f);var g=e.closest("."+d);h.html(a.extraReviewersToolTipTemplate({reviewers:g.data("reviewers")}));a.activeExtraReviewersToolTip.$content=h;i()},{cacheContent:false,hideDelay:200,onHover:true,width:false})},_onClickExtraReviewersToolTip:function(a){if(this.activeExtraReviewersToolTip){a.stopPropagation()}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/build/DetailDialogBuildView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogBuildView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.build,events:{"click a.project-link":"_onClickProjectLink","click a.plan-link":"_onClickPlanLink","click a.build-link":"_onClickBuildLink"},initialize:function(a){this.analytics=JIRA.DevStatus.BuildsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"build",width:1000,height:400},a))},renderSuccess:function(d,a){var c=_.reduce(a,function(e,f){return e.concat(f.projects||[])},[]);var b=this.getContentContainer(d);b.html(this.template({applicationType:d,projects:this.sortProjectsAndPlans(c),hasArtifacts:this.hasArtifacts(c)}));this.renderNoPermissionToViewAllWarningAtBottom(d,this.getBuildCount(c));JIRA.DevStatus.Date.addTooltip(b);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#build|1\u003cbuilds}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more builds by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related builds"},getConnectionMessageInCanvas:function(){return "Unable to retrieve build information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related builds."},hasData:function(a){return _.reduce(a,function(b,c){return b.concat(c.projects||[])},[]).length>0},sortProjectsAndPlans:function(a){a=_.sortBy(a,function(b){return _.last(_.sortBy(b.plans,function(c){return c.build.finishedDate})).build.finishedDate}).reverse();_.each(a,function(b){b.plans=_.sortBy(b.plans,function(c){return c.build.finishedDate}).reverse()});return a},hasArtifacts:function(a){return _.any(a,function(b){return _.any(b.plans,function(c){return c.build&&c.build.artifacts&&c.build.artifacts.length})})},getBuildCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.pluck(b.plans,"key")})).length},_onClickProjectLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailProjectClicked()},_onClickPlanLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailPlanClicked()},_onClickBuildLink:function(){JIRA.DevStatus.BuildsAnalytics.fireDetailBuildClicked()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/deployment/DetailDialogDeploymentView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogDeploymentView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.Deployment.deployment,events:{"click a.project-link":"_onClickProjectLink","click a.environment-link":"_onClickEnvironmentLink","click a.release-link":"_onClickReleaseLink"},initialize:function(a){this.analytics=JIRA.DevStatus.DeploymentsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"deployment",width:1000,height:400},a))},renderSuccess:function(d,a){var c=_.reduce(a,function(e,f){return e.concat(f.deploymentProjects||[])},[]);var b=this.getContentContainer(d);b.html(this.template({applicationType:d,deploymentProjects:this.sortProjects(c)}));this.renderNoPermissionToViewAllWarningAtBottom(d,this.getEnvironmentCount(c));JIRA.DevStatus.Date.addTooltip(b);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#deployment|1\u003cdeployments}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more deployments by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related deployments"},getConnectionMessageInCanvas:function(){return "Unable to retrieve deployment information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related deployments."},hasData:function(a){return _.reduce(a,function(b,c){return b.concat(c.deploymentProjects||[])},[]).length>0},sortProjects:function(a){return _.sortBy(a,function(b){return _.last(_.sortBy(b.environments,function(c){return new Date(c.lastDeployed||0).getTime()})).lastDeployed}).reverse()},getEnvironmentCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.pluck(b.environments,"environmentId")})).length},_onClickProjectLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailProjectClicked()},_onClickEnvironmentLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailEnvironmentClicked()},_onClickReleaseLink:function(){JIRA.DevStatus.DeploymentsAnalytics.fireDetailReleaseClicked()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/DetailDialogCommitView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogCommitView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.commit,events:{"click a.repository-link":"_onClickRepositoryLink","click a.changesetid":"_onClickChangesetId","click .filecount a":"_onClickFiles","click .file-expand a":"_onClickExpand","click .create-review-commit a":"_onClickCreateReview","click .filename a":"_onClickFile","mouseenter .reviews-link":"_onHoverReviewsToolTip",click:"_onClickReviewsToolTip"},initialize:function(a){this.analytics=JIRA.DevStatus.CommitsAnalytics;this.issueId=a.issueId;var c=AJS.Meta.get("fusion-open-detail-dialog");var b;if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(c)){b=JIRA.DevStatus.URL.getCreateReviewDetailDialogApplicationType(c)}JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"commit",width:1000,height:400,initialTab:b},a))},concatResults:function(a){return _.reduce(a,function(b,d){var c=d.repositories||[];_.each(c,function(e){e.showInstance=d._instance&&!d._instance.singleInstance;e.instance=d._instance});return b.concat(c)},[])},_clipEllipsis:function(){function a(b){return b.outerWidth()}this.$el.find(".detail-content-container .file .ellipsis").each(function(b,f){var e=AJS.$(f);var c=a(e);if(c==0){return}var d=e.find("a");if(a(d)>c){var g=d.text();while(a(d)>c){g=g.slice(1);d.text("\u2026"+g)}}})},renderSuccess:function(e,a){var c=this.concatResults(a);var b=this.getContentContainer(e);this.transformedRepositories=this.transformRepositories(c);var d=this.setupCreateReviewDialog(this.transformedRepositories);b.html(this.template({applicationType:e,repositories:this.transformedRepositories,canCreateReview:d}));this.renderNoPermissionToViewAllWarningAtBottom(e,this.getUniqueCommitCount(c));JIRA.DevStatus.Date.addTooltip(b);this.setupBranchesTooltip();this.createReviewDialog&&this.createReviewDialog.renderSuccess();return this},setupCreateReviewDialog:function(a){var c=_.chain(a).filter(function(e){return e.showCreateReview}).pluck("instance").value();var d=false;if(c.length){this.createReviewDialog=new JIRA.DevStatus.CreateReviewFormDialog({analytics:this.analytics,applicationType:this._getActiveApplicationType(),issueId:this.issueId,instances:c});d=true}var b=AJS.Meta.get("fusion-open-detail-dialog");if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(b)&&JIRA.DevStatus.URL.getCreateReviewDetailDialogApplicationType(b)===this._getActiveApplicationType()){AJS.Meta.set("fusion-open-detail-dialog",undefined);if(d){this.createReviewDialog.dialog.show()}}return d},_onHoverReviewsToolTip:function(c){var a=this;c.preventDefault();var b=AJS.$(c.target);var d="commit-reviews-popup";this.activeReviewsToolTip=AJS.InlineDialog(b,d,function(h,f,i){var g=a._getCommitDetails(AJS.$(f)).reviews;var e=AJS.$(f);JIRA.DevStatus.CommitsAnalytics.fireDetailReviewsShown(a._getActiveApplicationType());h.html(JIRA.Templates.DevStatus.DetailDialog.reviewsInlineDialog({reviewData:g}));h.find("a").click(function(j){a._onClickReview(j)});i()},{cacheContent:false,hideDelay:200,showDelay:50,onHover:true,width:false})},_onClickReviewsToolTip:function(a){if(this.activeReviewsToolTip){a.stopPropagation()}},setupBranchesTooltip:function(){var a=this;AJS.$(".branches-link").tooltip({title:function(){var b=a._getCommitDetails(AJS.$(this)).branches;JIRA.DevStatus.CommitsAnalytics.fireDetailBranchesShown(a._getActiveApplicationType());return JIRA.Templates.DevStatus.DetailDialog.branchesTooltip({branchData:b})},html:true})},getTitle:function(d,b){var a=_.chain(this.model.get("tabs")).map(function(e){return e.count}).reduce(function(e,f){return e+f},0).value();var c=Math.max(a-d,0);return AJS.$.trim(AJS.format("{1}: {0} unique {0,choice,1#commit|1\u003ccommits}{2,choice,0# |0\u003c (and {2} duplicates)}",d,b,c))},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more commits by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related commits"},getConnectionMessageInCanvas:function(){return "Unable to retrieve commit information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related commits."},hasData:function(a){return this.concatResults(a).length>0},transformRepositories:function(b){b=this.sortRepositoriesAndCommits(b);var a=this;var c=[["reviews","showReviews"],["branches","showBranches"],["files","showFiles"],["createReviewUrl","showCreateReview"]];_.each(c,function(d){b=a._setRepositoryFromFromCommitField(b,d[0],d[1])});b=this.prepareReviews(b);return b},_setRepositoryFromFromCommitField:function(b,c,a){_.each(b,function(d){d[a]=_.find(d.commits,function(e){return e[c]!=null})!=null});return b},prepareReviews:function(b){var a=this;_.each(b,function(c){_.each(c.commits,a._orderCommitReviews)});return b},_orderCommitReviews:function(b){if(b.reviews&&b.reviews.reviews){var a=["REVIEW","APPROVAL","SUMMARIZE","REJECTED","CLOSED"];b.reviews.reviews=_.chain(b.reviews.reviews).filter(function(c){return _.contains(a,c.state)}).sortBy(function(c){return _.indexOf(a,c.state)}).value()}},sortRepositoriesAndCommits:function(a){a=_.sortBy(a,function(b){return b.name.toLowerCase()});_.each(a,function(b){b.commits=_.sortBy(b.commits,"authorTimestamp").reverse()});return a},getUniqueCommitCount:function(a){return _.union.apply(null,_.map(a,function(b){return _.filter(_.pluck(b.commits,"id"),function(c){return c})})).length},_getRepoDetails:function(a){return this.transformedRepositories[parseInt(a.parents(".detail-commits-container").data("repository-index"))]},_getCommitDetails:function(a){return this._getRepoDetails(a).commits[parseInt(a.parents("tr").data("commit-index"))]},_onClickRepositoryLink:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailRepoClicked(this._getActiveApplicationType())},_onClickChangesetId:function(){JIRA.DevStatus.CommitsAnalytics.fireDetailCommitClicked(this._getActiveApplicationType())},_onClickExpand:function(b){b.preventDefault();var a=this._getFileExpand(AJS.$(b.target));if(a.toggle(a.getRows())){JIRA.DevStatus.CommitsAnalytics.fireDetailFilesExpandedClicked(this._getActiveApplicationType())}this._clipEllipsis()},_onClickFiles:function(b){b.preventDefault();var a=this._getFileExpand(AJS.$(b.target)).toggle(AJS.$(b.target).closest(".commitrow").next(".filerow"));this._clipEllipsis();if(a){JIRA.DevStatus.CommitsAnalytics.fireDetailFileExpandedClicked(this._getActiveApplicationType())}},_onClickCreateReview:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailCreateReviewClicked(this._getActiveApplicationType(),false)},_onClickReview:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailReviewClicked(this._getActiveApplicationType())},_onClickFile:function(a){JIRA.DevStatus.CommitsAnalytics.fireDetailFileClicked(this._getActiveApplicationType())},_getFileExpand:function(a){var c=a.closest(".detail-commits-container");function b(d){return d.length>d.filter(".hidden").length}return{getRows:function(){return c.find(".filerow")},toggle:function(e){var d=b(e);e.toggleClass("hidden",d);this._updateExpandLabel();return !d},_updateExpandLabel:function(){c.find(".file-expand a").text(b(this.getRows())?"Hide files":"Show all files")}}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/DetailDialogBranchView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogBranchView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.branch,pullRequestToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.pullRequestToolTip,STATE_ORDER:["OPEN","MERGED","DECLINED"],events:{"click a.repository-link":"_onClickRepositoryLink","click a.branch-link":"_onClickBranchLink","click a.pullrequest-link":"_onClickPullRequestLink","click a.create-pullrequest-link":"_onClickCreatePullRequestLink","mouseenter .pullrequest-tooltip":"_onHoverPullRequestsToolTip","click .pullrequest-tooltip":"_onClickPullRequestsToolTip"},initialize:function(a){this.analyticIssueData=a.analyticIssueData||{};this.analytics=JIRA.DevStatus.BranchesAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({},a,{type:"branch",width:1000,height:400,dataType:"pullrequest"}))},renderSuccess:function(g,a){var c=this._sortBranchesByName(this._removeWithNoRepos(this._extractAllBranches(a)));var f=this._extractAllPullRequests(a);this._populatePullRequestStateByBranch(c,f);var d=this._getBranchFeatures(c);var e=this._getBranchCount(c);var b=this.getContentContainer(g);if(e>0){b.html(this.template({applicationType:g,branches:c,features:d,branchCount:e}));JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(g,e);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#branch|1\u003cbranches}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more branches by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related branches"},getConnectionMessageInCanvas:function(){return "Unable to retrieve branch information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related branches."},hasData:function(a){return this._removeWithNoRepos(this._extractAllBranches(a)).length>0},_extractAllBranches:function(a){return _.compact(_.flatten(_.pluck(a,"branches")))},_getBranchFeatures:function(a){return{pullRequests:_.find(a,function(b){return b.createPullRequestUrl||(b.pullRequestState&&b.pullRequestState.total)})!=null,lastCommitId:_.find(a,function(b){return b.lastCommit&&b.lastCommit.displayId})!=null,lastCommitTimestamp:_.find(a,function(b){return b.lastCommit&&b.lastCommit.authorTimestamp})!=null}},_removeWithNoRepos:function(a){return _.filter(a,function(b){return b.repository})},_extractAllPullRequests:function(a){return _.flatten(_.compact(_.pluck(a,"pullRequests")))},_sortBranchesByName:function(a){return _.sortBy(a,function(b){return b.repository.name+b.name})},_onClickRepositoryLink:function(){this.analytics.fireDetailRepoClicked(this._getActiveApplicationType())},_onClickBranchLink:function(){this.analytics.fireDetailBranchClicked(this._getActiveApplicationType())},_onClickPullRequestLink:function(){this.analytics.fireDetailPullRequestLozengeClick(this._getActiveApplicationType())},_onClickCreatePullRequestLink:function(){this.analytics.fireDetailCreatePullRequestClicked(this._getActiveApplicationType(),this.analyticIssueData.isAssignee,this.analyticIssueData.isAssignable)},_onHoverPullRequestsToolTip:function(c){c.preventDefault();var a=this;var b=AJS.$(c.target);var d="pullrequest-tooltip";this.activePullRequestsToolTip=AJS.InlineDialog(b,d,function(h,f,i){var e=AJS.$(f);var g=e.closest("."+d);h.html(a.pullRequestToolTipTemplate({pullRequests:g.data("detail")}));a.activePullRequestsToolTip.$content=h;i()},{onHover:true,hideDelay:200,showDelay:50,offsetX:-200,cacheContent:false,width:400})},_onClickPullRequestsToolTip:function(a){if(this.activePullRequestsToolTip){a.stopPropagation()}},_getBranchCount:function(a){return a.length},_populatePullRequestStateByBranch:function(b,c){var a=this;_.each(b,function(d){var e=_.filter(c,function(f){return f.source.url===d.url});d.pullRequestState=a._summarisePullRequestState(e)});return b},_sortPullRequestsByStatus:function(a){return _.sortBy(a,function(b){return(b.status==="OPEN"?"2":(b.status==="MERGED"?"1":"0"))+b.lastUpdated}).reverse()},_getFirstStatusWithCount:function(a){return _.find(this.STATE_ORDER,function(b){return a[b]})},_summarisePullRequestState:function(a){var b=_.groupBy(a,function(c){return c.status});return{status:this._getFirstStatusWithCount(b),data:JSON.stringify(this._sortPullRequestsByStatus(a)),total:_.size(a)}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/DetailDialogPullRequestView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogPullRequestView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.pullRequest,extraReviewersToolTipTemplate:JIRA.Templates.DevStatus.DetailDialog.extraReviewersTooltip,events:{"click a.pullrequest-link":"_onClickPullRequestLink"},initialize:function(a){this.analytics=JIRA.DevStatus.PullRequestsAnalytics;JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"pullrequest",width:1000,height:400},a))},renderSuccess:function(f,a){var d=this._removeAuthorFromReviewers(this._extractAllPullRequests(a));var e=this._getSortedPullRequestsByDate(d);var c=_.size(e);var b=this.getContentContainer(f);if(c>0){b.html(this.template({pullRequests:e,pullRequestCount:c,reviewersThreshold:this.options.reviewersThreshold}));this._createReviewersInlineDialog();JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(f,c);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#pull request|1\u003cpull requests}",b,a)},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more pull requests by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getOAuthMessageInCanvas:function(){return "Authenticate to see related pull requests"},getConnectionMessageInCanvas:function(){return "Unable to retrieve pull request information"},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related pull requests."},hasData:function(a){return this._extractAllPullRequests(a).length>0},_extractAllPullRequests:function(a){return _.compact(_.flatten(_.pluck(a,"pullRequests")))},_removeAuthorFromReviewers:function(a){return _.map(a,function(d){if(d.reviewers&&d.author){var c=_.filter(d.reviewers,function(e){return e.name!=d.author.name});if(d.reviewers.length==c.length){return d}var b=_.clone(d);b.reviewers=c;return b}return d})},_sortReviewers:function(b){var a=this.options.reviewersThreshold;_.each(b,function(d,c){if(_.size(d.reviewers)>0){d.reviewers=_.sortBy(_.filter(d.reviewers,function(e){return e.name}),function(e){return e.approved?"0"+e.name:"1"+e.name});if(d.reviewers.length>a+1){d.extraReviewers=JSON.stringify(d.reviewers.slice(a))}}})},_getSortedPullRequestsByDate:function(a){this._sortReviewers(a);return _.sortBy(a,"lastUpdate").reverse()},_onClickPullRequestLink:function(){this.analytics.fireDetailPullRequestClicked(this._getActiveApplicationType())}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-dialog-resources', location = 'js/viewissue/dialog/DetailDialogReviewView.js' */
Backbone.define("JIRA.DevStatus.DetailDialogReviewView",JIRA.DevStatus.BaseDetailDialogView.extend({template:JIRA.Templates.DevStatus.DetailDialog.review,events:{"click a.review-link":"_onClickReviewLink","click a.comment-link":"_onClickReviewLink"},initialize:function(a){this.analytics=JIRA.DevStatus.ReviewsAnalytics;this.finalStates=["REJECTED","CLOSED"];this.nonFinalStates=["REVIEW","APPROVAL","SUMMARIZE"];this.validStates=_.union(this.finalStates,this.nonFinalStates);JIRA.DevStatus.BaseDetailDialogView.prototype.initialize.call(this,_.extend({type:"review",width:1000,height:400},a))},_updateReviewers:function(a){a.reviewers=_.chain(a.reviewers).filter(function(b){if(b&&a.author&&a.author.name&&b.name){return !_.isEqual(b.name,a.author.name)}return true}).sortBy(function(b){return(b.complete?"0":"1")+b.name}).map(function(b){b.approved=b.complete;return b}).value();if(a.moderator&&!_.isEqual(a.moderator,a.author)){a.reviewers=[_.extend(a.moderator,{name:"Moderator:"+" "+a.moderator.name})].concat(a.reviewers)}return a},_updateReview:function(a){return function(b){if(b.state&&b.dueDate&&_.contains(a,b.state)){delete b.dueDate}if(b.dueDate&&moment(b.dueDate).isBefore(moment())){b.overDue=true}return b}},_addExtraReviewersJson:function(a){return function(b){if(b.reviewers){b.extraReviewers=JSON.stringify(b.reviewers.slice(a))}return b}},_reviewCompare:function(b,a){if(b.dueDate&&!a.dueDate){return -1}else{if(!b.dueDate&&a.dueDate){return 1}else{if(b.dueDate&&a.dueDate){return b.dueDate.localeCompare(a.dueDate)}else{if(b.lastModified&&a.lastModified){return a.lastModified.localeCompare(b.lastModified)}}}}return 0},_mergeInstanceData:function(a,b){return a.concat(b.reviews||[])},_prepareReviews:function(b){var a=this;return _.chain(b).reduce(this._mergeInstanceData,[]).filter(function(c){c.state=c.state&&c.state.toUpperCase();return _.contains(a.validStates,c.state)}).map(_.compose(this._addExtraReviewersJson(this.options.reviewersThreshold),this._updateReviewers,this._updateReview(this.finalStates))).sort(this._reviewCompare).value()},renderSuccess:function(d,a){var c=this._prepareReviews(a),b=this.getContentContainer(d);if(c.length>0){b.html(this.template({applicationType:d,reviews:c,reviewersThreshold:this.options.reviewersThreshold}));this._createReviewersInlineDialog();JIRA.DevStatus.Date.addTooltip(b)}else{b.empty()}this.renderNoPermissionToViewAllWarningAtBottom(d,c.length);return this},getTitle:function(b,a){return AJS.format("{1}: {0} {0,choice,1#review|1\u003creviews}",b,a)},getNoPermissionToViewAllMessageInCanvas:function(){return "You don\'t have access to view all related reviews."},getOAuthMessageInCanvas:function(){return "Authenticate to see related reviews"},getOAuthMessageInFooter:function(a){return AJS.format("You might be able to see more reviews by authenticating with the following {0,choice,1#application|1\u003capplications}:",a.length)},getConnectionMessageInCanvas:function(){return "Unable to retrieve review information"},hasData:function(a){return _.flatten(_.pluck(a,"reviews"),true).length>0},_onClickReviewLink:function(){this.analytics.fireDetailReviewClicked()}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusInit.js' */
(function(){JIRA.DevStatus.setDetailDialogParam=function(){AJS.Meta.set("fusion-open-detail-dialog",JIRA.DevStatus.URL.getDetailDialogParam())};JIRA.DevStatus.setDetailDialogParam()})();AJS.$(function(){JIRA.DevStatus.showTooltip=true;JIRA.DevStatus.showAITTooltip=true;var d={devStatusContainer:"#devstatus-container",parentContainer:"[id$='devstatus-panel']",link:"a.devstatus-cta-link",statusPanel:".status-panels",viewIssueHeader:".mod-header",agileHeader:".ghx-header",agileNavMenuLink:'a[href="#ghx-tab-com-atlassian-jira-plugins-jira-development-integration-plugin-greenhopper-devstatus-panel"]'};function e(g){return g.find("body").hasClass("page-type-dashboard")}function b(g){return g.find("body").hasClass("ghx-agile")}function c(g){return g.find("body").hasClass("ka ajax-issue-search-and-view")}function a(h,i,g){JIRA.DevStatus.devStatusModule.initializePanel({container:h,showTooltip:JIRA.DevStatus.showTooltip,headerSelector:i,devStatusPanelVisibilityToggler:g,phaseTwoDisabled:!AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.phasetwo.enabled")})}function f(g,i,h,j){_.defer(function(){var k=h?1000:0;var l={duration:k,complete:j};if(i){g.slideDown(l)}else{g.slideUp(l)}})}JIRA.DevStatus.documentReadyInit=function(h){JIRA.DevStatus.devStatusModule=new JIRA.DevStatus.DevStatusModule({parentContainerSelector:d.parentContainer,linkSelector:d.link,panelSelector:d.devStatusContainer,statusPanelSelector:d.statusPanel});if(e(h)||b(h)){h.find("body").on("click",d.agileNavMenuLink,JIRA.DevStatus.Analytics.fireAgileDevStatusLinkClicked);JIRA.DevStatus.showTooltip=false;JIRA.DevStatus.showAITTooltip=false}else{if(c(h)){if(JIRA.Issues.Api.isFullScreenIssueVisible()){var g=AJS.$(d.devStatusContainer);if(g.length>0){a(g,d.viewIssueHeader,f)}}}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(j,i){if(i.not(document).is(d.parentContainer)){a(i.find(d.devStatusContainer),d.viewIssueHeader,f);JIRA.DevStatus.showTooltip=false;return true}return false});JIRA.bind("GH.DetailView.updated",function(j,i){a(AJS.$(d.devStatusContainer),d.agileHeader)})};AJS.$(function(){JIRA.DevStatus.documentReadyInit(AJS.$(document))})});;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusModule.js' */
Backbone.define("JIRA.DevStatus.DevStatusModule",Backbone.Model.extend({initialize:function(a){_.defaults(this,a);this._listeners=new JIRA.DevStatus.Util.Listeners();this.createBranchFormDialog=new JIRA.DevStatus.CreateBranchFormDialog(a);this.devSummaryJson=null;this.triggerHelpTipShown=false;this._initFocusHandler()},initializePanel:function(a){this._listeners.stopListening();this._renderedData=null;this._getContainers(a);this.labsOptIn=JIRA.DevStatus.Labs.LabsOptInModel.createFromDOM(this.parentContainer);a.showTooltip=a.showTooltip&&!(this.labsOptIn.isAllowed()&&!(this.labsOptIn.isOptedIn()||this.labsOptIn.isDismissed()));this._createCreateBranchView(a);this.devSummaryJson=this.devStatusContainer.find(".dev-summary.json-blob").data("json");this._initLabsOptInView();this._initTryLabsView();this._createDevStatusData(a);this._createAnalyticsModel(a);this._createSummaryViews(a);this._setupDataEventHandlers();this.devStatusPanelVisibilityToggler=a.devStatusPanelVisibilityToggler;if(!a.phaseTwoDisabled){this._startDevStatus()}else{this._postRender(false,true)}this.labsOptIn.on("change:optedIn",this._onChangeLabsOptIn,this);if(this.labsOptIn.isAllowed()&&this.labsOptIn.isOptedIn()){this._onChangeLabsOptIn(this.labsOptIn,true)}return this},_createCreateBranchView:function(a){this.createBranchView=new JIRA.DevStatus.CreateBranchView({el:this.createBranchContainer,showTooltip:a.showTooltip})},_createDevStatusData:function(a){this.devStatusData=new JIRA.DevStatus.DevStatusData({issueId:JIRA.Issue.getIssueId()})},_createSummaryViews:function(a){var c=this;var b=this.devStatusContainer.data();this._summaryModules=_.clone(this.statusPanelContainer.find(".status-panel").map(function(){var d=AJS.$(this);return new JIRA.DevStatus[d.data("module")]({dataAttrs:b,el:d,labsOptIn:c.labsOptIn,analyticsModel:c.analyticsModel})}));this._errorModule=new JIRA.DevStatus.SummaryErrorModule({el:this.messagePanelContainer,dataAttrs:b})},_createAnalyticsModel:function(a){this.analyticsModel=new JIRA.DevStatus.AnalyticsModel({devStatusContainer:this.devStatusContainer,devStatusData:this.devStatusData})},_getContainers:function(a){this.devStatusContainer=a.container;this.parentContainer=a.container.closest(this.parentContainerSelector);this.createBranchContainer=a.container.find(this.linkSelector);this.statusPanelContainer=a.container.find(this.statusPanelSelector);this.headerContainer=this.parentContainer.find(a.headerSelector);this.messagePanelContainer=a.container.find(".message-panel")},_onLoadingStarted:function(){this._startLoadingModuleData()},_onLoadingSuccess:function(b,a,c){this._renderModules({success:true,renderData:this.devStatusData.get("aggregatedData")});this._postRender(!a,c)},_onLoadingFailure:function(){this._renderModules({success:false});this._postRender(false,true)},_setupDataEventHandlers:function(){this._listeners.startListening(this.devStatusData,"beforeRequest",this._onLoadingStarted,this);this._listeners.startListening(this.devStatusData,"requestSuccess",this._onLoadingSuccess,this);this._listeners.startListening(this.devStatusData,"requestFail",this._onLoadingFailure,this)},_startDevStatus:function(){var a=!this.devSummaryJson||this.devSummaryJson.isStale===true;if(this.devSummaryJson){this.devStatusData.setAggregateData(this.devSummaryJson.cachedValue,true,!a)}if(a){this._startLoadingModuleData();this.devStatusData.retrieveAggregateData()}},_initFocusHandler:function(){var a=JIRA.DevStatus.DevStatusModule.MAX_REFRESH_WINDOW;AJS.$(window).on("focus",_.throttle(_.bind(this.refreshSummaryData,this),a,{trailing:false}))},refreshSummaryData:function(){this.devStatusData&&this.devStatusData.retrieveAggregateData()},_onChangeLabsOptIn:function(a,b){if(b===true){}else{}},_initLabsOptInView:function(){this.labsOptInView=new JIRA.DevStatus.Labs.LabsOptInView({el:this.parentContainer.find(".labs-on-off-container"),labsOptIn:this.labsOptIn}).render()},_initTryLabsView:function(){var a=AJS.$('<div class="try-labs-container"></div>').appendTo(this.headerContainer);new JIRA.DevStatus.Labs.TryLabsView({el:a,labsOptIn:this.labsOptIn}).render()},_postRender:function(h,g){var f=this._isAnySummaryViewVisibleOnPanel()||this._isAnyErrorViewVisible();var b=this;if(f){var e=this.analyticsModel.getIssue();JIRA.DevStatus.SummaryAnalytics.fireSummaryShownEvent(e.isAssignee,e.issueType,e.issueStatus,this.analyticsModel.getSummary());this._openDetailDialogUrlLink()}this._togglePanelEmptyStatus(!this._isAnySummaryViewVisibleOnPanel(true));var a=this.parentContainer;function c(){if(g){a.addClass("js-animation-completed");b._attachAutomaticTransitionsHelpTip()}}var d=f||(this.createBranchContainer.size()>0);if(this.devStatusPanelVisibilityToggler&&(a.is(":visible")!==d)){this.devStatusPanelVisibilityToggler(this.parentContainer,d,h,c)}else{c()}},_attachAutomaticTransitionsHelpTip:function(){var a=this.parentContainer.is(":visible");if(!this.triggerHelpTipShown&&JIRA.DevStatus.showAITTooltip&&a){_.defer(_.bind(function(){new AJS.HelpTip({id:"automaticTransitionDevSummaryTooltip",title:"Automate your status updates",bodyHtml:JIRA.Templates.DevStatus.Tooltip.automaticTransitions({aitHelpLinkUrl:this.devStatusContainer.data("ait-help-url-json")}),anchor:"#viewissue-devstatus-panel_heading .toggle-title",isSequence:true,callbacks:{init:function(){AJS.$("#trigger-docs-link").on("click",function(){AJS.trigger("analyticsEvent",{name:"devstatus.automatic.transitions.learn.more.clicked",data:{}})})}},inlineDialogOpts:{width:400}});AJS.HelpTip.Manager.showSequences()},this));this.triggerHelpTipShown=true}},_getModuleByType:function(a){return _.find(this._summaryModules,function(b){return b.data&&b.data.getType&&_.isEqual(b.data.getType(),a)})},_openDetailDialogUrlLink:function(){var a=AJS.Meta.get("fusion-open-detail-dialog");if(a){var c;if(JIRA.DevStatus.URL.isCreateReviewDetailDialogLink(a)){c=this._getModuleByType("repository")}else{c=this._getModuleByType(a);if(c){AJS.Meta.set("fusion-open-detail-dialog",undefined)}}if(c){var b=c.view;if(b&&b.isVisible()){AJS.Meta.set("fusion-analytics-new-context-link",true);b.getSummaryLink().click()}}}},_togglePanelEmptyStatus:function(a){if(this.statusPanelContainer){this.statusPanelContainer.toggleClass("empty-status",a)}},_isAnySummaryViewVisibleOnPanel:function(){return !!_.find(this._summaryModules,function(a){return a.isViewVisible()})},_isAnyErrorViewVisible:function(){return this._errorModule.isViewVisible()},_renderModules:function(a){var b=this._renderedData=a.renderData||this._renderedData;_.each(this._summaryModules,function(c){c.render(b)});this._errorModule.render(a.success?b:undefined)},_startLoadingModuleData:function(){_.each(this._summaryModules,function(a){a.startLoading()})}},{MAX_REFRESH_WINDOW:30000}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/DevStatusData.js' */
Backbone.define("JIRA.DevStatus.DevStatusData",Backbone.Model.extend({properties:["aggregatedData"],namedEvents:["beforeRequest","requestFail","requestSuccess"],initialize:function(a){this.issueId=a.issueId},retrieveAggregateData:function(){var a=AJS.contextPath()+"/rest/dev-status/1.0/issue/summary?issueId="+this.issueId;this.trigger("beforeRequest");return AJS.$.ajax(a).done(_.bind(this.setAggregateData,this)).fail(_.bind(this.setAggregateDataError,this)).promise()},setAggregateData:function(b,a,c){this.set("aggregatedData",b);this.trigger("requestSuccess",this,a===true,!!c)},setAggregateDataError:function(b,a){this.set("aggregatedData",undefined);this.trigger("requestFail",this,b)}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/CreateBranchView.js' */
Backbone.define("JIRA.DevStatus.CreateBranchView",Backbone.View.extend({initialize:function(a){this.tooltipShown=!a.showTooltip;this.linkTextSelector=".devstatus-cta-link-text";this.issueContainer=".issue-container";this._processLinkForNavigableURL();this._initTooltip();_.defer(_.bind(this._openCreateBranchDialog,this))},getCreateBranchLink:function(){return this.$el},_processLinkForNavigableURL:function(){this.getCreateBranchLink().data("cta",this._getCta(this.$el));this.getCreateBranchLink().attr("href",JIRA.DevStatus.URL.getUrlWithDetailDialogParam("create-branch"))},_openCreateBranchDialog:function(){var a=AJS.Meta.get("fusion-open-detail-dialog");if(a==="create-branch"){AJS.Meta.set("fusion-open-detail-dialog",undefined);AJS.Meta.set("fusion-analytics-new-context-link",true);this.getCreateBranchLink().click()}},_initTooltip:function(){if(!this.tooltipShown&&this.$el.length>0){_.defer(_.bind(function(){var a=this.$el.data("cta");if(a){new AJS.HelpTip({id:a+".tooltip",title:"Start development",bodyHtml:JIRA.Templates.DevStatus.Tooltip.createBranch(),anchor:this.$el.find(this.linkTextSelector),isSequence:true,inlineDialogOpts:{container:this.issueContainer,width:400}});this.tooltipShown=true;AJS.HelpTip.Manager.showSequences()}},this))}},_getCta:function(c){var b=c.attr("href"),a=b&&/\#([a-zA-Z\.]+)/.exec(b);return a&&a[1]}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BasePanelModule.js' */
Backbone.define("JIRA.DevStatus.BasePanelModule",Backbone.Model.extend({initialize:function(a){this.options=_.defaults({},a);this.data=this.createModel()},render:function(a){this.startViews();this.data.updateData(a);this.view.render()},startLoading:function(){this.data.startLoadingData&&this.data.startLoadingData()},startViews:function(){if(!this.view){this.view=this.createView()}},stopViews:function(){if(this.view){this.view.undelegateEvents();this.view.$el.empty();this.view.hide();this.view=null}},isViewVisible:function(){return this.view&&this.view.isVisible()},createView:function(){},createModel:function(){}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryView.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryView",Backbone.View.extend({template:undefined,events:{"simpleClick .summary":"_onSummaryLinkClick"},initialize:function(a){this.options=_.clone(a);this.model.on("change:hasData",this._addOrRemoveHasDataClass,this);this.model.on("change:dataLoading",this._addOrRemoveDataLoadingClass,this);this.transitionView=new JIRA.DevStatus.SummaryTransitionView({model:this.model,el:this.$el})},render:function(){var b=this.isVisible();if(b){var a=AJS.$(this.template(_.extend({issueKey:JIRA.Issue.getIssueKey()},this.model.getOverall())));if(this._shouldAnimateDataTransition()){this.transitionView.renderVisible(a)}else{this.$el.html(a);JIRA.DevStatus.Date.addTooltip(a)}this._renderNavigableSummaryLink();this.show()}else{if(!this._isHidden()){if(this._shouldAnimateDataTransition()){this.transitionView.renderHidden(_.bind(this.hide,this))}else{this.hide()}}}this._addOrRemoveDataLoadingClass();this._addOrRemoveHasDataClass()},getDefaultDetailDialogParameters:function(){return{issueKey:JIRA.Issue.getIssueKey(),issueId:JIRA.Issue.getIssueId(),tabs:this.model.get("byInstanceType"),dataType:this.model.getType(),showContactAdminForm:this.options.dataAttrs&&this.options.dataAttrs.showContactAdminForm}},getSummaryLink:function(){return this.$el.find("a.summary")},isVisible:function(){return this.model.getOverall().count>0},_addOrRemoveHasDataClass:function(){var a=this.model.get("hasData");this.$el.toggleClass("js-has-data",a)},_renderNavigableSummaryLink:function(){this.getSummaryLink().attr("href",JIRA.DevStatus.URL.getUrlWithDetailDialogParam(this.model.getType()))},_addOrRemoveDataLoadingClass:function(){var a=this.model.get("dataLoading");this.$el.toggleClass("data-loading",a)},_onSummaryLinkClick:function(a){a.preventDefault();console.log("Summary view not supported: ",this)},_shouldAnimateDataTransition:function(){return !!this.model.getPreviousOverall()},_isHidden:function(){return this.$el.hasClass("hidden")},show:function(){this.$el.removeClass("hidden")},hide:function(){this.$el.addClass("hidden")}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryTransitionView.js' */
Backbone.define("JIRA.DevStatus.SummaryTransitionView",Backbone.View.extend({slideTransitionTime:500,initialize:function(){},renderVisible:function(b){var a=!AJS.$.contains(document,this.$el[0]);if(this._hasPreviousData()){if(this._hasDataChanged()){this._prepareContentsForTransition(b,this.$el);this.$el.addClass("roll-transition")}}else{this._preStartSlideTransition();this.$el.addClass("slide-down-transition");a=true}this.$el.html(b);JIRA.DevStatus.Date.addTooltip(b);if(a){_.defer(_.bind(this._initiateTransition,this))}else{this._initiateTransition()}},renderHidden:function(b){var a=this;this.$el.slideUp(this.slideTransitionTime,function(){a.$el.css("display","");b()})},_initiateTransition:function(){if(this.$el.hasClass("slide-down-transition")){this._postStartSlideTransition();this.$el.removeClass("slide-down-transition");this._startSlideDownTransition(this.$el,0)}else{if(this.$el.hasClass("roll-transition")){this.$el.removeClass("roll-transition");this._startRollTransition()}var b=this.$el.find(".sliding-container");if(b.length>0){var a=this;b.each(function(d,c){var e=AJS.$(c);var f=e.data("prevHeight");a._startSlideDownTransition(e,f)})}}},_startSlideDownTransition:function(a,b){var c=a.height();if(b!==c){a.height(b).animate({height:c},this.slideTransitionTime,function(){a.css("height","auto");a.find(".rolling-content").removeClass("transit")})}},_startRollTransition:function(){this.$el.find(".rolling-container").each(_.bind(function(b,a){var f=AJS.$(a);var e=f.find(".rolling-content");var d=e.find(":not(.old-content)");var c=d.height();f.height(c);e.addClass("transit");d.css("margin-top","-"+c+"px").animate({"margin-top":"0"},this.slideTransitionTime,function(){f.css("height","auto");f.find(".old-content").remove();e.removeClass("transit");d.css("margin-top","")})},this))},_prepareContentsForTransition:function(b,d){b=AJS.$("<div></div>").append(b);var c=b.find(".sliding-container");var f=d.find(".sliding-container");c.each(function(h,i){var g=f.get(h);if(g){var j=AJS.$(g);AJS.$(i).data("prevHeight",j.height())}});var e=b.find(".rolling-container");var a=d.find(".rolling-container");e.each(function(i,j){var k=AJS.$(j).find(".rolling-content");var h=a.get(i);if(h){var g=AJS.$(h).find(".rolling-content").children();g.addClass("old-content");k.append(g)}})},_hasPreviousData:function(){var a=this.model.getPreviousOverall();return a&&a.count>0},_hasDataChanged:function(){return !_.isEqual(this.model.getOverall(),this.model.getPreviousOverall())},_preStartSlideTransition:function(){this.$el.css("height","0");this.$el.css("opacity","0")},_postStartSlideTransition:function(){this.$el.css("height","");this.$el.css("opacity","")}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryModule.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryModule",JIRA.DevStatus.BasePanelModule.extend({model:undefined,viewType:undefined,createModel:function(){return new this.model({})},createView:function(){return new this.viewType(_.extend(_.clone(this.options),{model:this.data}))}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/BaseSummaryModel.js' */
Backbone.define("JIRA.DevStatus.BaseSummaryModel",Backbone.Model.extend({typeId:undefined,properties:["byInstanceType","overall","previousOverall","hasData","dataLoading"],startLoadingData:function(){this.set("dataLoading",true)},updateData:function(b){this.set("hasData",b!==undefined);this.set("dataLoading",false);this.set("previousOverall",this.getOverall());if(b&&b.summary&&b.summary[this.typeId]){var a=b.summary[this.typeId];this.set("byInstanceType",a.byInstanceType);this.set("overall",a.overall)}else{this.set("byInstanceType",{});this.set("overall",{count:0})}},getType:function(){return this.typeId},getOverall:function(){return this.get("overall")},getPreviousOverall:function(){return this.get("previousOverall")}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/dialog/CreateBranchFormDialog.js' */
Backbone.define("JIRA.DevStatus.CreateBranchFormDialog",Backbone.View.extend({initialize:function(a){AJS.namespace("JIRA.DevStatus.CtaDialog");this.parentContainerSelector=a.parentContainerSelector;this.panelSelector=a.panelSelector;this.linkSelector=a.linkSelector;this.dialogId="devstatus-cta-dialog";JIRA.DevStatus.CtaDialogAnalytics.initialize(this.parentContainerSelector,this.linkSelector,this.dialogId);this._initFormDialog()},_initFormDialog:function(){var a=this;var b=JIRA.DevStatus.CtaDialog.dialog=new JIRA.FormDialog({id:this.dialogId,width:560,content:function(c){this.pickerView=new JIRA.DevStatus.InstancePickerView({el:this.$popup,activeTrigger:this.$activeTrigger,cta:a._getCta(this.$activeTrigger)});this.pickerView.render().always(function(d){c(d);AJS.$(b.$popup).find(".target").eq(0).focus();JIRA.DevStatus.CtaDialogAnalytics.fireCreateBranchEvent("dialog.open")})},trigger:this.linkSelector,autoClose:true})},_getCta:function(d){var c=d.data("cta");if(c){return c}else{var b=d.attr("href"),a=b&&/\#([a-zA-Z\.]+)/.exec(b);return a&&a[1]}}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorModule.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorModule",JIRA.DevStatus.BasePanelModule.extend({createModel:function(){return new JIRA.DevStatus.SummaryErrorModel({})},createView:function(){var a=this.options.dataAttrs&&this.options.dataAttrs.showContactAdminForm;return new JIRA.DevStatus.SummaryErrorView({model:this.data,el:this.options.el,showContactAdminForm:a})}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorModel.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorModel",Backbone.Model.extend({properties:["hasErrors","errorInstances","configInstances"],defaults:function(){return{hasErrors:false,errorInstances:[],configInstances:[]}},updateData:function(b){var c=this._extractErrors(b&&b.errors);var a=this._extractErrors(b&&b.configErrors);this.set("hasErrors",!b||!_.isEmpty(c)||!_.isEmpty(a));this.set("errorInstances",c);this.set("configInstances",a)},_extractErrors:function(a){if(!a){return[]}return _.map(_.filter(a,function(b){return b.error}),function(b){return b.instance})}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/summary/SummaryErrorView.js' */
Backbone.define("JIRA.DevStatus.SummaryErrorView",JIRA.DevStatus.BaseSummaryView.extend({initialize:function(a){this.showContactAdminForm=a.showContactAdminForm},render:function(){if(this.isVisible()){this.$el.html(JIRA.Templates.DevStatus.connectionProblemAsInfoWithoutIcon({instances:this.model.get("errorInstances"),notConfiguredInstances:this.model.get("configInstances"),showContactAdminForm:this.showContactAdminForm}));this.show()}else{this.hide()}return this},isVisible:function(){return this.model.get("hasErrors")}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/LabsOptInModel.js' */
Backbone.define("JIRA.DevStatus.Labs.LabsOptInModel",Backbone.Model.extend({defaults:{allowed:false,optedIn:false,optedInByAdmin:false,dismissed:false,id:1},isAllowed:function(){return this.get("allowed")},isOptedIn:function(){return this.get("optedIn")},isOptedInByAdmin:function(){return this.get("optedInByAdmin")},setOptedIn:function(a){return this.save({optedIn:a},{wait:true}).done(function(){JIRA.DevStatus.LabsAnalytics.fireLabsEvent(a)})},toggleOptedIn:function(a){var b=this.isOptedIn();return this.setOptedIn(!b)},setDismissed:function(a){return this.save({dismissed:a},{wait:true})},isDismissed:function(){return this.get("dismissed")},url:function(){return AJS.contextPath()+"/rest/dev-status/1.0/labs-opt-in/"}},{createFromDOM:function(b){var a=AJS.$(b).find("#devstatus-container");return new JIRA.DevStatus.Labs.LabsOptInModel(a.data("labs-json"))}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/LabsOptInView.js' */
Backbone.define("JIRA.DevStatus.Labs.LabsOptInView",Backbone.View.extend({events:{"click .toggle-labs":"_onClickToggle","click .labs-close":"_onClickDismiss","click .feedback-link":"_onClickFeedback"},initialize:function(a){this.labsOptIn=a.labsOptIn;this.labsOptIn.on("change",this.render,this);this.labsOptIn.on("change:optedIn",this._onChangeOptedIn,this)},render:function(){var a=this.labsOptIn;if(a.isAllowed()&&(a.isOptedInByAdmin()||!a.isDismissed())){this._show()}else{this._hide()}return this},_onClickToggle:function(a){a.preventDefault();this.labsOptIn.toggleOptedIn()},_onClickDismiss:function(a){a.preventDefault();this.labsOptIn.setDismissed(true)},_onClickFeedback:function(a){a.preventDefault();this._showFeedbackDialog()},_onChangeOptedIn:function(b,a){if(a===false){this._showFeedbackDialog({summary:"How can Atlassian improve the development panel?"})}},_showFeedbackDialog:function(b){var a=new JIRA.DevStatus.FeedbackDialog(b);a.show()},_show:function(){this.$el.html(JIRA.Templates.DevStatus.labsOnOff({isOptedIn:this.labsOptIn.isOptedIn(),isOptedInByAdmin:this.labsOptIn.isOptedInByAdmin()}));this.$el.removeClass("hidden")},_hide:function(){this.$el.empty();this.$el.addClass("hidden")}},{COLLECTOR_ID:"effe8b72"}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-panel-and-dialog-resources', location = 'js/viewissue/labs/TryLabsView.js' */
Backbone.define("JIRA.DevStatus.Labs.TryLabsView",Backbone.View.extend({events:{"click .try-labs":"_onClickTryLabs"},initialize:function(a){this.labsOptIn=a.labsOptIn;this.labsOptIn.on("change:dismissed",this.render,this)},render:function(){if(!this.labsOptIn.isAllowed()||this.labsOptIn.isOptedIn()||!this.labsOptIn.isDismissed()){this.$el.empty()}else{this.$el.html(JIRA.Templates.DevStatus.tryLabs())}return this},_onClickTryLabs:function(a){a.preventDefault();this.labsOptIn.setDismissed(false)}}));;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-cta-tooltip-resources', location = 'templates/viewissue/devstatus-cta-tooltips.soy' */
// This file was automatically generated from devstatus-cta-tooltips.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DevStatus == 'undefined') { JIRA.Templates.DevStatus = {}; }
if (typeof JIRA.Templates.DevStatus.Tooltip == 'undefined') { JIRA.Templates.DevStatus.Tooltip = {}; }


JIRA.Templates.DevStatus.Tooltip.createBranch = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.Tooltip.tooltipLayout({extraClasses: 'create-branch', content: '<span class="branch-illustration"></span><div class="branch-text"><p>' + soy.$$escapeHtml("Create a branch for this issue in your source repository") + '.<br /> <a class="cta-learn-more-link" href="https://www.atlassian.com/git/workflows" target="_blank">' + soy.$$escapeHtml("Learn more about branching strategies") + '.</a></p></div>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Tooltip.automaticTransitions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.DevStatus.Tooltip.tooltipLayout({extraClasses: 'dev-summary-automatic-transitions', content: '<p>' + soy.$$escapeHtml("Now JIRA can automatically update your issue status when pull requests and other actions occur.") + '</p><p><a href="' + soy.$$escapeHtml(opt_data.aitHelpLinkUrl.url) + '" id="trigger-docs-link" target="_blank" title="' + soy.$$escapeHtml("Learn about automating your workflow") + '">' + soy.$$escapeHtml("Learn about automating your workflow") + '</a></p>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.DevStatus.Tooltip.tooltipLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cta-tooltip', (opt_data.extraClasses) ? ' ' + soy.$$escapeHtml(opt_data.extraClasses) : '', '">', opt_data.content, '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-development-integration-plugin:devstatus-analytics-resources', location = 'js/analytics/devstatus-analytics.js' */
(function(d,a){AJS.namespace("JIRA.DevStatus.Analytics");var b=".edit-permission-link";function c(){return !AJS.DarkFeatures.isEnabled("jira.plugin.devstatus.analytics.disabled")}a.DevStatus.Analytics={fireEvent:function(f,g){if(c()){var e="devstatus."+f;var h=(typeof g!=="object")?{}:g;AJS.trigger("analyticsEvent",{name:e,data:h})}},fireAgileDevStatusLinkClicked:function(){return a.DevStatus.Analytics.fireEvent("panel.agile.icon.clicked")}};a.DevStatus.LabsAnalytics={fireLabsEvent:function(e){var f=e?"on":"off";return a.DevStatus.Analytics.fireEvent("labs.toggle."+f)}};a.DevStatus.SummaryAnalytics={fireSummaryShownEvent:function(g,f,e,h){var j=g?"assignee":"nonassignee";var i=_.extend({issueType:f,issueStatus:e},h);return a.DevStatus.Analytics.fireEvent("summary.shown."+j,i)},fireSummaryClickedEvent:function(f,e){var h=AJS.Meta.get("fusion-analytics-new-context-link");var g=".clicked";if(h){AJS.Meta.set("fusion-analytics-new-context-link",undefined);g+=".newcontext"}return a.DevStatus.Analytics.fireEvent(f+".summary"+g,e)},fireDetailTabClicked:function(f,e){return a.DevStatus.Analytics.fireEvent(e+".detail."+f+".tab.clicked")}};a.DevStatus.BuildsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("builds",e)},fireDetailProjectClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.project.clicked")},fireDetailPlanClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.plan.clicked")},fireDetailBuildClicked:function(){return a.DevStatus.Analytics.fireEvent("builds.detail.build.clicked")}};a.DevStatus.DeploymentsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("deployments",e)},fireDetailProjectClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.project.clicked")},fireDetailEnvironmentClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.environment.clicked")},fireDetailReleaseClicked:function(){return a.DevStatus.Analytics.fireEvent("deployments.detail.release.clicked")}};a.DevStatus.CommitsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("commits",e)},fireDetailRepoClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".repo.clicked")},fireDetailCommitClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".commit.clicked")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"commits")},fireDetailFileExpandedClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".file.expanded.clicked")},fireDetailFilesExpandedClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".files.expanded.clicked")},fireDetailFileClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".file.clicked")},fireDetailReviewsShown:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".reviews.shown")},fireDetailReviewClicked:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".review.clicked")},fireDetailBranchesShown:function(e){return a.DevStatus.Analytics.fireEvent("commits.detail."+e+".branches.shown")},fireDetailCreateReviewClicked:function(f,e){return a.DevStatus.Analytics.fireEvent("commits.detail."+f+".review.create"+(e?".all":""))}};a.DevStatus.ReviewsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("reviews",e)},fireDetailReviewClicked:function(){return a.DevStatus.Analytics.fireEvent("reviews.detail.review.clicked")}};a.DevStatus.BranchesAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("branches",e)},_fireDetailClickedEvent:function(f,e){return a.DevStatus.Analytics.fireEvent("branches.detail."+f+"."+e+".clicked")},fireDetailRepoClicked:function(e){this._fireDetailClickedEvent(e,"repo")},fireDetailBranchClicked:function(e){this._fireDetailClickedEvent(e,"branch")},fireDetailPullRequestLozengeClick:function(e){this._fireDetailClickedEvent(e,"pullrequest.lozenge")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"branches")},fireDetailCreatePullRequestClicked:function(g,e,h){var f="pullrequest.create";if(e){f+=".assignee"}else{f+=".nonassignee";if(h){f+=".assignable"}else{f+=".nonassignable"}}this._fireDetailClickedEvent(g,f)}};a.DevStatus.PullRequestsAnalytics={fireSummaryClickedEvent:function(e){return a.DevStatus.SummaryAnalytics.fireSummaryClickedEvent("pullrequests",e)},fireDetailPullRequestClicked:function(e){return a.DevStatus.Analytics.fireEvent("pullrequests.detail."+e+".pullrequest.clicked")},fireDetailTabClicked:function(e){return a.DevStatus.SummaryAnalytics.fireDetailTabClicked(e,"pullrequests")}};a.DevStatus.LearnMoreAnalytics={fireLearnMoreEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("learnmore."+e,f)}};a.DevStatus.CtaDialogAnalytics={issueDetails:{},fireCreateBranchEvent:function(e,g){g=(typeof g!=="object")?{}:g;var f=d.extend({issueStatus:this.issueDetails.status,issueType:this.issueDetails.type},g);return a.DevStatus.Analytics.fireEvent("createbranch."+e+"."+(this.issueDetails.isAssignee?"assignee":"nonassignee"),f)},_populateIssueDetails:function(e){this.issueDetails={status:""+e.data("issueStatus"),type:""+e.data("issueType"),isAssignee:e.data("isAssignee")}},_initHandler:function(h,g,j,i){if(j&&g.not(document).is(j)){var f=this;g.find(i).on("simpleClick",function(){var e=d(this);f._fireCreateBranchEvent(e)})}},_fireCreateBranchEvent:function(f){this._populateIssueDetails(f);var e="click";var g=AJS.Meta.get("fusion-analytics-new-context-link");if(g){AJS.Meta.set("fusion-analytics-new-context-link",undefined);e+=".newcontext"}this.fireCreateBranchEvent(e)},initialize:function(h,g,f){if(c()){var e=this;a.bind(a.Events.NEW_CONTENT_ADDED,_.bind(function(j,i){this._initHandler(j,i,h,g)},this));a.bind("GH.DetailView.updated",_.bind(function(i){this._initHandler(i,AJS.$(h),h,g)},this));d(g).on("simpleClick",function(){var i=d(this);e._fireCreateBranchEvent(i)});d(document).on("click","#"+f+" .jira-dialog-content .target",function(){var i=d(this);e.fireCreateBranchEvent("dialog.click",{title:i.find(".title").attr("title"),applicationType:i.data("applicationType")})});d(document).on("click","#"+f+" .jira-dialog-content button.cancel",function(){e.fireCreateBranchEvent("dialog.cancel")});d(document).on("click",".cta-tooltip .cta-learn-more-link",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.ctahelptipbranching")})}}};a.DevStatus.AdminAnalytics={fireAdminEvent:function(e,f){return a.DevStatus.Analytics.fireEvent("admin."+e,f)},initialize:function(){if(c()){var e=this,f=d("#project-config-panel-dev-status");f.find(b).on("click",function(){e.fireAdminEvent("editpermissionlink.config."+(d("ul.permissions-list li.devstatus-admin-permission-item").length>0?"withpermissions":"nopermissions"))});f.find(".learn-more-link").on("click",function(){a.DevStatus.LearnMoreAnalytics.fireLearnMoreEvent("click.adminappvertisementlink")});f.find("#project-config-applinks-connect").on("click",function(){e.fireAdminEvent("connect")});f.find(".devstatus-admin-connect-button-option").on("click",function(){var g=d(this).data("key")||"unknown";e.fireAdminEvent("connect."+g)})}}};a.DevStatus.AdminSummaryAnalytics={initialize:function(){if(c()){d("#project-config-webpanel-devstatus-admin-summary-panel").find(b).on("click",function(){a.DevStatus.AdminAnalytics.fireAdminEvent("editpermissionlink.summary.nopermissions")})}}}})(AJS.$,JIRA);;
;/* module-key = 'jira.webresources:admin-gadget-listener', location = '/includes/jira/dashboard/gadgetMsgListener.js' */
var gadgetAdminMessageListener={};gadgetAdminMessageListener.gadgetSource;(function(){gadgetAdminMessageListener.onMessage=function(e){gadgetAdminMessageListener.gadgetSource=e.source;var data=e.data;if(data=="createproject"){if(AJS.$("#hiddenCreateProjectLink").length==0){AJS.$("<a>").attr("id","hiddenCreateProjectLink").attr("href",AJS.params["baseURL"]+"/secure/admin/AddProject!default.jspa?src=admingadget").attr("style","display:none").addClass("add-project-trigger").appendTo("#footer")}AJS.$("#hiddenCreateProjectLink").click()}else{if(data=="createissue"){AJS.$(".create-issue").click()}}};if(typeof window.addEventListener!="undefined"){window.addEventListener("message",gadgetAdminMessageListener.onMessage,false)}else{if(typeof window.attachEvent!="undefined"){window.attachEvent("onmessage",gadgetAdminMessageListener.onMessage)}}})();JIRA.bind("QuickCreateIssue.sessionComplete",function(){var gadgetSrc=gadgetAdminMessageListener.gadgetSource;if(gadgetSrc&&typeof gadgetSrc.postMessage==="function"){gadgetSrc.postMessage("issuecreated","*")}});;
;/* module-key = 'jira.webresources:initMainDashboard', location = '/includes/jira/dashboard/initMainDashboard.js' */
AJS.$(function(){var infoMessage=WRM.data.claim("dashboardInfoMessage");var installMessage=WRM.data.claim("dashboardInstallMessage");if(infoMessage||installMessage){var flag=require("jira/flag");if(infoMessage){flag.showInfoMsg("",infoMessage)}if(installMessage){flag.showSuccessMsg("",installMessage)}}});;
;/* module-key = 'com.atlassian.auiplugin:internal-aui-browser', location = 'js/aui/internal/browser.js' */
(function(A){AJS._internal=AJS._internal||{};AJS._internal.browser=A(AJS.$)})(function(B){var A={};var C=null;A.supportsCalc=function(){if(C===null){var D=B('<div style="height: 10px; height: -webkit-calc(20px + 0); height: calc(20px);"></div>');C=(20===D.appendTo(document.documentElement).height());D.remove()}return C};A.supportsRequestAnimationFrame=function(){return !!window.requestAnimationFrame};return A});;
;/* module-key = 'com.atlassian.auiplugin:dialog2', location = 'js/dialog2.js' */
(function(A){AJS.dialog2=A(AJS.$,AJS.layer,AJS._internal.widget)})(function(D,G,C){var F={"aui-focus":"false","aui-blanketed":"true"};function B(H){D.each(F,function(I,J){var K="data-"+I;if(!H[0].hasAttribute(K)){H.attr(K,J)}})}function A(H){if(H){this.$el=D(H)}else{this.$el=D(aui.dialog.dialog2({}))}B(this.$el)}A.prototype.on=function(I,H){G(this.$el).on(I,H);return this};A.prototype.off=function(I,H){G(this.$el).off(I,H);return this};A.prototype.show=function(){G(this.$el).show();return this};A.prototype.hide=function(){G(this.$el).hide();return this};A.prototype.remove=function(){G(this.$el).remove();return this};A.prototype.isVisible=function(){return G(this.$el).isVisible()};var E=C("dialog2",A);E.on=function(H,I){G.on(H,".aui-dialog2",I);return this};E.off=function(H,I){G.off(H,".aui-dialog2",I);return this};D(document).on("click",".aui-dialog2-header-close",function(H){H.preventDefault();E(D(this).closest(".aui-dialog2")).hide()});E.on("show",function(K,J){var I=[".aui-dialog2-content",".aui-dialog2-footer",".aui-dialog2-header"];var H;I.some(function(L){H=J.find(L+" :aui-tabbable");return H.length});H&&H.first().focus()});E.on("hide",function(J,I){var H=G(I);if(I.data("aui-remove-on-hide")){H.remove()}});return E});;
;/* module-key = 'com.atlassian.auiplugin:dialog2', location = 'soy/dialog2.soy' */
// This file was automatically generated from dialog2.soy.
// Please don't edit this file by hand.

if (typeof aui == 'undefined') { var aui = {}; }
if (typeof aui.dialog == 'undefined') { aui.dialog = {}; }


aui.dialog.dialog2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param12 = new soy.StringBuilder();
  aui.dialog.dialog2Content({id: null, titleText: opt_data.titleText, titleContent: opt_data.titleContent, headerActionContent: opt_data.headerActionContent, headerSecondaryContent: opt_data.headerSecondaryContent, modal: opt_data.modal, content: opt_data.content, footerHintText: opt_data.footerHintText, footerHintContent: opt_data.footerHintContent, footerActionContent: opt_data.footerActionContent}, param12);
  aui.dialog.dialog2Chrome({id: opt_data.id, titleId: opt_data.id ? opt_data.id + '-dialog-title' : null, modal: opt_data.modal, tagName: opt_data.tagName, removeOnHide: opt_data.removeOnHide, visible: opt_data.visible, size: opt_data.size, extraClasses: opt_data.extraClasses, extraAttributes: opt_data.extraAttributes, content: param12.toString()}, output);
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Chrome = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.titleId) ? ' aria-labelledby="' + soy.$$escapeHtml(opt_data.titleId) + '"' : '', ' role="dialog" class=" aui-layer aui-dialog2 aui-dialog2-', soy.$$escapeHtml(opt_data.size ? opt_data.size : 'medium'));
  aui.renderExtraClasses(opt_data, output);
  output.append('"', (opt_data.modal) ? 'data-aui-modal="true"' : '', (opt_data.removeOnHide) ? 'data-aui-remove-on-hide="true"' : '', (opt_data.visible != true) ? 'aria-hidden="true"' : '');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', '</', soy.$$escapeHtml(opt_data.tagName ? opt_data.tagName : 'section'), '>');
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.dialog.dialog2Header({titleId: opt_data.id ? opt_data.id + '-dialog-title' : null, titleText: opt_data.titleText, titleContent: opt_data.titleContent, actionContent: opt_data.headerActionContent, secondaryContent: opt_data.headerSecondaryContent, modal: opt_data.modal}, output);
  aui.dialog.dialog2Panel(opt_data, output);
  aui.dialog.dialog2Footer({hintText: opt_data.footerHintText, hintContent: opt_data.footerHintContent, actionContent: opt_data.footerActionContent}, output);
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Header = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<header', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dialog2-header');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('><h2 ', (opt_data.titleId) ? ' id="' + soy.$$escapeHtml(opt_data.titleId) + '"' : '', ' class="aui-dialog2-header-main">', (opt_data.titleText) ? soy.$$escapeHtml(opt_data.titleText) : '', (opt_data.titleContent) ? opt_data.titleContent : '', '</h2>', (opt_data.actionContent) ? '<div class="aui-dialog2-header-actions">' + opt_data.actionContent + '</div>' : '', (opt_data.secondaryContent) ? '<div class="aui-dialog2-header-secondary">' + opt_data.secondaryContent + '</div>' : '', (opt_data.modal != true) ? '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">' + soy.$$escapeHtml("Close") + '</span></a>' : '', '</header>');
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Footer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<footer', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dialog2-footer');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.actionContent) ? '<div class="aui-dialog2-footer-actions">' + opt_data.actionContent + '</div>' : '', (opt_data.hintText || opt_data.hintContent) ? '<div class="aui-dialog2-footer-hint">' + ((opt_data.hintText) ? soy.$$escapeHtml(opt_data.hintText) : '') + ((opt_data.hintContent) ? opt_data.hintContent : '') + '</div>' : '', '</footer>');
  return opt_sb ? '' : output.toString();
};


aui.dialog.dialog2Panel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', ' class="aui-dialog2-content');
  aui.renderExtraClasses(opt_data, output);
  output.append('"');
  aui.renderExtraAttributes(opt_data, output);
  output.append('>', (opt_data.content) ? opt_data.content : '', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'templates/dashboard.soy' */
// This file was automatically generated from dashboard.soy.
// Please don't edit this file by hand.

if (typeof Gadgets == 'undefined') { var Gadgets = {}; }
if (typeof Gadgets.Templates == 'undefined') { Gadgets.Templates = {}; }
if (typeof Gadgets.Templates.Dashboard == 'undefined') { Gadgets.Templates.Dashboard = {}; }


Gadgets.Templates.Dashboard.attr = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.styleClass) ? ' class="' + soy.$$escapeHtml(opt_data.styleClass) + '"' : '', (opt_data.href) ? ' href="' + soy.$$escapeHtml(opt_data.href) + '"' : '', (opt_data.value) ? ' value="' + soy.$$escapeHtml(opt_data.value) + '"' : '', (opt_data.name) ? ' name="up_' + soy.$$escapeHtml(opt_data.name) + '"' : '', (opt_data.selected) ? ' selected="selected"' : '');
  return opt_sb ? '' : output.toString();
};


Gadgets.Templates.Dashboard.dropdown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var dropdownStyleClass__soy32 = opt_data.styleClass ? 'aui-dd-parent ' + opt_data.styleClass : 'aui-dd-parent';
  var triggerStyleClass__soy33 = opt_data.trigger.styleClass ? opt_data.trigger.styleClass : 'aui-dd-trigger';
  output.append('<li ');
  Gadgets.Templates.Dashboard.attr(soy.$$augmentData(opt_data, {styleClass: dropdownStyleClass__soy32}), output);
  output.append('><a id="', soy.$$escapeHtml(opt_data.trigger.id), '" class="', soy.$$escapeHtml(triggerStyleClass__soy33), ' standard " href="#"><span>', soy.$$escapeHtml(opt_data.trigger.text), '</span></a><ul class="aui-dropdown standard hidden">');
  var itemList44 = opt_data.list.items;
  var itemListLen44 = itemList44.length;
  for (var itemIndex44 = 0; itemIndex44 < itemListLen44; itemIndex44++) {
    var itemData44 = itemList44[itemIndex44];
    Gadgets.Templates.Dashboard.menuItem(itemData44, output);
  }
  output.append('</ul></li>');
  return opt_sb ? '' : output.toString();
};


Gadgets.Templates.Dashboard.menuItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.useTemplate == 'dropdown') {
    Gadgets.Templates.Dashboard.dropdown(opt_data, output);
  } else {
    output.append('<li ');
    Gadgets.Templates.Dashboard.attr(opt_data, output);
    output.append('>');
    if (opt_data.items) {
      output.append('<ul>');
      var subItemList59 = opt_data.items;
      var subItemListLen59 = subItemList59.length;
      for (var subItemIndex59 = 0; subItemIndex59 < subItemListLen59; subItemIndex59++) {
        var subItemData59 = subItemList59[subItemIndex59];
        Gadgets.Templates.Dashboard.menuItem(subItemData59, output);
      }
      output.append('</ul>');
    } else {
      output.append('<a ');
      Gadgets.Templates.Dashboard.attr(opt_data.link, output);
      output.append('>', soy.$$escapeHtml(opt_data.link.text), '</a>');
    }
    output.append('</li>');
  }
  return opt_sb ? '' : output.toString();
};


Gadgets.Templates.Dashboard.gadget = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="gadget ', (opt_data.color) ? soy.$$escapeHtml(opt_data.color) : '', '" id="gadget-', soy.$$escapeHtml(opt_data.id), '-renderbox"><div class="dashboard-item-frame gadget-container" id="gadget-', soy.$$escapeHtml(opt_data.id), '-chrome"><div class="dashboard-item-header"><h3 id="gadget-', soy.$$escapeHtml(opt_data.id), '-title" class="dashboard-item-title">', (opt_data.titleUrl) ? '<a href="' + soy.$$escapeHtml(opt_data.titleUrl) + '">' + soy.$$escapeHtml(opt_data.title) + '</a>' : soy.$$escapeHtml(opt_data.title), '</h3><div class="gadget-menu"><ul>', (opt_data.layout.writable) ? '<li class="aui-icon i-move">move</li>' : '', (opt_data.isMaximizable) ? '<li><a href="#" id="gadget-' + soy.$$escapeHtml(opt_data.id) + '-maximize" class="aui-icon maximize" title="' + soy.$$escapeHtml("Maximize") + '">' + soy.$$escapeHtml("Maximize") + '</a></li>' : '');
  Gadgets.Templates.Dashboard.dropdown(opt_data.menu, output);
  output.append('</ul></div></div><div class="dashboard-item-content ', (opt_data.minimized) ? 'minimization' : '', '">');
  if (opt_data.userPrefs) {
    output.append('<form action="', soy.$$escapeHtml(opt_data.userPrefs.action), '" class="aui userpref-form hidden" method="post" id="gadget-', soy.$$escapeHtml(opt_data.id), '-edit"><fieldset><legend><span class="dashboard-item-title">', soy.$$escapeHtml(opt_data.title), '</span> ', soy.$$escapeHtml("Preferences"), '</legend>');
    var fieldList121 = opt_data.userPrefs.fields;
    var fieldListLen121 = fieldList121.length;
    for (var fieldIndex121 = 0; fieldIndex121 < fieldListLen121; fieldIndex121++) {
      var fieldData121 = fieldList121[fieldIndex121];
      if (fieldData121.type == 'hidden') {
        output.append('<input id="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref" type="hidden" class="hidden" ');
        Gadgets.Templates.Dashboard.attr(fieldData121, output);
        output.append('/>');
      } else if (fieldData121.type == 'list') {
        output.append('<div id="up_', soy.$$escapeHtml(fieldData121.name), '-container" class="list-container field-group"><label for="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref">', soy.$$escapeHtml(fieldData121.displayName), '</label><input id="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref" type="text" class="list text med" ');
        Gadgets.Templates.Dashboard.attr(fieldData121, output);
        output.append(' />', (fieldData121.required) ? 'field.required' : '', '<div class="description">', soy.$$escapeHtml("(pipe-delimited)"), '</div></div>');
      } else if (fieldData121.type == 'bool') {
        output.append('<div class="checkbox field-group"><input type="checkbox" value="true" class="bool" id="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref" ', (fieldData121.value) ? 'checked' : '', ' ');
        Gadgets.Templates.Dashboard.attr(fieldData121, output);
        output.append(' /><label for="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref">', soy.$$escapeHtml(fieldData121.displayName), ' ', (fieldData121.required) ? 'field.required' : '', '</label><br/></div>');
      } else if (fieldData121.type == 'enum') {
        output.append('<div class="field-group"><label for="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref">', soy.$$escapeHtml(fieldData121.displayName), ' ', (fieldData121.required) ? 'field.required' : '', '</label><select id="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref" class="enum" ');
        Gadgets.Templates.Dashboard.attr(fieldData121, output);
        output.append('>');
        var optionList193 = fieldData121.options;
        var optionListLen193 = optionList193.length;
        for (var optionIndex193 = 0; optionIndex193 < optionListLen193; optionIndex193++) {
          var optionData193 = optionList193[optionIndex193];
          output.append('<option class="enum" ');
          Gadgets.Templates.Dashboard.attr(optionData193, output);
          output.append('>', soy.$$escapeHtml(optionData193.label), '</option>');
        }
        output.append('</select></div>');
      } else if (fieldData121.type == 'string') {
        output.append('<div class="field-group"><label for="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref">', soy.$$escapeHtml(fieldData121.displayName), '</label><input id="gadget-', soy.$$escapeHtml(opt_data.id), '-form-', soy.$$escapeHtml(fieldData121.name), '-pref" type="text" ');
        Gadgets.Templates.Dashboard.attr(fieldData121, output);
        output.append(' class="string text">', (fieldData121.required) ? 'field.required' : '', '<br/></div>');
      }
    }
    output.append('</fieldset><div class="buttons-container submit"><input type="submit" class="submit" value="', soy.$$escapeHtml("Save"), '" name="save" id="gadget-', soy.$$escapeHtml(opt_data.id), '-save"/><input type="reset" class="cancel" value="', soy.$$escapeHtml("Cancel"), '" name="reset" id="gadget-', soy.$$escapeHtml(opt_data.id), '-cancel" class="userpref-form-cancel"/></div></form>');
  }
  var gadgetHeight__soy229 = opt_data.height ? opt_data.height : 300;
  output.append((opt_data.inlineHtml || opt_data.amdModule) ? '<div id="gadget-' + soy.$$escapeHtml(opt_data.id) + '" class="gadget-inline" height="' + soy.$$escapeHtml(gadgetHeight__soy229) + '">' + opt_data.inlineHtml + '</div>' : '<iframe id="gadget-' + soy.$$escapeHtml(opt_data.id) + '" class="gadget-iframe" name="gadget-' + soy.$$escapeHtml(opt_data.id) + '" src="' + soy.$$escapeHtml(opt_data.renderedGadgetUrl) + '" height="' + soy.$$escapeHtml(gadgetHeight__soy229) + '" width="100%" scrolling="no" frameborder="no"></iframe>', '</div></div></div>');
  return opt_sb ? '' : output.toString();
};


Gadgets.Templates.Dashboard.layoutDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="dialog-components"><h2 class="dialog-title">', soy.$$escapeHtml("Edit Layout"), '</h2><div class="dialog-page-body"><div class="dialog-panel-body panel-body"><p><strong>', soy.$$escapeHtml("Choose dashboard layout"), '</strong></p><ul>');
  var layoutList257 = opt_data.layouts;
  var layoutListLen257 = layoutList257.length;
  for (var layoutIndex257 = 0; layoutIndex257 < layoutListLen257; layoutIndex257++) {
    var layoutData257 = layoutList257[layoutIndex257];
    output.append('<li><a href="#" id="', soy.$$escapeHtml(layoutData257.layoutAttrName), '"><strong>', soy.$$escapeHtml(layoutData257.layout), '</strong></a></li>');
  }
  output.append('</ul></div></div><div class="dialog-button-panel"><button class="button-panel-button" id="', soy.$$escapeHtml(opt_data.closeId), '">', soy.$$escapeHtml("Close"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};


Gadgets.Templates.Dashboard.dashboardMenu = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-header"><div class="aui-page-header-inner"><div class="aui-page-header-main"><h1></h1></div><div class="aui-page-header-actions" id="dash-options"><div id="dash-throbber" class="throbber">&nbsp;</div><ul class="operations enabled">');
  var itemList271 = opt_data.items;
  var itemListLen271 = itemList271.length;
  for (var itemIndex271 = 0; itemIndex271 < itemListLen271; itemIndex271++) {
    var itemData271 = itemList271[itemIndex271];
    Gadgets.Templates.Dashboard.menuItem(itemData271, output);
  }
  output.append('</ul></div></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'templates/dashboard-item-directory.soy' */
// This file was automatically generated from dashboard-item-directory.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Dashboard == 'undefined') { JIRA.Dashboard = {}; }
if (typeof JIRA.Dashboard.Templates == 'undefined') { JIRA.Dashboard.Templates = {}; }


JIRA.Dashboard.Templates.gadgetDirectoryDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<section role="dialog" id="', soy.$$escapeHtml(opt_data.id), '" class="aui-layer aui-dialog2 aui-dialog2-xlarge" aria-hidden="true"><header class="aui-dialog2-header"><h1 class="aui-dialog2-header-main">', soy.$$escapeHtml(opt_data.headerText), '</h1>', (opt_data.canManageGadgets) ? '<div class="aui-dialog2-header-secondary"><a href="' + soy.$$escapeHtml(opt_data.gadgetsAdminUrl) + '">' + soy.$$escapeHtml(opt_data.manageGadgetsLabel) + '</a></div>' : '', '<a class="aui-dialog2-header-close"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">', soy.$$escapeHtml("Close"), '</span></a></header><div class="aui-dialog2-content"></div></section>');
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.gadgetDirectoryLoadingPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="message-panel"><div class="loading-spinner"></div><p class="loading-text">', soy.$$escapeHtml(opt_data.loadingText), '</p></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.gadgetDirectoryLoadFailurePage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="message-panel"><p class="title" style="text-align: center;"><strong>', soy.$$escapeHtml("Failed to load gadgets"), '</strong></p><p style="text-align: center;">', soy.$$escapeHtml("Something went wrong while trying to load the gadgets."), '</p><p style="text-align: center;"><a href="#" data-purpose="reload-directory">', soy.$$escapeHtml("Try again"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.gadgetDirectoryPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="directory-page" class="aui-group"><div id="nav-panel" class="aui-item aui-page-panel-nav"><form class="directory-search aui" action="#"><input id="search" class="text" type="text" placeholder="', soy.$$escapeHtml(opt_data.searchPlaceholder), '"></input></form><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"></div></nav></div><div id="right-panel" class="aui-item"><div id="message-panel"></div><div id="list-panel"></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.directoryNavList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-nav-heading"><strong>', soy.$$escapeHtml(opt_data.headerText), '</strong></div><ul class="aui-nav">');
  var categoryList38 = opt_data.categories;
  var categoryListLen38 = categoryList38.length;
  for (var categoryIndex38 = 0; categoryIndex38 < categoryListLen38; categoryIndex38++) {
    var categoryData38 = categoryList38[categoryIndex38];
    var isSelected__soy39 = categoryData38.label == opt_data.selectedCategoryLabel;
    JIRA.Dashboard.Templates.directoryNavItem({category: categoryData38, selected: isSelected__soy39}, output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.directoryNavItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="category-nav-item', (opt_data.selected) ? ' aui-nav-selected' : '', '" ><a href="#" data-category-label="', soy.$$escapeHtml(opt_data.category.label), '" data-purpose="category-nav" title="', soy.$$escapeHtml(opt_data.category.label), '"><span class="aui-badge">', soy.$$escapeHtml(opt_data.category.count), '</span>', soy.$$escapeHtml(opt_data.category.label), '</a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.directoryItems = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var itemList60 = opt_data.items;
  var itemListLen60 = itemList60.length;
  for (var itemIndex60 = 0; itemIndex60 < itemListLen60; itemIndex60++) {
    var itemData60 = itemList60[itemIndex60];
    JIRA.Dashboard.Templates.directoryItem({item: itemData60}, output);
  }
  JIRA.Dashboard.Templates.noResultsPage(null, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.directoryItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var localityLabel__soy66 = opt_data.item.isLocal ? "Local" : "External";
  output.append('<div class="aui-group item-group" data-item-url="', soy.$$escapeHtml(opt_data.item.specUri), '" data-item-title="', soy.$$escapeHtml(opt_data.item.titleLabel), '">', (opt_data.item.thumbnailUri) ? '<div class="aui-item item-thumbnail"><img width="120" height="60" src="' + soy.$$escapeHtml(opt_data.item.thumbnailUri) + '"></img></div>' : '', '<div class="aui-item item-description"><h4>', soy.$$escapeHtml(opt_data.item.titleLabel), '</h4><p class="item-author">', soy.$$escapeHtml(opt_data.item.authorLineItem), '  &bull;  ', soy.$$escapeHtml(localityLabel__soy66), '</p><p>', soy.$$escapeHtml(opt_data.item.description), '</p><div class="aui-group"><textarea style="width: 350px; height: 50px; display: none;">', soy.$$escapeHtml(opt_data.item.specUriDisplay), '</textarea><a href="#" class="toggle-xml" data-purpose="toggle-xml">', soy.$$escapeHtml("Show XML link"), '</a></div></div><div class="aui-item item-actions"><button type="button" class="aui-button" data-purpose="add-dashboard-item" data-item-url="', soy.$$escapeHtml(opt_data.item.specUri), '">', soy.$$escapeHtml("Add gadget"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.directoryMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.payload.directoryIsVisible && opt_data.payload.hasUnrenderedData) {
    JIRA.Dashboard.Templates.moreDataMessage(null, output);
  }
  if (opt_data.payload.retrievalInProgress) {
    JIRA.Dashboard.Templates.inProgressMessage(null, output);
  } else {
    if (opt_data.payload.retrievalFailed) {
      JIRA.Dashboard.Templates.retrievalFailedMessage(null, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.inProgressMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({id: 'in-progress-message', titleContent: "Not all gadgets have loaded", content: '<p>' + soy.$$escapeHtml("Were still trying to fetch all of the available gadgets.") + '</p>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.retrievalFailedMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.warning({id: 'failure-message', titleContent: "Some gadgets failed to load", content: '<p>' + soy.$$escapeHtml("We were unable to load all of the available gadgets.") + '</p><p><a href=\'#\' data-purpose=\'retry\'>' + soy.$$escapeHtml("Try again") + '</a></p>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.moreDataMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({id: 'more-data-message', titleContent: "More gadgets available", content: '<p>' + soy.$$escapeHtml("Additional gadgets have been found and can be loaded.") + '</p><p><a href=\'#\' data-purpose=\'load\'>' + soy.$$escapeHtml("Load all gadgets") + '</a></p>'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Dashboard.Templates.noResultsPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="message-panel" data-item-url="no-result"><p class="title" style="text-align: center;"><strong>', soy.$$escapeHtml("No results"), '</strong></p><p style="text-align: center;">', soy.$$escapeHtml("Try a different category or change your search"), '</p></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/json.js' */
if(!this.JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z"};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}})();;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/lib/effects.js' */
jQuery.effects||(function($){$.effects={};$.each(["backgroundColor","borderBottomColor","borderLeftColor","borderRightColor","borderTopColor","color","outlineColor"],function(i,attr){$.fx.step[attr]=function(fx){if(!fx.colorInit){fx.start=getColor(fx.elem,attr);fx.end=getRGB(fx.end);fx.colorInit=true}fx.elem.style[attr]="rgb("+Math.max(Math.min(parseInt((fx.pos*(fx.end[0]-fx.start[0]))+fx.start[0],10),255),0)+","+Math.max(Math.min(parseInt((fx.pos*(fx.end[1]-fx.start[1]))+fx.start[1],10),255),0)+","+Math.max(Math.min(parseInt((fx.pos*(fx.end[2]-fx.start[2]))+fx.start[2],10),255),0)+")"}});function getRGB(color){var result;if(color&&color.constructor==Array&&color.length==3){return color}if(result=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(color)){return[parseInt(result[1],10),parseInt(result[2],10),parseInt(result[3],10)]}if(result=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(color)){return[parseFloat(result[1])*2.55,parseFloat(result[2])*2.55,parseFloat(result[3])*2.55]}if(result=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(color)){return[parseInt(result[1],16),parseInt(result[2],16),parseInt(result[3],16)]}if(result=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(color)){return[parseInt(result[1]+result[1],16),parseInt(result[2]+result[2],16),parseInt(result[3]+result[3],16)]}if(result=/rgba\(0, 0, 0, 0\)/.exec(color)){return colors["transparent"]}return colors[$.trim(color).toLowerCase()]}function getColor(elem,attr){var color;do{color=$.curCSS(elem,attr);if(color!=""&&color!="transparent"||$.nodeName(elem,"body")){break}attr="backgroundColor"}while(elem=elem.parentNode);return getRGB(color)}var colors={aqua:[0,255,255],azure:[240,255,255],beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0],transparent:[255,255,255]};var classAnimationActions=["add","remove","toggle"],shorthandStyles={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};function getElementStyles(){var style=document.defaultView?document.defaultView.getComputedStyle(this,null):this.currentStyle,newStyle={},key,camelCase;if(style&&style.length&&style[0]&&style[style[0]]){var len=style.length;while(len--){key=style[len];if(typeof style[key]=="string"){camelCase=key.replace(/\-(\w)/g,function(all,letter){return letter.toUpperCase()});newStyle[camelCase]=style[key]}}}else{for(key in style){if(typeof style[key]==="string"){newStyle[key]=style[key]}}}return newStyle}function filterStyles(styles){var name,value;for(name in styles){value=styles[name];if(value==null||$.isFunction(value)||name in shorthandStyles||(/scrollbar/).test(name)||(!(/color/i).test(name)&&isNaN(parseFloat(value)))){delete styles[name]}}return styles}function styleDifference(oldStyle,newStyle){var diff={_:0},name;for(name in newStyle){if(oldStyle[name]!=newStyle[name]){diff[name]=newStyle[name]}}return diff}$.effects.animateClass=function(value,duration,easing,callback){if($.isFunction(easing)){callback=easing;easing=null}return this.each(function(){var that=$(this),originalStyleAttr=that.attr("style")||" ",originalStyle=filterStyles(getElementStyles.call(this)),newStyle,className=that.attr("className");$.each(classAnimationActions,function(i,action){if(value[action]){that[action+"Class"](value[action])}});newStyle=filterStyles(getElementStyles.call(this));that.attr("className",className);that.animate(styleDifference(originalStyle,newStyle),duration,easing,function(){$.each(classAnimationActions,function(i,action){if(value[action]){that[action+"Class"](value[action])}});if(typeof that.attr("style")=="object"){that.attr("style").cssText="";that.attr("style").cssText=originalStyleAttr}else{that.attr("style",originalStyleAttr)}if(callback){callback.apply(this,arguments)}})})};$.fn.extend({_addClass:$.fn.addClass,addClass:function(classNames,speed,easing,callback){return speed?$.effects.animateClass.apply(this,[{add:classNames},speed,easing,callback]):this._addClass(classNames)},_removeClass:$.fn.removeClass,removeClass:function(classNames,speed,easing,callback){return speed?$.effects.animateClass.apply(this,[{remove:classNames},speed,easing,callback]):this._removeClass(classNames)},_toggleClass:$.fn.toggleClass,toggleClass:function(classNames,force,speed,easing,callback){if(typeof force=="boolean"||force===undefined){if(!speed){return this._toggleClass(classNames,force)}else{return $.effects.animateClass.apply(this,[(force?{add:classNames}:{remove:classNames}),speed,easing,callback])}}else{return $.effects.animateClass.apply(this,[{toggle:classNames},force,speed,easing])}},switchClass:function(remove,add,speed,easing,callback){return $.effects.animateClass.apply(this,[{add:add,remove:remove},speed,easing,callback])}});$.extend($.effects,{version:"1.8rc3",save:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.data("ec.storage."+set[i],element[0].style[set[i]])}}},restore:function(element,set){for(var i=0;i<set.length;i++){if(set[i]!==null){element.css(set[i],element.data("ec.storage."+set[i]))}}},setMode:function(el,mode){if(mode=="toggle"){mode=el.is(":hidden")?"show":"hide"}return mode},getBaseline:function(origin,original){var y,x;switch(origin[0]){case"top":y=0;break;case"middle":y=0.5;break;case"bottom":y=1;break;default:y=origin[0]/original.height}switch(origin[1]){case"left":x=0;break;case"center":x=0.5;break;case"right":x=1;break;default:x=origin[1]/original.width}return{x:x,y:y}},createWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent()}var props={width:element.outerWidth(true),height:element.outerHeight(true),"float":element.css("float")},wrapper=$("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0});element.wrap(wrapper);wrapper=element.parent();if(element.css("position")=="static"){wrapper.css({position:"relative"});element.css({position:"relative"})}else{$.extend(props,{position:element.css("position"),zIndex:element.css("z-index")});$.each(["top","left","bottom","right"],function(i,pos){props[pos]=element.css(pos);if(isNaN(parseInt(props[pos],10))){props[pos]="auto"}});element.css({position:"relative",top:0,left:0})}return wrapper.css(props).show()},removeWrapper:function(element){if(element.parent().is(".ui-effects-wrapper")){return element.parent().replaceWith(element)}return element},setTransition:function(element,list,factor,value){value=value||{};$.each(list,function(i,x){unit=element.cssUnit(x);if(unit[0]>0){value[x]=unit[0]*factor+unit[1]}});return value}});function _normalizeArguments(effect,options,speed,callback){if(typeof effect=="object"){callback=options;speed=null;options=effect;effect=options.effect}if($.isFunction(options)){callback=options;speed=null;options={}}if(typeof options=="number"||$.fx.speeds[options]){callback=speed;speed=options;options={}}options=options||{};speed=speed||options.duration;speed=$.fx.off?0:typeof speed=="number"?speed:$.fx.speeds[speed]||$.fx.speeds._default;callback=callback||options.complete;return[effect,options,speed,callback]}$.fn.extend({effect:function(effect,options,speed,callback){var args=_normalizeArguments.apply(this,arguments),args2={options:args[1],duration:args[2],callback:args[3]},effectMethod=$.effects[effect];return effectMethod&&!$.fx.off?effectMethod.call(this,args2):this},_show:$.fn.show,show:function(speed){if(!speed||typeof speed=="number"||$.fx.speeds[speed]){return this._show.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args[1].mode="show";return this.effect.apply(this,args)}},_hide:$.fn.hide,hide:function(speed){if(!speed||typeof speed=="number"||$.fx.speeds[speed]){return this._hide.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args[1].mode="hide";return this.effect.apply(this,args)}},__toggle:$.fn.toggle,toggle:function(speed){if(!speed||typeof speed=="number"||$.fx.speeds[speed]||typeof speed=="boolean"||$.isFunction(speed)){return this.__toggle.apply(this,arguments)}else{var args=_normalizeArguments.apply(this,arguments);args[1].mode="toggle";return this.effect.apply(this,args)}},cssUnit:function(key){var style=this.css(key),val=[];$.each(["em","px","%","pt"],function(i,unit){if(style.indexOf(unit)>0){val=[parseFloat(style),unit]}});return val}});$.easing.jswing=$.easing.swing;$.extend($.easing,{def:"easeOutQuad",swing:function(x,t,b,c,d){return $.easing[$.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return -c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t+b}return -c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t+b}return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return -c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t+b}return -c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1){return c/2*t*t*t*t*t+b}return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return -c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return -c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0){return b}if(t==d){return b+c}if((t/=d/2)<1){return c/2*Math.pow(2,10*(t-1))+b}return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return -c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1){return -c/2*(Math.sqrt(1-t*t)-1)+b}return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return -(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d)==1){return b+c}if(!p){p=d*0.3}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0){return b}if((t/=d/2)==2){return b+c}if(!p){p=d*(0.3*1.5)}if(a<Math.abs(c)){a=c;var s=p/4}else{var s=p/(2*Math.PI)*Math.asin(c/a)}if(t<1){return -0.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b}return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*0.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined){s=1.70158}if((t/=d/2)<1){return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b}return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-$.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else{if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+0.75)+b}else{if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+0.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+0.984375)+b}}}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2){return $.easing.easeInBounce(x,t*2,0,c,d)*0.5+b}return $.easing.easeOutBounce(x,t*2-d,0,c,d)*0.5+c*0.5+b}})})(jQuery);;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/lib/ajs.clone.js' */
AJS.clone=function(o){function F(){}F.prototype=o;return new F()};;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/lib/ajs.parseUri.js' */
if(!console.error){console.log=console.warn=console.error=console.time=console.timeEnd=function(){}}AJS.parseUri=function(uri,strict){var unesc=window.decodeURIComponent||unescape;var esc=window.encodeURIComponent||escape;function parseUri(str){var o=parseUri.options,m=o.parser[o.strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[o.key[i]]=m[i]||""}uri[o.q.name]={};uri[o.key[12]].replace(o.q.parser,function($0,$1,$2){if($1){uri[o.q.name][unesc($1)]=unesc($2)}});return uri}parseUri.options={strictMode:!!strict,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};uri=parseUri(uri);uri.toString=function(){var params=[];AJS.$.each(uri.queryKey,function(name,value){params.push(esc(name)+"="+esc(value))});return uri.protocol+"://"+uri.authority+uri.path+"?"+params.join("&")+"#"+uri.anchor};return uri};;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/AG.DashboardManager.js' */
AG={};AG.DashboardManager=(function(){var dashboard,layouts=[],createMenu=function(json){var editButton;dashboard.contents.append(Gadgets.Templates.Dashboard.dashboardMenu(json));editButton=AJS.$("#layout-changer");editButton.click(function(e){e.preventDefault();AG.DashboardManager.editLayout()});AJS.$("#dashboard-tools-dropdown").dropDown("standard",{trigger:".aui-dd-link"})};return{getDashboard:function(){return dashboard},addLayout:function(descriptor){var layout=AG.LayoutManager(descriptor);layouts.push(layout);if(descriptor.active!==false){this.setLayout(layout)}layout.init()},showShims:function(){if(!AJS.$("body").hasClass("propagation-blocker")){AJS.$("body").addClass("propagation-blocker");this.getDashboard().shim.height(this.getDashboard().outerHeight())}},hideShims:function(){if(AJS.$("body").hasClass("propagation-blocker")){AJS.$("body").removeClass("propagation-blocker")}},doDiagnostics:function(){AJS.$.ajax({type:"post",url:AG.param.get("dashboardDiagnosticsUrl"),data:{uri:document.location.href},error:function(request){if(request.status==500){diagnosticsErrorDisplay(request)}},success:function(data){AJS.$("#diagnostic-warning").addClass("hidden")}});var diagnosticsErrorDisplay=function(request){var diagnosticsWarningDiv=AJS.$("#diagnostic-warning");diagnosticsWarningDiv.html(request.responseText);var learnMoreText="Click here to learn more";var diagnosticsContentDiv=AJS.$("#diagnostic-content",diagnosticsWarningDiv);var learnMoreLink=AJS.$("#learn-more-link",diagnosticsWarningDiv);var displayErrorLink=AJS.$("#display-error-link",diagnosticsWarningDiv);var stackTraceDiv=AJS.$("#error-stack-trace",diagnosticsWarningDiv);var closeWarning=function(){diagnosticsWarningDiv.slideUp();diagnosticsWarningDiv.addClass("hidden");AJS.$.ajax({type:"post",url:AG.param.get("dashboardDiagnosticsUrl"),data:{method:"delete"}})};var setToggleDetails=function(link,detailDiv){link.click(function(){if(link.text()=="Hide"){link.text(learnMoreText);detailDiv.slideUp();detailDiv.addClass("hidden")}else{detailDiv.removeClass("hidden");detailDiv.slideDown("slow");link.text("Hide")}})};setToggleDetails(learnMoreLink,diagnosticsContentDiv);setToggleDetails(displayErrorLink,stackTraceDiv);AJS.$("#diagnostic-warning .close").click(function(){closeWarning()});diagnosticsWarningDiv.removeClass("hidden")}},editLayout:function(){var layoutHtml,popup,layouts=[];AJS.$.each(AG.LayoutManager.layouts,function(){var layout=this,layoutAttrName=AG.LayoutManager.getLayoutAttrName(layout);layouts.push({layoutAttrName:layoutAttrName,layout:layout})});layoutHtml=Gadgets.Templates.Dashboard.layoutDialog({layouts:layouts,closeId:"dialog-close"});popup=AJS.popup(507,224,"layout-dialog");popup.element.html(layoutHtml).addClass(AG.LayoutManager.getLayoutAttrName(AG.DashboardManager.getLayout().getLayout())).addClass("aui-dialog");AJS.$("#dialog-close",popup.element).click(function(e){popup.hide();e.preventDefault()});AJS.$.each(AG.LayoutManager.layouts,function(){var layout=this,layoutAttrName=AG.LayoutManager.getLayoutAttrName(layout);AJS.$("#"+layoutAttrName).click(function(e){var activeLayout=AG.DashboardManager.getLayout();popup.element.removeClass(AG.LayoutManager.getLayoutAttrName(activeLayout.getLayout())).addClass(layoutAttrName);activeLayout.setLayout(layout);popup.hide();AG.Sortable.update();e.preventDefault()})});this.editLayout=(function(){popup.show();AJS.$(document).keyup(function(e){if(e.keyCode===27){popup.hide();AJS.$(document).unbind("keyup",arguments.callee);e.preventDefault()}});return arguments.callee}())},getLayout:function(){return this.activeLayout},markReadOnlyLayouts:function(){AJS.$.each(layouts,function(){if(!this.isWritable()){this.markReadOnlyLayout()}})},unmarkReadOnlyLayouts:function(){AJS.$.each(layouts,function(){if(!this.isWritable()){this.unmarkReadOnlyLayout()}})},setLayout:function(layout){this.activeLayout=layout;this.getDashboard().header.html(AJS.$("<h1></h1>").text(layout.getName()))},addGadget:function(gadget,column){this.activeLayout.addGadget(gadget,column)},setup:function(options){var that=this,securityTokenRefreshRate=AJS.parseUri(document.location.href).queryKey["__st_refresh"]||1000*60*12;console.debug=console.debug||function(){};AJS.$.aop.after({target:gadgets.IfrGadgetService.prototype,method:"setHeight"},function(){that.getLayout().onInit(function(){that.getLayout().refresh()})});AG.param.set(options.params);AJS.$(function(){AG.Sortable.init();dashboard=AJS.$("#dashboard");if(options.layouts.length>1){that.getDashboard().addClass("v-tabs");dashboard.tabContainer=AJS.$("<ul class='vertical tabs' />").appendTo(dashboard)}dashboard.contents=AJS.$("<div id='dashboard-content' />").appendTo(dashboard);if(options.menu.items&&options.menu.items.length>0){dashboard.menu=createMenu(options.menu);dashboard.header=dashboard.contents.find(".aui-page-header-main")}dashboard.shim=AJS.$('<div class="dashboard-shim"> </div>').appendTo(dashboard.contents);AJS.$.each(options.layouts,function(){that.addLayout(this)});dashboard.removeClass("initializing");function updateSecurityTokens(){var gadgetTokenFrames=new Array(),updateTokenParams={};console.debug("Updating all gadget security tokens");AJS.$.each(AG.DashboardManager.getLayout().getGadgets(),function(index){gadgetTokenFrames.push({gadget:this,iframeId:this.getElement().find("iframe.gadget-iframe").attr("id")});updateTokenParams["st."+index]=this.getSecurityToken()});if(!updateTokenParams["st.0"]){console.debug("No gadgets on dashboard, so there is no need to update security tokens.");return }AJS.$.ajax({type:"POST",url:AG.param.get("securityTokensUrl"),data:updateTokenParams,dataType:"json",success:function(newSecurityTokens){AJS.$.each(gadgetTokenFrames,function(index){this.gadget.setSecurityToken(newSecurityTokens["st."+index]);try{gadgets.rpc.call(this.iframeId,"update_security_token",null,this.gadget.getSecurityToken())}catch(e){console.debug("Unable to update the security token for gadget with iframe id "+this.iframeId+".  This likely means that the gadget does not use the "+"'auth-refresh' feature.  If the gadget uses gadgets.io.makeRequest after its"+"initial startup, it is a good idea to use the 'auth-refresh' feature "+"by adding <Optional feature='auth-refresh' /> to your gadget's "+"<ModulePrefs> section.  Otherwise, the gadget's security token could expire"+" and subsequent calls to gadgets.io.makeRequest will fail.")}});console.debug("Updating security tokens complete.")},error:function(request,textStatus){if(request.status!=200){console.debug("Failed to get new security tokens. Response was had a status of '"+request.status+"' saying '"+request.statusText+"'")}else{console.debug("There was an error processing the response. Error was '"+textStatus+"'")}}})}console.debug("Security tokens will be refreshed every "+securityTokenRefreshRate+"ms");window.setInterval(updateSecurityTokens,securityTokenRefreshRate);that.doDiagnostics()})}}}());(function(){var buffer;jQuery(AG).bind("AG.iframeResize",function(){if(buffer){clearTimeout(buffer)}buffer=window.setTimeout(function(){AG.DashboardManager.getLayout().refresh();buffer=null},100)})})();;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/AG.LayoutManager.js' */
(function(){if(typeof Object.create!=="function"){Object.create=function(o){function F(){}F.prototype=o;return new F()}}var LayoutManager={saveLayout:function(){var that=this;function getData(){return AJS.$.extend({layout:that.layout},AG.Sortable.serialize())}AJS.$.ajax({type:"post",url:AG.param.get("layoutAction"),contentType:"application/json",data:JSON.stringify(getData()),beforeSend:function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override","PUT")},success:function(){if(AJS.debug){console.log("AG.LayoutManager.saveLayout: Layout ("+that.layout+") saved successfully")}},error:function(request){if(request.status==403||request.status==401){alert("Sorry, you do not have permission to modify this Dashboard.  Your dashboard may be out of sync with the server: please reload the page.")}else{alert("Sorry, your changes to this Dashboard could not be saved. Your dashboard may be out of sync with the server: please reload the page.")}if(AJS.debug){console.log("AG.LayoutManager.saveLayout: Request failed! Printing response object...");console.log(request)}}})},getColumn:function(idx){var that=this,i=parseInt(idx,16);if(arguments.length){return that.columns}else{if(!isNaN(i)||!that.columns[i]){return that.columns.eq(i)}else{if(AJS.debug){console.error("AG.LayoutManager.getColumn: The column index you provided is invalid. "+"Expected a number in the range of 0-"+that.columns.length-1+" but recieved "+idx)}}}},setLayout:function(layout,save){layout=AJS.$.trim(layout);if(this.layout===layout){if(AJS.debug){console.warn("AG.LayoutManager.setLayout: Ignoring! The layout supplied is the same as the current "+"layout ("+layout+")")}return }if(AJS.$.inArray(layout,AG.LayoutManager.layouts)===-1){if(AJS.debug){console.error("AG.LayoutManager.setLayout: Invalid layout! Was given "+layout+", but expected "+"either of '"+AG.LayoutManager.layouts.toString()+"'")}}this.container.addClass("layout-"+layout.toLowerCase());if(!this.isWritable()){if(AJS.debug){console.log("AG.LayoutManager.setLayout: Can't manipulate layout. Layout is not writable")}return }if(this.layout){this.container.removeClass("layout-"+this.layout.toLowerCase())}AJS.$.each(this.gadgets,function(){var layoutRep=this.getElement().layoutRep,prevColumn=layoutRep.parent().prev();if(!layoutRep.is(":visible")){if(prevColumn.is(":visible")){prevColumn.append(layoutRep)}else{prevColumn.prev().append(layoutRep)}}});if(layout==="AB"||layout==="BA"||layout==="AA"){this.columns.eq(0).addClass("sortable");this.columns.eq(1).addClass("sortable");this.columns.eq(2).removeClass("sortable")}else{if(layout==="A"){this.columns.eq(0).addClass("sortable");this.columns.eq(1).removeClass("sortable");this.columns.eq(2).removeClass("sortable")}else{if(layout==="AAA"){this.columns.eq(0).addClass("sortable");this.columns.eq(1).addClass("sortable");this.columns.eq(2).addClass("sortable")}}}this.layout=layout;this.refresh();if(save!==false){this.saveLayout()}else{if(AJS.debug){console.log("AG.LayoutManager.setLayout: Layout successfully set to '"+this.layout+"'")}}},getGadgets:function(){return this.gadgets},removeGadget:function(gadget){var that=this;AJS.$.each(this.gadgets,function(idx){if(this===gadget){that.gadgets.splice(idx,1);return false}})},deactivate:function(){this.container.hide();AJS.$.each(this.gadgets,function(){if(this.getElement().layoutRep.css("display")==="list-item"){this.getElement().hide()}})},activate:function(){this.container.show();AJS.$.each(this.gadgets,function(){this.getElement().show()});this.refresh()},restoreDefaultView:function(){var that=this;AJS.$(".operations li",AG.DashboardManager.getDashboard()).toggleClass("hidden");this.container.removeClass("maximized");jQuery.each(this.getGadgets(),function(){if(that.getPublicInstance()!==this){this.getElement().show()}});this.refresh()},refresh:function(){var that=this,isIE6OrBelow=!!(AJS.$.browser.msie&&parseInt(jQuery.browser.version)<=6);function appendEmptyMsgElem(col,idx){var message=AJS.format("Drag your gadgets here or {0}add a new gadget.{1}","<a class='add-gadget-link' id='add-gadget-"+idx+"' href='#'>","</a>");return AJS.$("<li class='empty-text'>"+message+"</li>").appendTo(col)}function isCanvasMode(){return !!AJS.$(".layout.maximized").size()}if(!this.initialized&&!isCanvasMode()){return }if(!AG.DashboardManager.getDashboard().hasClass("dragging")){this.columns.css(isIE6OrBelow?"height":"minHeight","");this.columns.filter(":visible").each(function(idx){var column=AJS.$(this);if(AJS.$("li:visible:not(.empty-text)",column).length===0){column.addClass("empty");if(that.isWritable()){if(!this.msgElem){this.msgElem=appendEmptyMsgElem(column,idx)}else{if(this.msgElem){this.msgElem.show()}}}}else{if(column.hasClass("empty")){column.removeClass("empty");if(this.msgElem){this.msgElem.hide()}}}})}AJS.$("li.gadget",this.container).each(function(){this.getGadgetInstance().updatePosition()});if(!AG.DashboardManager.getDashboard().hasClass("dragging")){this.columns.each(function(){var column=AJS.$(this);column.css(isIE6OrBelow?"height":"minHeight",column.parent().height())})}},addGadget:function(gadget,column){var that=this,rpctoken;function hideGadget(){gadget.getElement().layoutRep.addClass("hidden");gadget.getElement().hide();gadget.getLayoutManager().refresh()}function showGadget(){delete gadget.hasBeenDropped;gadget.getElement().layoutRep.removeClass("hidden");gadget.getElement().show();gadget.getLayoutManager().refresh()}function validateAdd(numGadgets){if(parseInt(numGadgets)>=AG.param.get("maxGadgets")){showGadget();alert("Sorry, you have exceeded the maximum number of gadgets supported by your Dashboard.  You must remove some gadgets before proceeding.")}else{gadget.move(that.options.resourceUrl)}}function appendToColumn(){if(!that.initialized){that.columns.eq(column).append(gadget.getElement().layoutRep)}else{that.columns.eq(column).prepend(gadget.getElement().layoutRep)}}function isFromDifferentLayout(){return AJS.$.isFunction(gadget.getLayoutManager)}function ensureIframeDoesntCache(){AJS.$("iframe",gadget.getElement()).each(function(){this.src=this.src;this.contentWindow.location=this.src})}function raiseIframeAppendedEvent(){AJS.$("iframe",gadget.getElement()).each(function(idx,elem){AJS.$(document).trigger("iframeAppended",elem)})}if(!isFromDifferentLayout()){column=column||gadget.column||0;gadget=gadget.loaded?gadget:AG.Gadget.getNullGadgetRepresentation(gadget);rpctoken=Math.round(Math.random()*10000000);if(gadget.renderedGadgetUrl){if(gadget.renderedGadgetUrl.indexOf("#rpctoken")==-1){gadget.renderedGadgetUrl+="#rpctoken="+rpctoken}else{gadget.renderedGadgetUrl=gadget.renderedGadgetUrl.replace(/#rpctoken=\d*/,"#rpctoken="+rpctoken)}}gadget.layout=this.options;gadget=AG.Gadget(gadget);appendToColumn();AG.DashboardManager.getDashboard().contents.append(gadget.getElement());gadget.updatePosition();gadgets.rpc.setAuthToken(gadget.getElement().find("iframe").attr("id"),rpctoken);ensureIframeDoesntCache();AG.Sortable.update();raiseIframeAppendedEvent();gadget.onAfterRender()}else{hideGadget();AJS.$.get(this.options.resourceUrl+"/numGadgets",function(numGadgets){validateAdd(numGadgets)})}this.refresh();this.gadgets.push(gadget);return gadget},markReadOnlyLayout:function(){if(!this.isWritable()){this.tab.addClass("inactive")}},onInit:function(callback){if(!this.initialized){this.onInit.callbacks=this.onInit.callbacks||[];this.onInit.callbacks.push(callback)}else{callback()}},unmarkReadOnlyLayout:function(){if(!this.isWritable()&&this.tab.hasClass("inactive")){this.tab.removeClass("inactive")}},isWritable:function(){return this.options.writable},getPublicInstance:function(){var that=this;if(!this.publicInterface){this.publicInterface={unmarkReadOnlyLayout:function(){return that.unmarkReadOnlyLayout.apply(that,arguments)},restoreDefaultView:function(){return that.restoreDefaultView.apply(that,arguments)},markReadOnlyLayout:function(){return that.markReadOnlyLayout.apply(that,arguments)},isWritable:function(){return that.isWritable.apply(that,arguments)},activate:function(){return that.activate.apply(that,arguments)},deactivate:function(){return that.deactivate.apply(that,arguments)},getGadgets:function(){return that.getGadgets.apply(that,arguments)},getLayout:function(){return that.layout},getContainer:function(){return that.container},getColumn:function(){return that.columns},setLayout:function(){return that.setLayout.apply(that,arguments)},addGadget:function(){return that.addGadget.apply(that,arguments)},removeGadget:function(){return that.removeGadget.apply(that,arguments)},refresh:function(){return that.refresh.apply(that,arguments)},init:function(){return that.init.apply(that,arguments)},saveLayout:function(){return that.saveLayout.apply(that,arguments)},getId:function(){return that.options.id},getName:function(){return that.options.title},onInit:function(){return that.onInit.apply(that,arguments)}}}return this.publicInterface},init:function(){var that=this,canvasGadget;this.gadgets=[];this.options.gadgets=this.options.gadgets||[];function getCanvasGadgetRepresentation(gadgets){var canvasGadget;AJS.$.each(that.options.gadgets,function(){if(AG.Gadget.isCanvasView(this.id)){canvasGadget=this;return false}});return canvasGadget}function fitTab(label,capacity){var labelText=label.text();while(label.width()>=capacity&&labelText.length>=3){labelText=labelText.slice(0,labelText.length-1);label.text(labelText+"...")}}function appendTab(){var labelSpan=AJS.$("<span />").text(that.options.title).attr("title",that.options.title),labelStrong=AJS.$("<strong />").append(labelSpan),capacity;that.tab=AJS.$("<li />");if(that.options.uri){that.tab.append(AJS.$("<a href='"+that.options.uri+"' />").append(labelStrong))}else{that.tab.append(labelStrong);that.tab.addClass("active")}that.tab.get(0).getLayoutInstance=function(){return that.getPublicInstance()};that.tab.appendTo(AG.DashboardManager.getDashboard().tabContainer);capacity=AG.DashboardManager.getDashboard().tabContainer.innerWidth()-parseInt(labelStrong.css("padding-left"))-parseInt(labelStrong.css("padding-right"));fitTab(labelSpan,capacity);AJS.$("li:first",AG.DashboardManager.getDashboard().tabContainer).addClass("first");if(that.isWritable()&&that.options.active===false){AG.Sortable.addHotSpot(that.tab,function(gadget){that.addGadget(gadget)})}}function appendColumns(){that.container=AJS.$("<div class='layout' />").appendTo(AG.DashboardManager.getDashboard().contents);that.columns=AJS.$("<ul />").addClass("column first").add(AJS.$("<ul />").addClass("column second")).add(AJS.$("<ul />").addClass("column third")).appendTo(that.container)}function appendGadgets(){AJS.$.each(that.options.gadgets,function(){that.addGadget(this)})}function setInitialized(){that.initialized=true;if(that.onInit.callbacks){AJS.$.each(that.onInit.callbacks,function(){this()})}that.refresh()}if(AG.DashboardManager.getDashboard().tabContainer){appendTab()}if(this.options.active!==false){appendColumns();this.setLayout(this.options.layout,false);canvasGadget=getCanvasGadgetRepresentation(this.options.gadgets);if(canvasGadget){canvasGadget=this.addGadget(canvasGadget);canvasGadget.setView("canvas");canvasGadget.updatePosition();AJS.$.aop.after({target:canvasGadget,method:"setView"},function(){canvasGadget.remove();that.removeGadget(canvasGadget);appendGadgets();setInitialized()})}else{appendGadgets();setInitialized()}}}};AG.LayoutManager=function(options){var layoutManager=Object.create(LayoutManager);layoutManager.options=options;return layoutManager.getPublicInstance()};AG.LayoutManager.layouts=["A","AA","BA","AB","AAA"];AG.LayoutManager.getLayoutAttrName=function(layout){return"layout-"+layout.toLowerCase()}}());;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/AG.Gadget.js' */
(function(){function FauxList(listContainer){var that=this,ENTER_KEY=13;this.container=AJS.$(listContainer);this.values=AJS.$("input.list",this.container).hide().val().split("|");this.originalValues=this.values.join("|").split("|");this.container.append('<input class="add-to-list text med js" type="text" value="" />'+'<button class="submit-to-list js">'+AG.param.get("add")+"</button>");this.container.children(".submit-to-list").click(function(e){that.addToList();e.preventDefault()});AJS.$("input.add-to-list",this.container).keydown(function(e){if(e.keyCode==ENTER_KEY){that.addToList();e.preventDefault()}});AJS.$(".description",this.container).appendTo(this.container);this.create(this.values)}FauxList.prototype={reset:function(){this.create(this.originalValues)},create:function(values){var ul,listItem,that=this;if(values){AJS.$.each(values,function(){if(this==""){values.splice(values.indexOf(this),1)}});ul=AJS.$('<ul class="faux-list"></ul>');if(values.length>0){for(var i=0,ii=values.length;i<ii;i++){listItem=AJS.$('<li class="listvalue-'+i+'"><span>'+values[i]+'</span><a class="remove" href="#remove-from-list" title="'+"Remove from list."+'">x</a></li>');AJS.$("a",listItem).click(function(e){var removeValue=AJS.$(this).parent("li").attr("class").split("-")[1];values.splice(removeValue,1);if(values.length>0){that.create(values)}else{AJS.$("input.list",this.container).val("")}listItem.remove();e.preventDefault()});ul.append(listItem)}if(AJS.$("ul.faux-list",this.container).length==0){AJS.$("input.list",this.container).before(ul)}else{AJS.$("ul.faux-list",this.container).replaceWith(ul)}}else{AJS.$("ul.faux-list",this.container).remove()}AJS.$("input.list",this.container).val(values.join("|"));AG.DashboardManager.getLayout().refresh()}},addToList:function(){var newValue=AJS.$("input.add-to-list",this.container).val().replace(/\|+/g,"%7C");this.values.push(newValue);AJS.$("input.add-to-list",this.container).val("");this.create(this.values)}};var Gadget={draw:function(json){var that=this;function addRenderingData(args){function generateMenuItems(){var menu=[];function isEditable(){return !!(isWritable()&&args.hasNonHiddenUserPrefs)}function isWritable(){return args.layout.writable}function generateColorList(){var colorList=[];AJS.$.each(AG.Gadget.COLORS,function(){var color=AG.Gadget.getColorAttrName(this);colorList.push({styleClass:color,link:{href:"#",text:AG.param.get(color)}})});return{styleClass:"item-link gadget-colors",items:colorList}}if(isEditable()){menu.push({styleClass:"dropdown-item",link:{styleClass:"item-link edit",href:"#gadget-"+args.id+"-edit",text:AG.param.get("edit")}})}menu.push({styleClass:"dropdown-item",link:{styleClass:"item-link "+(args.minimized?"maximization":"minimization"),href:"#",text:args.minimized?AG.param.get("expand"):AG.param.get("minimize")}});if(isWritable()){menu.push(generateColorList());menu.push({styleClass:"dropdown-item",link:{styleClass:"item-link delete",href:"#",text:AG.param.get("remove")}})}return menu}return AJS.$.extend({menu:{trigger:{text:"Gadget menu",href:"#"},list:{items:generateMenuItems()}}},args)}function createElement(){json.minimized=that.minimized;json.view=that.view;var renderingData=addRenderingData(json);that.$=AJS.$(Gadgets.Templates.Dashboard.gadget(renderingData))}function setHeightFromCookie(){if(json){var height=AG.Cookie.read("gadget-"+json.id+"-fh",null);if(!isNaN(parseInt(height))){json=AJS.$.extend(json,{height:height})}}}function setElementShortcuts(){that.$.layoutRep=AJS.$("<li class='gadget' id='rep-"+json.id+"' />").height(that.$.height());that.$.layoutRep.get(0).getGadgetInstance=that.$.get(0).getGadgetInstance=function(){return that.getPublicInstance()}}function applyDropdownControls(){var ACTIVE_CLASS="dropdown-active",ddParent=AJS.$("li.aui-dd-parent",that.$);ddParent.mousedown(function(e){e.stopPropagation()});that.$.dropdown=ddParent.dropDown("standard",{selectionHandler:function(e){e.preventDefault()},item:"> li"})[0];that.$.dropdown.addCallback("show",function(){that.$.addClass(ACTIVE_CLASS);AG.DashboardManager.showShims()});that.$.dropdown.addCallback("hide",function(){that.$.removeClass(ACTIVE_CLASS);AG.DashboardManager.hideShims()});that.$.hover(function(){},function(){if(that.$.dropdown.$.is(":visible")){that.$.dropdown.hide()}})}function applyGadgetHoverControls(){var HOVER_CLASS="gadget-hover";that.$.hover(function(){AJS.$(".gadget-container",that.$).addClass(HOVER_CLASS)},function(){AJS.$(".gadget-container",that.$).removeClass(HOVER_CLASS)})}function applyColorControls(){AJS.$(".gadget-colors a",that.$).click(function(e){that.setColor(this.parentNode.className);e.preventDefault()})}function applyMinimizeControls(){var menuElem=AJS.$("a.minimization, a.maximization",that.$),titleElem=AJS.$(".dashboard-item-title",that.$),maxMinToggle=function(e){if(that.minimized){that.maximize()}else{that.minimize()}AJS.$(this).one(e.type,function(e){if(that.minimized){that.maximize()}else{that.minimize()}AJS.$(this).one(e.type,maxMinToggle)})};titleElem.one("dblclick",maxMinToggle);menuElem.one("click",maxMinToggle);if(AJS.$.browser.safari){titleElem.get(0).onselectstart=function(){return false}}}function applyFocusControls(){var column;AJS.$(".dashboard-item-header",that.$).mousedown(function(e){if(!that.$.hasClass("maximized")||AG.DashboardManager.getDashboard().hasClass("v-tabs")){if(!column){column=that.$.layoutRep.parent()}that.$.dropdown.hide();that.$.focusTimeout=setTimeout(function(){delete that.$.focusTimeout},150);e.target=that.$.layoutRep[0];that.$.layoutRep.trigger(e)}});that.$.mouseup(function(){if(that.$.focusTimeout){clearTimeout(that.$.focusTimeout)}else{if(that.$.layoutRep.is(":visible")){that.$.stop(true,true)}}})}function applyUserPrefControls(){var fauxLists=[],prefForm=AJS.$(".userpref-form",that.$),prefsChanged=false,savePrefForm=function(success){var formArray=prefForm.serializeArray(),submittedState={};AJS.$.each(formArray,function(){submittedState[this.name]=this.value||""});AJS.$(":checkbox:not(:checked)",prefForm).each(function(){submittedState[this.name]=false});AJS.$.ajax({url:prefForm.attr("action"),type:"POST",contentType:"application/json",data:JSON.stringify(submittedState),beforeSend:function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override","PUT")},dataType:"text",success:success})};if(that.isEditable()){AJS.$(".list-container",that.$).each(function(){fauxLists.push(new FauxList(this))});AJS.$(".edit",that.$).click(function(e){if(!prefForm.is(":visible")){if(that.minimized){that.maximize()}prefForm.show();AJS.$(".field-group :input:first",prefForm).focus();that.getLayoutManager().refresh()}else{prefForm.hide();that.getLayoutManager().refresh()}e.preventDefault()});prefForm.submit(function(e){savePrefForm(function(){window.location.reload()});e.preventDefault()});AJS.$(":reset",prefForm).click(function(){AJS.$.each(fauxLists,function(){this.reset()});prefForm.hide();that.getLayoutManager().refresh()})}AJS.$("iframe.gadget-iframe",that.$).bind("setUserPref",function(e){for(var i=1,j=arguments.length;i<j;i+=2){if(pref_name=arguments[i]){var pref_value=arguments[i+1];var input=AJS.$(":input[name='up_"+pref_name+"']",prefForm);if(input.attr("type")=="checkbox"){input.attr("checked",pref_value)}else{input.val(pref_value)}}}if(!prefsChanged){setTimeout(function(){savePrefForm(function(){});prefsChanged=false},100);prefsChanged=true}})}function applyDeleteControls(){AJS.$("a.delete",that.$).bind("click",function(e){that.destroy();e.preventDefault()})}function applyViewToggleControls(){AJS.$("a.maximize",that.$).click(function(e){if(!AG.Gadget.isCanvasView(that.id)){that.getPublicInstance().setView("canvas");e.preventDefault()}else{that.getPublicInstance().setView("default");e.preventDefault()}})}function applyErrorMessage(){AJS.$("iframe.gadget-iframe",that.$).load(function(){AJS.$("#error-gadget-message",AJS.$(this).contents()).html(that.errorMessage)})}setHeightFromCookie();createElement();setElementShortcuts();applyDropdownControls();applyGadgetHoverControls();applyMinimizeControls();if(this.isMaximizable){applyViewToggleControls()}if(!this.loaded){applyErrorMessage()}if(this.getLayoutManager().isWritable()){applyDeleteControls();applyFocusControls();applyColorControls();applyUserPrefControls()}},isEditable:function(){if(this.configurable){return this.getLayoutManager().isWritable()}else{return !!(this.getLayoutManager().isWritable()&&this.hasNonHiddenUserPrefs)}},setLayoutManager:function(layoutManager){if(layoutManager){this.layoutManager=layoutManager}else{this.layoutManager=AG.DashboardManager.getLayout()}},getLayoutManager:function(){if(!this.layoutManager){this.setLayoutManager()}return this.layoutManager},setColor:function(color){var that=this;that.$.removeClass(that.color).addClass(color);that.color=color;AJS.$.ajax({type:"post",url:that.colorUrl,contentType:"application/json",data:JSON.stringify({color:color}),beforeSend:function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override","PUT")},error:function(request){if(request.status==403||request.status==401){alert("Sorry, you do not have permission to modify this Dashboard.  Your dashboard may be out of sync with the server: please reload the page.")}else{alert("Sorry, your changes to this Dashboard could not be saved. Your dashboard may be out of sync with the server: please reload the page.")}}})},updatePosition:function(){var gadgetCSSToUpdate,layoutCSSToUpdate,that=this;function isGadgetBeingDragged(){return that.$.hasClass("dragging")}function getCurrentGadgetCSS(){var LAYOUT_REP_OFFSET,dashboard=AG.DashboardManager.getDashboard().contents,DASHBOARD_OFFSET=dashboard.offset();if(!getCurrentGadgetCSS.cache){LAYOUT_REP_OFFSET=that.$.layoutRep.offset();getCurrentGadgetCSS.cache={left:(LAYOUT_REP_OFFSET.left-DASHBOARD_OFFSET.left)/dashboard.width()*100+"%",top:LAYOUT_REP_OFFSET.top-DASHBOARD_OFFSET.top,width:that.$.layoutRep.width()/dashboard.width()*100+"%"}}return getCurrentGadgetCSS.cache}function getCurrentLayoutRepCSS(){if(!getCurrentLayoutRepCSS.cache){getCurrentLayoutRepCSS.cache={height:that.$.height()}}return getCurrentLayoutRepCSS.cache}function filterModifiedCSS(lastRecordedCSS,currentCSS){if(lastRecordedCSS){AJS.$.each(lastRecordedCSS,function(property){if(this===currentCSS[property]){delete currentCSS[property]}})}return currentCSS}if(!isGadgetBeingDragged()){layoutCSSToUpdate=filterModifiedCSS(this.$.layoutRep.lastRecordedCSS,getCurrentLayoutRepCSS());this.$.layoutRep.css(layoutCSSToUpdate);this.$.layoutRep.lastRecordedCSS=layoutCSSToUpdate;gadgetCSSToUpdate=filterModifiedCSS(this.$.lastRecordedCSS,getCurrentGadgetCSS());this.$.css(gadgetCSSToUpdate);this.$.lastRecordedCSS=gadgetCSSToUpdate;if(this.$.hasClass("hidden")){this.$.removeClass("hidden")}}},maximize:function(){var MIN_CLASS="minimization",MAX_CLASS="maximization",MIN_TEXT=AG.param.get("minimize"),menuElem=AJS.$("a.minimization, a.maximization",this.$);menuElem.removeClass(MAX_CLASS).addClass(MIN_CLASS).text(MIN_TEXT);this.$.css({height:"auto"});AJS.$(".dashboard-item-content",this.$).removeClass(MIN_CLASS);this.getLayoutManager().refresh();AG.Cookie.erase(this.COOKIE_MINIMIZE);if(this.minimized){this.moduleAPI.trigger("expand")}this.minimized=false},minimize:function(){var MIN_CLASS="minimization",MAX_CLASS="maximization",MAX_TEXT=AG.param.get("expand"),menuElem=AJS.$("a.minimization, a.maximization",this.$);menuElem.removeClass(MIN_CLASS).addClass(MAX_CLASS).text(MAX_TEXT);this.$.css({height:"auto"});AJS.$(".dashboard-item-content",this.$).addClass(MIN_CLASS);this.getLayoutManager().refresh();AG.Cookie.save(this.COOKIE_MINIMIZE,"true");this.minimized=true;this.moduleAPI.trigger("minimize")},remove:function(){var that=this;that.$.layoutRep.remove();that.$.remove();this.moduleAPI.trigger("remove");that.getLayoutManager().removeGadget(that.getPublicInstance());that.getLayoutManager().refresh();AJS.$.each(this,function(name,property){property=null});AG.Cookie.erase("gadget-"+that.id+"-fh")},move:function(targetResourceUrl){this.remove();AJS.$(AJS.$.ajax({type:"post",data:{id:this.id,title:this.title,titleUrl:this.titleUrl,gadgetSpecUrl:this.gadgetSpecUrl,height:this.$.height(),width:this.$.width(),color:this.color,isMaximizable:this.isMaximizable,userPrefs:this.userPrefs,renderedGadgetUrl:this.renderedGadgetUrl,colorUrl:this.colorUrl,gadgetUrl:this.gadgetUrl,hasNonHiddenUserPrefs:this.hasNonHiddenUserPrefs,column:this.column,loaded:this.loaded},contentType:"application/json",url:targetResourceUrl+"/gadget/"+this.id,beforeSend:function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override","PUT")}})).throbber({target:AJS.$("#dash-throbber")})},destroy:function(){var that=this;if(confirm(AJS.format("Are you sure you want to permanently remove the {0} gadget?",that.title))){AJS.$("#dash-throbber").addClass("loading");AJS.$.ajax({type:"POST",url:this.gadgetUrl,beforeSend:function(xhr){xhr.setRequestHeader("X-HTTP-Method-Override","DELETE")},complete:function(){AJS.$("#dash-throbber").removeClass("loading")},success:function(){that.$.fadeOut(function(){that.remove();if(that.view==="canvas"){that.getLayoutManager().restoreDefaultView()}})},error:function(request){if(request.status==403||request.status==401){alert("Sorry, you do not have permission to modify this Dashboard.  Your dashboard may be out of sync with the server: please reload the page.")}else{alert("Sorry, your changes to this Dashboard could not be saved. Your dashboard may be out of sync with the server: please reload the page.")}}})}},setView:function(view){var MAXIMIZED_CLASS="maximized",uri={},that=this,anchor=this.title.replace(/\s/g,"-")+"/"+this.id,layoutManager=this.getLayoutManager(),rpctoken;function toDefaultViewHandler(){that.getPublicInstance().setView("default")}if(this.view===view){return }if(view==="canvas"||view==="default"){if(this.gadgetUrl){AJS.$.ajax({async:false,type:"GET",url:this.gadgetUrl,dataType:"json",success:function(rep){rpctoken=Math.round(Math.random()*10000000);uri=AJS.parseUri(rep.renderedGadgetUrl+"#rpctoken="+rpctoken)}})}gadgets.rpc.setAuthToken(AJS.$("iframe.gadget-iframe",this.$).attr("id"),rpctoken);if(view==="canvas"){AJS.$(".operations li",AG.DashboardManager.getDashboard()).toggleClass("hidden");AJS.$.extend(uri.queryKey,{view:"canvas"});AJS.$("iframe.gadget-iframe",this.$).attr("src",uri.toString());layoutManager.getContainer().addClass(MAXIMIZED_CLASS);AJS.$(".gadget-container",this.$).addClass(MAXIMIZED_CLASS);this.$.addClass(MAXIMIZED_CLASS);AJS.$(".aui-icon",this.$).attr("title","Restore");this.$.layoutRep.addClass(MAXIMIZED_CLASS);this.$.layoutRep.parent().addClass(MAXIMIZED_CLASS);AJS.$.each(this.getLayoutManager().getGadgets(),function(){if(that.getPublicInstance()!==this){this.getElement().hide()}});AJS.$.extend(uri.queryKey,{view:"canvas"});AJS.$("iframe.gadget-iframe",this.$).attr("src",uri.toString());this.maximize();window.location.href=window.location.href.replace(/#.*/,"")+"#"+anchor;AJS.$(".minimize",AG.DashboardManager.getDashboard()).click(toDefaultViewHandler);this.view="canvas";this.moduleAPI.trigger("maximize")}else{AJS.$(".gadget-container",this.$).removeClass(MAXIMIZED_CLASS);this.$.removeClass(MAXIMIZED_CLASS);AJS.$(".aui-icon",this.$).attr("title","Maximize");this.$.layoutRep.removeClass(MAXIMIZED_CLASS);this.$.layoutRep.parent().removeClass(MAXIMIZED_CLASS);this.getLayoutManager().restoreDefaultView();AJS.$.extend(uri.queryKey,{view:"default"});AJS.$("iframe.gadget-iframe",this.$).attr("src",uri.toString());this.getLayoutManager().refresh();window.location.href=window.location.href.replace(anchor,"");AJS.$("a.minimize",AG.DashboardManager.getDashboard()).unbind("click",toDefaultViewHandler);this.view="default";this.moduleAPI.trigger("restore")}}else{if(AJS.debug){console.warn("AG.Gadget.setView: Ignored! not a valid view. Was supplied '"+view+"' but expected "+"either 'default' or 'canvas'")}}},editPrefs:function(){},getPublicInstance:function(){var gadget=this;if(!this.publicInterface){this.publicInterface={updatePosition:function(){return gadget.updatePosition.apply(gadget,arguments)},getLayoutManager:function(){return gadget.getLayoutManager.apply(gadget,arguments)},setLayoutManager:function(){return gadget.setLayoutManager.apply(gadget,arguments)},getElement:function(){return gadget.$},move:function(targetUrl){return gadget.move(targetUrl)},remove:function(){return gadget.remove.apply(gadget,arguments)},getId:function(){return gadget.id},showShim:function(){return gadget.showShim.apply(gadget,arguments)},hideShim:function(){return gadget.hideShim.apply(gadget,arguments)},minimize:function(){return gadget.minimize.apply(gadget,arguments)},maximize:function(){return gadget.minimize.apply(gadget,arguments)},getSecurityToken:function(){return gadget.securityToken},setSecurityToken:function(securityToken){gadget.securityToken=securityToken},onDragStart:function(){gadget.moduleAPI.trigger("dragStart")},onDragStop:function(){gadget.moduleAPI.trigger("dragStop")},onAfterRender:function(){gadget.moduleAPI.trigger("afterRender")}};if(this.isMaximizable){this.publicInterface.setView=function(){return gadget.setView.apply(gadget,arguments)}}}return this.publicInterface},init:function(options){var gadget=this;this.COOKIE_MINIMIZE=options.id+":minimized";this.minimized=AG.Cookie.read(this.COOKIE_MINIMIZE)==="true";this.title=options.title;this.color=options.color;this.colorUrl=options.colorUrl;this.gadgetUrl=options.gadgetUrl;this.id=options.id;this.hasNonHiddenUserPrefs=options.hasNonHiddenUserPrefs;this.isMaximizable=options.isMaximizable;this.titleUrl=options.titleUrl;this.gadgetSpecUrl=options.gadgetSpecUrl;this.userPrefs=options.userPrefs;this.renderedGadgetUrl=options.renderedGadgetUrl;this.column=options.column;this.loaded=options.loaded;this.errorMessage=options.errorMessage;this.inlineHtml=options.inlineHtml;this.configurable=options.configurable;this.amdModule=options.amdModule;this.securityToken=AJS.parseUri(options.renderedGadgetUrl).queryKey["st"];this.draw(options);this.moduleAPI=new AG.InlineGadgetAPI(this);if(this.amdModule){var Module=require(this.amdModule);if(Module){var extractUserPreferences=function(userPreferences){var preferences={};_.each(userPreferences,function(preference){var parsedValue;if(preference.value==="true"||preference.value==="false"){parsedValue=preference.value==="true"}else{parsedValue=preference.value}preferences[preference.name]=parsedValue});return preferences};var safeRender=function(cb){try{cb()}catch(err){var errorContainer=AJS.$('<div class="item-error"/>').append(aui.message.error({content:"<p>"+"Unknown error occurred rendering this gadget."+"</p>"}));gadgetElement.append(errorContainer);console.error("Error rendering gadget with id '"+gadget.id+"': "+err.message,err);gadget.moduleAPI.hideLoadingBar()}};var userPreferences=extractUserPreferences(options.userPrefs.fields);var moduleInstance=new Module(this.moduleAPI);var gadgetElement=this.$.find("#gadget-"+this.id);if(this.isEditable()){var dropdown=this.getPublicInstance().getElement().dropdown;var configureLink=AJS.$('<li class="dropdown-item configure"><a class="item-link no_target" href="#">'+"Edit"+"</a></li>");configureLink.on("click",function(){safeRender(function(){moduleInstance.renderEdit(gadgetElement,userPreferences);gadget.moduleAPI.trigger("afterRender")})});configureLink.appendTo(dropdown.$);dropdown.reset()}if(this.isEditable()&&!userPreferences.isConfigured){safeRender(function(){moduleInstance.renderEdit(gadgetElement,userPreferences)})}else{safeRender(function(){moduleInstance.render(gadgetElement,userPreferences)})}this.moduleAPI.on("preferencesSaved",function(prefs){userPreferences=extractUserPreferences(prefs);safeRender(function(){moduleInstance.render(gadgetElement,userPreferences);gadget.moduleAPI.trigger("afterRender")})});this.moduleAPI.on("close-edit",function(){safeRender(function(){moduleInstance.render(gadgetElement,userPreferences);gadget.moduleAPI.trigger("afterRender")})});this.moduleAPI.on("force-layout-refresh",_.bind(function(){this.getLayoutManager().refresh()},this))}}}};AG.Gadget=function(options){var gadget=AJS.clone(Gadget);gadget.init(options);return gadget.getPublicInstance()};AG.Gadget.COLORS=[1,2,3,4,5,6,7,8];AG.Gadget.getColorAttrName=function(color){return"color"+color};AG.Gadget.isCanvasView=function(gadgetId){var uri=AJS.parseUri(window.location.href);return new RegExp(gadgetId).test(uri.anchor)};AG.Gadget.getNullGadgetRepresentation=function(errorGadget){return AJS.$.extend(errorGadget,{title:"Gadget Error",renderedGadgetUrl:AG.param.get("errorGadgetUrl"),color:errorGadget.color||"color7"})}})();;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/AG.Param.js' */
if(typeof AG==="undefined"){var AG={}}if(!console.warn){console.warn=function(){}}AG.param=(function(){var strs={};return{get:function(key){var args=arguments;if(strs[key]){if(arguments.length>1){args[0]=strs[key];return AJS.format.apply(this,args)}else{return strs[key]}}else{if(AJS.debug){console.warn("param.get: Key '"+key+"' does not exist.")}return null}},set:function(key,str){var setParam=function(){var k=arguments[0];var v=arguments[1];if(typeof k==="string"){strs[k]=v}else{if(AJS.debug){console.warn("param.set: Ignored param.set, key may be undefined. "+"Printing value...");console.log(k)}}};if(arguments.length===1&&typeof arguments[0]==="object"){AJS.$.each(arguments[0],function(key,str){setParam(key,str)})}else{if(arguments.length===2){setParam(arguments[0],arguments[1])}else{if(AJS.debug){console.warn("param.set: Expected arguments to be of length 1 or 2, however recieved a length of "+arguments.length+". Printing value...");console.log(arguments)}}}},clear:function(){if(AJS.debug){strs={}}}}}());;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/AG.Cookie.js' */
(function(){var COOKIE_NAME="AG.congolmerate.cookie";function getValueFromCongolmerate(name,cookieValue){if(cookieValue==null){cookieValue=""}var eq=name+"=";var cookieParts=cookieValue.split("|");for(var i=0;i<cookieParts.length;i++){var cp=cookieParts[i];while(cp.charAt(0)==" "){cp=cp.substring(1,cp.length)}if(cp.indexOf(name)==0){return cp.substring(eq.length,cp.length)}}return null}function addOrAppendToValue(name,value,cookieValue){var newCookieValue="";if(cookieValue==null){cookieValue=""}var cookieParts=cookieValue.split("|");for(var i=0;i<cookieParts.length;i++){var cp=cookieParts[i];if(cp!=""){while(cp.charAt(0)==" "){cp=cp.substring(1,cp.length)}if(cp.indexOf(name)!=0){newCookieValue+=cp+"|"}}}if(value!=null&&value!=""){var pair=name+"="+value;if((newCookieValue.length+pair.length)<4020){newCookieValue+=pair}}return newCookieValue}function getCookieValue(name){var eq=name+"=",ca=document.cookie.split(";");for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==" "){c=c.substring(1,c.length)}if(c.indexOf(eq)==0){return c.substring(eq.length,c.length)}}return null}function saveCookie(name,value,days){var ex;if(days){var d=new Date();d.setTime(d.getTime()+(days*24*60*60*1000));ex="; expires="+d.toGMTString()}else{ex=""}document.cookie=name+"="+value+ex+";path=/"}AG.Cookie={save:function(name,value){var cookieValue;if(window.localStorage){cookieValue=localStorage.getItem(COOKIE_NAME)}else{cookieValue=getCookieValue(COOKIE_NAME)}cookieValue=addOrAppendToValue(name,value,cookieValue);if(window.localStorage){localStorage.setItem(COOKIE_NAME,cookieValue)}else{saveCookie(COOKIE_NAME,cookieValue,365)}},read:function(name,defaultValue){var cookieValue,value;if(window.localStorage){cookieValue=localStorage.getItem(COOKIE_NAME)}else{cookieValue=getCookieValue(COOKIE_NAME)}value=getValueFromCongolmerate(name,cookieValue);if(value!=null){return value}return defaultValue},erase:function(name){this.save(name,"")}}})();;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/AG.Sortable.js' */
AG.Sortable=function(){var sortableControl,dragGadget,hotspots=[],options={cursor:"move",items:"li.gadget",tolerance:"pointer",placeholder:"placeholder",forcePointerForContainers:true,scroll:true,revert:AJS.$.browser.safari?false:250,scrollSensitivity:300,scrollSpeed:16,zIndex:10,helper:function(event,item){return item.get(0).getGadgetInstance().getElement()},change:function(){AG.DashboardManager.getLayout().refresh()},start:function(event,obj){dragGadget=obj.item.get(0).getGadgetInstance();function preventTextSelection(){if(typeof document.onselectstart!=="undefined"){document.onselectstart=function(){return false}}}function preventHelperRemovalOnDrop(){obj.item.removeValidator=AJS.$.aop.around({target:AJS.$,method:"remove"},function(invocation){if(obj.helper!==this){invocation.proceed()}})}function setPlaceholder(){obj.placeholder.height(obj.helper.outerHeight()-2).html("<p>"+"Drag your gadget here."+"</p>")}obj.helper.addClass("dragging");preventTextSelection();preventHelperRemovalOnDrop();setPlaceholder();AG.DashboardManager.getLayout().refresh();AG.DashboardManager.getDashboard().addClass("dragging");AG.DashboardManager.showShims();AG.DashboardManager.markReadOnlyLayouts();dragGadget.onDragStart()},stop:function(event,obj){var gadgetElement=dragGadget.getElement();function enableTextSelection(){if(typeof document.onselectstart!=="undefined"){document.onselectstart=null}}gadgetElement.layoutRep.css({display:""});gadgetElement.css({height:"auto"}).removeClass("dragging");if(!dragGadget.hasBeenDropped){AG.DashboardManager.getLayout().saveLayout()}else{sortableControl.sortable("option","revert",250)}enableTextSelection();obj.item.removeValidator[0].unweave();AG.DashboardManager.getDashboard().removeClass("dragging");AG.DashboardManager.hideShims();AG.DashboardManager.getLayout().refresh();AG.DashboardManager.unmarkReadOnlyLayouts();dragGadget.onDragStop()}};return{serialize:function(){var params={};AJS.$.each(this.columns.filter(":visible"),function(i){params[i]=[];AJS.$.each(AJS.$(this).sortable("toArray"),function(){params[i].push(AJS.$("#"+this).get(0).getGadgetInstance().getId())})});return params},addHotSpot:function(elem,callback){var offset=elem.offset(),dashboardOffset=AG.DashboardManager.getDashboard().offset();hotspots.push(AJS.$("<div class='hotspot-shim hidden' />").hover(function(){dragGadget.getElement().css({opacity:0.5});elem.addClass("hover")},function(){dragGadget.getElement().css({opacity:""});elem.removeClass("hover")}).mouseup(function(){sortableControl.sortable("option","revert",false);dragGadget.hasBeenDropped=true;callback(dragGadget)}).css({height:elem.outerHeight(),width:elem.outerWidth(),left:offset.left-dashboardOffset.left,top:offset.top-dashboardOffset.top}).appendTo(AG.DashboardManager.getDashboard()))},update:function(){AG.Sortable.init()},init:function(){if(sortableControl){sortableControl.sortable("destroy")}this.columns=AJS.$(".draggable .column.sortable");if(this.columns.length>0){sortableControl=this.columns.sortable(AJS.$.extend(options,{connectWith:this.columns}))}}}}();;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/api/AG.InlineGadgetAPI.js' */
(function(){var API=function(gadget){this.gadget=gadget};_.extend(API.prototype,Backbone.Events,{isEditable:function(){return this.gadget.isEditable()},_preparePreferencesToBeSaved:function(preferences){var userPreferences={};userPreferences["up_isConfigured"]=true;_.each(preferences,function(value,name){userPreferences["up_"+name]=String(value)});return userPreferences},getRefreshFieldValue:function(fieldName){fieldName=fieldName||"refresh";var input=this.gadget.$.find("input[name="+fieldName+"]");return input.is(":checked")?input.val():"false"},savePreferences:function(preferences){if(!this.isEditable()){this.trigger("error:preferencesSaved");return }return AJS.$.ajax({url:this.gadget.userPrefs.action,type:"PUT",contentType:"application/json",data:JSON.stringify(this._preparePreferencesToBeSaved(preferences))}).done(_.bind(function(){AJS.$.ajax({url:this.gadget.userPrefs.action,type:"GET",dataType:"json"}).done(_.bind(function(results){this.trigger("preferencesSaved",results.fields)},this)).fail(_.bind(function(){this.trigger("error:preferencesSaved")},this))},this)).fail(_.bind(function(){this.trigger("error:preferencesSaved")},this))},setTitle:function(title){if(!this.gadget.$){return }this.gadget.$.find(".dashboard-item-title").text(title)},initRefresh:function(preferences,cb){if(this.gadget.refreshIntervalId){clearInterval(this.gadget.refreshIntervalId)}if(!isNaN(parseInt(preferences.refresh))){var refreshIntervalMillis=parseInt(preferences.refresh)*60000;this.gadget.refreshIntervalId=setInterval(cb,refreshIntervalMillis)}},showLoadingBar:function(){if(!this.gadget.$){return }var self=this;if(!this.gadget.showLoadingBarTimeoutId){this.gadget.showLoadingBarTimeoutId=setTimeout(function(){var $gadgetContainer=self.gadget.$.find("#gadget-"+self.gadget.id);var cls=$gadgetContainer.width()<250?"loading-small":"loading";self.$loadingBar=AJS.$('<div class="'+cls+'"></div>');self.$loadingBar.height(Math.max(40,$gadgetContainer.height()));$gadgetContainer.after(self.$loadingBar);$gadgetContainer.addClass("hidden");self.forceLayoutRefresh()},1000)}},hideLoadingBar:function(){if(this.gadget.showLoadingBarTimeoutId){clearTimeout(this.gadget.showLoadingBarTimeoutId);delete this.gadget.showLoadingBarTimeoutId}if(!this.$loadingBar){return }if(!this.gadget.$){return }this.$loadingBar.detach();this.$loadingBar=null;this.gadget.$.find("#gadget-"+this.gadget.id).removeClass("hidden");this.forceLayoutRefresh()},closeEdit:function(){this.trigger("close-edit")},forceLayoutRefresh:function(){this.trigger("force-layout-refresh")},getGadgetId:function(){return this.gadget.id}});AG=window.AG||{};AG.InlineGadgetAPI=API})();;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/dashboard-service.js' */
AJS.namespace("JIRA.Dashboard.DashboardService");JIRA.Dashboard.DashboardService={addItem:function(itemUrl,callback){if(AG.DashboardManager.getLayout().getGadgets().length>=AG.param.get("maxGadgets")){callback.onError("Sorry, you have exceeded the maximum number of gadgets supported by your Dashboard.  You must remove some gadgets before proceeding.");return }var dashboardResourceUrl=AG.param.get("dashboardResourceUrl");var localeLang=AJS.$(".locale-lang","#i18n-settings").val();var localeCountry=AJS.$(".locale-country","#i18n-settings").val();AJS.$.ajax({type:"POST",url:dashboardResourceUrl+".json?"+(localeLang?"locale.lang="+localeLang:"")+(localeCountry?"&locale.country="+localeCountry:""),contentType:"application/json",dataType:"json",data:JSON.stringify({url:itemUrl,columnIndex:AJS.activeColumn}),processData:false,success:function(data){AG.Cookie.erase("gadget-"+data.id+"-fh");AG.DashboardManager.addGadget(data,AJS.activeColumn);callback.onSuccess()},error:function(request,textStatus,errorThrown){console.error("DashboardService: Failed to add item to the dashboard. Reason: "+errorThrown);callback.onError()}})}};;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/entities/dashboard-item-retriever.js' */
AJS.namespace("JIRA.Dashboard.Services");JIRA.Dashboard.Services.ItemRetriever=function(){this.inProgressUrls=[];this.retrievedUrls=[];this.failedUrls=[]};JIRA.Dashboard.Services.ItemRetriever.prototype=_.extend({retrieve:function(endpointUrls){this.trigger("batchRetrieving");_.each(endpointUrls,retrieveFromUrl,this);function retrieveFromUrl(endpointUrl){this.inProgressUrls.push(endpointUrl);this.trigger("retrieving");AJS.$.ajax({type:"GET",dataType:"json",global:false,cache:false,url:endpointUrl,context:this,success:function(data){this.inProgressUrls=_.reject(this.inProgressUrls,function(url){return url===endpointUrl});this.retrievedUrls.push(endpointUrl);this.trigger("retrieve",data);this.checkForCompletion()},error:function(request,textStatus,errorThrown){this.inProgressUrls=_.reject(this.inProgressUrls,function(url){return url===endpointUrl});this.failedUrls.push(endpointUrl);this.trigger("retrieveFailure",endpointUrl);this.checkForCompletion()}})}},retrievalStarted:function(){return this.inProgressUrls.length!==0||this.retrievedUrls.length!==0||this.failedUrls.length!==0},retrievalInProgress:function(){return this.inProgressUrls.length!==0},retrievalCompleted:function(){return this.inProgressUrls.length===0&&(this.retrievedUrls.length!==0||this.failedUrls.length!==0)},retrievalFailed:function(){return this.inProgressUrls.length===0&&this.retrievedUrls.length===0&&this.failedUrls.length!==0},hasSomeFailure:function(){return this.failedUrls.length!==0},isReady:function(){return this.retrievedUrls.length>0},checkForCompletion:function(){if(this.retrievalCompleted()){this.trigger("batchRetrieveComplete")}},reset:function(){this.inProgressUrls.length=0;this.retrievedUrls.length=0;this.failedUrls.length=0},retryFailedEndpoints:function(){var failedUrls=this.failedUrls;this.failedUrls=[];this.retrieve(failedUrls)}},Backbone.Events);;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/entities/dashboard-item-directory-entities.js' */
AJS.namespace("JIRA.Dashboard.Entities");JIRA.Dashboard.Entities.DirectoryItem=Backbone.Model.extend({});JIRA.Dashboard.Entities.DirectoryItems=Backbone.Collection.extend({model:JIRA.Dashboard.Entities.DirectoryItem,initialize:function(models,options){this.localItemsEndpointUrl=AJS.contextPath()+"/rest/config/1.0/directoryitems/local.json";this.externalItemsEndpointUrl=AJS.contextPath()+"/rest/config/1.0/directoryitems/external.json";this.endpointUrls=[this.localItemsEndpointUrl,this.externalItemsEndpointUrl];this.retriever=options.retriever;this.listenTo(this.retriever,{"retrieving":this.beforeRetrieve,"retrieve":this.processRetrievedItems,"retrieveFailure":this.handleRetrievalError,"batchRetrieving":function(){this.trigger("batchRetrieving")},"batchRetrieveComplete":function(){this.trigger("batchRetrieveComplete")}});this.categorisedItems={}},comparator:"titleLabel",retrievalStarted:function(){return this.retriever.retrievalStarted()},retrievalInProgress:function(){return this.retriever.retrievalInProgress()},retrievalCompleted:function(){return this.retriever.retrievalCompleted()},retrievalFailed:function(){return this.retriever.retrievalFailed()},isReady:function(){return this.retriever.isReady()},hasSomeFailure:function(){return this.retriever.hasSomeFailure()},retrieve:function(){this.retriever.retrieve(this.endpointUrls)},beforeRetrieve:function(){this.trigger("retrieving")},processRetrievedItems:function(data){this.set(this.transformResponseData(data),{remove:false});this.updateCategorisedItems();this.trigger("retrieve",data)},handleRetrievalError:function(failedEndpointUrl){this.trigger("retrieveFailure",failedEndpointUrl)},updateCategorisedItems:function(){this.categorisedItems={};var allCategory=AG.param.get("all");this.categorisedItems[allCategory]=[];_.each(this.models,function(model){this.categorisedItems[allCategory].push(model);_.each(model.get("categories"),function(category){this.categorisedItems[category]=this.categorisedItems[category]||[];this.categorisedItems[category].push(model)},this)},this)},getCategorisedItems:function(){return this.categorisedItems},reset:function(){this.set([]);this.categorisedItems={};this.retriever.reset();this.trigger("reset")},retryFailedEndpoints:function(){this.retriever.retryFailedEndpoints()},transformResponseData:function(data){return _.map(data,function(item){item.isLocal=false;item.specUriDisplay=item.specUri;item.description=item.description||"Description not available";item.authorLabel=item.authorLabel||"Author unknown";item.authorLineItem=AJS.format("By {0}",item.authorLabel);if(!/^http/.test(item.specUri)){item.specUriDisplay=AG.param.get("dashboardDirectoryBaseUrl")+item.specUri;item.isLocal=true}return item})}});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/entities/directory-view-state.js' */
AJS.namespace("JIRA.Dashboard.Entities");JIRA.Dashboard.Entities.DirectoryViewModel=Backbone.Model.extend({initialize:function(attributes,options){this.directoryItems=options.directoryItems;this.initializeStates();this.listenTo(this.directoryItems,{"batchRetrieving":this.handleBatchRetrievalStart,"retrieve":this.handleRetrieval,"retrieveFailure":this.handleRetrievalFailure,"reset":this.initializeStates})},initializeStates:function(){this.set({retrievalInProgress:false,retrievalFailed:false,hasUnrenderedData:false,directoryIsVisible:false,searchText:"",selectedCategory:AG.param.get("all"),categorisedItems:{},filteredCategorisedItems:{}})},handleBatchRetrievalStart:function(){this.set("retrievalInProgress",true);this.trigger("messageUpdate")},handleRetrieval:function(data){this.checkRetrievalCompleted();if(this.get("directoryIsVisible")&&data.length>0){this.set("hasUnrenderedData",true)}if(!this.get("retrievalInProgress")||this.get("hasUnrenderedData")){this.trigger("messageUpdate")}if(!this.get("directoryIsVisible")&&data.length>0){this.loadData()}},loadData:function(){this.updateCategorisedItems();this.trigger("dataUpdate")},loadUnrenderedData:function(){this.loadData();this.set("hasUnrenderedData",false);this.trigger("messageUpdate")},handleRetrievalFailure:function(){this.checkRetrievalCompleted();if(!this.get("retrievalInProgress")){this.trigger("messageUpdate")}},checkRetrievalCompleted:function(){if(this.directoryItems.retrievalCompleted()){this.set("retrievalInProgress",false);this.set("retrievalFailed",this.directoryItems.hasSomeFailure())}},setDirectoryVisible:function(){this.set("directoryIsVisible",true)},setDirectoryNotVisible:function(){this.set("directoryIsVisible",false)},setSearchText:function(searchText){this.set("searchText",searchText.toLowerCase());this.updateFilteredCategorisedItems()},getSearchText:function(){return this.get("searchText")},setSelectedCategory:function(category){this.set("selectedCategory",category)},getSelectedCategory:function(){return this.get("selectedCategory")},updateCategorisedItems:function(){this.set("categorisedItems",this.directoryItems.getCategorisedItems());this.updateFilteredCategorisedItems()},getCategorisedItems:function(){return this.get("categorisedItems")},updateFilteredCategorisedItems:function(){this.set("filteredCategorisedItems",this.filterCategorisedItems(this.getSearchText()))},getFilteredCategorisedItems:function(){return this.get("filteredCategorisedItems")},filterCategorisedItems:function(searchText){if(!searchText){return this.getCategorisedItems()}var filtered={};_.each(this.getCategorisedItems(),function(items,category){filtered[category]=_.filter(items,function(item){return this.matchesSearchText(searchText,item)},this)},this);return filtered},matchesSearchText:function(searchText,item){searchText=searchText.toLowerCase();return item.get("specUri").toLowerCase().indexOf(searchText)>-1||item.get("titleLabel").toLowerCase().indexOf(searchText)>-1||item.get("authorLabel").toLowerCase().indexOf(searchText)>-1||item.get("description").toLowerCase().indexOf(searchText)>-1},getCategoryCount:function(){return this.transformCategoryCountForDisplay(this.getCategorisedItems())},getFilteredCategoryCount:function(){return this.transformCategoryCountForDisplay(this.getFilteredCategorisedItems())},transformCategoryCountForDisplay:function(categorisedItems){var categoryCount=[];_.each(categorisedItems,function(items,category){categoryCount.push({label:category,count:items.length})});return _.sortBy(categoryCount,"label")},getItemsForCategory:function(category){return this.getCategorisedItems()[category]},getVisibleItemsForCategory:function(category){return this.getFilteredCategorisedItems()[category]}});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/views/directory-items-view.js' */
AJS.namespace("JIRA.Dashboard.Views");JIRA.Dashboard.Views.DirectoryItems=Backbone.View.extend({template:JIRA.Dashboard.Templates.directoryItems,events:{"click button[data-purpose='add-dashboard-item']":function(e){this.trigger("dashboardItemAdd",AJS.$(e.target).attr("data-item-url"))},"click a[data-purpose='toggle-xml']":function(e){e.preventDefault();var $textArea=AJS.$(e.target.parentNode).find("textarea");var $anchor=AJS.$(e.target);if($textArea.is(":visible")){$textArea.hide();$anchor.text("Show XML link")}else{$textArea.show();$textArea.select();$anchor.text("Hide XML link")}}},render:function(){var items=[];_.each(this.model.getItemsForCategory(this.model.getSelectedCategory()),function(model){items.push(model.attributes)});this.$el.html(this.template({items:items}));this.applySearchTextFiltering();this.$el.children().filter(".item-group").last().addClass("last")},applySearchTextFiltering:function(){var visibleItemUrls={};var visibleCount=0;_.each(this.model.getVisibleItemsForCategory(this.model.getSelectedCategory()),function(model){visibleItemUrls[model.get("specUri")]=true;visibleCount++});if(visibleCount===0){visibleItemUrls["no-result"]=true}var $items=this.$el.children();_.each($items,function(item){var $item=AJS.$(item);if(!visibleItemUrls[$item.attr("data-item-url")]){$item.hide()}else{$item.show()}});$items.removeClass("last").filter(".item-group:visible").last().addClass("last")},enableAddButtons:function(){this.delegateEvents();this.$("button[data-purpose='add-dashboard-item']").removeAttr("aria-disabled")},disableAddButtons:function(){this.undelegateEvents();this.$("button[data-purpose='add-dashboard-item']").attr("aria-disabled","true")}});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/views/directory-view.js' */
AJS.namespace("JIRA.Dashboard.Views");JIRA.Dashboard.Views.Directory=Backbone.View.extend({initialize:function(){this.$shell=AJS.$(JIRA.Dashboard.Templates.gadgetDirectoryPage({searchPlaceholder:"Search"}));this.$searchBox=this.$shell.find("#search")},events:{"submit form.directory-search":function(e){e.preventDefault()},"keyup #search":function(e){e.preventDefault();this.trigger("searchTextUpdate",AJS.$(e.target).val())}},getNavRootElement:function(){return this.$shell.find("div.aui-navgroup-inner")},getItemsRootElement:function(){return this.$shell.find("div#list-panel")},getMessagesRootElement:function(){return this.$shell.find("div#message-panel")},render:function(){this.$el.html(this.$shell)},detach:function(){this.$shell.detach()},resetUserInput:function(){this.$searchBox.val("")},setFocusOnSearch:function(){this.$searchBox.focus()}});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/views/directory-nav-view.js' */
AJS.namespace("JIRA.Dashboard.Views");JIRA.Dashboard.Views.DirectoryNav=Backbone.View.extend({template:JIRA.Dashboard.Templates.directoryNavList,events:{"click a[data-purpose='category-nav']":function(e){this.trigger("categorySelect",AJS.$(e.target).attr("data-category-label"));e.preventDefault()},"click a[data-purpose='category-nav'] > span":function(e){this.trigger("categorySelect",AJS.$(e.target.parentNode).attr("data-category-label"));e.stopPropagation()}},render:function(){var self=this;this.$el.html(this.template({categories:self.model.getFilteredCategoryCount(),selectedCategoryLabel:self.model.getSelectedCategory(),headerText:"CATEGORIES"}))}});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/views/directory-loading-view.js' */
AJS.namespace("JIRA.Dashboard.Views");JIRA.Dashboard.Views.DirectoryLoadingView=Backbone.View.extend({template:JIRA.Dashboard.Templates.gadgetDirectoryLoadingPage,initialize:function(){this.$content=AJS.$(this.template({loadingText:"Loading gadgets..."}))},render:function(){this.$el.html(this.$content);var spinnerOpts=AJS.$.fn.spin&&AJS.$.fn.spin.presets?AJS.$.fn.spin.presets.medium:{};var spinner=new Spinner(spinnerOpts).spin();this.$el.find(".loading-spinner").html(spinner.el)},detach:function(){this.$content.detach()}});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/views/directory-load-failure-view.js' */
AJS.namespace("JIRA.Dashboard.Views");JIRA.Dashboard.Views.DirectoryLoadFailureView=Backbone.View.extend({template:JIRA.Dashboard.Templates.gadgetDirectoryLoadFailurePage,events:{"click a[data-purpose='reload-directory']":function(){this.trigger("directoryReloadRequest")}},initialize:function(){this.$content=AJS.$(this.template())},render:function(){this.$el.html(this.$content)},detach:function(){this.$content.detach()}});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/views/directory-message-view.js' */
AJS.namespace("JIRA.Dashboard.Views");JIRA.Dashboard.Views.DirectoryMessageView=Backbone.View.extend({template:JIRA.Dashboard.Templates.directoryMessages,events:{"click a[data-purpose='retry']":function(){this.trigger("retrieveRetryRequest")},"click a[data-purpose='load']":function(){this.trigger("additionalItemsLoadRequest")}},render:function(payload){this.$el.html(this.template({payload:payload}))}});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/controllers/directory-controller.js' */
AJS.namespace("JIRA.Dashboard.Controllers");JIRA.Dashboard.Controllers.DirectoryController=function(model,contentRootElement){this.model=model;this.viewState=new JIRA.Dashboard.Entities.DirectoryViewModel({},{directoryItems:model});this.directory=new JIRA.Dashboard.Views.Directory({el:contentRootElement});this.directoryNav=new JIRA.Dashboard.Views.DirectoryNav({model:this.viewState,el:this.directory.getNavRootElement()});this.directoryItemsView=new JIRA.Dashboard.Views.DirectoryItems({model:this.viewState,el:this.directory.getItemsRootElement()});this.messageView=new JIRA.Dashboard.Views.DirectoryMessageView({el:this.directory.getMessagesRootElement()});this.listenTo(this.viewState,{"messageUpdate":this.refreshMessage,"dataUpdate":this.refreshData});this.listenTo(this.directoryItemsView,"dashboardItemAdd",this.handleDashboardItemAddition);this.listenTo(this.directoryNav,"categorySelect",this.updatedSelectedCategory);this.listenTo(this.directory,"searchTextUpdate",this.updateSearchText);this.listenTo(this.messageView,{"additionalItemsLoadRequest":function(){this.viewState.loadUnrenderedData()},"retrieveRetryRequest":function(){this.model.retryFailedEndpoints()}})};JIRA.Dashboard.Controllers.DirectoryController.prototype=_.extend({refreshMessage:function(){this.messageView.render({"retrievalInProgress":this.viewState.get("retrievalInProgress"),"retrievalFailed":this.viewState.get("retrievalFailed"),"directoryIsVisible":this.viewState.get("directoryIsVisible"),"hasUnrenderedData":this.viewState.get("hasUnrenderedData")})},refreshData:function(){this.directoryNav.render();this.directoryItemsView.render()},handleDashboardItemAddition:function(itemUrl){this.trigger("dashboardItemAdd",itemUrl)},disableDirectoryAddButtons:function(){this.directoryItemsView.disableAddButtons()},enableDirectoryAddButtons:function(){this.directoryItemsView.enableAddButtons()},updatedSelectedCategory:function(category){this.viewState.setSelectedCategory(category);this.directoryNav.render();this.directoryItemsView.render()},updateSearchText:function(searchText){if(searchText===this.viewState.getSearchText()){return }this.viewState.setSearchText(searchText);this.directoryNav.render();this.directoryItemsView.applySearchTextFiltering()},render:function(){this.directory.render();this.viewState.setDirectoryVisible()},detach:function(){this.directory.detach();this.viewState.setDirectoryNotVisible()},resetUserInput:function(){this.viewState.setSelectedCategory(AG.param.get("all"));this.viewState.setSearchText("");this.directoryNav.render();this.directoryItemsView.render();this.directory.resetUserInput()},setFocusOnSearch:function(){this.directory.setFocusOnSearch()}},Backbone.Events);;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/controllers/directory-loader.js' */
AJS.namespace("JIRA.Dashboard.Controllers");JIRA.Dashboard.Controllers.DirectoryLoader=function($clickable){this.directoryItems=new JIRA.Dashboard.Entities.DirectoryItems([],{retriever:new JIRA.Dashboard.Services.ItemRetriever()});this.dialogController=new JIRA.Dashboard.Controllers.DialogController(this.directoryItems);this.directoryController=this.dialogController.getDirectoryController();$clickable.live("click",_.bind(this.handleClickEvent,this));this.listenTo(this.directoryController,"dashboardItemAdd",function(itemUrl){this.trigger("dashboardItemAdd",itemUrl)});this.listenTo(this.dialogController,"directoryReloadRequest",this.reload)};JIRA.Dashboard.Controllers.DirectoryLoader.prototype=_.extend({handleClickEvent:function(e){this.load();return e.preventDefault()},load:function(){if(this.directoryItems.isReady()){this.dialogController.showDirectory()}else{if(!this.directoryItems.retrievalStarted()){this.dialogController.showDirectoryLoadingPage();this.listenTo(this.directoryItems,"retrieve",this.handleFirstRetrieve);this.listenTo(this.directoryItems,"retrieveFailure",this.handleRetrieveFailure);this.directoryItems.retrieve()}else{if(this.directoryItems.retrievalFailed()){this.dialogController.showDirectoryLoadFailurePage()}else{this.dialogController.showDirectoryLoadingPage()}}}},reload:function(){this.directoryItems.reset();this.load()},handleFirstRetrieve:function(data){if(data.length==0&&this.directoryItems.retrievalInProgress()){return }this.stopListening(this.directoryItems);this.dialogController.renderDirectory()},handleRetrieveFailure:function(){if(!this.directoryItems.retrievalInProgress()){this.stopListening(this.directoryItems);this.dialogController.renderDirectoryLoadFailurePage()}},disableDirectoryAddButtons:function(){this.directoryController.disableDirectoryAddButtons()},enableDirectoryAddButtons:function(){this.directoryController.enableDirectoryAddButtons()}},Backbone.Events);;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/controllers/dialog-controller.js' */
AJS.namespace("JIRA.Dashboard.Controllers");JIRA.Dashboard.Controllers.DialogController=function(model,dialogId){var $dialog=AJS.$(JIRA.Dashboard.Templates.gadgetDirectoryDialog({id:dialogId||"gadget-dialog",headerText:"Add a gadget",gadgetsAdminUrl:AG.param.get("gadgetDirectoryAdminUrl"),manageGadgetsLabel:"Manage gadgets",canManageGadgets:AG.param.get("canAddExternalGadgetsToDirectory")==="true"}));var $contentRootElement=$dialog.find("div.aui-dialog2-content");this.dialog=AJS.dialog2($dialog);this.dialogVisible=false;var self=this;this.dialog.on("hide",function(){self.dialogVisible=false;self.resetUserInputOnCurrentPage()});this.currentPage="";this.loadingView=new JIRA.Dashboard.Views.DirectoryLoadingView({el:$contentRootElement[0]});this.loadFailureView=new JIRA.Dashboard.Views.DirectoryLoadFailureView({el:$contentRootElement[0]});this.directoryController=new JIRA.Dashboard.Controllers.DirectoryController(model,$contentRootElement[0]);this.listenTo(this.loadFailureView,"directoryReloadRequest",function(){this.trigger("directoryReloadRequest")});this.windowIsUnloading=false;window.onbeforeunload=function(){self.windowIsUnloading=true;if(self.dialogVisible){self.dialog.hide()}}};JIRA.Dashboard.Controllers.DialogController.prototype=_.extend({showDirectoryLoadingPage:function(){this.renderDirectoryLoadingPage(true)},renderDirectoryLoadingPage:function(showDialog){this.renderPage("loading",_.bind(function(){this.loadingView.render()},this),showDialog)},showDirectory:function(){this.renderDirectory(true)},renderDirectory:function(showDialog){this.renderPage("directory",_.bind(function(){this.directoryController.render();this.directoryController.setFocusOnSearch()},this),showDialog)},showDirectoryLoadFailurePage:function(){this.renderDirectoryLoadFailurePage(true)},renderDirectoryLoadFailurePage:function(showDialog){if(this.windowIsUnloading){return }this.renderPage("loadFailure",_.bind(function(){this.loadFailureView.render()},this),showDialog)},renderPage:function(pageName,renderFn,showDialog){if(this.currentPage!==pageName){this.detachCurrentPage();renderFn();this.currentPage=pageName}if(showDialog&&!this.dialogVisible){this.showDialog()}},detachCurrentPage:function(){switch(this.currentPage){case"":break;case"loading":this.loadingView.detach();break;case"directory":this.directoryController.detach();break;case"loadFailure":this.loadFailureView.detach();break;default:throw"Unknown page: "+this.currentPage}},resetUserInputOnCurrentPage:function(){if(this.currentPage==="directory"){this.directoryController.resetUserInput()}},getDirectoryController:function(){return this.directoryController},showDialog:function(){this.dialog.show();this.dialogVisible=true},destroyDialog:function(){this.dialog.remove()}},Backbone.Events);;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/dashboard-item-directory.js' */
AJS.namespace("JIRA.Dashboard.Modules");JIRA.Dashboard.Modules.Directory=function($loadTrigger){this.controller=new JIRA.Dashboard.Controllers.DirectoryLoader($loadTrigger);this.controller.on("dashboardItemAdd",this.onDashboardItemAdd,this)};JIRA.Dashboard.Modules.Directory.prototype={onDashboardItemAdd:function(itemUrl){this.controller.disableDirectoryAddButtons();var self=this;JIRA.Dashboard.DashboardService.addItem(itemUrl,{onSuccess:function(){self.controller.enableDirectoryAddButtons()},onError:function(errorMsg){if(errorMsg){alert(errorMsg)}self.controller.enableDirectoryAddButtons()}})}};;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard', location = 'js/jquery.cookie.js' */
jQuery.cookie=function(name,value,options){if(typeof value!="undefined"){options=options||{};if(value===null){value="";options.expires=-1}var expires="";if(options.expires&&(typeof options.expires=="number"||options.expires.toUTCString)){var date;if(typeof options.expires=="number"){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000))}else{date=options.expires}expires="; expires="+date.toUTCString()}var path=options.path?"; path="+(options.path):"";var domain=options.domain?"; domain="+(options.domain):"";var secure=options.secure?"; secure":"";document.cookie=[name,"=",encodeURIComponent(value),expires,path,domain,secure].join("")}else{var cookieValue=null;if(document.cookie&&document.cookie!=""){var cookies=document.cookie.split(";");for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+"=")){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}return cookieValue}};;
;/* module-key = 'jira.webresources:captcha', location = '/includes/jira/captcha/Captcha.js' */
JIRA.Captcha={setup:function(){AJS.$("#captcha").delegate("span.captcha-reload","click",function(e){JIRA.Captcha.refresh();e.preventDefault()})},refresh:function(){var $img=AJS.$(".captcha-image","#captcha .captcha-container"),src=$img.attr("src");if(src.indexOf("__r")>=0){src=src.replace(/__r=([^&]+)/,"__r="+Math.random())}else{src=src.indexOf("?")>=0?(src+"&__r="+Math.random()):(src+"?__r="+Math.random())}$img.attr("src",src);AJS.$("#captcha .captcha-response").focus()}};jQuery(JIRA.Captcha.setup);;
;/* module-key = 'com.atlassian.jira.gadgets:login-dashboard-item-resources', location = 'static/dashboarditem/login/login.soy' */
// This file was automatically generated from login.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Login == 'undefined') { JIRA.DashboardItem.Login = {}; }
if (typeof JIRA.DashboardItem.Login.Templates == 'undefined') { JIRA.DashboardItem.Login.Templates = {}; }


JIRA.DashboardItem.Login.Templates.Login = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="login-container" class=""><form id="loginform" method="post" action="#" name="loginform" class="aui gdt">', (opt_data.errorMessage) ? '<div id="usernameerror" class="aui-message error"><span id="usernamerror-icon" class="aui-icon icon-error"></span><p>' + soy.$$escapeHtml(opt_data.errorMessage) + '</p></div>' : '', '<div class="field-group"><label accesskey="u" for="login-form-username" id="usernamelabel">', AJS.format("{0}U{1}sername",'<u>','</u>'), '</label><input class="text medium-field" id="login-form-username" name="os_username" type="text"></div><div class="field-group"><label accesskey="p" for="login-form-password" id="passwordlabel">', AJS.format("{0}P{1}assword",'<u>','</u>'), '</label><input class="text medium-field" id="login-form-password" name="os_password" type="password"></div>', (opt_data.showRememberMe) ? '<fieldset class="group"><div class="checkbox" id="rememberme"><input class="checkbox" id="login-form-remember-me" name="os_cookie" type="checkbox" value="true"><label accesskey="r" for="login-form-remember-me" id="remembermelabel">' + AJS.format("{0}R{1}emember my login on this computer",'<u>','</u>') + '</label></div></fieldset>' : '', (opt_data.showCaptcha) ? '<div class="field-group" id="captcha"><label id="captchalabel" for="login-form-captcha" accesskey="c">' + soy.$$escapeHtml("Please enter the word as shown below") + '</label><input type="text" name="os_captcha" id="login-form-captcha" class="text medium-field captcha-response"><div class="captcha-container"><img alt="" class="captcha-image" height="100px" id="captchaimg" src="' + soy.$$escapeHtml("") + '/captcha?ts=' + soy.$$escapeHtml(opt_data.captchaTimestamp) + '" width="200px"><a id="os-captcha-icon" href="#login-form-os-captcha" tabindex="-1" class="captcha-trigger" title="' + soy.$$escapeHtml("Refresh the image") + '"><span class="aui-icon captcha-reload icon-reload">' + soy.$$escapeHtml("Refresh the image") + '</span></a></div></div>' : '', (opt_data.isPublicMode) ? '<div class="field-group" id="publicmodeon"><div id="publicmodeonmsg">' + AJS.format("Not a member? {0}{1}{2} for an account.",'<a id="signup" href="' + "" + '/secure/Signup!default.jspa" tabindex="-1" target="_parent">',"Sign up",'</a>') + '</div></div>' : (opt_data.adminFormOn) ? '<div class="field-group" id="publicmodeooff"><div id="publicmodeoffmsg">' + AJS.format("Not a member? To request an account, {0}.",AJS.format("please contact your {0}JIRA administrators{1}",'<a id="contact-admin" href="' + "" + '/secure/ContactAdministrators!default.jspa">','</a>')) + '</div></div>' : '<div class="field-group" id="publicmodeooff"><div id="publicmodeoffmsg">' + soy.$$escapeHtml(AJS.format("Not a member? To request an account, {0}.",AJS.format("please contact your {0}JIRA administrators{1}",'',''))) + '</div></div>', '<div class="buttons-container"><div class="buttons"><input class="button" id="login" name="login" type="submit" value="', soy.$$escapeHtml("Log In"), '">', (opt_data.showForgotPassword) ? '<a class="cancel" href="' + soy.$$escapeHtml("") + '/secure/ForgotLoginDetails.jspa" id="forgotpassword" target="_parent">' + soy.$$escapeHtml("Can\x27t access your account?") + '</a>' : '', '</div></div></form></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:login-dashboard-item-resources', location = 'static/dashboarditem/login/login.js' */
define("jira-dashboard-items/login",["underscore"],function(_){function renderTemplate($element,userPreferences,currentError){$element.empty().html(JIRA.DashboardItem.Login.Templates.Login({isPublicMode:userPreferences.isPublicMode,adminFormOn:userPreferences.isAdminFormOn,showForgotPassword:!userPreferences.externalUserManagement&&!userPreferences.externalPasswordManagement,showRememberMe:userPreferences.allowCookies,errorMessage:currentError,showCaptcha:userPreferences.isElevatedSecurityCheckShown,captchaTimestamp:Date.now()}))}function applyResponsiveLayout($element,$form){if($element.width()<490){$form.addClass("top-label")}else{$form.removeClass("top-label")}}function focusInputUsername($element){setTimeout(function(){$element.find("#login-form-username").focus()},200)}function onAfterRender(){applyResponsiveLayout(this.$element,this.$form);focusInputUsername(this.$element);JIRA.Captcha.setup();this.API.forceLayoutRefresh()}function responseToErrorMessage(data){data=data||{};if(data.communicationError){return "Sorry, a communication error occurred while trying to contact the remote authentication server."}if(data.loginError){return "Sorry, an error occurred trying to log you in - please try again."}if(data.loginFailedByPermissions){return AJS.format("You do not have a permission to log in. If you think this is incorrect, {0}.",data.contactAdminLink)}if(data.isElevatedSecurityCheckShown){return "Sorry, your userid is required to answer a CAPTCHA question correctly."}return "Sorry, your username and password are incorrect - please try again."}function updateTemplate(data,userPreferences){this.currentError=responseToErrorMessage(data);this.render(this.$element,userPreferences,true);this.API.hideLoadingBar();onAfterRender.call(this)}var DashboardItem=function(API){this.currentError=null;this.API=API;this.API.on("afterRender",onAfterRender,this)};DashboardItem.prototype.render=function(element,userPreferences,forceRender){var $element=this.$element=AJS.$(element);var currentError=this.currentError;if(forceRender||$element.find("#loginform").length===0){renderTemplate($element,userPreferences,currentError)}var $form=this.$form=$element.find("#loginform");$form.submit(_.bind(function(e){e.preventDefault();this.API.showLoadingBar();AJS.$.ajax({type:"POST",url:AJS.contextPath()+"/rest/gadget/1.0/login",data:$form.serialize(),success:_.bind(function(data){if(data.loginSucceeded){window.location=AJS.contextPath()}else{userPreferences.isElevatedSecurityCheckShown=data.isElevatedSecurityCheckShown;updateTemplate.call(this,data,userPreferences)}},this),error:_.bind(function(data){updateTemplate.call(this,data,userPreferences)},this)})},this))};return DashboardItem});;
;/* module-key = 'com.atlassian.jira.gadgets:admin-dashboard-item-resources', location = 'static/dashboarditem/admin/admin.soy' */
// This file was automatically generated from admin.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Admin == 'undefined') { JIRA.DashboardItem.Admin = {}; }
if (typeof JIRA.DashboardItem.Admin.Templates == 'undefined') { JIRA.DashboardItem.Admin.Templates = {}; }


JIRA.DashboardItem.Admin.Templates.admin = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="g-admin">');
  JIRA.DashboardItem.Admin.Templates.adminGettingStarted(opt_data, output);
  JIRA.DashboardItem.Admin.Templates.adminDoMore(opt_data, output);
  JIRA.DashboardItem.Admin.Templates.adminDocs(opt_data, output);
  if (! opt_data.admin.onDemand) {
    JIRA.DashboardItem.Admin.Templates.adminLicense(opt_data, output);
  }
  if ((opt_data.admin.warningMessages.length || opt_data.admin.usingHsql) && (! opt_data.admin.onDemand || opt_data.admin.systemAdministrator)) {
    JIRA.DashboardItem.Admin.Templates.adminWarnings(opt_data, output);
  }
  JIRA.DashboardItem.Admin.Templates.adminUnHideSection(opt_data, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Admin.Templates.adminGettingStarted = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div data-name="gettingstarted" class="admin-task-container admin-getting-started-content" ', (opt_data.admin.tasks.gettingStarted.dismissed) ? 'style="display: none"' : '', '><div class="admin-getting-started-img"><img src="', soy.$$escapeHtml(opt_data.baseUrl), '/download/resources/com.atlassian.jira.gadgets:common-lite/admin-flag.png" height="48" width="48" border="0" /></div><div class="admin-item-content"><h3>', soy.$$escapeHtml("Getting Started"), '</h3><ul class="admin-task-list"><li class="admin-task', (opt_data.admin.tasks.gettingStarted.createProject.completed) ? ' admin-task-completed' : '', '"><div class="admin-task-checkbox-w"><div class="admin-task-checkbox"></div></div><a class="admin-task-content add-project-trigger" data-name="createproject" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/AddProject!default.jspa?nextAction=browseproject&src=admingadget">', soy.$$escapeHtml("Create or import your first project to start tracking your work"), '</a></li><li class="admin-task create-issue-admin-task', (opt_data.admin.tasks.gettingStarted.createIssue.completed) ? ' admin-task-completed' : '', ' ', (! opt_data.admin.tasks.gettingStarted.createIssue.enabled) ? ' admin-task-disabled' : '', '"><div class="admin-task-checkbox-w"><div class="admin-task-checkbox"></div></div><a class="admin-task-content create-issue-admin-task create-issue-trigger', (! opt_data.admin.tasks.gettingStarted.createIssue.enabled) ? ' admin-task-disabled' : '', '" data-name="createissue" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/CreateIssue!default.jspa?nextAction=viewissue&src=admingadget">', soy.$$escapeHtml("Create your first JIRA issue to get things done"), '</a></li><li class="admin-task', (opt_data.admin.tasks.gettingStarted.createUser.completed) ? ' admin-task-completed' : '', '"><div class="admin-task-checkbox-w"><div class="admin-task-checkbox"></div></div><a class="admin-task-content" data-name="createuser" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/user/UserBrowser.jspa">', soy.$$escapeHtml("Build your team by adding users or inviting users"), '</a></li><li class="admin-task', (opt_data.admin.tasks.gettingStarted.lookAndFeel.completed) ? ' admin-task-completed' : '', '"><div class="admin-task-checkbox-w"><div class="admin-task-checkbox"></div></div><a class="admin-task-content" data-name="lookandfeel" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/LookAndFeel!default.jspa">', soy.$$escapeHtml("Add your own style by customizing the look and feel"), '</a></li></ul><p class="hide-admin-tasks"><span class="hide-admin-task-list-completed" ', (! opt_data.admin.tasks.gettingStarted.completed) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Congratulations, you\x27ve completed everything on the list!"), ' <a href="#" class="hide-admin-task-list" aria-owns="admin-task">', soy.$$escapeHtml("Hide this list now."), '</a></span><span class="hide-admin-task-list-not-completed" ', (opt_data.admin.tasks.gettingStarted.completed) ? 'style="display: none"' : '', '><a href="#" class="hide-admin-task-list">', soy.$$escapeHtml("I\x27m done, hide this list"), '</a></span></p></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Admin.Templates.upmProgress = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="content-area-container upm-progress"><img src="', soy.$$escapeHtml(""), '/images/icons/wait-large.gif" alt="', soy.$$escapeHtml("In Progress"), '"><div class="upm-progress-text"></div><div class="upm-progress-bar-container"><div class="upm-progress-bar"><div class="upm-progress-amount"></div></div><span class="upm-progress-bar-percent">0</span>%</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Admin.Templates.adminDoMore = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div data-name="domore" class="admin-task-container admin-do-more-content" ', (! opt_data.admin.systemAdministrator && ! (opt_data.admin.licenseHolder && opt_data.admin.onDemand) || opt_data.admin.tasks.doMore.dismissed) ? 'style="display: none"' : '', '><div class="admin-getting-started-img"><img src="', soy.$$escapeHtml(opt_data.baseUrl), '/download/resources/com.atlassian.jira.gadgets:common-lite/admin-glass.png" height="48" width="48" border="0" /></div><div class="admin-item-content"><div class="admin-do-more"><h3>', soy.$$escapeHtml("Do more with JIRA"), '</h3><ul class="admin-task-list"><li class="admin-task', (opt_data.admin.tasks.doMore.tryGreenHopper.completed) ? ' admin-task-completed' : '', '"><div class="admin-task-checkbox-w"><div class="admin-task-checkbox"></div></div><a data-name="greenhopper" class="admin-task-content greenHopperInstall', (opt_data.admin.onDemand) ? 'OD" href="' + soy.$$escapeHtml(opt_data.admin.addGreenhopperToODUrl) + '" target="_blank"' : '" href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/plugins/servlet/upm"', '>', soy.$$escapeHtml("Install JIRA Agile for project management. Free for 30 days!"), '</a></li><li class="admin-task', (opt_data.admin.tasks.doMore.tryBonfire.completed) ? ' admin-task-completed' : '', '"><div class="admin-task-checkbox-w"><div class="admin-task-checkbox"></div></div><a data-name="bonfire" class="admin-task-content bonfireInstall', (opt_data.admin.onDemand) ? 'OD" href="' + soy.$$escapeHtml(opt_data.admin.addBonfireToODUrl) + '" target="_blank"' : '"', '>', soy.$$escapeHtml("Install JIRA Capture, exploratory testing for agile teams. Free for 30 days!"), '</a></li></ul><p class="hide-admin-tasks"><span class="hide-admin-task-list-completed" ', (! opt_data.admin.tasks.doMore.completed) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Congratulations, you\x27ve completed everything on the list!"), ' <a href="#" class="hide-admin-task-list">', soy.$$escapeHtml("Hide this list now."), '</a></span><span class="hide-admin-task-list-not-completed" ', (opt_data.admin.tasks.doMore.completed) ? 'style="display: none"' : '', '> <a href="#" class="hide-admin-task-list">', soy.$$escapeHtml("I\x27m done, hide this list"), '</a></span></p></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Admin.Templates.adminDocs = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div data-name="admindocs" class="admin-docs"><div class="admin-docs-img"> <img src="', soy.$$escapeHtml(opt_data.baseUrl), '/download/resources/com.atlassian.jira.gadgets:common-lite/admin-docs.png" height="48" width="48" border="0" /> </div> <div class="admin-item-content"> <h3>', soy.$$escapeHtml("Administrator documentation"), '</h3> <div class="aui-message generic">');
  var migrationMessageHtml__soy146 = AJS.format("If you are migrating from another issue tracker you might want to read our {0}migration guides{1}.",'<a class="admin-migration-docs" target="_blank" href="' + opt_data.admin.migrationDocsUrl + '">','</a>');
  output.append(AJS.format("Browse through the {0}admin documentation{1} to learn more about {2}defining your workflows{3}, customizing {4}issue fields{5} and {6}screens{7}, {8}managing users{9} or the {10}time tracking{11} features of JIRA.",'<a class="admin-browse-docs" target="_blank" href="' + opt_data.admin.browseDocsUrl + '">','</a>','<a class="admin-define-workflows-docs" target="_blank" href="' + opt_data.admin.defineWorkflowsDocsUrl + '">','</a>','<a class="admin-customize-fields-docs" target="_blank" href="' + opt_data.admin.customizeFieldsDocsUrl + '">','</a>','<a class="admin-customize-screens-docs" target="_blank" href="' + opt_data.admin.customizeScreensDocsUrl + '">','</a>','<a class="admin-manage-users-docs" target="_blank" href="' + opt_data.admin.manageUsersDocsUrl + '">','</a>','<a class="admin-time-tracking-docs" target="_blank" href="' + opt_data.admin.timeTrackingDocsUrl + '">','</a>'), '<br />', migrationMessageHtml__soy146, '</div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Admin.Templates.adminLicense = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="admin-license"><div class="admin-license-img"><img src="', soy.$$escapeHtml(opt_data.baseUrl), '/download/resources/com.atlassian.jira.gadgets:common-lite/admin-license.png" height="48" width="48" border="0" /></div><div class="admin-item-content"><h3>', soy.$$escapeHtml("License"), '</h3><div class="aui-message generic license-content"><p class="license-title"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/ViewLicense!default.jspa">', soy.$$escapeHtml(opt_data.admin.licenseTypeNiceName), '</a></p><span class="license-status">', (opt_data.admin.partnerName) ? soy.$$escapeHtml(AJS.format("Atlassian Partner: {0}",opt_data.admin.partnerName)) + '<br/>' : '', opt_data.admin.licenseExpiryStatusMessageHtml, '</span>');
  if (opt_data.admin.hasReachedUserLimit) {
    output.append('<p><span class="message license-warning red-highlight ', (opt_data.admin.hasExceededUserLimit && ! opt_data.admin.hasZeroUserLicense) ? 'userLimitExceeded' : 'notuserLimitExceeded', '">');
    if (opt_data.admin.hasZeroUserLicense) {
      var expiryMessageHtml__soy181 = AJS.format("It appears there is a problem with your current license. It specifies a limit of 0 users that are allowed to log in to JIRA. Please verify you have got the correct license key on {0}My Account{1}.",'<a href="' + opt_data.admin.externalLinkMyAccount + '">','</a>');
      output.append(expiryMessageHtml__soy181);
    } else {
      if (opt_data.admin.hasExceededUserLimit) {
        var userLimitWarningHtml__soy187 = AJS.format("You have exceeded the number of users allowed to use JIRA under {0}your license{1}. You will not be able to create any more issues in JIRA until you reduce the number of users with the \x27\x27JIRA Users\x27\x27, \x27\x27JIRA Administrators\x27\x27 or \x27\x27JIRA System Administrators\x27\x27 global permissions. If you require more user accounts, please consider upgrading your license.",'<a href="' + opt_data.baseUrl + '/secure/admin/ViewLicense!default.jspa">','</a>');
        output.append(userLimitWarningHtml__soy187);
      } else {
        var userLimitReachedHtml__soy191 = AJS.format("You have reached the number of users allowed to use JIRA by {0}your license{1}.",'<a href="' + opt_data.baseUrl + '/secure/admin/ViewLicense!default.jspa">','</a>');
        output.append(userLimitReachedHtml__soy191);
      }
    }
    output.append('</span>');
    if (! opt_data.admin.hasZeroUserLicense) {
      output.append('<br/>');
      var purchaseFullLicenseHtml__soy198 = AJS.format("If you require more user accounts, consider {0}purchasing{1} a full license.",'<a href="' + opt_data.admin.externalLinkPersonalSite + '">','</a>');
      output.append(purchaseFullLicenseHtml__soy198);
    }
    output.append('</p>');
  }
  output.append('</div>');
  if (opt_data.admin.licenseStatusMessage) {
    var licenseStatusMessageHtml__soy205 = opt_data.admin.licenseStatusMessage;
    output.append('<p class="licenseStatusMessage">', licenseStatusMessageHtml__soy205, '</p>');
  }
  output.append('</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Admin.Templates.adminWarnings = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="admin-warnings"><div class="admin-warnings-img"><img src="', soy.$$escapeHtml(opt_data.baseUrl), '/download/resources/com.atlassian.jira.gadgets:common-lite/admin-warning.png" height="48" width="48" border="0" /></div><div class="admin-item-content"><h3>', soy.$$escapeHtml("Warnings"), '</h3><div class="aui-message warning"><ul>');
  if (opt_data.admin.usingHsql) {
    var hsqlWarningHtml__soy219 = AJS.format("You are using HSQL DB, which is an in-memory database and susceptible to corruption when abnormally terminated. {0}DO NOT USE THIS IN A PRODUCTION SYSTEM{1}. Instead we recommend using an external database, for a list of supported databases please see {2}our documentation{3}.",'<span class="red-highlight">','</span>','<a target="_blank" href="' + opt_data.admin.dbConfigDocsUrl + '">','</a>');
    output.append('<li>', hsqlWarningHtml__soy219, '</li>');
  }
  var warningHtmlList224 = opt_data.admin.warningMessages;
  var warningHtmlListLen224 = warningHtmlList224.length;
  for (var warningHtmlIndex224 = 0; warningHtmlIndex224 < warningHtmlListLen224; warningHtmlIndex224++) {
    var warningHtmlData224 = warningHtmlList224[warningHtmlIndex224];
    output.append('<li>', warningHtmlData224, '</li>');
  }
  output.append('</ul></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Admin.Templates.adminUnHideSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="unhide-section admin-unhide-section"><span aria-owns="gettingstarted" class="admin-task-list-unhide" ', (! opt_data.admin.tasks.gettingStarted.dismissed) ? 'style="display: none"' : '', '><a href="#" class="show-admin-task-list">', soy.$$escapeHtml("Show \x27Getting Started\x27"), '</a></span><span class="unhide-separator" ', (! (opt_data.admin.tasks.gettingStarted.dismissed && opt_data.admin.tasks.doMore.dismissed && opt_data.admin.systemAdministrator)) ? 'style="display: none"' : '', '> | </span><span aria-owns="domore" class="admin-task-list-unhide" ', (! (opt_data.admin.tasks.doMore.dismissed && opt_data.admin.systemAdministrator)) ? 'style="display: none"' : '', '><a href="#" class="show-admin-task-list">', soy.$$escapeHtml("Show \x27Do More with JIRA\x27"), '</a></span></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:admin-dashboard-item-resources', location = 'script/gadget-plugin-installer.js' */
AJS.namespace("AJS.gadget.plugin.installer");AJS.gadget.plugin.installer=function(key,setupPath){var pollTimeout,pollInterval=500,contentType="application/vnd.atl.plugins.install.uri+json",pluginDisplayName,progressPopup=displayPluginInstallDialog();getLatestSupportedPluginVersion();function getLatestSupportedPluginVersion(){window.top.JIRA.SmartAjax.makeWebSudoRequest({type:"GET",url:window.top.contextPath+"/rest/plugins/1.0/available/"+key,dataType:"json",contentType:contentType,global:false},{cancel:function(e){e.preventDefault()}}).fail(function(xhr){progressPopup.show();progressPopup.setError(AJS.format("Failed to obtain the details of plugin with key {0}. Status: {1}. URL: {2}.",key,xhr.status,this.url))}).done(installPlugin)}function installPlugin(response){pluginDisplayName=response.name;var url=response.links.binary;window.top.JIRA.SmartAjax.makeWebSudoRequest({type:"head",url:window.top.contextPath+"/rest/plugins/1.0/",cache:false,complete:function(xhr,textStatus,response){if(textStatus==="success"){var token=xhr.getResponseHeader("upm-token");installPluginViaPost(url,token)}else{progressPopup.show();progressPopup.setError(AJS.format("{0} install failed. Status: {1}. URL: {2}.",pluginDisplayName,xhr.status,this.url))}}})}function installPluginViaPost(pluginUri,token){window.top.JIRA.SmartAjax.makeWebSudoRequest({type:"POST",url:window.top.contextPath+"/rest/plugins/1.0/?token="+token,dataType:"json",contentType:contentType,data:JSON.stringify({pluginUri:pluginUri}),globalThrobber:false,global:false,success:function(response){progressPopup.show();updatePluginInstallStatus(response);pollInstallStatus(response)},error:function(xhr){progressPopup.setError(AJS.format("{0} install failed. Status: {1}. URL: {2}.",pluginDisplayName,xhr.status,this.url))}})}function pollInstallStatus(response){AJS.$.ajax({method:"GET",url:getCleanUri(response.links.self),contentType:contentType,success:parsePollResponse,global:false,globalThrobber:false,error:function(xhr){if(xhr.status===0){return }progressPopup.setError(AJS.format("{0} download failed. Status: {1}. URL: {2}.",pluginDisplayName,xhr.status,this.url))}})}function parsePollResponse(response){updatePluginInstallStatus(response);pollTimeout=setTimeout(function(){pollInstallStatus(response)},pollInterval)}function updatePluginInstallStatus(response){if(response.status){var statusText="Initializing.";if(response.status.amountDownloaded&&response.status.amountDownloaded>0){var percent=parseInt((response.status.amountDownloaded/response.status.totalSize)*100);progressPopup.setPercent(percent);if(percent<100){statusText=AJS.format("Downloading {0}.",response.status.source)}else{statusText=AJS.format("Installing {0}.",response.status.source)}}progressPopup.setText(statusText)}else{if(response.vendor){clearTimeout(pollTimeout);progressPopup.hideImage();progressPopup.setText(AJS.format("{0} successfully installed.",pluginDisplayName));getLatestPluginDetails()}}}function getLatestPluginDetails(){window.top.JIRA.SmartAjax.makeWebSudoRequest({type:"GET",url:window.top.contextPath+"/rest/plugins/1.0/"+key,dataType:"json",contentType:contentType,global:false},{cancel:function(e){e.preventDefault()}}).fail(function(xhr){progressPopup.show();progressPopup.setError(AJS.format("Failed to obtain the details of plugin with key {0}. Status: {1}. URL: {2}.",key,xhr.status,this.url))}).done(redirectToSetupPath)}function redirectToSetupPath(response){if(typeof (response.licenseDetails)==="undefined"){setTimeout(function(){window.top.location.href=window.top.contextPath+setupPath},1000)}}function getCleanUri(uri){if(!AJS.contextPath()&&uri.indexOf(window.top.contextPath)===0){uri=uri.substr(uri.indexOf(window.top.contextPath)+window.top.contextPath.length)}return uri}function displayPluginInstallDialog(){var container;if(window.top.AJS.$("#upm-progress-popup")){window.top.AJS.$("#upm-progress-popup").remove()}var dialog=new window.top.JIRA.Dialog({width:400,height:175,content:function(callback){callback(JIRA.Templates.Gadgets.upmProgress())},id:"upm-progress-popup"});dialog.show();function getContainer(){if(!container){container=window.top.AJS.$("#upm-progress-popup")}return container}function hideImage(){getContainer().find("img").hide()}function hideProgress(){getContainer().find(".upm-progress-bar-container").hide()}return{show:function(){dialog.show()},destroy:function(){dialog.destroy()},setPercent:function(percent){getContainer().find(".upm-progress-bar-percent").text(percent);getContainer().find(".upm-progress-amount").css({width:percent+"%"})},hideImage:hideImage,setText:function(text){getContainer().find(".upm-progress-text").text(text)},setError:function(text){hideImage();hideProgress();getContainer().find(".upm-progress-text").text(text)}}}};;
;/* module-key = 'com.atlassian.jira.gadgets:admin-dashboard-item-resources', location = 'static/dashboarditem/admin/admin.js' */
define("jira-dashboard-items/admin",["jquery"],function($){function installGreenHopper(event){event.preventDefault();AJS.gadget.plugin.installer("com.pyxis.greenhopper.jira-key","/secure/SetupGreenHopper!default.jspa")}function installBonfire(event){event.preventDefault();AJS.gadget.plugin.installer("com.atlassian.bonfire.plugin-key","/secure/SetupBonfire!default.jspa")}function taskCheckboxClicked(element){var $element=$(element);var $task=$element.parents(".admin-task");if($task.hasClass("admin-task-disabled")){return }var $taskList=$element.parents(".admin-task-list");var $taskListContainer=$element.parents(".admin-task-list-container");var taskName=$task.find(".admin-task-content").data("name");var eventName;var restUrl;if($task.hasClass("admin-task-completed")){$task.removeClass("admin-task-completed");eventName="xlane.admingadget.task."+taskName+".unchecked";restUrl=AJS.contextPath()+"/rest/gadget/1.0/admin/task/undone"}else{$task.addClass("admin-task-completed");eventName="xlane.admingadget.task."+taskName+".checked";restUrl=AJS.contextPath()+"/rest/gadget/1.0/admin/task/done"}if($taskList.find(".admin-task:not(.admin-task-completed)").length===0){$taskListContainer.find(".hide-admin-task-list-completed").show();$taskListContainer.find(".hide-admin-task-list-not-completed").hide()}else{$taskListContainer.find(".hide-admin-task-list-not-completed").show();$taskListContainer.find(".hide-admin-task-list-completed").hide()}$.ajax({url:restUrl+"?name="+taskName,type:"PUT",global:false});AJS.trigger("analyticsEvent",{name:eventName})}function showTaskList(element,gadget,event,API){event.preventDefault();var $element=$(element);var $gadget=$(gadget);var name=$element.parents(".admin-task-list-unhide").attr("aria-owns");var $taskList=$gadget.find(".admin-task-container").filter("[data-name="+name+"]");var $separator=$gadget.find(".unhide-separator");$separator.hide();var $unhideContainer=$element.parents(".admin-task-list-unhide");$unhideContainer.hide();$taskList.slideDown("slow",function(){API.forceLayoutRefresh()});$.ajax({url:AJS.contextPath()+"/rest/gadget/1.0/admin/tasklist/undone?name="+name,type:"PUT",global:false});var eventName="xlane.admingadget.tasklist."+name+".unhide";AJS.trigger("analyticsEvent",{name:eventName})}function taskContentClicked(element,event){var $task=$(element);if($task.hasClass("admin-task-disabled")){event.preventDefault();return }var taskName=$(this).data("name");AJS.trigger("analyticsEvent",{name:"xlane.admingadget.task."+taskName+".clicked"})}function createIssueClicked(event){event.preventDefault();var $task=$(this);if($task.hasClass("admin-task-disabled")){return }AJS.$(".create-issue").click()}function hideTaskList(element,gadget,event,API){event.preventDefault();var $element=$(element);var $gadget=$(gadget);var $container=$element.parents(".admin-task-container");var name=$container.data("name");var $unhideContainer=$gadget.find(".admin-task-list-unhide").filter("[aria-owns="+name+"]");var eventName="xlane.admingadget.tasklist."+name+".hide";var $separator=$gadget.find(".unhide-separator");if($gadget.find(".admin-task-list-unhide :visible").length==1){$separator.show()}$container.slideUp("slow",function(){API.forceLayoutRefresh()});$unhideContainer.show();$.ajax({url:AJS.contextPath()+"/rest/gadget/1.0/admin/tasklist/done?name="+name,type:"PUT",global:false});var completed=Boolean($element.parents(".hide-admin-task-list-completed").length);AJS.trigger("analyticsEvent",{name:eventName,properties:{completed:completed}})}var DashboardItem=function(API){this.API=API};DashboardItem.prototype.render=function(element){var $element=$(element);var API=this.API;$element.on("click",".greenHopperInstall",installGreenHopper);$element.on("click",".bonfireInstall",installBonfire);$element.on("click",".greenHopperInstallOD",function(e){taskCheckboxClicked(this,e)});$element.on("click",".bonfireInstallOD",function(){taskCheckboxClicked(this)});$element.on("click",".admin-task .admin-task-checkbox",function(){taskCheckboxClicked(this)});$element.on("click",".hide-admin-task-list",function(e){hideTaskList(this,element,e,API)});$element.on("click",".show-admin-task-list",function(e){showTaskList(this,element,e,API)});$element.on("click",".admin-task-content",function(e){taskContentClicked(this,e)});$element.on("click",".create-issue-trigger",createIssueClicked)};return DashboardItem});;
;/* module-key = 'com.atlassian.gadgets.publisher:dashboard-item-common', location = 'dashboard-item/common/dashboard-item-common.soy' */
// This file was automatically generated from dashboard-item-common.soy.
// Please don't edit this file by hand.

if (typeof Atlassian == 'undefined') { var Atlassian = {}; }
if (typeof Atlassian.DashboardItem == 'undefined') { Atlassian.DashboardItem = {}; }
if (typeof Atlassian.DashboardItem.Common == 'undefined') { Atlassian.DashboardItem.Common = {}; }
if (typeof Atlassian.DashboardItem.Common.Templates == 'undefined') { Atlassian.DashboardItem.Common.Templates = {}; }


Atlassian.DashboardItem.Common.Templates.config = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="dashboard-item-preferences-config"><div class="dashboard-item-error"></div><form action="#" method="post" class="aui">', opt_data.fields, '<div class="buttons-container"><div class="buttons"><input class="button submit" type="submit" value="', soy.$$escapeHtml("Save"), '">', (opt_data.isConfigured) ? '<input class="aui-button aui-button-link cancel" type="button" value="' + soy.$$escapeHtml("Cancel") + '">' : '', '</div></div></form></div>');
  return opt_sb ? '' : output.toString();
};


Atlassian.DashboardItem.Common.Templates.refreshInterval = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy16 = opt_data.prefix + opt_data.id;
  output.append('<div class="field-group ', soy.$$escapeHtml(opt_data.id), '"><label for="', soy.$$escapeHtml(prefixedId__soy16), '">', soy.$$escapeHtml("Auto refresh"), '</label><div class="checkbox"><label><input type="checkbox" id="', soy.$$escapeHtml(prefixedId__soy16), '" name="', soy.$$escapeHtml(opt_data.id), '" value="15" class="checkbox" ', (opt_data.value != 'false' && opt_data.value != '') ? 'checked="checked"' : '', '>', soy.$$escapeHtml("Update every 15 minutes"), '</label></div><div class="description">&nbsp;</div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/dropdown/Dropdown.js' */
JIRA.Dropdown=function(){var instances=[];return{addInstance:function(){instances.push(this)},hideInstances:function(){var that=this;jQuery(instances).each(function(){if(that!==this){this.hideDropdown()}})},getHash:function(){if(!this.hash){this.hash={container:this.dropdown,hide:this.hideDropdown,show:this.displayDropdown}}return this.hash},displayDropdown:function(){if(JIRA.Dropdown.current===this){return }this.hideInstances();JIRA.Dropdown.current=this;this.dropdown.css({display:"block"});this.displayed=true;var dd=this.dropdown;if(window.top.JIRA&&!window.top.JIRA.Dialog.current){setTimeout(function(){var win=jQuery(window);var minScrollTop=dd.offset().top+dd.prop("offsetHeight")-win.height()+10;if(win.scrollTop()<minScrollTop){jQuery("html,body").animate({scrollTop:minScrollTop},300,"linear")}},100)}},hideDropdown:function(){if(this.displayed===false){return }JIRA.Dropdown.current=null;this.dropdown.css({display:"none"});this.displayed=false},init:function(trigger,dropdown){var that=this;this.addInstance(this);this.dropdown=jQuery(dropdown);this.dropdown.css({display:"none"});jQuery(document).keydown(function(e){if(e.keyCode===9){that.hideDropdown()}});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{that.dropdown.css("top",jQuery(trigger).outerHeight()+"px");trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}else{that.hideDropdown()}e.preventDefault()})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})}}}();JIRA.Dropdown.Standard=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init(trigger,dropdown);return that};JIRA.Dropdown.AutoComplete=function(trigger,dropdown){var that=begetObject(JIRA.Dropdown);that.init=function(trigger,dropdown){this.addInstance(this);this.dropdown=jQuery(dropdown).click(function(e){e.stopPropagation()});this.dropdown.css({display:"none"});if(trigger.target){jQuery.aop.before(trigger,function(){if(!that.displayed){that.displayDropdown()}})}else{trigger.click(function(e){if(!that.displayed){that.displayDropdown();e.stopPropagation()}})}jQuery(document.body).click(function(){if(that.displayed){that.hideDropdown()}})};that.init(trigger,dropdown);return that};AJS.namespace("jira.widget.dropdown",null,JIRA.Dropdown);;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/AutoComplete.js' */
define("jira/autocomplete/autocomplete",["jira/ajs/ajax/smart-ajax","jira/util/objects","jquery"],function(SmartAjax,Objects,jQuery){return function(){var inFocus;var delay=function(callback,l){if(delay.t){clearTimeout(delay.t);delay.t=undefined}delay.t=setTimeout(callback,l*1000)};var INVALID_KEYS={9:true,13:true,14:true,25:true,27:true,38:true,40:true,224:true};return{dispatcher:function(){},getSavedResponse:function(){},saveResponse:function(){},renderSuggestions:function(){},disable:function(){this.disabled=true},enable:function(){this.disabled=false},set:function(options){for(var name in options){if(options.hasOwnProperty(name)){this[name]=options[name]}}},completeField:function(value){if(value){this.field.val(value).focus();this.field.trigger("change")}},textToSuggestionCursorPosition:function(){return this.field.val()},_makeRequest:function(options){var that=this,requestParams=Objects.copyObject(options);if(this.pendingRequest){this.pendingRequest.abort()}requestParams.complete=function(){that.pendingRequest=null};requestParams.error=function(xhr){if(!xhr.aborted&&xhr.status!==0&&options.error){options.error.apply(this,arguments)}};return this.pendingRequest=SmartAjax.makeRequest(requestParams)},addSuggestionControls:function(suggestionNodes){var that=this;var evaluateIndex=function(idx,max){var minBoundary=(that.autoSelectFirst===false)?-1:0;if(that.allowArrowCarousel){if(idx>max){return minBoundary}else{if(idx<minBoundary){return max}else{return idx}}}else{if(idx>max){return max}else{if(idx<minBoundary){that.responseContainer.scrollTop(0);return minBoundary}else{return idx}}}};var setActive=function(idx){if(that.selectedIndex!==undefined&&that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].removeClass("active")}that.selectedIndex=evaluateIndex(idx,that.suggestionNodes.length-1);if(that.selectedIndex>-1){that.suggestionNodes[that.selectedIndex][0].addClass("active")}};var evaluateIfActive=function(){return that.suggestionNodes&&that.suggestionNodes[that.selectedIndex]&&that.suggestionNodes[that.selectedIndex][0].hasClass("active")};var keyPressHandler=function(e){if(that.responseContainer.is(":visible")){if(e.keyCode===13){if(evaluateIfActive()&&!that.pendingRequest){that.completeField(that.suggestionNodes[that.selectedIndex][1])}e.preventDefault();e.stopPropagation()}}};var keyboardNavigateHandler=function(e){if(that.responseContainer.is(":visible")){if(that.field[0]!==document.activeElement){that.field.focus()}if(e.keyCode===40){setActive(that.selectedIndex+1);if(that.selectedIndex>=0){var containerHeight=that.responseContainer.height();var bottom=that.suggestionNodes[that.selectedIndex][0].position().top+that.suggestionNodes[that.selectedIndex][0].outerHeight();if(bottom-containerHeight>0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+bottom-containerHeight+2)}}else{that.responseContainer.scrollTop(0)}e.preventDefault()}else{if(e.keyCode===38){setActive(that.selectedIndex-1);if(that.selectedIndex>=0){var top=that.suggestionNodes[that.selectedIndex][0].position().top;if(top<0){that.responseContainer.scrollTop(that.responseContainer.scrollTop()+top-2)}}e.preventDefault()}else{if(e.keyCode===9){if(evaluateIfActive()){that.completeField(that.suggestionNodes[that.selectedIndex][1]);e.preventDefault()}else{that.dropdownController.hideDropdown()}}}}}};if(suggestionNodes.length){this.selectedIndex=0;this.suggestionNodes=suggestionNodes;for(var i=0;i<that.suggestionNodes.length;i++){var eventData={instance:this,index:i};this.suggestionNodes[i][0].bind("mouseover",eventData,activate).bind("mouseout",eventData,deactivate).bind("click",eventData,complete)}if(!this.keyboardHandlerBinded){jQuery(this.field).keypress(keyPressHandler);jQuery(this.field).keydown(keyboardNavigateHandler);this.keyboardHandlerBinded=true}if(that.autoSelectFirst===false){setActive(-1)}else{setActive(0)}inFocus=this}function activate(event){if(that.dropdownController.displayed){setActive(event.data.index)}}function deactivate(event){if(event.data.index===0){that.selectedIndex=-1}jQuery(this).removeClass("active")}function complete(event){that.completeField(that.suggestionNodes[event.data.index][1])}},clearResponseContainer:function(){this.responseContainer.empty();this.suggestionNodes=undefined},delay:delay,buildResponseContainer:function(){var inputParent=this.field.parent().addClass("atlassian-autocomplete");this.responseContainer=jQuery(document.createElement("div"));this.responseContainer.addClass("suggestions");this.positionResponseContainer();this.responseContainer.appendTo(inputParent)},positionResponseContainer:function(){this.responseContainer.css({top:this.field.outerHeight()})},keyUpHandler:(function(){function callback(){if(!this.responseContainer){this.buildResponseContainer()}this.dispatcher(this.field.val())}return function(e){if(this.field.val().length>=this.minQueryLength){if(!(e.keyCode in INVALID_KEYS)||(this.responseContainer&&!this.responseContainer.is(":visible")&&(e.keyCode==38||e.keyCode==40))){callback.call(this)}}return e}})(),addMultiSelectAdvice:function(delim){var that=this;var alertUserValueAlreadyExists=function(val){if(!alertUserValueAlreadyExists.isAlerting){alertUserValueAlreadyExists.isAlerting=true;var userAlert=jQuery(document.createElement("div")).css({"float":"left",display:"none"}).addClass("warningBox").html("Oops! You have already entered the value <em>"+val+"</em>").appendTo(that.field.parent()).show("fast",function(){that.delay(function(){userAlert.hide("fast",function(){userAlert.remove();alertUserValueAlreadyExists.isAlerting=false})},4)})}};jQuery.aop.before({target:this,method:"dispatcher"},function(innvocation){var val=this.field.val();innvocation[0]=jQuery.trim(val.slice(val.lastIndexOf(delim)+1));return innvocation});jQuery.aop.before({target:this,method:"completeField"},function(args){var valueToAdd=args[0],untrimmedVals=this.field.val().split(delim);var trimmedVals=jQuery(untrimmedVals).map(function(){return jQuery.trim(this)}).get();if(!this.allowDuplicates&&new RegExp("(?:^|[\\s"+delim+"])"+valueToAdd+"\\s*"+delim).test(this.field.val())){alertUserValueAlreadyExists(valueToAdd);trimmedVals[trimmedVals.length-1]=""}else{trimmedVals[trimmedVals.length-1]=valueToAdd;trimmedVals[trimmedVals.length]=""}args[0]=trimmedVals.join(delim.replace(/([^\s]$)/,"$1 "));return args})},addDropdownAdvice:function(){var that=this;jQuery.aop.after({target:this,method:"buildResponseContainer"},function(args){this.dropdownController=JIRA.Dropdown.AutoComplete({target:this,method:"renderSuggestions"},this.responseContainer);jQuery.aop.after({target:this.dropdownController,method:"hideDropdown"},function(){this.dropdown.removeClass("dropdown-ready")});return args});jQuery.aop.after({target:this,method:"renderSuggestions"},function(args){if(args&&args.length>0){this.dropdownController.displayDropdown();if(this.maxHeight&&this.dropdownController.dropdown.prop("scrollHeight")>this.maxHeight){this.dropdownController.dropdown.css({height:this.maxHeight,overflowX:"visible",overflowY:"scroll"})}else{if(this.maxHeight){this.dropdownController.dropdown.css({height:"",overflowX:"",overflowY:""})}}this.dropdownController.dropdown.addClass("dropdown-ready")}else{this.dropdownController.hideDropdown()}return args});jQuery.aop.after({target:this,method:"completeField"},function(args){this.dropdownController.hideDropdown();return args});jQuery.aop.after({target:this,method:"keyUpHandler"},function(e){if((!(this.field.val().length>=this.minQueryLength)||e.keyCode===27)&&this.dropdownController&&this.dropdownController.displayed){this.dropdownController.hideDropdown();if(e.keyCode===27){e.stopPropagation()}}return e})},init:function(options){var that=this;this.set(options);this.field=this.field||jQuery("#"+this.fieldID);this.field.attr("autocomplete","off").keyup(function(e){if(!that.disabled){that.keyUpHandler(e)}}).keydown(function(e){var ESC_KEY=27;if(e.keyCode===ESC_KEY&&that.responseContainer&&that.responseContainer.is(":visible")){e.preventDefault()}}).click(function(e){if(inFocus===that){e.stopPropagation()}}).blur(function(){if(that.pendingRequest){that.pendingRequest.abort()}});this.addDropdownAdvice();if(options.delimChar){this.addMultiSelectAdvice(options.delimChar)}}}}()});AJS.namespace("jira.widget.autocomplete",null,require("jira/autocomplete/autocomplete"));AJS.namespace("JIRA.AutoComplete",null,require("jira/autocomplete/autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/RESTAutoComplete.js' */
define("jira/autocomplete/rest-autocomplete",["jira/autocomplete/autocomplete","jira/util/objects"],function(AutoComplete,Objects){return function(){var that=Objects.begetObject(AutoComplete);that.dispatcher=function(reqFieldVal){var that=this;if(reqFieldVal.length<this.minQueryLength){return }if(!this.getSavedResponse(reqFieldVal)){this.delay(function(){var params=that.getAjaxParams();params.data.query=reqFieldVal;params.success=function(data){that.saveResponse(reqFieldVal,data);that.responseContainer.scrollTop(0);that.renderSuggestions(data)};that._makeRequest(params)},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(reqFieldVal));that.responseContainer.scrollTop(0)}};that.getAjaxParams=function(){};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};return that}()});AJS.namespace("jira.widget.autocomplete.REST",null,require("jira/autocomplete/rest-autocomplete"));AJS.namespace("JIRA.RESTAutoComplete",null,require("jira/autocomplete/rest-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/IssueAutoComplete.js' */
define("jira/autocomplete/issue-autocomplete",["jira/autocomplete/rest-autocomplete","jira/util/objects","jquery"],function(RESTAutoComplete,Objects,jQuery){var IssueAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/2/issue/picker",data:options.ajaxData,dataType:"json",type:"GET"}};that.renderSuggestions=function(response){var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.sections&&response.sections.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.sections).each(function(){var section=this;var subSection=jQuery("<div/>").attr("id",options.fieldID+"_s_"+section.id).addClass("yag").text(section.label);if(section.sub){subSection.append(jQuery("<span/>").addClass("yagt").text("("+section.sub+")"))}resultsContainer.append(jQuery("<li/>").append(subSection).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}));if(section.msg){var msg=jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_n").addClass("yad").text(section.msg);resultsContainer.append(jQuery("<li/>").append(msg).mouseover(function(){jQuery(this).addClass("active")}).mouseout(function(){jQuery(this).removeClass("active")}))}if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){var imgUrl;if(/^http/.test(this.img)){imgUrl=this.img}else{imgUrl=contextPath+this.img}var issueNode=jQuery("<li/>").append(jQuery("<div/>").attr("id",options.fieldID+"_i_"+section.id+"_"+this.key).addClass("yad").append(jQuery("<table/>").addClass("yat").attr({cellpadding:"0",cellspacing:"0"}).append(jQuery("<tr/>").append(jQuery("<td/>").append(jQuery("<img/>").attr("src",imgUrl))).append(jQuery("<td/>").append(jQuery("<div/>").addClass("yak").html(this.keyHtml))).append(jQuery("<td/>").css("width","100%").html(this.summary)))));resultsContainer.append(issueNode);suggestionNodes.push([issueNode,this.key])})}});that.addSuggestionControls(suggestionNodes);return suggestionNodes}};options.minQueryLength=1;options.queryDelay=0.25;that.init(options);return that};IssueAutoComplete.init=function(){jQuery("fieldset.issue-picker-params").each(function(){var params=JIRA.parseOptionsFromFieldset(jQuery(this)),$container=jQuery("#"+params.fieldId+"-container").add("#"+params.fieldName+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath+"/secure/popups/IssuePicker.jspa?";url+="currentIssue="+params.currentIssueKey+"&";url+="singleSelectOnly="+params.singleSelectOnly+"&";url+="showSubTasks="+params.showSubTasks+"&";url+="showSubTasksParent="+params.showSubTaskParent;if(params.currentProjectId&&params.currentProjectId!=""){url+="&selectedProjectId="+params.currentProjectId}JIRA.IssuePicker.callback=function(keysMap){var $formElement,keys=[];keysMap=JSON.parse(keysMap);if(params.fieldId&&keys){$formElement=jQuery("#"+params.fieldId);if($formElement){jQuery.each(keysMap,function(){keys.push(this.value)});$formElement.val(keys.join(", "))}}};var vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width=620,height=500,scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});if(!params.fieldId){params.fieldId=params.fieldName}if(params.issuePickerEnabled===true){IssueAutoComplete({fieldID:params.fieldId,delimChar:params.singleSelectOnly===true?undefined:",",ajaxData:params})}})};return IssueAutoComplete});AJS.namespace("jira.widget.autocomplete.Issues",null,require("jira/autocomplete/issue-autocomplete"));AJS.namespace("JIRA.IssueAutoComplete",null,require("jira/autocomplete/issue-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/UserAutoComplete.js' */
define("jira/autocomplete/user-autocomplete",["jira/autocomplete/rest-autocomplete","jira/data/parse-options-from-fieldset","jira/util/browser","jira/util/elements","jira/util/objects","jquery"],function(RESTAutoComplete,parseOptionsFromFieldset,Browser,Elements,Objects,jQuery){var UserAutoComplete=function(options){var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:contextPath+"/rest/api/1.0/users/picker",data:{fieldName:options.fieldID,fieldConfigId:options.fieldConfigID,projectId:options.projectId},dataType:"json",type:"GET"}};function fieldsFormHasBeenSubmitted(field){var submitting=false,form=field.closest("form");if(form.length&&form.hasClass("submitting")){submitting=true}return submitting}that.renderSuggestions=function(response){if(fieldsFormHasBeenSubmitted(this.field)||!Browser.isSelenium()&&!Elements.elementIsFocused(this.field)){return false}var resultsContainer,suggestionNodes=[];this.clearResponseContainer();if(response&&response.users&&response.users.length>0){resultsContainer=jQuery("<ul/>").appendTo(this.responseContainer);jQuery(response.users).each(function(){suggestionNodes.push([jQuery("<li/>").html(this.html).appendTo(resultsContainer),this.name])})}if(response.footer){this.responseContainer.append(jQuery("<div/>").addClass("yui-ac-ft").html(response.footer).css("display","block"))}if(suggestionNodes.length>0){that.addSuggestionControls(suggestionNodes);jQuery(".atlassian-autocomplete div.yad, .atlassian-autocomplete .labels li").textOverflow({autoUpdate:true})}return suggestionNodes};options.minQueryLength=2;options.queryDelay=0.25;that.init(options);return that};UserAutoComplete.init=function(parent){jQuery("fieldset.user-picker-params",parent).each(function(){var params=parseOptionsFromFieldset(jQuery(this)),field=(params.fieldId||params.fieldName),$container=jQuery("#"+field+"_container");$container.find("a.popup-trigger").click(function(e){var url=contextPath,vWinUsers;e.preventDefault();if(!params.formName){params.formName=$container.find("#"+field).parents("form").attr("name")}if(params.actionToOpen){url=url+params.actionToOpen}else{url=url+"/secure/popups/UserPickerBrowser.jspa"}url+="?formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+field;if(params.fieldConfigId){url+="&fieldConfigId="+params.fieldConfigId}if(params.projectId){if(jQuery.isArray(params.projectId)){for(var projectId in params.projectId){url+="&projectId="+projectId}}else{url+="&projectId="+params.projectId}}vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus()});if(params.userPickerEnabled===true){UserAutoComplete({field:parent?parent.find("#"+field):null,fieldID:field,fieldConfigID:params.fieldConfigId,projectId:params.projectId,delimChar:params.multiSelect===false?undefined:",",ajaxData:{fieldName:params.fieldName}})}})};return UserAutoComplete});AJS.namespace("jira.widget.autocomplete.Users",null,require("jira/autocomplete/user-autocomplete"));AJS.namespace("JIRA.UserAutoComplete",null,require("jira/autocomplete/user-autocomplete"));;
;/* module-key = 'jira.webresources:autocomplete', location = '/includes/jira/autocomplete/initAutoCompleteFields.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){JIRA.UserAutoComplete.init(context);JIRA.IssueAutoComplete.init(context)}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){AJS.$("fieldset.user-searcher-params",context).each(function(){var params=JIRA.parseOptionsFromFieldset(AJS.$(this)),$container=AJS.$("#"+params.fieldId+"_container",context);if(params.userPickerEnabled===true){var autocompleter=JIRA.UserAutoComplete({fieldID:params.fieldId,delimChar:params.multiSelect===true?",":undefined,ajaxData:{fieldName:params.fieldName}})}var setupFields=function(related){var field=AJS.$("#"+params.fieldId,context);var userImage=AJS.$("#"+params.fieldId+"Image",context);var groupImage=AJS.$("#"+params.fieldId+"GroupImage",context);var fieldDesc=AJS.$("#"+params.fieldId+"_desc",context);if(related==="select.list.none"){field.val("").attr("disabled","true");userImage.hide();groupImage.hide();fieldDesc.hide()}else{field.removeAttr("disabled");if(related==="select.list.group"){userImage.hide();groupImage.show();if(params.userPickerEnabled===true){autocompleter.disable();fieldDesc.hide()}}else{userImage.show();groupImage.hide();if(params.userPickerEnabled===true){autocompleter.enable();fieldDesc.show()}}}};AJS.$("#"+params.userSelect,context).change(function(){var related=AJS.$(this).find("option:selected").attr("rel");setupFields(related)}).find("option:selected").each(function(){setupFields(AJS.$(this).attr("rel"))});$container.find("a.user-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/UserPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"UserPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()});$container.find("a.group-popup-trigger").click(function(e){var url=contextPath+"/secure/popups/GroupPickerBrowser.jspa?";url+="formName="+params.formName+"&";url+="multiSelect="+params.multiSelect+"&";url+="decorator=popup&";url+="element="+params.fieldId;var vWinUsers=window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes");vWinUsers.opener=self;vWinUsers.focus();e.preventDefault()})})}});;
;/* module-key = 'com.atlassian.jira.gadgets:project-filter-autocomplete-component', location = 'static/components/project-filter-autocomplete/project-filter-autocomplete.soy' */
// This file was automatically generated from project-filter-autocomplete.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.ProjectFilterAutoComplete == 'undefined') { JIRA.DashboardItem.ProjectFilterAutoComplete = {}; }
if (typeof JIRA.DashboardItem.ProjectFilterAutoComplete.Config == 'undefined') { JIRA.DashboardItem.ProjectFilterAutoComplete.Config = {}; }
if (typeof JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates == 'undefined') { JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates = {}; }


JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates.SuggestionSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'suggestionBlock\'><h5>', soy.$$escapeHtml(opt_data.sectionTitle), '</h5><ul class=\'aui-list-section\'></ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates.SuggestionProject = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="aui-list-item" data-type="project" data-id="', soy.$$escapeHtml(opt_data.suggestion.id), '"><a href="#" class="aui-list-item-link aui-indented-link" target="_parent">', opt_data.suggestion.html, '(', soy.$$escapeHtml(opt_data.suggestion.key), ')</a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates.SuggestionFilter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="aui-list-item" data-type="filter" data-id="', soy.$$escapeHtml(opt_data.suggestion.id), '"><a href="#" class="aui-list-item-link aui-indented-link" target="_parent">', opt_data.suggestion.nameHtml, '</a></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates.projectFilterPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy23 = opt_data.prefix + opt_data.id;
  output.append('<div class="field-group"><label for="', soy.$$escapeHtml(prefixedId__soy23), '">', soy.$$escapeHtml("Project or Saved Filter:"), '<span class="aui-icon icon-required"> ', soy.$$escapeHtml("required"), '</span></label><div class="builder-container"><input type="hidden" name="name" ', (opt_data.selectionName) ? 'value="' + soy.$$escapeHtml(opt_data.selectionName) + '"' : '', '><input type="hidden" name="type" ', (opt_data.selectionType) ? 'value="' + soy.$$escapeHtml(opt_data.selectionType) + '"' : '', '><input type="hidden" name="id" ', (opt_data.selectionID) ? 'value="' + soy.$$escapeHtml(opt_data.selectionID) + '"' : '', '><span class="filterpicker-value-name field-value">', (opt_data.selectionName) ? soy.$$escapeHtml(opt_data.selectionName) : soy.$$escapeHtml("No Filter/Project selected"), '</span><div class="quick-find"><input class="text" id="', soy.$$escapeHtml(prefixedId__soy23), '" placeholder="', soy.$$escapeHtml("Search"), '"><span class="inline-error"></span></div></div><div class="projectOrFilter-error error"></div><div class="description">', soy.$$escapeHtml("Project or saved filter to use as the basis for the graph."), '</div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:project-filter-autocomplete-component', location = 'static/components/project-filter-autocomplete/ProjectFilterAutoComplete.js' */
define("jira-dashboard-items/components/autocomplete/project-filter-autocomplete",["jira/autocomplete/rest-autocomplete","jira/util/objects","jquery"],function(RESTAutoComplete,Objects,jQuery){var Templates=JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates;var ProjectFilterAutoComplete=function(options){options=options||{};var that=Objects.begetObject(RESTAutoComplete);that.getAjaxParams=function(){return{url:AJS.contextPath()+"/rest/gadget/1.0/pickers/projectsAndFilters",data:options.ajaxData||{},dataType:"json",type:"GET"}};if(options.completeField){that.completeField=options.completeField}var createSuggestionBlock=function(element,sectionType,sectionName,data,renderer){var suggestionNodes=[];var suggestionSectionElement=jQuery(Templates.SuggestionSection({sectionTitle:sectionName}));var suggestionSectionList=suggestionSectionElement.find("ul.aui-list-section");jQuery(data).each(function(){var suggestion=this;var suggestionElement=jQuery(renderer({suggestion:suggestion}));suggestion.type=sectionType;suggestionElement.mouseover(function(){jQuery(this).addClass("active")});suggestionNodes.push([suggestionElement,suggestion]);suggestionSectionList.append(suggestionElement)});element.append(suggestionSectionElement);return suggestionNodes};that.renderSuggestions=function(response){this.clearResponseContainer();this.responseContainer.addClass("aui-list");var suggestionNodes=[];if(response&&response.projects&&response.projects.length>0){var projectSectionNodes=createSuggestionBlock(this.responseContainer,"project","Projects",response.projects,Templates.SuggestionProject);suggestionNodes=suggestionNodes.concat(projectSectionNodes)}if(response&&response.filters&&response.filters.length>0){var filterSectionNodes=createSuggestionBlock(this.responseContainer,"filter","Filters",response.filters,Templates.SuggestionFilter);suggestionNodes=suggestionNodes.concat(filterSectionNodes)}this.responseContainer.find(".aui-list-item-link").click(function(event){event.preventDefault()});that.addSuggestionControls(suggestionNodes);return suggestionNodes};options.minQueryLength=1;options.queryDelay=0.25;that.init(options);return that};return ProjectFilterAutoComplete});;
;/* module-key = 'com.atlassian.jira.gadgets:d3', location = 'static/lib/d3.min.js' */
!function(){function n(n,t){return t>n?-1:n>t?1:n>=t?0:0/0}function t(n){return null!=n&&!isNaN(n)}function e(n){return{left:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)<0?r=i+1:u=i}return r},right:function(t,e,r,u){for(arguments.length<3&&(r=0),arguments.length<4&&(u=t.length);u>r;){var i=r+u>>>1;n(t[i],e)>0?u=i:r=i+1}return r}}}function r(n){return n.length}function u(n){for(var t=1;n*t%1;)t*=10;return t}function i(n,t){try{for(var e in t)Object.defineProperty(n.prototype,e,{value:t[e],enumerable:!1})}catch(r){n.prototype=t}}function o(){}function a(n){return ia+n in this}function c(n){return n=ia+n,n in this&&delete this[n]}function s(){var n=[];return this.forEach(function(t){n.push(t)}),n}function l(){var n=0;for(var t in this)t.charCodeAt(0)===oa&&++n;return n}function f(){for(var n in this)if(n.charCodeAt(0)===oa)return!1;return!0}function h(){}function g(n,t,e){return function(){var r=e.apply(t,arguments);return r===t?n:r}}function p(n,t){if(t in n)return t;t=t.charAt(0).toUpperCase()+t.substring(1);for(var e=0,r=aa.length;r>e;++e){var u=aa[e]+t;if(u in n)return u}}function v(){}function d(){}function m(n){function t(){for(var t,r=e,u=-1,i=r.length;++u<i;)(t=r[u].on)&&t.apply(this,arguments);return n}var e=[],r=new o;return t.on=function(t,u){var i,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,e=e.slice(0,i=e.indexOf(o)).concat(e.slice(i+1)),r.remove(t)),u&&e.push(r.set(t,{on:u})),n)},t}function y(){Zo.event.preventDefault()}function x(){for(var n,t=Zo.event;n=t.sourceEvent;)t=n;return t}function M(n){for(var t=new d,e=0,r=arguments.length;++e<r;)t[arguments[e]]=m(t);return t.of=function(e,r){return function(u){try{var i=u.sourceEvent=Zo.event;u.target=n,Zo.event=u,t[u.type].apply(e,r)}finally{Zo.event=i}}},t}function _(n){return sa(n,pa),n}function b(n){return"function"==typeof n?n:function(){return la(n,this)}}function w(n){return"function"==typeof n?n:function(){return fa(n,this)}}function S(n,t){function e(){this.removeAttribute(n)}function r(){this.removeAttributeNS(n.space,n.local)}function u(){this.setAttribute(n,t)}function i(){this.setAttributeNS(n.space,n.local,t)}function o(){var e=t.apply(this,arguments);null==e?this.removeAttribute(n):this.setAttribute(n,e)}function a(){var e=t.apply(this,arguments);null==e?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,e)}return n=Zo.ns.qualify(n),null==t?n.local?r:e:"function"==typeof t?n.local?a:o:n.local?i:u}function k(n){return n.trim().replace(/\s+/g," ")}function E(n){return new RegExp("(?:^|\\s+)"+Zo.requote(n)+"(?:\\s+|$)","g")}function A(n){return(n+"").trim().split(/^|\s+/)}function C(n,t){function e(){for(var e=-1;++e<u;)n[e](this,t)}function r(){for(var e=-1,r=t.apply(this,arguments);++e<u;)n[e](this,r)}n=A(n).map(N);var u=n.length;return"function"==typeof t?r:e}function N(n){var t=E(n);return function(e,r){if(u=e.classList)return r?u.add(n):u.remove(n);var u=e.getAttribute("class")||"";r?(t.lastIndex=0,t.test(u)||e.setAttribute("class",k(u+" "+n))):e.setAttribute("class",k(u.replace(t," ")))}}function z(n,t,e){function r(){this.style.removeProperty(n)}function u(){this.style.setProperty(n,t,e)}function i(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(n):this.style.setProperty(n,r,e)}return null==t?r:"function"==typeof t?i:u}function L(n,t){function e(){delete this[n]}function r(){this[n]=t}function u(){var e=t.apply(this,arguments);null==e?delete this[n]:this[n]=e}return null==t?e:"function"==typeof t?u:r}function T(n){return"function"==typeof n?n:(n=Zo.ns.qualify(n)).local?function(){return this.ownerDocument.createElementNS(n.space,n.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,n)}}function q(n){return{__data__:n}}function R(n){return function(){return ga(this,n)}}function D(t){return arguments.length||(t=n),function(n,e){return n&&e?t(n.__data__,e.__data__):!n-!e}}function P(n,t){for(var e=0,r=n.length;r>e;e++)for(var u,i=n[e],o=0,a=i.length;a>o;o++)(u=i[o])&&t(u,o,e);return n}function U(n){return sa(n,da),n}function j(n){var t,e;return function(r,u,i){var o,a=n[i].update,c=a.length;for(i!=e&&(e=i,t=0),u>=t&&(t=u+1);!(o=a[t])&&++t<c;);return o}}function H(){var n=this.__transition__;n&&++n.active}function F(n,t,e){function r(){var t=this[o];t&&(this.removeEventListener(n,t,t.$),delete this[o])}function u(){var u=c(t,Xo(arguments));r.call(this),this.addEventListener(n,this[o]=u,u.$=e),u._=t}function i(){var t,e=new RegExp("^__on([^.]+)"+Zo.requote(n)+"$");for(var r in this)if(t=r.match(e)){var u=this[r];this.removeEventListener(t[1],u,u.$),delete this[r]}}var o="__on"+n,a=n.indexOf("."),c=O;a>0&&(n=n.substring(0,a));var s=ya.get(n);return s&&(n=s,c=Y),a?t?u:r:t?v:i}function O(n,t){return function(e){var r=Zo.event;Zo.event=e,t[0]=this.__data__;try{n.apply(this,t)}finally{Zo.event=r}}}function Y(n,t){var e=O(n,t);return function(n){var t=this,r=n.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||e.call(t,n)}}function I(){var n=".dragsuppress-"+ ++Ma,t="click"+n,e=Zo.select(Wo).on("touchmove"+n,y).on("dragstart"+n,y).on("selectstart"+n,y);if(xa){var r=Bo.style,u=r[xa];r[xa]="none"}return function(i){function o(){e.on(t,null)}e.on(n,null),xa&&(r[xa]=u),i&&(e.on(t,function(){y(),o()},!0),setTimeout(o,0))}}function Z(n,t){t.changedTouches&&(t=t.changedTouches[0]);var e=n.ownerSVGElement||n;if(e.createSVGPoint){var r=e.createSVGPoint();if(0>_a&&(Wo.scrollX||Wo.scrollY)){e=Zo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var u=e[0][0].getScreenCTM();_a=!(u.f||u.e),e.remove()}return _a?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(n.getScreenCTM().inverse()),[r.x,r.y]}var i=n.getBoundingClientRect();return[t.clientX-i.left-n.clientLeft,t.clientY-i.top-n.clientTop]}function V(){return Zo.event.changedTouches[0].identifier}function X(){return Zo.event.target}function $(){return Wo}function B(n){return n>0?1:0>n?-1:0}function W(n,t,e){return(t[0]-n[0])*(e[1]-n[1])-(t[1]-n[1])*(e[0]-n[0])}function J(n){return n>1?0:-1>n?ba:Math.acos(n)}function G(n){return n>1?Sa:-1>n?-Sa:Math.asin(n)}function K(n){return((n=Math.exp(n))-1/n)/2}function Q(n){return((n=Math.exp(n))+1/n)/2}function nt(n){return((n=Math.exp(2*n))-1)/(n+1)}function tt(n){return(n=Math.sin(n/2))*n}function et(){}function rt(n,t,e){return this instanceof rt?(this.h=+n,this.s=+t,void(this.l=+e)):arguments.length<2?n instanceof rt?new rt(n.h,n.s,n.l):mt(""+n,yt,rt):new rt(n,t,e)}function ut(n,t,e){function r(n){return n>360?n-=360:0>n&&(n+=360),60>n?i+(o-i)*n/60:180>n?o:240>n?i+(o-i)*(240-n)/60:i}function u(n){return Math.round(255*r(n))}var i,o;return n=isNaN(n)?0:(n%=360)<0?n+360:n,t=isNaN(t)?0:0>t?0:t>1?1:t,e=0>e?0:e>1?1:e,o=.5>=e?e*(1+t):e+t-e*t,i=2*e-o,new gt(u(n+120),u(n),u(n-120))}function it(n,t,e){return this instanceof it?(this.h=+n,this.c=+t,void(this.l=+e)):arguments.length<2?n instanceof it?new it(n.h,n.c,n.l):n instanceof at?st(n.l,n.a,n.b):st((n=xt((n=Zo.rgb(n)).r,n.g,n.b)).l,n.a,n.b):new it(n,t,e)}function ot(n,t,e){return isNaN(n)&&(n=0),isNaN(t)&&(t=0),new at(e,Math.cos(n*=Aa)*t,Math.sin(n)*t)}function at(n,t,e){return this instanceof at?(this.l=+n,this.a=+t,void(this.b=+e)):arguments.length<2?n instanceof at?new at(n.l,n.a,n.b):n instanceof it?ot(n.l,n.c,n.h):xt((n=gt(n)).r,n.g,n.b):new at(n,t,e)}function ct(n,t,e){var r=(n+16)/116,u=r+t/500,i=r-e/200;return u=lt(u)*ja,r=lt(r)*Ha,i=lt(i)*Fa,new gt(ht(3.2404542*u-1.5371385*r-.4985314*i),ht(-.969266*u+1.8760108*r+.041556*i),ht(.0556434*u-.2040259*r+1.0572252*i))}function st(n,t,e){return n>0?new it(Math.atan2(e,t)*Ca,Math.sqrt(t*t+e*e),n):new it(0/0,0/0,n)}function lt(n){return n>.206893034?n*n*n:(n-4/29)/7.787037}function ft(n){return n>.008856?Math.pow(n,1/3):7.787037*n+4/29}function ht(n){return Math.round(255*(.00304>=n?12.92*n:1.055*Math.pow(n,1/2.4)-.055))}function gt(n,t,e){return this instanceof gt?(this.r=~~n,this.g=~~t,void(this.b=~~e)):arguments.length<2?n instanceof gt?new gt(n.r,n.g,n.b):mt(""+n,gt,ut):new gt(n,t,e)}function pt(n){return new gt(n>>16,255&n>>8,255&n)}function vt(n){return pt(n)+""}function dt(n){return 16>n?"0"+Math.max(0,n).toString(16):Math.min(255,n).toString(16)}function mt(n,t,e){var r,u,i,o=0,a=0,c=0;if(r=/([a-z]+)\((.*)\)/i.exec(n))switch(u=r[2].split(","),r[1]){case"hsl":return e(parseFloat(u[0]),parseFloat(u[1])/100,parseFloat(u[2])/100);case"rgb":return t(_t(u[0]),_t(u[1]),_t(u[2]))}return(i=Ia.get(n))?t(i.r,i.g,i.b):(null==n||"#"!==n.charAt(0)||isNaN(i=parseInt(n.substring(1),16))||(4===n.length?(o=(3840&i)>>4,o=o>>4|o,a=240&i,a=a>>4|a,c=15&i,c=c<<4|c):7===n.length&&(o=(16711680&i)>>16,a=(65280&i)>>8,c=255&i)),t(o,a,c))}function yt(n,t,e){var r,u,i=Math.min(n/=255,t/=255,e/=255),o=Math.max(n,t,e),a=o-i,c=(o+i)/2;return a?(u=.5>c?a/(o+i):a/(2-o-i),r=n==o?(t-e)/a+(e>t?6:0):t==o?(e-n)/a+2:(n-t)/a+4,r*=60):(r=0/0,u=c>0&&1>c?0:r),new rt(r,u,c)}function xt(n,t,e){n=Mt(n),t=Mt(t),e=Mt(e);var r=ft((.4124564*n+.3575761*t+.1804375*e)/ja),u=ft((.2126729*n+.7151522*t+.072175*e)/Ha),i=ft((.0193339*n+.119192*t+.9503041*e)/Fa);return at(116*u-16,500*(r-u),200*(u-i))}function Mt(n){return(n/=255)<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function _t(n){var t=parseFloat(n);return"%"===n.charAt(n.length-1)?Math.round(2.55*t):t}function bt(n){return"function"==typeof n?n:function(){return n}}function wt(n){return n}function St(n){return function(t,e,r){return 2===arguments.length&&"function"==typeof e&&(r=e,e=null),kt(t,e,n,r)}}function kt(n,t,e,r){function u(){var n,t=c.status;if(!t&&c.responseText||t>=200&&300>t||304===t){try{n=e.call(i,c)}catch(r){return o.error.call(i,r),void 0}o.load.call(i,n)}else o.error.call(i,c)}var i={},o=Zo.dispatch("beforesend","progress","load","error"),a={},c=new XMLHttpRequest,s=null;return!Wo.XDomainRequest||"withCredentials"in c||!/^(http(s)?:)?\/\//.test(n)||(c=new XDomainRequest),"onload"in c?c.onload=c.onerror=u:c.onreadystatechange=function(){c.readyState>3&&u()},c.onprogress=function(n){var t=Zo.event;Zo.event=n;try{o.progress.call(i,c)}finally{Zo.event=t}},i.header=function(n,t){return n=(n+"").toLowerCase(),arguments.length<2?a[n]:(null==t?delete a[n]:a[n]=t+"",i)},i.mimeType=function(n){return arguments.length?(t=null==n?null:n+"",i):t},i.responseType=function(n){return arguments.length?(s=n,i):s},i.response=function(n){return e=n,i},["get","post"].forEach(function(n){i[n]=function(){return i.send.apply(i,[n].concat(Xo(arguments)))}}),i.send=function(e,r,u){if(2===arguments.length&&"function"==typeof r&&(u=r,r=null),c.open(e,n,!0),null==t||"accept"in a||(a.accept=t+",*/*"),c.setRequestHeader)for(var l in a)c.setRequestHeader(l,a[l]);return null!=t&&c.overrideMimeType&&c.overrideMimeType(t),null!=s&&(c.responseType=s),null!=u&&i.on("error",u).on("load",function(n){u(null,n)}),o.beforesend.call(i,c),c.send(null==r?null:r),i},i.abort=function(){return c.abort(),i},Zo.rebind(i,o,"on"),null==r?i:i.get(Et(r))}function Et(n){return 1===n.length?function(t,e){n(null==t?e:null)}:n}function At(){var n=Ct(),t=Nt()-n;t>24?(isFinite(t)&&(clearTimeout($a),$a=setTimeout(At,t)),Xa=0):(Xa=1,Wa(At))}function Ct(){var n=Date.now();for(Ba=Za;Ba;)n>=Ba.t&&(Ba.f=Ba.c(n-Ba.t)),Ba=Ba.n;return n}function Nt(){for(var n,t=Za,e=1/0;t;)t.f?t=n?n.n=t.n:Za=t.n:(t.t<e&&(e=t.t),t=(n=t).n);return Va=n,e}function zt(n,t){return t-(n?Math.ceil(Math.log(n)/Math.LN10):1)}function Lt(n,t){var e=Math.pow(10,3*ua(8-t));return{scale:t>8?function(n){return n/e}:function(n){return n*e},symbol:n}}function Tt(n){var t=n.decimal,e=n.thousands,r=n.grouping,u=n.currency,i=r?function(n){for(var t=n.length,u=[],i=0,o=r[0];t>0&&o>0;)u.push(n.substring(t-=o,t+o)),o=r[i=(i+1)%r.length];return u.reverse().join(e)}:wt;return function(n){var e=Ga.exec(n),r=e[1]||" ",o=e[2]||">",a=e[3]||"",c=e[4]||"",s=e[5],l=+e[6],f=e[7],h=e[8],g=e[9],p=1,v="",d="",m=!1;switch(h&&(h=+h.substring(1)),(s||"0"===r&&"="===o)&&(s=r="0",o="=",f&&(l-=Math.floor((l-1)/4))),g){case"n":f=!0,g="g";break;case"%":p=100,d="%",g="f";break;case"p":p=100,d="%",g="r";break;case"b":case"o":case"x":case"X":"#"===c&&(v="0"+g.toLowerCase());case"c":case"d":m=!0,h=0;break;case"s":p=-1,g="r"}"$"===c&&(v=u[0],d=u[1]),"r"!=g||h||(g="g"),null!=h&&("g"==g?h=Math.max(1,Math.min(21,h)):("e"==g||"f"==g)&&(h=Math.max(0,Math.min(20,h)))),g=Ka.get(g)||qt;var y=s&&f;return function(n){var e=d;if(m&&n%1)return"";var u=0>n||0===n&&0>1/n?(n=-n,"-"):a;if(0>p){var c=Zo.formatPrefix(n,h);n=c.scale(n),e=c.symbol+d}else n*=p;n=g(n,h);var x=n.lastIndexOf("."),M=0>x?n:n.substring(0,x),_=0>x?"":t+n.substring(x+1);!s&&f&&(M=i(M));var b=v.length+M.length+_.length+(y?0:u.length),w=l>b?new Array(b=l-b+1).join(r):"";return y&&(M=i(w+M)),u+=v,n=M+_,("<"===o?u+n+w:">"===o?w+u+n:"^"===o?w.substring(0,b>>=1)+u+n+w.substring(b):u+(y?n:w+n))+e}}}function qt(n){return n+""}function Rt(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Dt(n,t,e){function r(t){var e=n(t),r=i(e,1);return r-t>t-e?e:r}function u(e){return t(e=n(new nc(e-1)),1),e}function i(n,e){return t(n=new nc(+n),e),n}function o(n,r,i){var o=u(n),a=[];if(i>1)for(;r>o;)e(o)%i||a.push(new Date(+o)),t(o,1);else for(;r>o;)a.push(new Date(+o)),t(o,1);return a}function a(n,t,e){try{nc=Rt;var r=new Rt;return r._=n,o(r,t,e)}finally{nc=Date}}n.floor=n,n.round=r,n.ceil=u,n.offset=i,n.range=o;var c=n.utc=Pt(n);return c.floor=c,c.round=Pt(r),c.ceil=Pt(u),c.offset=Pt(i),c.range=a,n}function Pt(n){return function(t,e){try{nc=Rt;var r=new Rt;return r._=t,n(r,e)._}finally{nc=Date}}}function Ut(n){function t(n){function t(t){for(var e,u,i,o=[],a=-1,c=0;++a<r;)37===n.charCodeAt(a)&&(o.push(n.substring(c,a)),null!=(u=ec[e=n.charAt(++a)])&&(e=n.charAt(++a)),(i=C[e])&&(e=i(t,null==u?"e"===e?" ":"0":u)),o.push(e),c=a+1);return o.push(n.substring(c,a)),o.join("")}var r=n.length;return t.parse=function(t){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},u=e(r,n,t,0);if(u!=t.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var i=null!=r.Z&&nc!==Rt,o=new(i?Rt:nc);return"j"in r?o.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(o.setFullYear(r.y,0,1),o.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(o.getDay()+5)%7:r.w+7*r.U-(o.getDay()+6)%7)):o.setFullYear(r.y,r.m,r.d),o.setHours(r.H+Math.floor(r.Z/100),r.M+r.Z%100,r.S,r.L),i?o._:o},t.toString=function(){return n},t}function e(n,t,e,r){for(var u,i,o,a=0,c=t.length,s=e.length;c>a;){if(r>=s)return-1;if(u=t.charCodeAt(a++),37===u){if(o=t.charAt(a++),i=N[o in ec?t.charAt(a++):o],!i||(r=i(n,e,r))<0)return-1}else if(u!=e.charCodeAt(r++))return-1}return r}function r(n,t,e){b.lastIndex=0;var r=b.exec(t.substring(e));return r?(n.w=w.get(r[0].toLowerCase()),e+r[0].length):-1}function u(n,t,e){M.lastIndex=0;var r=M.exec(t.substring(e));return r?(n.w=_.get(r[0].toLowerCase()),e+r[0].length):-1}function i(n,t,e){E.lastIndex=0;var r=E.exec(t.substring(e));return r?(n.m=A.get(r[0].toLowerCase()),e+r[0].length):-1}function o(n,t,e){S.lastIndex=0;var r=S.exec(t.substring(e));return r?(n.m=k.get(r[0].toLowerCase()),e+r[0].length):-1}function a(n,t,r){return e(n,C.c.toString(),t,r)}function c(n,t,r){return e(n,C.x.toString(),t,r)}function s(n,t,r){return e(n,C.X.toString(),t,r)}function l(n,t,e){var r=x.get(t.substring(e,e+=2).toLowerCase());return null==r?-1:(n.p=r,e)}var f=n.dateTime,h=n.date,g=n.time,p=n.periods,v=n.days,d=n.shortDays,m=n.months,y=n.shortMonths;t.utc=function(n){function e(n){try{nc=Rt;var t=new nc;return t._=n,r(t)}finally{nc=Date}}var r=t(n);return e.parse=function(n){try{nc=Rt;var t=r.parse(n);return t&&t._}finally{nc=Date}},e.toString=r.toString,e},t.multi=t.utc.multi=re;var x=Zo.map(),M=Ht(v),_=Ft(v),b=Ht(d),w=Ft(d),S=Ht(m),k=Ft(m),E=Ht(y),A=Ft(y);p.forEach(function(n,t){x.set(n.toLowerCase(),t)});var C={a:function(n){return d[n.getDay()]},A:function(n){return v[n.getDay()]},b:function(n){return y[n.getMonth()]},B:function(n){return m[n.getMonth()]},c:t(f),d:function(n,t){return jt(n.getDate(),t,2)},e:function(n,t){return jt(n.getDate(),t,2)},H:function(n,t){return jt(n.getHours(),t,2)},I:function(n,t){return jt(n.getHours()%12||12,t,2)},j:function(n,t){return jt(1+Qa.dayOfYear(n),t,3)},L:function(n,t){return jt(n.getMilliseconds(),t,3)},m:function(n,t){return jt(n.getMonth()+1,t,2)},M:function(n,t){return jt(n.getMinutes(),t,2)},p:function(n){return p[+(n.getHours()>=12)]},S:function(n,t){return jt(n.getSeconds(),t,2)},U:function(n,t){return jt(Qa.sundayOfYear(n),t,2)},w:function(n){return n.getDay()},W:function(n,t){return jt(Qa.mondayOfYear(n),t,2)},x:t(h),X:t(g),y:function(n,t){return jt(n.getFullYear()%100,t,2)},Y:function(n,t){return jt(n.getFullYear()%1e4,t,4)},Z:te,"%":function(){return"%"}},N={a:r,A:u,b:i,B:o,c:a,d:Wt,e:Wt,H:Gt,I:Gt,j:Jt,L:ne,m:Bt,M:Kt,p:l,S:Qt,U:Yt,w:Ot,W:It,x:c,X:s,y:Vt,Y:Zt,Z:Xt,"%":ee};return t}function jt(n,t,e){var r=0>n?"-":"",u=(r?-n:n)+"",i=u.length;return r+(e>i?new Array(e-i+1).join(t)+u:u)}function Ht(n){return new RegExp("^(?:"+n.map(Zo.requote).join("|")+")","i")}function Ft(n){for(var t=new o,e=-1,r=n.length;++e<r;)t.set(n[e].toLowerCase(),e);return t}function Ot(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+1));return r?(n.w=+r[0],e+r[0].length):-1}function Yt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e));return r?(n.U=+r[0],e+r[0].length):-1}function It(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e));return r?(n.W=+r[0],e+r[0].length):-1}function Zt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+4));return r?(n.y=+r[0],e+r[0].length):-1}function Vt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+2));return r?(n.y=$t(+r[0]),e+r[0].length):-1}function Xt(n,t,e){return/^[+-]\d{4}$/.test(t=t.substring(e,e+5))?(n.Z=-t,e+5):-1}function $t(n){return n+(n>68?1900:2e3)}function Bt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+2));return r?(n.m=r[0]-1,e+r[0].length):-1}function Wt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+2));return r?(n.d=+r[0],e+r[0].length):-1}function Jt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+3));return r?(n.j=+r[0],e+r[0].length):-1}function Gt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+2));return r?(n.H=+r[0],e+r[0].length):-1}function Kt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+2));return r?(n.M=+r[0],e+r[0].length):-1}function Qt(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+2));return r?(n.S=+r[0],e+r[0].length):-1}function ne(n,t,e){rc.lastIndex=0;var r=rc.exec(t.substring(e,e+3));return r?(n.L=+r[0],e+r[0].length):-1}function te(n){var t=n.getTimezoneOffset(),e=t>0?"-":"+",r=~~(ua(t)/60),u=ua(t)%60;return e+jt(r,"0",2)+jt(u,"0",2)}function ee(n,t,e){uc.lastIndex=0;var r=uc.exec(t.substring(e,e+1));return r?e+r[0].length:-1}function re(n){for(var t=n.length,e=-1;++e<t;)n[e][0]=this(n[e][0]);return function(t){for(var e=0,r=n[e];!r[1](t);)r=n[++e];return r[0](t)}}function ue(){}function ie(n,t,e){var r=e.s=n+t,u=r-n,i=r-u;e.t=n-i+(t-u)}function oe(n,t){n&&cc.hasOwnProperty(n.type)&&cc[n.type](n,t)}function ae(n,t,e){var r,u=-1,i=n.length-e;for(t.lineStart();++u<i;)r=n[u],t.point(r[0],r[1],r[2]);t.lineEnd()}function ce(n,t){var e=-1,r=n.length;for(t.polygonStart();++e<r;)ae(n[e],t,1);t.polygonEnd()}function se(){function n(n,t){n*=Aa,t=t*Aa/2+ba/4;var e=n-r,o=e>=0?1:-1,a=o*e,c=Math.cos(t),s=Math.sin(t),l=i*s,f=u*c+l*Math.cos(a),h=l*o*Math.sin(a);lc.add(Math.atan2(h,f)),r=n,u=c,i=s}var t,e,r,u,i;fc.point=function(o,a){fc.point=n,r=(t=o)*Aa,u=Math.cos(a=(e=a)*Aa/2+ba/4),i=Math.sin(a)},fc.lineEnd=function(){n(t,e)}}function le(n){var t=n[0],e=n[1],r=Math.cos(e);return[r*Math.cos(t),r*Math.sin(t),Math.sin(e)]}function fe(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]}function he(n,t){return[n[1]*t[2]-n[2]*t[1],n[2]*t[0]-n[0]*t[2],n[0]*t[1]-n[1]*t[0]]}function ge(n,t){n[0]+=t[0],n[1]+=t[1],n[2]+=t[2]}function pe(n,t){return[n[0]*t,n[1]*t,n[2]*t]}function ve(n){var t=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);n[0]/=t,n[1]/=t,n[2]/=t}function de(n){return[Math.atan2(n[1],n[0]),G(n[2])]}function me(n,t){return ua(n[0]-t[0])<ka&&ua(n[1]-t[1])<ka}function ye(n,t){n*=Aa;var e=Math.cos(t*=Aa);xe(e*Math.cos(n),e*Math.sin(n),Math.sin(t))}function xe(n,t,e){++hc,pc+=(n-pc)/hc,vc+=(t-vc)/hc,dc+=(e-dc)/hc}function Me(){function n(n,u){n*=Aa;var i=Math.cos(u*=Aa),o=i*Math.cos(n),a=i*Math.sin(n),c=Math.sin(u),s=Math.atan2(Math.sqrt((s=e*c-r*a)*s+(s=r*o-t*c)*s+(s=t*a-e*o)*s),t*o+e*a+r*c);gc+=s,mc+=s*(t+(t=o)),yc+=s*(e+(e=a)),xc+=s*(r+(r=c)),xe(t,e,r)}var t,e,r;wc.point=function(u,i){u*=Aa;var o=Math.cos(i*=Aa);t=o*Math.cos(u),e=o*Math.sin(u),r=Math.sin(i),wc.point=n,xe(t,e,r)}}function _e(){wc.point=ye}function be(){function n(n,t){n*=Aa;var e=Math.cos(t*=Aa),o=e*Math.cos(n),a=e*Math.sin(n),c=Math.sin(t),s=u*c-i*a,l=i*o-r*c,f=r*a-u*o,h=Math.sqrt(s*s+l*l+f*f),g=r*o+u*a+i*c,p=h&&-J(g)/h,v=Math.atan2(h,g);Mc+=p*s,_c+=p*l,bc+=p*f,gc+=v,mc+=v*(r+(r=o)),yc+=v*(u+(u=a)),xc+=v*(i+(i=c)),xe(r,u,i)}var t,e,r,u,i;wc.point=function(o,a){t=o,e=a,wc.point=n,o*=Aa;var c=Math.cos(a*=Aa);r=c*Math.cos(o),u=c*Math.sin(o),i=Math.sin(a),xe(r,u,i)},wc.lineEnd=function(){n(t,e),wc.lineEnd=_e,wc.point=ye}}function we(){return!0}function Se(n,t,e,r,u){var i=[],o=[];if(n.forEach(function(n){if(!((t=n.length-1)<=0)){var t,e=n[0],r=n[t];if(me(e,r)){u.lineStart();for(var a=0;t>a;++a)u.point((e=n[a])[0],e[1]);return u.lineEnd(),void 0}var c=new Ee(e,n,null,!0),s=new Ee(e,null,c,!1);c.o=s,i.push(c),o.push(s),c=new Ee(r,n,null,!1),s=new Ee(r,null,c,!0),c.o=s,i.push(c),o.push(s)}}),o.sort(t),ke(i),ke(o),i.length){for(var a=0,c=e,s=o.length;s>a;++a)o[a].e=c=!c;for(var l,f,h=i[0];;){for(var g=h,p=!0;g.v;)if((g=g.n)===h)return;l=g.z,u.lineStart();do{if(g.v=g.o.v=!0,g.e){if(p)for(var a=0,s=l.length;s>a;++a)u.point((f=l[a])[0],f[1]);else r(g.x,g.n.x,1,u);g=g.n}else{if(p){l=g.p.z;for(var a=l.length-1;a>=0;--a)u.point((f=l[a])[0],f[1])}else r(g.x,g.p.x,-1,u);g=g.p}g=g.o,l=g.z,p=!p}while(!g.v);u.lineEnd()}}}function ke(n){if(t=n.length){for(var t,e,r=0,u=n[0];++r<t;)u.n=e=n[r],e.p=u,u=e;u.n=e=n[0],e.p=u}}function Ee(n,t,e,r){this.x=n,this.z=t,this.o=e,this.e=r,this.v=!1,this.n=this.p=null}function Ae(n,t,e,r){return function(u,i){function o(t,e){var r=u(t,e);n(t=r[0],e=r[1])&&i.point(t,e)}function a(n,t){var e=u(n,t);d.point(e[0],e[1])}function c(){y.point=a,d.lineStart()}function s(){y.point=o,d.lineEnd()}function l(n,t){v.push([n,t]);var e=u(n,t);M.point(e[0],e[1])}function f(){M.lineStart(),v=[]}function h(){l(v[0][0],v[0][1]),M.lineEnd();var n,t=M.clean(),e=x.buffer(),r=e.length;if(v.pop(),p.push(v),v=null,r)if(1&t){n=e[0];var u,r=n.length-1,o=-1;if(r>0){for(_||(i.polygonStart(),_=!0),i.lineStart();++o<r;)i.point((u=n[o])[0],u[1]);i.lineEnd()}}else r>1&&2&t&&e.push(e.pop().concat(e.shift())),g.push(e.filter(Ce))}var g,p,v,d=t(i),m=u.invert(r[0],r[1]),y={point:o,lineStart:c,lineEnd:s,polygonStart:function(){y.point=l,y.lineStart=f,y.lineEnd=h,g=[],p=[]},polygonEnd:function(){y.point=o,y.lineStart=c,y.lineEnd=s,g=Zo.merge(g);var n=Le(m,p);g.length?(_||(i.polygonStart(),_=!0),Se(g,ze,n,e,i)):n&&(_||(i.polygonStart(),_=!0),i.lineStart(),e(null,null,1,i),i.lineEnd()),_&&(i.polygonEnd(),_=!1),g=p=null},sphere:function(){i.polygonStart(),i.lineStart(),e(null,null,1,i),i.lineEnd(),i.polygonEnd()}},x=Ne(),M=t(x),_=!1;return y}}function Ce(n){return n.length>1}function Ne(){var n,t=[];return{lineStart:function(){t.push(n=[])},point:function(t,e){n.push([t,e])},lineEnd:v,buffer:function(){var e=t;return t=[],n=null,e},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function ze(n,t){return((n=n.x)[0]<0?n[1]-Sa-ka:Sa-n[1])-((t=t.x)[0]<0?t[1]-Sa-ka:Sa-t[1])}function Le(n,t){var e=n[0],r=n[1],u=[Math.sin(e),-Math.cos(e),0],i=0,o=0;lc.reset();for(var a=0,c=t.length;c>a;++a){var s=t[a],l=s.length;if(l)for(var f=s[0],h=f[0],g=f[1]/2+ba/4,p=Math.sin(g),v=Math.cos(g),d=1;;){d===l&&(d=0),n=s[d];var m=n[0],y=n[1]/2+ba/4,x=Math.sin(y),M=Math.cos(y),_=m-h,b=_>=0?1:-1,w=b*_,S=w>ba,k=p*x;if(lc.add(Math.atan2(k*b*Math.sin(w),v*M+k*Math.cos(w))),i+=S?_+b*wa:_,S^h>=e^m>=e){var E=he(le(f),le(n));ve(E);var A=he(u,E);ve(A);var C=(S^_>=0?-1:1)*G(A[2]);(r>C||r===C&&(E[0]||E[1]))&&(o+=S^_>=0?1:-1)}if(!d++)break;h=m,p=x,v=M,f=n}}return(-ka>i||ka>i&&0>lc)^1&o}function Te(n){var t,e=0/0,r=0/0,u=0/0;return{lineStart:function(){n.lineStart(),t=1},point:function(i,o){var a=i>0?ba:-ba,c=ua(i-e);ua(c-ba)<ka?(n.point(e,r=(r+o)/2>0?Sa:-Sa),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),n.point(i,r),t=0):u!==a&&c>=ba&&(ua(e-u)<ka&&(e-=u*ka),ua(i-a)<ka&&(i-=a*ka),r=qe(e,r,i,o),n.point(u,r),n.lineEnd(),n.lineStart(),n.point(a,r),t=0),n.point(e=i,r=o),u=a},lineEnd:function(){n.lineEnd(),e=r=0/0},clean:function(){return 2-t}}}function qe(n,t,e,r){var u,i,o=Math.sin(n-e);return ua(o)>ka?Math.atan((Math.sin(t)*(i=Math.cos(r))*Math.sin(e)-Math.sin(r)*(u=Math.cos(t))*Math.sin(n))/(u*i*o)):(t+r)/2}function Re(n,t,e,r){var u;if(null==n)u=e*Sa,r.point(-ba,u),r.point(0,u),r.point(ba,u),r.point(ba,0),r.point(ba,-u),r.point(0,-u),r.point(-ba,-u),r.point(-ba,0),r.point(-ba,u);else if(ua(n[0]-t[0])>ka){var i=n[0]<t[0]?ba:-ba;u=e*i/2,r.point(-i,u),r.point(0,u),r.point(i,u)}else r.point(t[0],t[1])}function De(n){function t(n,t){return Math.cos(n)*Math.cos(t)>i}function e(n){var e,i,c,s,l;return{lineStart:function(){s=c=!1,l=1},point:function(f,h){var g,p=[f,h],v=t(f,h),d=o?v?0:u(f,h):v?u(f+(0>f?ba:-ba),h):0;if(!e&&(s=c=v)&&n.lineStart(),v!==c&&(g=r(e,p),(me(e,g)||me(p,g))&&(p[0]+=ka,p[1]+=ka,v=t(p[0],p[1]))),v!==c)l=0,v?(n.lineStart(),g=r(p,e),n.point(g[0],g[1])):(g=r(e,p),n.point(g[0],g[1]),n.lineEnd()),e=g;else if(a&&e&&o^v){var m;d&i||!(m=r(p,e,!0))||(l=0,o?(n.lineStart(),n.point(m[0][0],m[0][1]),n.point(m[1][0],m[1][1]),n.lineEnd()):(n.point(m[1][0],m[1][1]),n.lineEnd(),n.lineStart(),n.point(m[0][0],m[0][1])))}!v||e&&me(e,p)||n.point(p[0],p[1]),e=p,c=v,i=d},lineEnd:function(){c&&n.lineEnd(),e=null},clean:function(){return l|(s&&c)<<1}}}function r(n,t,e){var r=le(n),u=le(t),o=[1,0,0],a=he(r,u),c=fe(a,a),s=a[0],l=c-s*s;if(!l)return!e&&n;var f=i*c/l,h=-i*s/l,g=he(o,a),p=pe(o,f),v=pe(a,h);ge(p,v);var d=g,m=fe(p,d),y=fe(d,d),x=m*m-y*(fe(p,p)-1);if(!(0>x)){var M=Math.sqrt(x),_=pe(d,(-m-M)/y);if(ge(_,p),_=de(_),!e)return _;var b,w=n[0],S=t[0],k=n[1],E=t[1];w>S&&(b=w,w=S,S=b);var A=S-w,C=ua(A-ba)<ka,N=C||ka>A;if(!C&&k>E&&(b=k,k=E,E=b),N?C?k+E>0^_[1]<(ua(_[0]-w)<ka?k:E):k<=_[1]&&_[1]<=E:A>ba^(w<=_[0]&&_[0]<=S)){var z=pe(d,(-m+M)/y);return ge(z,p),[_,de(z)]}}}function u(t,e){var r=o?n:ba-n,u=0;return-r>t?u|=1:t>r&&(u|=2),-r>e?u|=4:e>r&&(u|=8),u}var i=Math.cos(n),o=i>0,a=ua(i)>ka,c=sr(n,6*Aa);return Ae(t,e,c,o?[0,-n]:[-ba,n-ba])}function Pe(n,t,e,r){return function(u){var i,o=u.a,a=u.b,c=o.x,s=o.y,l=a.x,f=a.y,h=0,g=1,p=l-c,v=f-s;if(i=n-c,p||!(i>0)){if(i/=p,0>p){if(h>i)return;g>i&&(g=i)}else if(p>0){if(i>g)return;i>h&&(h=i)}if(i=e-c,p||!(0>i)){if(i/=p,0>p){if(i>g)return;i>h&&(h=i)}else if(p>0){if(h>i)return;g>i&&(g=i)}if(i=t-s,v||!(i>0)){if(i/=v,0>v){if(h>i)return;g>i&&(g=i)}else if(v>0){if(i>g)return;i>h&&(h=i)}if(i=r-s,v||!(0>i)){if(i/=v,0>v){if(i>g)return;i>h&&(h=i)}else if(v>0){if(h>i)return;g>i&&(g=i)}return h>0&&(u.a={x:c+h*p,y:s+h*v}),1>g&&(u.b={x:c+g*p,y:s+g*v}),u}}}}}}function Ue(n,t,e,r){function u(r,u){return ua(r[0]-n)<ka?u>0?0:3:ua(r[0]-e)<ka?u>0?2:1:ua(r[1]-t)<ka?u>0?1:0:u>0?3:2}function i(n,t){return o(n.x,t.x)}function o(n,t){var e=u(n,1),r=u(t,1);return e!==r?e-r:0===e?t[1]-n[1]:1===e?n[0]-t[0]:2===e?n[1]-t[1]:t[0]-n[0]}return function(a){function c(n){for(var t=0,e=d.length,r=n[1],u=0;e>u;++u)for(var i,o=1,a=d[u],c=a.length,s=a[0];c>o;++o)i=a[o],s[1]<=r?i[1]>r&&W(s,i,n)>0&&++t:i[1]<=r&&W(s,i,n)<0&&--t,s=i;return 0!==t}function s(i,a,c,s){var l=0,f=0;if(null==i||(l=u(i,c))!==(f=u(a,c))||o(i,a)<0^c>0){do s.point(0===l||3===l?n:e,l>1?r:t);while((l=(l+c+4)%4)!==f)}else s.point(a[0],a[1])}function l(u,i){return u>=n&&e>=u&&i>=t&&r>=i}function f(n,t){l(n,t)&&a.point(n,t)}function h(){N.point=p,d&&d.push(m=[]),S=!0,w=!1,_=b=0/0}function g(){v&&(p(y,x),M&&w&&A.rejoin(),v.push(A.buffer())),N.point=f,w&&a.lineEnd()}function p(n,t){n=Math.max(-kc,Math.min(kc,n)),t=Math.max(-kc,Math.min(kc,t));var e=l(n,t);if(d&&m.push([n,t]),S)y=n,x=t,M=e,S=!1,e&&(a.lineStart(),a.point(n,t));else if(e&&w)a.point(n,t);else{var r={a:{x:_,y:b},b:{x:n,y:t}};C(r)?(w||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),e||a.lineEnd(),k=!1):e&&(a.lineStart(),a.point(n,t),k=!1)}_=n,b=t,w=e}var v,d,m,y,x,M,_,b,w,S,k,E=a,A=Ne(),C=Pe(n,t,e,r),N={point:f,lineStart:h,lineEnd:g,polygonStart:function(){a=A,v=[],d=[],k=!0},polygonEnd:function(){a=E,v=Zo.merge(v);var t=c([n,r]),e=k&&t,u=v.length;(e||u)&&(a.polygonStart(),e&&(a.lineStart(),s(null,null,1,a),a.lineEnd()),u&&Se(v,i,t,s,a),a.polygonEnd()),v=d=m=null}};return N}}function je(n,t){function e(e,r){return e=n(e,r),t(e[0],e[1])}return n.invert&&t.invert&&(e.invert=function(e,r){return e=t.invert(e,r),e&&n.invert(e[0],e[1])}),e}function He(n){var t=0,e=ba/3,r=tr(n),u=r(t,e);return u.parallels=function(n){return arguments.length?r(t=n[0]*ba/180,e=n[1]*ba/180):[180*(t/ba),180*(e/ba)]},u}function Fe(n,t){function e(n,t){var e=Math.sqrt(i-2*u*Math.sin(t))/u;return[e*Math.sin(n*=u),o-e*Math.cos(n)]}var r=Math.sin(n),u=(r+Math.sin(t))/2,i=1+r*(2*u-r),o=Math.sqrt(i)/u;return e.invert=function(n,t){var e=o-t;return[Math.atan2(n,e)/u,G((i-(n*n+e*e)*u*u)/(2*u))]},e}function Oe(){function n(n,t){Ac+=u*n-r*t,r=n,u=t}var t,e,r,u;Tc.point=function(i,o){Tc.point=n,t=r=i,e=u=o},Tc.lineEnd=function(){n(t,e)}}function Ye(n,t){Cc>n&&(Cc=n),n>zc&&(zc=n),Nc>t&&(Nc=t),t>Lc&&(Lc=t)}function Ie(){function n(n,t){o.push("M",n,",",t,i)}function t(n,t){o.push("M",n,",",t),a.point=e}function e(n,t){o.push("L",n,",",t)}function r(){a.point=n}function u(){o.push("Z")}var i=Ze(4.5),o=[],a={point:n,lineStart:function(){a.point=t},lineEnd:r,polygonStart:function(){a.lineEnd=u},polygonEnd:function(){a.lineEnd=r,a.point=n},pointRadius:function(n){return i=Ze(n),a},result:function(){if(o.length){var n=o.join("");return o=[],n}}};return a}function Ze(n){return"m0,"+n+"a"+n+","+n+" 0 1,1 0,"+-2*n+"a"+n+","+n+" 0 1,1 0,"+2*n+"z"}function Ve(n,t){pc+=n,vc+=t,++dc}function Xe(){function n(n,r){var u=n-t,i=r-e,o=Math.sqrt(u*u+i*i);mc+=o*(t+n)/2,yc+=o*(e+r)/2,xc+=o,Ve(t=n,e=r)}var t,e;Rc.point=function(r,u){Rc.point=n,Ve(t=r,e=u)}}function $e(){Rc.point=Ve}function Be(){function n(n,t){var e=n-r,i=t-u,o=Math.sqrt(e*e+i*i);mc+=o*(r+n)/2,yc+=o*(u+t)/2,xc+=o,o=u*n-r*t,Mc+=o*(r+n),_c+=o*(u+t),bc+=3*o,Ve(r=n,u=t)}var t,e,r,u;Rc.point=function(i,o){Rc.point=n,Ve(t=r=i,e=u=o)},Rc.lineEnd=function(){n(t,e)}}function We(n){function t(t,e){n.moveTo(t,e),n.arc(t,e,o,0,wa)}function e(t,e){n.moveTo(t,e),a.point=r}function r(t,e){n.lineTo(t,e)}function u(){a.point=t}function i(){n.closePath()}var o=4.5,a={point:t,lineStart:function(){a.point=e},lineEnd:u,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=u,a.point=t},pointRadius:function(n){return o=n,a},result:v};return a}function Je(n){function t(n){return(a?r:e)(n)}function e(t){return Qe(t,function(e,r){e=n(e,r),t.point(e[0],e[1])})}function r(t){function e(e,r){e=n(e,r),t.point(e[0],e[1])}function r(){x=0/0,S.point=i,t.lineStart()}function i(e,r){var i=le([e,r]),o=n(e,r);u(x,M,y,_,b,w,x=o[0],M=o[1],y=e,_=i[0],b=i[1],w=i[2],a,t),t.point(x,M)}function o(){S.point=e,t.lineEnd()}function c(){r(),S.point=s,S.lineEnd=l}function s(n,t){i(f=n,h=t),g=x,p=M,v=_,d=b,m=w,S.point=i}function l(){u(x,M,y,_,b,w,g,p,f,v,d,m,a,t),S.lineEnd=o,o()}var f,h,g,p,v,d,m,y,x,M,_,b,w,S={point:e,lineStart:r,lineEnd:o,polygonStart:function(){t.polygonStart(),S.lineStart=c},polygonEnd:function(){t.polygonEnd(),S.lineStart=r}};return S}function u(t,e,r,a,c,s,l,f,h,g,p,v,d,m){var y=l-t,x=f-e,M=y*y+x*x;if(M>4*i&&d--){var _=a+g,b=c+p,w=s+v,S=Math.sqrt(_*_+b*b+w*w),k=Math.asin(w/=S),E=ua(ua(w)-1)<ka||ua(r-h)<ka?(r+h)/2:Math.atan2(b,_),A=n(E,k),C=A[0],N=A[1],z=C-t,L=N-e,T=x*z-y*L;(T*T/M>i||ua((y*z+x*L)/M-.5)>.3||o>a*g+c*p+s*v)&&(u(t,e,r,a,c,s,C,N,E,_/=S,b/=S,w,d,m),m.point(C,N),u(C,N,E,_,b,w,l,f,h,g,p,v,d,m))}}var i=.5,o=Math.cos(30*Aa),a=16;
    return t.precision=function(n){return arguments.length?(a=(i=n*n)>0&&16,t):Math.sqrt(i)},t}function Ge(n){var t=Je(function(t,e){return n([t*Ca,e*Ca])});return function(n){return er(t(n))}}function Ke(n){this.stream=n}function Qe(n,t){return{point:t,sphere:function(){n.sphere()},lineStart:function(){n.lineStart()},lineEnd:function(){n.lineEnd()},polygonStart:function(){n.polygonStart()},polygonEnd:function(){n.polygonEnd()}}}function nr(n){return tr(function(){return n})()}function tr(n){function t(n){return n=a(n[0]*Aa,n[1]*Aa),[n[0]*h+c,s-n[1]*h]}function e(n){return n=a.invert((n[0]-c)/h,(s-n[1])/h),n&&[n[0]*Ca,n[1]*Ca]}function r(){a=je(o=ir(m,y,x),i);var n=i(v,d);return c=g-n[0]*h,s=p+n[1]*h,u()}function u(){return l&&(l.valid=!1,l=null),t}var i,o,a,c,s,l,f=Je(function(n,t){return n=i(n,t),[n[0]*h+c,s-n[1]*h]}),h=150,g=480,p=250,v=0,d=0,m=0,y=0,x=0,M=Sc,_=wt,b=null,w=null;return t.stream=function(n){return l&&(l.valid=!1),l=er(M(o,f(_(n)))),l.valid=!0,l},t.clipAngle=function(n){return arguments.length?(M=null==n?(b=n,Sc):De((b=+n)*Aa),u()):b},t.clipExtent=function(n){return arguments.length?(w=n,_=n?Ue(n[0][0],n[0][1],n[1][0],n[1][1]):wt,u()):w},t.scale=function(n){return arguments.length?(h=+n,r()):h},t.translate=function(n){return arguments.length?(g=+n[0],p=+n[1],r()):[g,p]},t.center=function(n){return arguments.length?(v=n[0]%360*Aa,d=n[1]%360*Aa,r()):[v*Ca,d*Ca]},t.rotate=function(n){return arguments.length?(m=n[0]%360*Aa,y=n[1]%360*Aa,x=n.length>2?n[2]%360*Aa:0,r()):[m*Ca,y*Ca,x*Ca]},Zo.rebind(t,f,"precision"),function(){return i=n.apply(this,arguments),t.invert=i.invert&&e,r()}}function er(n){return Qe(n,function(t,e){n.point(t*Aa,e*Aa)})}function rr(n,t){return[n,t]}function ur(n,t){return[n>ba?n-wa:-ba>n?n+wa:n,t]}function ir(n,t,e){return n?t||e?je(ar(n),cr(t,e)):ar(n):t||e?cr(t,e):ur}function or(n){return function(t,e){return t+=n,[t>ba?t-wa:-ba>t?t+wa:t,e]}}function ar(n){var t=or(n);return t.invert=or(-n),t}function cr(n,t){function e(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,s=Math.sin(t),l=s*r+a*u;return[Math.atan2(c*i-l*o,a*r-s*u),G(l*i+c*o)]}var r=Math.cos(n),u=Math.sin(n),i=Math.cos(t),o=Math.sin(t);return e.invert=function(n,t){var e=Math.cos(t),a=Math.cos(n)*e,c=Math.sin(n)*e,s=Math.sin(t),l=s*i-c*o;return[Math.atan2(c*i+s*o,a*r+l*u),G(l*r-a*u)]},e}function sr(n,t){var e=Math.cos(n),r=Math.sin(n);return function(u,i,o,a){var c=o*t;null!=u?(u=lr(e,u),i=lr(e,i),(o>0?i>u:u>i)&&(u+=o*wa)):(u=n+o*wa,i=n-.5*c);for(var s,l=u;o>0?l>i:i>l;l-=c)a.point((s=de([e,-r*Math.cos(l),-r*Math.sin(l)]))[0],s[1])}}function lr(n,t){var e=le(t);e[0]-=n,ve(e);var r=J(-e[1]);return((-e[2]<0?-r:r)+2*Math.PI-ka)%(2*Math.PI)}function fr(n,t,e){var r=Zo.range(n,t-ka,e).concat(t);return function(n){return r.map(function(t){return[n,t]})}}function hr(n,t,e){var r=Zo.range(n,t-ka,e).concat(t);return function(n){return r.map(function(t){return[t,n]})}}function gr(n){return n.source}function pr(n){return n.target}function vr(n,t,e,r){var u=Math.cos(t),i=Math.sin(t),o=Math.cos(r),a=Math.sin(r),c=u*Math.cos(n),s=u*Math.sin(n),l=o*Math.cos(e),f=o*Math.sin(e),h=2*Math.asin(Math.sqrt(tt(r-t)+u*o*tt(e-n))),g=1/Math.sin(h),p=h?function(n){var t=Math.sin(n*=h)*g,e=Math.sin(h-n)*g,r=e*c+t*l,u=e*s+t*f,o=e*i+t*a;return[Math.atan2(u,r)*Ca,Math.atan2(o,Math.sqrt(r*r+u*u))*Ca]}:function(){return[n*Ca,t*Ca]};return p.distance=h,p}function dr(){function n(n,u){var i=Math.sin(u*=Aa),o=Math.cos(u),a=ua((n*=Aa)-t),c=Math.cos(a);Dc+=Math.atan2(Math.sqrt((a=o*Math.sin(a))*a+(a=r*i-e*o*c)*a),e*i+r*o*c),t=n,e=i,r=o}var t,e,r;Pc.point=function(u,i){t=u*Aa,e=Math.sin(i*=Aa),r=Math.cos(i),Pc.point=n},Pc.lineEnd=function(){Pc.point=Pc.lineEnd=v}}function mr(n,t){function e(t,e){var r=Math.cos(t),u=Math.cos(e),i=n(r*u);return[i*u*Math.sin(t),i*Math.sin(e)]}return e.invert=function(n,e){var r=Math.sqrt(n*n+e*e),u=t(r),i=Math.sin(u),o=Math.cos(u);return[Math.atan2(n*i,r*o),Math.asin(r&&e*i/r)]},e}function yr(n,t){function e(n,t){o>0?-Sa+ka>t&&(t=-Sa+ka):t>Sa-ka&&(t=Sa-ka);var e=o/Math.pow(u(t),i);return[e*Math.sin(i*n),o-e*Math.cos(i*n)]}var r=Math.cos(n),u=function(n){return Math.tan(ba/4+n/2)},i=n===t?Math.sin(n):Math.log(r/Math.cos(t))/Math.log(u(t)/u(n)),o=r*Math.pow(u(n),i)/i;return i?(e.invert=function(n,t){var e=o-t,r=B(i)*Math.sqrt(n*n+e*e);return[Math.atan2(n,e)/i,2*Math.atan(Math.pow(o/r,1/i))-Sa]},e):Mr}function xr(n,t){function e(n,t){var e=i-t;return[e*Math.sin(u*n),i-e*Math.cos(u*n)]}var r=Math.cos(n),u=n===t?Math.sin(n):(r-Math.cos(t))/(t-n),i=r/u+n;return ua(u)<ka?rr:(e.invert=function(n,t){var e=i-t;return[Math.atan2(n,e)/u,i-B(u)*Math.sqrt(n*n+e*e)]},e)}function Mr(n,t){return[n,Math.log(Math.tan(ba/4+t/2))]}function _r(n){var t,e=nr(n),r=e.scale,u=e.translate,i=e.clipExtent;return e.scale=function(){var n=r.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.translate=function(){var n=u.apply(e,arguments);return n===e?t?e.clipExtent(null):e:n},e.clipExtent=function(n){var o=i.apply(e,arguments);if(o===e){if(t=null==n){var a=ba*r(),c=u();i([[c[0]-a,c[1]-a],[c[0]+a,c[1]+a]])}}else t&&(o=null);return o},e.clipExtent(null)}function br(n,t){return[Math.log(Math.tan(ba/4+t/2)),-n]}function wr(n){return n[0]}function Sr(n){return n[1]}function kr(n){for(var t=n.length,e=[0,1],r=2,u=2;t>u;u++){for(;r>1&&W(n[e[r-2]],n[e[r-1]],n[u])<=0;)--r;e[r++]=u}return e.slice(0,r)}function Er(n,t){return n[0]-t[0]||n[1]-t[1]}function Ar(n,t,e){return(e[0]-t[0])*(n[1]-t[1])<(e[1]-t[1])*(n[0]-t[0])}function Cr(n,t,e,r){var u=n[0],i=e[0],o=t[0]-u,a=r[0]-i,c=n[1],s=e[1],l=t[1]-c,f=r[1]-s,h=(a*(c-s)-f*(u-i))/(f*o-a*l);return[u+h*o,c+h*l]}function Nr(n){var t=n[0],e=n[n.length-1];return!(t[0]-e[0]||t[1]-e[1])}function zr(){Gr(this),this.edge=this.site=this.circle=null}function Lr(n){var t=Bc.pop()||new zr;return t.site=n,t}function Tr(n){Yr(n),Vc.remove(n),Bc.push(n),Gr(n)}function qr(n){var t=n.circle,e=t.x,r=t.cy,u={x:e,y:r},i=n.P,o=n.N,a=[n];Tr(n);for(var c=i;c.circle&&ua(e-c.circle.x)<ka&&ua(r-c.circle.cy)<ka;)i=c.P,a.unshift(c),Tr(c),c=i;a.unshift(c),Yr(c);for(var s=o;s.circle&&ua(e-s.circle.x)<ka&&ua(r-s.circle.cy)<ka;)o=s.N,a.push(s),Tr(s),s=o;a.push(s),Yr(s);var l,f=a.length;for(l=1;f>l;++l)s=a[l],c=a[l-1],Br(s.edge,c.site,s.site,u);c=a[0],s=a[f-1],s.edge=Xr(c.site,s.site,null,u),Or(c),Or(s)}function Rr(n){for(var t,e,r,u,i=n.x,o=n.y,a=Vc._;a;)if(r=Dr(a,o)-i,r>ka)a=a.L;else{if(u=i-Pr(a,o),!(u>ka)){r>-ka?(t=a.P,e=a):u>-ka?(t=a,e=a.N):t=e=a;break}if(!a.R){t=a;break}a=a.R}var c=Lr(n);if(Vc.insert(t,c),t||e){if(t===e)return Yr(t),e=Lr(t.site),Vc.insert(c,e),c.edge=e.edge=Xr(t.site,c.site),Or(t),Or(e),void 0;if(!e)return c.edge=Xr(t.site,c.site),void 0;Yr(t),Yr(e);var s=t.site,l=s.x,f=s.y,h=n.x-l,g=n.y-f,p=e.site,v=p.x-l,d=p.y-f,m=2*(h*d-g*v),y=h*h+g*g,x=v*v+d*d,M={x:(d*y-g*x)/m+l,y:(h*x-v*y)/m+f};Br(e.edge,s,p,M),c.edge=Xr(s,n,null,M),e.edge=Xr(n,p,null,M),Or(t),Or(e)}}function Dr(n,t){var e=n.site,r=e.x,u=e.y,i=u-t;if(!i)return r;var o=n.P;if(!o)return-1/0;e=o.site;var a=e.x,c=e.y,s=c-t;if(!s)return a;var l=a-r,f=1/i-1/s,h=l/s;return f?(-h+Math.sqrt(h*h-2*f*(l*l/(-2*s)-c+s/2+u-i/2)))/f+r:(r+a)/2}function Pr(n,t){var e=n.N;if(e)return Dr(e,t);var r=n.site;return r.y===t?r.x:1/0}function Ur(n){this.site=n,this.edges=[]}function jr(n){for(var t,e,r,u,i,o,a,c,s,l,f=n[0][0],h=n[1][0],g=n[0][1],p=n[1][1],v=Zc,d=v.length;d--;)if(i=v[d],i&&i.prepare())for(a=i.edges,c=a.length,o=0;c>o;)l=a[o].end(),r=l.x,u=l.y,s=a[++o%c].start(),t=s.x,e=s.y,(ua(r-t)>ka||ua(u-e)>ka)&&(a.splice(o,0,new Wr($r(i.site,l,ua(r-f)<ka&&p-u>ka?{x:f,y:ua(t-f)<ka?e:p}:ua(u-p)<ka&&h-r>ka?{x:ua(e-p)<ka?t:h,y:p}:ua(r-h)<ka&&u-g>ka?{x:h,y:ua(t-h)<ka?e:g}:ua(u-g)<ka&&r-f>ka?{x:ua(e-g)<ka?t:f,y:g}:null),i.site,null)),++c)}function Hr(n,t){return t.angle-n.angle}function Fr(){Gr(this),this.x=this.y=this.arc=this.site=this.cy=null}function Or(n){var t=n.P,e=n.N;if(t&&e){var r=t.site,u=n.site,i=e.site;if(r!==i){var o=u.x,a=u.y,c=r.x-o,s=r.y-a,l=i.x-o,f=i.y-a,h=2*(c*f-s*l);if(!(h>=-Ea)){var g=c*c+s*s,p=l*l+f*f,v=(f*g-s*p)/h,d=(c*p-l*g)/h,f=d+a,m=Wc.pop()||new Fr;m.arc=n,m.site=u,m.x=v+o,m.y=f+Math.sqrt(v*v+d*d),m.cy=f,n.circle=m;for(var y=null,x=$c._;x;)if(m.y<x.y||m.y===x.y&&m.x<=x.x){if(!x.L){y=x.P;break}x=x.L}else{if(!x.R){y=x;break}x=x.R}$c.insert(y,m),y||(Xc=m)}}}}function Yr(n){var t=n.circle;t&&(t.P||(Xc=t.N),$c.remove(t),Wc.push(t),Gr(t),n.circle=null)}function Ir(n){for(var t,e=Ic,r=Pe(n[0][0],n[0][1],n[1][0],n[1][1]),u=e.length;u--;)t=e[u],(!Zr(t,n)||!r(t)||ua(t.a.x-t.b.x)<ka&&ua(t.a.y-t.b.y)<ka)&&(t.a=t.b=null,e.splice(u,1))}function Zr(n,t){var e=n.b;if(e)return!0;var r,u,i=n.a,o=t[0][0],a=t[1][0],c=t[0][1],s=t[1][1],l=n.l,f=n.r,h=l.x,g=l.y,p=f.x,v=f.y,d=(h+p)/2,m=(g+v)/2;if(v===g){if(o>d||d>=a)return;if(h>p){if(i){if(i.y>=s)return}else i={x:d,y:c};e={x:d,y:s}}else{if(i){if(i.y<c)return}else i={x:d,y:s};e={x:d,y:c}}}else if(r=(h-p)/(v-g),u=m-r*d,-1>r||r>1)if(h>p){if(i){if(i.y>=s)return}else i={x:(c-u)/r,y:c};e={x:(s-u)/r,y:s}}else{if(i){if(i.y<c)return}else i={x:(s-u)/r,y:s};e={x:(c-u)/r,y:c}}else if(v>g){if(i){if(i.x>=a)return}else i={x:o,y:r*o+u};e={x:a,y:r*a+u}}else{if(i){if(i.x<o)return}else i={x:a,y:r*a+u};e={x:o,y:r*o+u}}return n.a=i,n.b=e,!0}function Vr(n,t){this.l=n,this.r=t,this.a=this.b=null}function Xr(n,t,e,r){var u=new Vr(n,t);return Ic.push(u),e&&Br(u,n,t,e),r&&Br(u,t,n,r),Zc[n.i].edges.push(new Wr(u,n,t)),Zc[t.i].edges.push(new Wr(u,t,n)),u}function $r(n,t,e){var r=new Vr(n,null);return r.a=t,r.b=e,Ic.push(r),r}function Br(n,t,e,r){n.a||n.b?n.l===e?n.b=r:n.a=r:(n.a=r,n.l=t,n.r=e)}function Wr(n,t,e){var r=n.a,u=n.b;this.edge=n,this.site=t,this.angle=e?Math.atan2(e.y-t.y,e.x-t.x):n.l===t?Math.atan2(u.x-r.x,r.y-u.y):Math.atan2(r.x-u.x,u.y-r.y)}function Jr(){this._=null}function Gr(n){n.U=n.C=n.L=n.R=n.P=n.N=null}function Kr(n,t){var e=t,r=t.R,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.R=r.L,e.R&&(e.R.U=e),r.L=e}function Qr(n,t){var e=t,r=t.L,u=e.U;u?u.L===e?u.L=r:u.R=r:n._=r,r.U=u,e.U=r,e.L=r.R,e.L&&(e.L.U=e),r.R=e}function nu(n){for(;n.L;)n=n.L;return n}function tu(n,t){var e,r,u,i=n.sort(eu).pop();for(Ic=[],Zc=new Array(n.length),Vc=new Jr,$c=new Jr;;)if(u=Xc,i&&(!u||i.y<u.y||i.y===u.y&&i.x<u.x))(i.x!==e||i.y!==r)&&(Zc[i.i]=new Ur(i),Rr(i),e=i.x,r=i.y),i=n.pop();else{if(!u)break;qr(u.arc)}t&&(Ir(t),jr(t));var o={cells:Zc,edges:Ic};return Vc=$c=Ic=Zc=null,o}function eu(n,t){return t.y-n.y||t.x-n.x}function ru(n,t,e){return(n.x-e.x)*(t.y-n.y)-(n.x-t.x)*(e.y-n.y)}function uu(n){return n.x}function iu(n){return n.y}function ou(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function au(n,t,e,r,u,i){if(!n(t,e,r,u,i)){var o=.5*(e+u),a=.5*(r+i),c=t.nodes;c[0]&&au(n,c[0],e,r,o,a),c[1]&&au(n,c[1],o,r,u,a),c[2]&&au(n,c[2],e,a,o,i),c[3]&&au(n,c[3],o,a,u,i)}}function cu(n,t){n=Zo.rgb(n),t=Zo.rgb(t);var e=n.r,r=n.g,u=n.b,i=t.r-e,o=t.g-r,a=t.b-u;return function(n){return"#"+dt(Math.round(e+i*n))+dt(Math.round(r+o*n))+dt(Math.round(u+a*n))}}function su(n,t){var e,r={},u={};for(e in n)e in t?r[e]=hu(n[e],t[e]):u[e]=n[e];for(e in t)e in n||(u[e]=t[e]);return function(n){for(e in r)u[e]=r[e](n);return u}}function lu(n,t){return t-=n=+n,function(e){return n+t*e}}function fu(n,t){var e,r,u,i=Gc.lastIndex=Kc.lastIndex=0,o=-1,a=[],c=[];for(n+="",t+="";(e=Gc.exec(n))&&(r=Kc.exec(t));)(u=r.index)>i&&(u=t.substring(i,u),a[o]?a[o]+=u:a[++o]=u),(e=e[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,c.push({i:o,x:lu(e,r)})),i=Kc.lastIndex;return i<t.length&&(u=t.substring(i),a[o]?a[o]+=u:a[++o]=u),a.length<2?c[0]?(t=c[0].x,function(n){return t(n)+""}):function(){return t}:(t=c.length,function(n){for(var e,r=0;t>r;++r)a[(e=c[r]).i]=e.x(n);return a.join("")})}function hu(n,t){for(var e,r=Zo.interpolators.length;--r>=0&&!(e=Zo.interpolators[r](n,t)););return e}function gu(n,t){var e,r=[],u=[],i=n.length,o=t.length,a=Math.min(n.length,t.length);for(e=0;a>e;++e)r.push(hu(n[e],t[e]));for(;i>e;++e)u[e]=n[e];for(;o>e;++e)u[e]=t[e];return function(n){for(e=0;a>e;++e)u[e]=r[e](n);return u}}function pu(n){return function(t){return 0>=t?0:t>=1?1:n(t)}}function vu(n){return function(t){return 1-n(1-t)}}function du(n){return function(t){return.5*(.5>t?n(2*t):2-n(2-2*t))}}function mu(n){return n*n}function yu(n){return n*n*n}function xu(n){if(0>=n)return 0;if(n>=1)return 1;var t=n*n,e=t*n;return 4*(.5>n?e:3*(n-t)+e-.75)}function Mu(n){return function(t){return Math.pow(t,n)}}function _u(n){return 1-Math.cos(n*Sa)}function bu(n){return Math.pow(2,10*(n-1))}function wu(n){return 1-Math.sqrt(1-n*n)}function Su(n,t){var e;return arguments.length<2&&(t=.45),arguments.length?e=t/wa*Math.asin(1/n):(n=1,e=t/4),function(r){return 1+n*Math.pow(2,-10*r)*Math.sin((r-e)*wa/t)}}function ku(n){return n||(n=1.70158),function(t){return t*t*((n+1)*t-n)}}function Eu(n){return 1/2.75>n?7.5625*n*n:2/2.75>n?7.5625*(n-=1.5/2.75)*n+.75:2.5/2.75>n?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375}function Au(n,t){n=Zo.hcl(n),t=Zo.hcl(t);var e=n.h,r=n.c,u=n.l,i=t.h-e,o=t.c-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return ot(e+i*n,r+o*n,u+a*n)+""}}function Cu(n,t){n=Zo.hsl(n),t=Zo.hsl(t);var e=n.h,r=n.s,u=n.l,i=t.h-e,o=t.s-r,a=t.l-u;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(i)?(i=0,e=isNaN(e)?t.h:e):i>180?i-=360:-180>i&&(i+=360),function(n){return ut(e+i*n,r+o*n,u+a*n)+""}}function Nu(n,t){n=Zo.lab(n),t=Zo.lab(t);var e=n.l,r=n.a,u=n.b,i=t.l-e,o=t.a-r,a=t.b-u;return function(n){return ct(e+i*n,r+o*n,u+a*n)+""}}function zu(n,t){return t-=n,function(e){return Math.round(n+t*e)}}function Lu(n){var t=[n.a,n.b],e=[n.c,n.d],r=qu(t),u=Tu(t,e),i=qu(Ru(e,t,-u))||0;t[0]*e[1]<e[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,u*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-e[0],e[1]))*Ca,this.translate=[n.e,n.f],this.scale=[r,i],this.skew=i?Math.atan2(u,i)*Ca:0}function Tu(n,t){return n[0]*t[0]+n[1]*t[1]}function qu(n){var t=Math.sqrt(Tu(n,n));return t&&(n[0]/=t,n[1]/=t),t}function Ru(n,t,e){return n[0]+=e*t[0],n[1]+=e*t[1],n}function Du(n,t){var e,r=[],u=[],i=Zo.transform(n),o=Zo.transform(t),a=i.translate,c=o.translate,s=i.rotate,l=o.rotate,f=i.skew,h=o.skew,g=i.scale,p=o.scale;return a[0]!=c[0]||a[1]!=c[1]?(r.push("translate(",null,",",null,")"),u.push({i:1,x:lu(a[0],c[0])},{i:3,x:lu(a[1],c[1])})):c[0]||c[1]?r.push("translate("+c+")"):r.push(""),s!=l?(s-l>180?l+=360:l-s>180&&(s+=360),u.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:lu(s,l)})):l&&r.push(r.pop()+"rotate("+l+")"),f!=h?u.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:lu(f,h)}):h&&r.push(r.pop()+"skewX("+h+")"),g[0]!=p[0]||g[1]!=p[1]?(e=r.push(r.pop()+"scale(",null,",",null,")"),u.push({i:e-4,x:lu(g[0],p[0])},{i:e-2,x:lu(g[1],p[1])})):(1!=p[0]||1!=p[1])&&r.push(r.pop()+"scale("+p+")"),e=u.length,function(n){for(var t,i=-1;++i<e;)r[(t=u[i]).i]=t.x(n);return r.join("")}}function Pu(n,t){return t=t-(n=+n)?1/(t-n):0,function(e){return(e-n)*t}}function Uu(n,t){return t=t-(n=+n)?1/(t-n):0,function(e){return Math.max(0,Math.min(1,(e-n)*t))}}function ju(n){for(var t=n.source,e=n.target,r=Fu(t,e),u=[t];t!==r;)t=t.parent,u.push(t);for(var i=u.length;e!==r;)u.splice(i,0,e),e=e.parent;return u}function Hu(n){for(var t=[],e=n.parent;null!=e;)t.push(n),n=e,e=e.parent;return t.push(n),t}function Fu(n,t){if(n===t)return n;for(var e=Hu(n),r=Hu(t),u=e.pop(),i=r.pop(),o=null;u===i;)o=u,u=e.pop(),i=r.pop();return o}function Ou(n){n.fixed|=2}function Yu(n){n.fixed&=-7}function Iu(n){n.fixed|=4,n.px=n.x,n.py=n.y}function Zu(n){n.fixed&=-5}function Vu(n,t,e){var r=0,u=0;if(n.charge=0,!n.leaf)for(var i,o=n.nodes,a=o.length,c=-1;++c<a;)i=o[c],null!=i&&(Vu(i,t,e),n.charge+=i.charge,r+=i.charge*i.cx,u+=i.charge*i.cy);if(n.point){n.leaf||(n.point.x+=Math.random()-.5,n.point.y+=Math.random()-.5);var s=t*e[n.point.index];n.charge+=n.pointCharge=s,r+=s*n.point.x,u+=s*n.point.y}n.cx=r/n.charge,n.cy=u/n.charge}function Xu(n,t){return Zo.rebind(n,t,"sort","children","value"),n.nodes=n,n.links=Ku,n}function $u(n,t){for(var e=[n];null!=(n=e.pop());)if(t(n),(u=n.children)&&(r=u.length))for(var r,u;--r>=0;)e.push(u[r])}function Bu(n,t){for(var e=[n],r=[];null!=(n=e.pop());)if(r.push(n),(i=n.children)&&(u=i.length))for(var u,i,o=-1;++o<u;)e.push(i[o]);for(;null!=(n=r.pop());)t(n)}function Wu(n){return n.children}function Ju(n){return n.value}function Gu(n,t){return t.value-n.value}function Ku(n){return Zo.merge(n.map(function(n){return(n.children||[]).map(function(t){return{source:n,target:t}})}))}function Qu(n){return n.x}function ni(n){return n.y}function ti(n,t,e){n.y0=t,n.y=e}function ei(n){return Zo.range(n.length)}function ri(n){for(var t=-1,e=n[0].length,r=[];++t<e;)r[t]=0;return r}function ui(n){for(var t,e=1,r=0,u=n[0][1],i=n.length;i>e;++e)(t=n[e][1])>u&&(r=e,u=t);return r}function ii(n){return n.reduce(oi,0)}function oi(n,t){return n+t[1]}function ai(n,t){return ci(n,Math.ceil(Math.log(t.length)/Math.LN2+1))}function ci(n,t){for(var e=-1,r=+n[0],u=(n[1]-r)/t,i=[];++e<=t;)i[e]=u*e+r;return i}function si(n){return[Zo.min(n),Zo.max(n)]}function li(n,t){return n.value-t.value}function fi(n,t){var e=n._pack_next;n._pack_next=t,t._pack_prev=n,t._pack_next=e,e._pack_prev=t}function hi(n,t){n._pack_next=t,t._pack_prev=n}function gi(n,t){var e=t.x-n.x,r=t.y-n.y,u=n.r+t.r;return.999*u*u>e*e+r*r}function pi(n){function t(n){l=Math.min(n.x-n.r,l),f=Math.max(n.x+n.r,f),h=Math.min(n.y-n.r,h),g=Math.max(n.y+n.r,g)}if((e=n.children)&&(s=e.length)){var e,r,u,i,o,a,c,s,l=1/0,f=-1/0,h=1/0,g=-1/0;if(e.forEach(vi),r=e[0],r.x=-r.r,r.y=0,t(r),s>1&&(u=e[1],u.x=u.r,u.y=0,t(u),s>2))for(i=e[2],yi(r,u,i),t(i),fi(r,i),r._pack_prev=i,fi(i,u),u=r._pack_next,o=3;s>o;o++){yi(r,u,i=e[o]);var p=0,v=1,d=1;for(a=u._pack_next;a!==u;a=a._pack_next,v++)if(gi(a,i)){p=1;break}if(1==p)for(c=r._pack_prev;c!==a._pack_prev&&!gi(c,i);c=c._pack_prev,d++);p?(d>v||v==d&&u.r<r.r?hi(r,u=a):hi(r=c,u),o--):(fi(r,i),u=i,t(i))}var m=(l+f)/2,y=(h+g)/2,x=0;for(o=0;s>o;o++)i=e[o],i.x-=m,i.y-=y,x=Math.max(x,i.r+Math.sqrt(i.x*i.x+i.y*i.y));n.r=x,e.forEach(di)}}function vi(n){n._pack_next=n._pack_prev=n}function di(n){delete n._pack_next,delete n._pack_prev}function mi(n,t,e,r){var u=n.children;if(n.x=t+=r*n.x,n.y=e+=r*n.y,n.r*=r,u)for(var i=-1,o=u.length;++i<o;)mi(u[i],t,e,r)}function yi(n,t,e){var r=n.r+e.r,u=t.x-n.x,i=t.y-n.y;if(r&&(u||i)){var o=t.r+e.r,a=u*u+i*i;o*=o,r*=r;var c=.5+(r-o)/(2*a),s=Math.sqrt(Math.max(0,2*o*(r+a)-(r-=a)*r-o*o))/(2*a);e.x=n.x+c*u+s*i,e.y=n.y+c*i-s*u}else e.x=n.x+r,e.y=n.y}function xi(n,t){return n.parent==t.parent?1:2}function Mi(n){var t=n.children;return t.length?t[0]:n.t}function _i(n){var t,e=n.children;return(t=e.length)?e[t-1]:n.t}function bi(n,t,e){var r=e/(t.i-n.i);t.c-=r,t.s+=e,n.c+=r,t.z+=e,t.m+=e}function wi(n){for(var t,e=0,r=0,u=n.children,i=u.length;--i>=0;)t=u[i],t.z+=e,t.m+=e,e+=t.s+(r+=t.c)}function Si(n,t,e){return n.a.parent===t.parent?n.a:e}function ki(n){return 1+Zo.max(n,function(n){return n.y})}function Ei(n){return n.reduce(function(n,t){return n+t.x},0)/n.length}function Ai(n){var t=n.children;return t&&t.length?Ai(t[0]):n}function Ci(n){var t,e=n.children;return e&&(t=e.length)?Ci(e[t-1]):n}function Ni(n){return{x:n.x,y:n.y,dx:n.dx,dy:n.dy}}function zi(n,t){var e=n.x+t[3],r=n.y+t[0],u=n.dx-t[1]-t[3],i=n.dy-t[0]-t[2];return 0>u&&(e+=u/2,u=0),0>i&&(r+=i/2,i=0),{x:e,y:r,dx:u,dy:i}}function Li(n){var t=n[0],e=n[n.length-1];return e>t?[t,e]:[e,t]}function Ti(n){return n.rangeExtent?n.rangeExtent():Li(n.range())}function qi(n,t,e,r){var u=e(n[0],n[1]),i=r(t[0],t[1]);return function(n){return i(u(n))}}function Ri(n,t){var e,r=0,u=n.length-1,i=n[r],o=n[u];return i>o&&(e=r,r=u,u=e,e=i,i=o,o=e),n[r]=t.floor(i),n[u]=t.ceil(o),n}function Di(n){return n?{floor:function(t){return Math.floor(t/n)*n},ceil:function(t){return Math.ceil(t/n)*n}}:ss}function Pi(n,t,e,r){var u=[],i=[],o=0,a=Math.min(n.length,t.length)-1;for(n[a]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++o<=a;)u.push(e(n[o-1],n[o])),i.push(r(t[o-1],t[o]));return function(t){var e=Zo.bisect(n,t,1,a)-1;return i[e](u[e](t))}}function Ui(n,t,e,r){function u(){var u=Math.min(n.length,t.length)>2?Pi:qi,c=r?Uu:Pu;return o=u(n,t,c,e),a=u(t,n,c,hu),i}function i(n){return o(n)}var o,a;return i.invert=function(n){return a(n)},i.domain=function(t){return arguments.length?(n=t.map(Number),u()):n},i.range=function(n){return arguments.length?(t=n,u()):t},i.rangeRound=function(n){return i.range(n).interpolate(zu)},i.clamp=function(n){return arguments.length?(r=n,u()):r},i.interpolate=function(n){return arguments.length?(e=n,u()):e},i.ticks=function(t){return Oi(n,t)},i.tickFormat=function(t,e){return Yi(n,t,e)},i.nice=function(t){return Hi(n,t),u()},i.copy=function(){return Ui(n,t,e,r)},u()}function ji(n,t){return Zo.rebind(n,t,"range","rangeRound","interpolate","clamp")}function Hi(n,t){return Ri(n,Di(Fi(n,t)[2]))}function Fi(n,t){null==t&&(t=10);var e=Li(n),r=e[1]-e[0],u=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),i=t/r*u;return.15>=i?u*=10:.35>=i?u*=5:.75>=i&&(u*=2),e[0]=Math.ceil(e[0]/u)*u,e[1]=Math.floor(e[1]/u)*u+.5*u,e[2]=u,e}function Oi(n,t){return Zo.range.apply(Zo,Fi(n,t))}function Yi(n,t,e){var r=Fi(n,t);if(e){var u=Ga.exec(e);if(u.shift(),"s"===u[8]){var i=Zo.formatPrefix(Math.max(ua(r[0]),ua(r[1])));return u[7]||(u[7]="."+Ii(i.scale(r[2]))),u[8]="f",e=Zo.format(u.join("")),function(n){return e(i.scale(n))+i.symbol}}u[7]||(u[7]="."+Zi(u[8],r)),e=u.join("")}else e=",."+Ii(r[2])+"f";return Zo.format(e)}function Ii(n){return-Math.floor(Math.log(n)/Math.LN10+.01)}function Zi(n,t){var e=Ii(t[2]);return n in ls?Math.abs(e-Ii(Math.max(ua(t[0]),ua(t[1]))))+ +("e"!==n):e-2*("%"===n)}function Vi(n,t,e,r){function u(n){return(e?Math.log(0>n?0:n):-Math.log(n>0?0:-n))/Math.log(t)}function i(n){return e?Math.pow(t,n):-Math.pow(t,-n)}function o(t){return n(u(t))}return o.invert=function(t){return i(n.invert(t))},o.domain=function(t){return arguments.length?(e=t[0]>=0,n.domain((r=t.map(Number)).map(u)),o):r},o.base=function(e){return arguments.length?(t=+e,n.domain(r.map(u)),o):t},o.nice=function(){var t=Ri(r.map(u),e?Math:hs);return n.domain(t),r=t.map(i),o},o.ticks=function(){var n=Li(r),o=[],a=n[0],c=n[1],s=Math.floor(u(a)),l=Math.ceil(u(c)),f=t%1?2:t;if(isFinite(l-s)){if(e){for(;l>s;s++)for(var h=1;f>h;h++)o.push(i(s)*h);o.push(i(s))}else for(o.push(i(s));s++<l;)for(var h=f-1;h>0;h--)o.push(i(s)*h);for(s=0;o[s]<a;s++);for(l=o.length;o[l-1]>c;l--);o=o.slice(s,l)}return o},o.tickFormat=function(n,t){if(!arguments.length)return fs;arguments.length<2?t=fs:"function"!=typeof t&&(t=Zo.format(t));var r,a=Math.max(.1,n/o.ticks().length),c=e?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(n){return n/i(c(u(n)+r))<=a?t(n):""}},o.copy=function(){return Vi(n.copy(),t,e,r)},ji(o,n)}function Xi(n,t,e){function r(t){return n(u(t))}var u=$i(t),i=$i(1/t);return r.invert=function(t){return i(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain((e=t.map(Number)).map(u)),r):e},r.ticks=function(n){return Oi(e,n)},r.tickFormat=function(n,t){return Yi(e,n,t)},r.nice=function(n){return r.domain(Hi(e,n))},r.exponent=function(o){return arguments.length?(u=$i(t=o),i=$i(1/t),n.domain(e.map(u)),r):t},r.copy=function(){return Xi(n.copy(),t,e)},ji(r,n)}function $i(n){return function(t){return 0>t?-Math.pow(-t,n):Math.pow(t,n)}}function Bi(n,t){function e(e){return i[((u.get(e)||("range"===t.t?u.set(e,n.push(e)):0/0))-1)%i.length]}function r(t,e){return Zo.range(n.length).map(function(n){return t+e*n})}var u,i,a;return e.domain=function(r){if(!arguments.length)return n;n=[],u=new o;for(var i,a=-1,c=r.length;++a<c;)u.has(i=r[a])||u.set(i,n.push(i));return e[t.t].apply(e,t.a)},e.range=function(n){return arguments.length?(i=n,a=0,t={t:"range",a:arguments},e):i},e.rangePoints=function(u,o){arguments.length<2&&(o=0);var c=u[0],s=u[1],l=(s-c)/(Math.max(1,n.length-1)+o);return i=r(n.length<2?(c+s)/2:c+l*o/2,l),a=0,t={t:"rangePoints",a:arguments},e},e.rangeBands=function(u,o,c){arguments.length<2&&(o=0),arguments.length<3&&(c=o);var s=u[1]<u[0],l=u[s-0],f=u[1-s],h=(f-l)/(n.length-o+2*c);return i=r(l+h*c,h),s&&i.reverse(),a=h*(1-o),t={t:"rangeBands",a:arguments},e},e.rangeRoundBands=function(u,o,c){arguments.length<2&&(o=0),arguments.length<3&&(c=o);var s=u[1]<u[0],l=u[s-0],f=u[1-s],h=Math.floor((f-l)/(n.length-o+2*c)),g=f-l-(n.length-o)*h;return i=r(l+Math.round(g/2),h),s&&i.reverse(),a=Math.round(h*(1-o)),t={t:"rangeRoundBands",a:arguments},e},e.rangeBand=function(){return a},e.rangeExtent=function(){return Li(t.a[0])},e.copy=function(){return Bi(n,t)},e.domain(n)}function Wi(e,r){function u(){var n=0,t=r.length;for(o=[];++n<t;)o[n-1]=Zo.quantile(e,n/t);return i}function i(n){return isNaN(n=+n)?void 0:r[Zo.bisect(o,n)]}var o;return i.domain=function(r){return arguments.length?(e=r.filter(t).sort(n),u()):e},i.range=function(n){return arguments.length?(r=n,u()):r},i.quantiles=function(){return o},i.invertExtent=function(n){return n=r.indexOf(n),0>n?[0/0,0/0]:[n>0?o[n-1]:e[0],n<o.length?o[n]:e[e.length-1]]},i.copy=function(){return Wi(e,r)},u()}function Ji(n,t,e){function r(t){return e[Math.max(0,Math.min(o,Math.floor(i*(t-n))))]}function u(){return i=e.length/(t-n),o=e.length-1,r}var i,o;return r.domain=function(e){return arguments.length?(n=+e[0],t=+e[e.length-1],u()):[n,t]},r.range=function(n){return arguments.length?(e=n,u()):e},r.invertExtent=function(t){return t=e.indexOf(t),t=0>t?0/0:t/i+n,[t,t+1/i]},r.copy=function(){return Ji(n,t,e)},u()}function Gi(n,t){function e(e){return e>=e?t[Zo.bisect(n,e)]:void 0}return e.domain=function(t){return arguments.length?(n=t,e):n},e.range=function(n){return arguments.length?(t=n,e):t},e.invertExtent=function(e){return e=t.indexOf(e),[n[e-1],n[e]]},e.copy=function(){return Gi(n,t)},e}function Ki(n){function t(n){return+n}return t.invert=t,t.domain=t.range=function(e){return arguments.length?(n=e.map(t),t):n},t.ticks=function(t){return Oi(n,t)},t.tickFormat=function(t,e){return Yi(n,t,e)},t.copy=function(){return Ki(n)},t}function Qi(n){return n.innerRadius}function no(n){return n.outerRadius}function to(n){return n.startAngle}function eo(n){return n.endAngle}function ro(n){function t(t){function o(){s.push("M",i(n(l),a))}for(var c,s=[],l=[],f=-1,h=t.length,g=bt(e),p=bt(r);++f<h;)u.call(this,c=t[f],f)?l.push([+g.call(this,c,f),+p.call(this,c,f)]):l.length&&(o(),l=[]);return l.length&&o(),s.length?s.join(""):null}var e=wr,r=Sr,u=we,i=uo,o=i.key,a=.7;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t.defined=function(n){return arguments.length?(u=n,t):u},t.interpolate=function(n){return arguments.length?(o="function"==typeof n?i=n:(i=xs.get(n)||uo).key,t):o},t.tension=function(n){return arguments.length?(a=n,t):a},t}function uo(n){return n.join("L")}function io(n){return uo(n)+"Z"}function oo(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r[0]+(r=n[t])[0])/2,"V",r[1]);return e>1&&u.push("H",r[0]),u.join("")}function ao(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("V",(r=n[t])[1],"H",r[0]);return u.join("")}function co(n){for(var t=0,e=n.length,r=n[0],u=[r[0],",",r[1]];++t<e;)u.push("H",(r=n[t])[0],"V",r[1]);return u.join("")}function so(n,t){return n.length<4?uo(n):n[1]+ho(n.slice(1,n.length-1),go(n,t))}function lo(n,t){return n.length<3?uo(n):n[0]+ho((n.push(n[0]),n),go([n[n.length-2]].concat(n,[n[1]]),t))}function fo(n,t){return n.length<3?uo(n):n[0]+ho(n,go(n,t))}function ho(n,t){if(t.length<1||n.length!=t.length&&n.length!=t.length+2)return uo(n);var e=n.length!=t.length,r="",u=n[0],i=n[1],o=t[0],a=o,c=1;if(e&&(r+="Q"+(i[0]-2*o[0]/3)+","+(i[1]-2*o[1]/3)+","+i[0]+","+i[1],u=n[1],c=2),t.length>1){a=t[1],i=n[c],c++,r+="C"+(u[0]+o[0])+","+(u[1]+o[1])+","+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1];for(var s=2;s<t.length;s++,c++)i=n[c],a=t[s],r+="S"+(i[0]-a[0])+","+(i[1]-a[1])+","+i[0]+","+i[1]}if(e){var l=n[c];r+="Q"+(i[0]+2*a[0]/3)+","+(i[1]+2*a[1]/3)+","+l[0]+","+l[1]}return r}function go(n,t){for(var e,r=[],u=(1-t)/2,i=n[0],o=n[1],a=1,c=n.length;++a<c;)e=i,i=o,o=n[a],r.push([u*(o[0]-e[0]),u*(o[1]-e[1])]);return r}function po(n){if(n.length<3)return uo(n);var t=1,e=n.length,r=n[0],u=r[0],i=r[1],o=[u,u,u,(r=n[1])[0]],a=[i,i,i,r[1]],c=[u,",",i,"L",xo(bs,o),",",xo(bs,a)];for(n.push(n[e-1]);++t<=e;)r=n[t],o.shift(),o.push(r[0]),a.shift(),a.push(r[1]),Mo(c,o,a);return n.pop(),c.push("L",r),c.join("")}function vo(n){if(n.length<4)return uo(n);for(var t,e=[],r=-1,u=n.length,i=[0],o=[0];++r<3;)t=n[r],i.push(t[0]),o.push(t[1]);for(e.push(xo(bs,i)+","+xo(bs,o)),--r;++r<u;)t=n[r],i.shift(),i.push(t[0]),o.shift(),o.push(t[1]),Mo(e,i,o);return e.join("")}function mo(n){for(var t,e,r=-1,u=n.length,i=u+4,o=[],a=[];++r<4;)e=n[r%u],o.push(e[0]),a.push(e[1]);for(t=[xo(bs,o),",",xo(bs,a)],--r;++r<i;)e=n[r%u],o.shift(),o.push(e[0]),a.shift(),a.push(e[1]),Mo(t,o,a);return t.join("")}function yo(n,t){var e=n.length-1;if(e)for(var r,u,i=n[0][0],o=n[0][1],a=n[e][0]-i,c=n[e][1]-o,s=-1;++s<=e;)r=n[s],u=s/e,r[0]=t*r[0]+(1-t)*(i+u*a),r[1]=t*r[1]+(1-t)*(o+u*c);return po(n)}function xo(n,t){return n[0]*t[0]+n[1]*t[1]+n[2]*t[2]+n[3]*t[3]}function Mo(n,t,e){n.push("C",xo(Ms,t),",",xo(Ms,e),",",xo(_s,t),",",xo(_s,e),",",xo(bs,t),",",xo(bs,e))}function _o(n,t){return(t[1]-n[1])/(t[0]-n[0])}function bo(n){for(var t=0,e=n.length-1,r=[],u=n[0],i=n[1],o=r[0]=_o(u,i);++t<e;)r[t]=(o+(o=_o(u=i,i=n[t+1])))/2;return r[t]=o,r}function wo(n){for(var t,e,r,u,i=[],o=bo(n),a=-1,c=n.length-1;++a<c;)t=_o(n[a],n[a+1]),ua(t)<ka?o[a]=o[a+1]=0:(e=o[a]/t,r=o[a+1]/t,u=e*e+r*r,u>9&&(u=3*t/Math.sqrt(u),o[a]=u*e,o[a+1]=u*r));for(a=-1;++a<=c;)u=(n[Math.min(c,a+1)][0]-n[Math.max(0,a-1)][0])/(6*(1+o[a]*o[a])),i.push([u||0,o[a]*u||0]);return i}function So(n){return n.length<3?uo(n):n[0]+ho(n,wo(n))}function ko(n){for(var t,e,r,u=-1,i=n.length;++u<i;)t=n[u],e=t[0],r=t[1]+ms,t[0]=e*Math.cos(r),t[1]=e*Math.sin(r);return n}function Eo(n){function t(t){function c(){v.push("M",a(n(m),f),l,s(n(d.reverse()),f),"Z")}for(var h,g,p,v=[],d=[],m=[],y=-1,x=t.length,M=bt(e),_=bt(u),b=e===r?function(){return g}:bt(r),w=u===i?function(){return p}:bt(i);++y<x;)o.call(this,h=t[y],y)?(d.push([g=+M.call(this,h,y),p=+_.call(this,h,y)]),m.push([+b.call(this,h,y),+w.call(this,h,y)])):d.length&&(c(),d=[],m=[]);return d.length&&c(),v.length?v.join(""):null}var e=wr,r=wr,u=0,i=Sr,o=we,a=uo,c=a.key,s=a,l="L",f=.7;return t.x=function(n){return arguments.length?(e=r=n,t):r},t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(n){return arguments.length?(r=n,t):r},t.y=function(n){return arguments.length?(u=i=n,t):i},t.y0=function(n){return arguments.length?(u=n,t):u},t.y1=function(n){return arguments.length?(i=n,t):i},t.defined=function(n){return arguments.length?(o=n,t):o},t.interpolate=function(n){return arguments.length?(c="function"==typeof n?a=n:(a=xs.get(n)||uo).key,s=a.reverse||a,l=a.closed?"M":"L",t):c},t.tension=function(n){return arguments.length?(f=n,t):f},t}function Ao(n){return n.radius}function Co(n){return[n.x,n.y]}function No(n){return function(){var t=n.apply(this,arguments),e=t[0],r=t[1]+ms;return[e*Math.cos(r),e*Math.sin(r)]}}function zo(){return 64}function Lo(){return"circle"}function To(n){var t=Math.sqrt(n/ba);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+-t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function qo(n,t){return sa(n,Cs),n.id=t,n}function Ro(n,t,e,r){var u=n.id;return P(n,"function"==typeof e?function(n,i,o){n.__transition__[u].tween.set(t,r(e.call(n,n.__data__,i,o)))}:(e=r(e),function(n){n.__transition__[u].tween.set(t,e)}))}function Do(n){return null==n&&(n=""),function(){this.textContent=n}}function Po(n,t,e,r){var u=n.__transition__||(n.__transition__={active:0,count:0}),i=u[e];if(!i){var a=r.time;i=u[e]={tween:new o,time:a,ease:r.ease,delay:r.delay,duration:r.duration},++u.count,Zo.timer(function(r){function o(r){return u.active>e?s():(u.active=e,i.event&&i.event.start.call(n,l,t),i.tween.forEach(function(e,r){(r=r.call(n,l,t))&&v.push(r)}),Zo.timer(function(){return p.c=c(r||1)?we:c,1},0,a),void 0)}function c(r){if(u.active!==e)return s();for(var o=r/g,a=f(o),c=v.length;c>0;)v[--c].call(n,a);
    return o>=1?(i.event&&i.event.end.call(n,l,t),s()):void 0}function s(){return--u.count?delete u[e]:delete n.__transition__,1}var l=n.__data__,f=i.ease,h=i.delay,g=i.duration,p=Ba,v=[];return p.t=h+a,r>=h?o(r-h):(p.c=o,void 0)},0,a)}}function Uo(n,t){n.attr("transform",function(n){return"translate("+t(n)+",0)"})}function jo(n,t){n.attr("transform",function(n){return"translate(0,"+t(n)+")"})}function Ho(n){return n.toISOString()}function Fo(n,t,e){function r(t){return n(t)}function u(n,e){var r=n[1]-n[0],u=r/e,i=Zo.bisect(Us,u);return i==Us.length?[t.year,Fi(n.map(function(n){return n/31536e6}),e)[2]]:i?t[u/Us[i-1]<Us[i]/u?i-1:i]:[Fs,Fi(n,e)[2]]}return r.invert=function(t){return Oo(n.invert(t))},r.domain=function(t){return arguments.length?(n.domain(t),r):n.domain().map(Oo)},r.nice=function(n,t){function e(e){return!isNaN(e)&&!n.range(e,Oo(+e+1),t).length}var i=r.domain(),o=Li(i),a=null==n?u(o,10):"number"==typeof n&&u(o,n);return a&&(n=a[0],t=a[1]),r.domain(Ri(i,t>1?{floor:function(t){for(;e(t=n.floor(t));)t=Oo(t-1);return t},ceil:function(t){for(;e(t=n.ceil(t));)t=Oo(+t+1);return t}}:n))},r.ticks=function(n,t){var e=Li(r.domain()),i=null==n?u(e,10):"number"==typeof n?u(e,n):!n.range&&[{range:n},t];return i&&(n=i[0],t=i[1]),n.range(e[0],Oo(+e[1]+1),1>t?1:t)},r.tickFormat=function(){return e},r.copy=function(){return Fo(n.copy(),t,e)},ji(r,n)}function Oo(n){return new Date(n)}function Yo(n){return JSON.parse(n.responseText)}function Io(n){var t=$o.createRange();return t.selectNode($o.body),t.createContextualFragment(n.responseText)}var Zo={version:"3.4.11"};Date.now||(Date.now=function(){return+new Date});var Vo=[].slice,Xo=function(n){return Vo.call(n)},$o=document,Bo=$o.documentElement,Wo=window;try{Xo(Bo.childNodes)[0].nodeType}catch(Jo){Xo=function(n){for(var t=n.length,e=new Array(t);t--;)e[t]=n[t];return e}}try{$o.createElement("div").style.setProperty("opacity",0,"")}catch(Go){var Ko=Wo.Element.prototype,Qo=Ko.setAttribute,na=Ko.setAttributeNS,ta=Wo.CSSStyleDeclaration.prototype,ea=ta.setProperty;Ko.setAttribute=function(n,t){Qo.call(this,n,t+"")},Ko.setAttributeNS=function(n,t,e){na.call(this,n,t,e+"")},ta.setProperty=function(n,t,e){ea.call(this,n,t+"",e)}}Zo.ascending=n,Zo.descending=function(n,t){return n>t?-1:t>n?1:t>=n?0:0/0},Zo.min=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i&&!(null!=(e=n[u])&&e>=e);)e=void 0;for(;++u<i;)null!=(r=n[u])&&e>r&&(e=r)}else{for(;++u<i&&!(null!=(e=t.call(n,n[u],u))&&e>=e);)e=void 0;for(;++u<i;)null!=(r=t.call(n,n[u],u))&&e>r&&(e=r)}return e},Zo.max=function(n,t){var e,r,u=-1,i=n.length;if(1===arguments.length){for(;++u<i&&!(null!=(e=n[u])&&e>=e);)e=void 0;for(;++u<i;)null!=(r=n[u])&&r>e&&(e=r)}else{for(;++u<i&&!(null!=(e=t.call(n,n[u],u))&&e>=e);)e=void 0;for(;++u<i;)null!=(r=t.call(n,n[u],u))&&r>e&&(e=r)}return e},Zo.extent=function(n,t){var e,r,u,i=-1,o=n.length;if(1===arguments.length){for(;++i<o&&!(null!=(e=u=n[i])&&e>=e);)e=u=void 0;for(;++i<o;)null!=(r=n[i])&&(e>r&&(e=r),r>u&&(u=r))}else{for(;++i<o&&!(null!=(e=u=t.call(n,n[i],i))&&e>=e);)e=void 0;for(;++i<o;)null!=(r=t.call(n,n[i],i))&&(e>r&&(e=r),r>u&&(u=r))}return[e,u]},Zo.sum=function(n,t){var e,r=0,u=n.length,i=-1;if(1===arguments.length)for(;++i<u;)isNaN(e=+n[i])||(r+=e);else for(;++i<u;)isNaN(e=+t.call(n,n[i],i))||(r+=e);return r},Zo.mean=function(n,e){var r,u=0,i=n.length,o=-1,a=i;if(1===arguments.length)for(;++o<i;)t(r=n[o])?u+=r:--a;else for(;++o<i;)t(r=e.call(n,n[o],o))?u+=r:--a;return a?u/a:void 0},Zo.quantile=function(n,t){var e=(n.length-1)*t+1,r=Math.floor(e),u=+n[r-1],i=e-r;return i?u+i*(n[r]-u):u},Zo.median=function(e,r){return arguments.length>1&&(e=e.map(r)),e=e.filter(t),e.length?Zo.quantile(e.sort(n),.5):void 0};var ra=e(n);Zo.bisectLeft=ra.left,Zo.bisect=Zo.bisectRight=ra.right,Zo.bisector=function(t){return e(1===t.length?function(e,r){return n(t(e),r)}:t)},Zo.shuffle=function(n){for(var t,e,r=n.length;r;)e=0|Math.random()*r--,t=n[r],n[r]=n[e],n[e]=t;return n},Zo.permute=function(n,t){for(var e=t.length,r=new Array(e);e--;)r[e]=n[t[e]];return r},Zo.pairs=function(n){for(var t,e=0,r=n.length-1,u=n[0],i=new Array(0>r?0:r);r>e;)i[e]=[t=u,u=n[++e]];return i},Zo.zip=function(){if(!(u=arguments.length))return[];for(var n=-1,t=Zo.min(arguments,r),e=new Array(t);++n<t;)for(var u,i=-1,o=e[n]=new Array(u);++i<u;)o[i]=arguments[i][n];return e},Zo.transpose=function(n){return Zo.zip.apply(Zo,n)},Zo.keys=function(n){var t=[];for(var e in n)t.push(e);return t},Zo.values=function(n){var t=[];for(var e in n)t.push(n[e]);return t},Zo.entries=function(n){var t=[];for(var e in n)t.push({key:e,value:n[e]});return t},Zo.merge=function(n){for(var t,e,r,u=n.length,i=-1,o=0;++i<u;)o+=n[i].length;for(e=new Array(o);--u>=0;)for(r=n[u],t=r.length;--t>=0;)e[--o]=r[t];return e};var ua=Math.abs;Zo.range=function(n,t,e){if(arguments.length<3&&(e=1,arguments.length<2&&(t=n,n=0)),1/0===(t-n)/e)throw new Error("infinite range");var r,i=[],o=u(ua(e)),a=-1;if(n*=o,t*=o,e*=o,0>e)for(;(r=n+e*++a)>t;)i.push(r/o);else for(;(r=n+e*++a)<t;)i.push(r/o);return i},Zo.map=function(n){var t=new o;if(n instanceof o)n.forEach(function(n,e){t.set(n,e)});else for(var e in n)t.set(e,n[e]);return t},i(o,{has:a,get:function(n){return this[ia+n]},set:function(n,t){return this[ia+n]=t},remove:c,keys:s,values:function(){var n=[];return this.forEach(function(t,e){n.push(e)}),n},entries:function(){var n=[];return this.forEach(function(t,e){n.push({key:t,value:e})}),n},size:l,empty:f,forEach:function(n){for(var t in this)t.charCodeAt(0)===oa&&n.call(this,t.substring(1),this[t])}});var ia="\x00",oa=ia.charCodeAt(0);Zo.nest=function(){function n(t,a,c){if(c>=i.length)return r?r.call(u,a):e?a.sort(e):a;for(var s,l,f,h,g=-1,p=a.length,v=i[c++],d=new o;++g<p;)(h=d.get(s=v(l=a[g])))?h.push(l):d.set(s,[l]);return t?(l=t(),f=function(e,r){l.set(e,n(t,r,c))}):(l={},f=function(e,r){l[e]=n(t,r,c)}),d.forEach(f),l}function t(n,e){if(e>=i.length)return n;var r=[],u=a[e++];return n.forEach(function(n,u){r.push({key:n,values:t(u,e)})}),u?r.sort(function(n,t){return u(n.key,t.key)}):r}var e,r,u={},i=[],a=[];return u.map=function(t,e){return n(e,t,0)},u.entries=function(e){return t(n(Zo.map,e,0),0)},u.key=function(n){return i.push(n),u},u.sortKeys=function(n){return a[i.length-1]=n,u},u.sortValues=function(n){return e=n,u},u.rollup=function(n){return r=n,u},u},Zo.set=function(n){var t=new h;if(n)for(var e=0,r=n.length;r>e;++e)t.add(n[e]);return t},i(h,{has:a,add:function(n){return this[ia+n]=!0,n},remove:function(n){return n=ia+n,n in this&&delete this[n]},values:s,size:l,empty:f,forEach:function(n){for(var t in this)t.charCodeAt(0)===oa&&n.call(this,t.substring(1))}}),Zo.behavior={},Zo.rebind=function(n,t){for(var e,r=1,u=arguments.length;++r<u;)n[e=arguments[r]]=g(n,t,t[e]);return n};var aa=["webkit","ms","moz","Moz","o","O"];Zo.dispatch=function(){for(var n=new d,t=-1,e=arguments.length;++t<e;)n[arguments[t]]=m(n);return n},d.prototype.on=function(n,t){var e=n.indexOf("."),r="";if(e>=0&&(r=n.substring(e+1),n=n.substring(0,e)),n)return arguments.length<2?this[n].on(r):this[n].on(r,t);if(2===arguments.length){if(null==t)for(n in this)this.hasOwnProperty(n)&&this[n].on(r,null);return this}},Zo.event=null,Zo.requote=function(n){return n.replace(ca,"\\$&")};var ca=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,sa={}.__proto__?function(n,t){n.__proto__=t}:function(n,t){for(var e in t)n[e]=t[e]},la=function(n,t){return t.querySelector(n)},fa=function(n,t){return t.querySelectorAll(n)},ha=Bo.matches||Bo[p(Bo,"matchesSelector")],ga=function(n,t){return ha.call(n,t)};"function"==typeof Sizzle&&(la=function(n,t){return Sizzle(n,t)[0]||null},fa=Sizzle,ga=Sizzle.matchesSelector),Zo.selection=function(){return ma};var pa=Zo.selection.prototype=[];pa.select=function(n){var t,e,r,u,i=[];n=b(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var c=-1,s=r.length;++c<s;)(u=r[c])?(t.push(e=n.call(u,u.__data__,c,o)),e&&"__data__"in u&&(e.__data__=u.__data__)):t.push(null)}return _(i)},pa.selectAll=function(n){var t,e,r=[];n=w(n);for(var u=-1,i=this.length;++u<i;)for(var o=this[u],a=-1,c=o.length;++a<c;)(e=o[a])&&(r.push(t=Xo(n.call(e,e.__data__,a,u))),t.parentNode=e);return _(r)};var va={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Zo.ns={prefix:va,qualify:function(n){var t=n.indexOf(":"),e=n;return t>=0&&(e=n.substring(0,t),n=n.substring(t+1)),va.hasOwnProperty(e)?{space:va[e],local:n}:n}},pa.attr=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node();return n=Zo.ns.qualify(n),n.local?e.getAttributeNS(n.space,n.local):e.getAttribute(n)}for(t in n)this.each(S(t,n[t]));return this}return this.each(S(n,t))},pa.classed=function(n,t){if(arguments.length<2){if("string"==typeof n){var e=this.node(),r=(n=A(n)).length,u=-1;if(t=e.classList){for(;++u<r;)if(!t.contains(n[u]))return!1}else for(t=e.getAttribute("class");++u<r;)if(!E(n[u]).test(t))return!1;return!0}for(t in n)this.each(C(t,n[t]));return this}return this.each(C(n,t))},pa.style=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t="");for(e in n)this.each(z(e,n[e],t));return this}if(2>r)return Wo.getComputedStyle(this.node(),null).getPropertyValue(n);e=""}return this.each(z(n,t,e))},pa.property=function(n,t){if(arguments.length<2){if("string"==typeof n)return this.node()[n];for(t in n)this.each(L(t,n[t]));return this}return this.each(L(n,t))},pa.text=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.textContent=null==t?"":t}:null==n?function(){this.textContent=""}:function(){this.textContent=n}):this.node().textContent},pa.html=function(n){return arguments.length?this.each("function"==typeof n?function(){var t=n.apply(this,arguments);this.innerHTML=null==t?"":t}:null==n?function(){this.innerHTML=""}:function(){this.innerHTML=n}):this.node().innerHTML},pa.append=function(n){return n=T(n),this.select(function(){return this.appendChild(n.apply(this,arguments))})},pa.insert=function(n,t){return n=T(n),t=b(t),this.select(function(){return this.insertBefore(n.apply(this,arguments),t.apply(this,arguments)||null)})},pa.remove=function(){return this.each(function(){var n=this.parentNode;n&&n.removeChild(this)})},pa.data=function(n,t){function e(n,e){var r,u,i,a=n.length,f=e.length,h=Math.min(a,f),g=new Array(f),p=new Array(f),v=new Array(a);if(t){var d,m=new o,y=new o,x=[];for(r=-1;++r<a;)d=t.call(u=n[r],u.__data__,r),m.has(d)?v[r]=u:m.set(d,u),x.push(d);for(r=-1;++r<f;)d=t.call(e,i=e[r],r),(u=m.get(d))?(g[r]=u,u.__data__=i):y.has(d)||(p[r]=q(i)),y.set(d,i),m.remove(d);for(r=-1;++r<a;)m.has(x[r])&&(v[r]=n[r])}else{for(r=-1;++r<h;)u=n[r],i=e[r],u?(u.__data__=i,g[r]=u):p[r]=q(i);for(;f>r;++r)p[r]=q(e[r]);for(;a>r;++r)v[r]=n[r]}p.update=g,p.parentNode=g.parentNode=v.parentNode=n.parentNode,c.push(p),s.push(g),l.push(v)}var r,u,i=-1,a=this.length;if(!arguments.length){for(n=new Array(a=(r=this[0]).length);++i<a;)(u=r[i])&&(n[i]=u.__data__);return n}var c=U([]),s=_([]),l=_([]);if("function"==typeof n)for(;++i<a;)e(r=this[i],n.call(r,r.parentNode.__data__,i));else for(;++i<a;)e(r=this[i],n);return s.enter=function(){return c},s.exit=function(){return l},s},pa.datum=function(n){return arguments.length?this.property("__data__",n):this.property("__data__")},pa.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=R(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]),t.parentNode=(e=this[i]).parentNode;for(var a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a,i)&&t.push(r)}return _(u)},pa.order=function(){for(var n=-1,t=this.length;++n<t;)for(var e,r=this[n],u=r.length-1,i=r[u];--u>=0;)(e=r[u])&&(i&&i!==e.nextSibling&&i.parentNode.insertBefore(e,i),i=e);return this},pa.sort=function(n){n=D.apply(this,arguments);for(var t=-1,e=this.length;++t<e;)this[t].sort(n);return this.order()},pa.each=function(n){return P(this,function(t,e,r){n.call(t,t.__data__,e,r)})},pa.call=function(n){var t=Xo(arguments);return n.apply(t[0]=this,t),this},pa.empty=function(){return!this.node()},pa.node=function(){for(var n=0,t=this.length;t>n;n++)for(var e=this[n],r=0,u=e.length;u>r;r++){var i=e[r];if(i)return i}return null},pa.size=function(){var n=0;return this.each(function(){++n}),n};var da=[];Zo.selection.enter=U,Zo.selection.enter.prototype=da,da.append=pa.append,da.empty=pa.empty,da.node=pa.node,da.call=pa.call,da.size=pa.size,da.select=function(n){for(var t,e,r,u,i,o=[],a=-1,c=this.length;++a<c;){r=(u=this[a]).update,o.push(t=[]),t.parentNode=u.parentNode;for(var s=-1,l=u.length;++s<l;)(i=u[s])?(t.push(r[s]=e=n.call(u.parentNode,i.__data__,s,a)),e.__data__=i.__data__):t.push(null)}return _(o)},da.insert=function(n,t){return arguments.length<2&&(t=j(this)),pa.insert.call(this,n,t)},pa.transition=function(){for(var n,t,e=Ss||++Ns,r=[],u=ks||{time:Date.now(),ease:xu,delay:0,duration:250},i=-1,o=this.length;++i<o;){r.push(n=[]);for(var a=this[i],c=-1,s=a.length;++c<s;)(t=a[c])&&Po(t,c,e,u),n.push(t)}return qo(r,e)},pa.interrupt=function(){return this.each(H)},Zo.select=function(n){var t=["string"==typeof n?la(n,$o):n];return t.parentNode=Bo,_([t])},Zo.selectAll=function(n){var t=Xo("string"==typeof n?fa(n,$o):n);return t.parentNode=Bo,_([t])};var ma=Zo.select(Bo);pa.on=function(n,t,e){var r=arguments.length;if(3>r){if("string"!=typeof n){2>r&&(t=!1);for(e in n)this.each(F(e,n[e],t));return this}if(2>r)return(r=this.node()["__on"+n])&&r._;e=!1}return this.each(F(n,t,e))};var ya=Zo.map({mouseenter:"mouseover",mouseleave:"mouseout"});ya.forEach(function(n){"on"+n in $o&&ya.remove(n)});var xa="onselectstart"in $o?null:p(Bo.style,"userSelect"),Ma=0;Zo.mouse=function(n){return Z(n,x())};var _a=/WebKit/.test(Wo.navigator.userAgent)?-1:0;Zo.touches=function(n,t){return arguments.length<2&&(t=x().touches),t?Xo(t).map(function(t){var e=Z(n,t);return e.identifier=t.identifier,e}):[]},Zo.behavior.drag=function(){function n(){this.on("mousedown.drag",u).on("touchstart.drag",i)}function t(n,t,u,i,o){return function(){function a(){var n,e,r=t(h,v);r&&(n=r[0]-x[0],e=r[1]-x[1],p|=n|e,x=r,g({type:"drag",x:r[0]+s[0],y:r[1]+s[1],dx:n,dy:e}))}function c(){t(h,v)&&(m.on(i+d,null).on(o+d,null),y(p&&Zo.event.target===f),g({type:"dragend"}))}var s,l=this,f=Zo.event.target,h=l.parentNode,g=e.of(l,arguments),p=0,v=n(),d=".drag"+(null==v?"":"-"+v),m=Zo.select(u()).on(i+d,a).on(o+d,c),y=I(),x=t(h,v);r?(s=r.apply(l,arguments),s=[s.x-x[0],s.y-x[1]]):s=[0,0],g({type:"dragstart"})}}var e=M(n,"drag","dragstart","dragend"),r=null,u=t(v,Zo.mouse,$,"mousemove","mouseup"),i=t(V,Zo.touch,X,"touchmove","touchend");return n.origin=function(t){return arguments.length?(r=t,n):r},Zo.rebind(n,e,"on")};var ba=Math.PI,wa=2*ba,Sa=ba/2,ka=1e-6,Ea=ka*ka,Aa=ba/180,Ca=180/ba,Na=Math.SQRT2,za=2,La=4;Zo.interpolateZoom=function(n,t){function e(n){var t=n*y;if(m){var e=Q(v),o=i/(za*h)*(e*nt(Na*t+v)-K(v));return[r+o*s,u+o*l,i*e/Q(Na*t+v)]}return[r+n*s,u+n*l,i*Math.exp(Na*t)]}var r=n[0],u=n[1],i=n[2],o=t[0],a=t[1],c=t[2],s=o-r,l=a-u,f=s*s+l*l,h=Math.sqrt(f),g=(c*c-i*i+La*f)/(2*i*za*h),p=(c*c-i*i-La*f)/(2*c*za*h),v=Math.log(Math.sqrt(g*g+1)-g),d=Math.log(Math.sqrt(p*p+1)-p),m=d-v,y=(m||Math.log(c/i))/Na;return e.duration=1e3*y,e},Zo.behavior.zoom=function(){function n(n){n.on(A,s).on(Ra+".zoom",f).on("dblclick.zoom",h).on(z,l)}function t(n){return[(n[0]-S.x)/S.k,(n[1]-S.y)/S.k]}function e(n){return[n[0]*S.k+S.x,n[1]*S.k+S.y]}function r(n){S.k=Math.max(E[0],Math.min(E[1],n))}function u(n,t){t=e(t),S.x+=n[0]-t[0],S.y+=n[1]-t[1]}function i(){_&&_.domain(x.range().map(function(n){return(n-S.x)/S.k}).map(x.invert)),w&&w.domain(b.range().map(function(n){return(n-S.y)/S.k}).map(b.invert))}function o(n){n({type:"zoomstart"})}function a(n){i(),n({type:"zoom",scale:S.k,translate:[S.x,S.y]})}function c(n){n({type:"zoomend"})}function s(){function n(){l=1,u(Zo.mouse(r),h),a(s)}function e(){f.on(C,null).on(N,null),g(l&&Zo.event.target===i),c(s)}var r=this,i=Zo.event.target,s=L.of(r,arguments),l=0,f=Zo.select(Wo).on(C,n).on(N,e),h=t(Zo.mouse(r)),g=I();H.call(r),o(s)}function l(){function n(){var n=Zo.touches(g);return h=S.k,n.forEach(function(n){n.identifier in v&&(v[n.identifier]=t(n))}),n}function e(){var t=Zo.event.target;Zo.select(t).on(M,i).on(_,f),b.push(t);for(var e=Zo.event.changedTouches,o=0,c=e.length;c>o;++o)v[e[o].identifier]=null;var s=n(),l=Date.now();if(1===s.length){if(500>l-m){var h=s[0],g=v[h.identifier];r(2*S.k),u(h,g),y(),a(p)}m=l}else if(s.length>1){var h=s[0],x=s[1],w=h[0]-x[0],k=h[1]-x[1];d=w*w+k*k}}function i(){for(var n,t,e,i,o=Zo.touches(g),c=0,s=o.length;s>c;++c,i=null)if(e=o[c],i=v[e.identifier]){if(t)break;n=e,t=i}if(i){var l=(l=e[0]-n[0])*l+(l=e[1]-n[1])*l,f=d&&Math.sqrt(l/d);n=[(n[0]+e[0])/2,(n[1]+e[1])/2],t=[(t[0]+i[0])/2,(t[1]+i[1])/2],r(f*h)}m=null,u(n,t),a(p)}function f(){if(Zo.event.touches.length){for(var t=Zo.event.changedTouches,e=0,r=t.length;r>e;++e)delete v[t[e].identifier];for(var u in v)return void n()}Zo.selectAll(b).on(x,null),w.on(A,s).on(z,l),k(),c(p)}var h,g=this,p=L.of(g,arguments),v={},d=0,x=".zoom-"+Zo.event.changedTouches[0].identifier,M="touchmove"+x,_="touchend"+x,b=[],w=Zo.select(g).on(A,null).on(z,e),k=I();H.call(g),e(),o(p)}function f(){var n=L.of(this,arguments);d?clearTimeout(d):(g=t(p=v||Zo.mouse(this)),H.call(this),o(n)),d=setTimeout(function(){d=null,c(n)},50),y(),r(Math.pow(2,.002*Ta())*S.k),u(p,g),a(n)}function h(){var n=L.of(this,arguments),e=Zo.mouse(this),i=t(e),s=Math.log(S.k)/Math.LN2;o(n),r(Math.pow(2,Zo.event.shiftKey?Math.ceil(s)-1:Math.floor(s)+1)),u(e,i),a(n),c(n)}var g,p,v,d,m,x,_,b,w,S={x:0,y:0,k:1},k=[960,500],E=qa,A="mousedown.zoom",C="mousemove.zoom",N="mouseup.zoom",z="touchstart.zoom",L=M(n,"zoomstart","zoom","zoomend");return n.event=function(n){n.each(function(){var n=L.of(this,arguments),t=S;Ss?Zo.select(this).transition().each("start.zoom",function(){S=this.__chart__||{x:0,y:0,k:1},o(n)}).tween("zoom:zoom",function(){var e=k[0],r=k[1],u=e/2,i=r/2,o=Zo.interpolateZoom([(u-S.x)/S.k,(i-S.y)/S.k,e/S.k],[(u-t.x)/t.k,(i-t.y)/t.k,e/t.k]);return function(t){var r=o(t),c=e/r[2];this.__chart__=S={x:u-r[0]*c,y:i-r[1]*c,k:c},a(n)}}).each("end.zoom",function(){c(n)}):(this.__chart__=S,o(n),a(n),c(n))})},n.translate=function(t){return arguments.length?(S={x:+t[0],y:+t[1],k:S.k},i(),n):[S.x,S.y]},n.scale=function(t){return arguments.length?(S={x:S.x,y:S.y,k:+t},i(),n):S.k},n.scaleExtent=function(t){return arguments.length?(E=null==t?qa:[+t[0],+t[1]],n):E},n.center=function(t){return arguments.length?(v=t&&[+t[0],+t[1]],n):v},n.size=function(t){return arguments.length?(k=t&&[+t[0],+t[1]],n):k},n.x=function(t){return arguments.length?(_=t,x=t.copy(),S={x:0,y:0,k:1},n):_},n.y=function(t){return arguments.length?(w=t,b=t.copy(),S={x:0,y:0,k:1},n):w},Zo.rebind(n,L,"on")};var Ta,qa=[0,1/0],Ra="onwheel"in $o?(Ta=function(){return-Zo.event.deltaY*(Zo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in $o?(Ta=function(){return Zo.event.wheelDelta},"mousewheel"):(Ta=function(){return-Zo.event.detail},"MozMousePixelScroll");Zo.color=et,et.prototype.toString=function(){return this.rgb()+""},Zo.hsl=rt;var Da=rt.prototype=new et;Da.brighter=function(n){return n=Math.pow(.7,arguments.length?n:1),new rt(this.h,this.s,this.l/n)},Da.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new rt(this.h,this.s,n*this.l)},Da.rgb=function(){return ut(this.h,this.s,this.l)},Zo.hcl=it;var Pa=it.prototype=new et;Pa.brighter=function(n){return new it(this.h,this.c,Math.min(100,this.l+Ua*(arguments.length?n:1)))},Pa.darker=function(n){return new it(this.h,this.c,Math.max(0,this.l-Ua*(arguments.length?n:1)))},Pa.rgb=function(){return ot(this.h,this.c,this.l).rgb()},Zo.lab=at;var Ua=18,ja=.95047,Ha=1,Fa=1.08883,Oa=at.prototype=new et;Oa.brighter=function(n){return new at(Math.min(100,this.l+Ua*(arguments.length?n:1)),this.a,this.b)},Oa.darker=function(n){return new at(Math.max(0,this.l-Ua*(arguments.length?n:1)),this.a,this.b)},Oa.rgb=function(){return ct(this.l,this.a,this.b)},Zo.rgb=gt;var Ya=gt.prototype=new et;Ya.brighter=function(n){n=Math.pow(.7,arguments.length?n:1);var t=this.r,e=this.g,r=this.b,u=30;return t||e||r?(t&&u>t&&(t=u),e&&u>e&&(e=u),r&&u>r&&(r=u),new gt(Math.min(255,t/n),Math.min(255,e/n),Math.min(255,r/n))):new gt(u,u,u)},Ya.darker=function(n){return n=Math.pow(.7,arguments.length?n:1),new gt(n*this.r,n*this.g,n*this.b)},Ya.hsl=function(){return yt(this.r,this.g,this.b)},Ya.toString=function(){return"#"+dt(this.r)+dt(this.g)+dt(this.b)};var Ia=Zo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Ia.forEach(function(n,t){Ia.set(n,pt(t))}),Zo.functor=bt,Zo.xhr=St(wt),Zo.dsv=function(n,t){function e(n,e,i){arguments.length<3&&(i=e,e=null);var o=kt(n,t,null==e?r:u(e),i);return o.row=function(n){return arguments.length?o.response(null==(e=n)?r:u(n)):e},o}function r(n){return e.parse(n.responseText)}function u(n){return function(t){return e.parse(t.responseText,n)}}function i(t){return t.map(o).join(n)}function o(n){return a.test(n)?'"'+n.replace(/\"/g,'""')+'"':n}var a=new RegExp('["'+n+"\n]"),c=n.charCodeAt(0);return e.parse=function(n,t){var r;return e.parseRows(n,function(n,e){if(r)return r(n,e-1);var u=new Function("d","return {"+n.map(function(n,t){return JSON.stringify(n)+": d["+t+"]"}).join(",")+"}");r=t?function(n,e){return t(u(n),e)}:u})},e.parseRows=function(n,t){function e(){if(l>=s)return o;if(u)return u=!1,i;var t=l;if(34===n.charCodeAt(t)){for(var e=t;e++<s;)if(34===n.charCodeAt(e)){if(34!==n.charCodeAt(e+1))break;++e}l=e+2;var r=n.charCodeAt(e+1);return 13===r?(u=!0,10===n.charCodeAt(e+2)&&++l):10===r&&(u=!0),n.substring(t+1,e).replace(/""/g,'"')}for(;s>l;){var r=n.charCodeAt(l++),a=1;if(10===r)u=!0;else if(13===r)u=!0,10===n.charCodeAt(l)&&(++l,++a);else if(r!==c)continue;return n.substring(t,l-a)}return n.substring(t)}for(var r,u,i={},o={},a=[],s=n.length,l=0,f=0;(r=e())!==o;){for(var h=[];r!==i&&r!==o;)h.push(r),r=e();(!t||(h=t(h,f++)))&&a.push(h)}return a},e.format=function(t){if(Array.isArray(t[0]))return e.formatRows(t);var r=new h,u=[];return t.forEach(function(n){for(var t in n)r.has(t)||u.push(r.add(t))}),[u.map(o).join(n)].concat(t.map(function(t){return u.map(function(n){return o(t[n])}).join(n)})).join("\n")},e.formatRows=function(n){return n.map(i).join("\n")},e},Zo.csv=Zo.dsv(",","text/csv"),Zo.tsv=Zo.dsv("	","text/tab-separated-values"),Zo.touch=function(n,t,e){if(arguments.length<3&&(e=t,t=x().changedTouches),t)for(var r,u=0,i=t.length;i>u;++u)if((r=t[u]).identifier===e)return Z(n,r)};var Za,Va,Xa,$a,Ba,Wa=Wo[p(Wo,"requestAnimationFrame")]||function(n){setTimeout(n,17)};Zo.timer=function(n,t,e){var r=arguments.length;2>r&&(t=0),3>r&&(e=Date.now());var u=e+t,i={c:n,t:u,f:!1,n:null};Va?Va.n=i:Za=i,Va=i,Xa||($a=clearTimeout($a),Xa=1,Wa(At))},Zo.timer.flush=function(){Ct(),Nt()},Zo.round=function(n,t){return t?Math.round(n*(t=Math.pow(10,t)))/t:Math.round(n)};var Ja=["y","z","a","f","p","n","\xb5","m","","k","M","G","T","P","E","Z","Y"].map(Lt);Zo.formatPrefix=function(n,t){var e=0;return n&&(0>n&&(n*=-1),t&&(n=Zo.round(n,zt(n,t))),e=1+Math.floor(1e-12+Math.log(n)/Math.LN10),e=Math.max(-24,Math.min(24,3*Math.floor((e-1)/3)))),Ja[8+e/3]};var Ga=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Ka=Zo.map({b:function(n){return n.toString(2)},c:function(n){return String.fromCharCode(n)},o:function(n){return n.toString(8)},x:function(n){return n.toString(16)},X:function(n){return n.toString(16).toUpperCase()},g:function(n,t){return n.toPrecision(t)},e:function(n,t){return n.toExponential(t)},f:function(n,t){return n.toFixed(t)},r:function(n,t){return(n=Zo.round(n,zt(n,t))).toFixed(Math.max(0,Math.min(20,zt(n*(1+1e-15),t))))}}),Qa=Zo.time={},nc=Date;Rt.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){tc.setUTCDate.apply(this._,arguments)},setDay:function(){tc.setUTCDay.apply(this._,arguments)},setFullYear:function(){tc.setUTCFullYear.apply(this._,arguments)},setHours:function(){tc.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){tc.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){tc.setUTCMinutes.apply(this._,arguments)},setMonth:function(){tc.setUTCMonth.apply(this._,arguments)},setSeconds:function(){tc.setUTCSeconds.apply(this._,arguments)},setTime:function(){tc.setTime.apply(this._,arguments)}};var tc=Date.prototype;Qa.year=Dt(function(n){return n=Qa.day(n),n.setMonth(0,1),n},function(n,t){n.setFullYear(n.getFullYear()+t)},function(n){return n.getFullYear()}),Qa.years=Qa.year.range,Qa.years.utc=Qa.year.utc.range,Qa.day=Dt(function(n){var t=new nc(2e3,0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t},function(n,t){n.setDate(n.getDate()+t)},function(n){return n.getDate()-1}),Qa.days=Qa.day.range,Qa.days.utc=Qa.day.utc.range,Qa.dayOfYear=function(n){var t=Qa.year(n);return Math.floor((n-t-6e4*(n.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(n,t){t=7-t;var e=Qa[n]=Dt(function(n){return(n=Qa.day(n)).setDate(n.getDate()-(n.getDay()+t)%7),n},function(n,t){n.setDate(n.getDate()+7*Math.floor(t))},function(n){var e=Qa.year(n).getDay();return Math.floor((Qa.dayOfYear(n)+(e+t)%7)/7)-(e!==t)});Qa[n+"s"]=e.range,Qa[n+"s"].utc=e.utc.range,Qa[n+"OfYear"]=function(n){var e=Qa.year(n).getDay();return Math.floor((Qa.dayOfYear(n)+(e+t)%7)/7)}}),Qa.week=Qa.sunday,Qa.weeks=Qa.sunday.range,Qa.weeks.utc=Qa.sunday.utc.range,Qa.weekOfYear=Qa.sundayOfYear;var ec={"-":"",_:" ",0:"0"},rc=/^\s*\d+/,uc=/^%/;Zo.locale=function(n){return{numberFormat:Tt(n),timeFormat:Ut(n)}};var ic=Zo.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Zo.format=ic.numberFormat,Zo.geo={},ue.prototype={s:0,t:0,add:function(n){ie(n,this.t,oc),ie(oc.s,this.s,this),this.s?this.t+=oc.t:this.s=oc.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var oc=new ue;Zo.geo.stream=function(n,t){n&&ac.hasOwnProperty(n.type)?ac[n.type](n,t):oe(n,t)};var ac={Feature:function(n,t){oe(n.geometry,t)},FeatureCollection:function(n,t){for(var e=n.features,r=-1,u=e.length;++r<u;)oe(e[r].geometry,t)}},cc={Sphere:function(n,t){t.sphere()},Point:function(n,t){n=n.coordinates,t.point(n[0],n[1],n[2])},MultiPoint:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)n=e[r],t.point(n[0],n[1],n[2])},LineString:function(n,t){ae(n.coordinates,t,0)},MultiLineString:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)ae(e[r],t,0)},Polygon:function(n,t){ce(n.coordinates,t)},MultiPolygon:function(n,t){for(var e=n.coordinates,r=-1,u=e.length;++r<u;)ce(e[r],t)},GeometryCollection:function(n,t){for(var e=n.geometries,r=-1,u=e.length;++r<u;)oe(e[r],t)}};Zo.geo.area=function(n){return sc=0,Zo.geo.stream(n,fc),sc};var sc,lc=new ue,fc={sphere:function(){sc+=4*ba},point:v,lineStart:v,lineEnd:v,polygonStart:function(){lc.reset(),fc.lineStart=se},polygonEnd:function(){var n=2*lc;sc+=0>n?4*ba+n:n,fc.lineStart=fc.lineEnd=fc.point=v}};Zo.geo.bounds=function(){function n(n,t){x.push(M=[l=n,h=n]),f>t&&(f=t),t>g&&(g=t)}function t(t,e){var r=le([t*Aa,e*Aa]);if(m){var u=he(m,r),i=[u[1],-u[0],0],o=he(i,u);ve(o),o=de(o);var c=t-p,s=c>0?1:-1,v=o[0]*Ca*s,d=ua(c)>180;if(d^(v>s*p&&s*t>v)){var y=o[1]*Ca;y>g&&(g=y)}else if(v=(v+360)%360-180,d^(v>s*p&&s*t>v)){var y=-o[1]*Ca;f>y&&(f=y)}else f>e&&(f=e),e>g&&(g=e);d?p>t?a(l,t)>a(l,h)&&(h=t):a(t,h)>a(l,h)&&(l=t):h>=l?(l>t&&(l=t),t>h&&(h=t)):t>p?a(l,t)>a(l,h)&&(h=t):a(t,h)>a(l,h)&&(l=t)}else n(t,e);m=r,p=t}function e(){_.point=t}function r(){M[0]=l,M[1]=h,_.point=n,m=null}function u(n,e){if(m){var r=n-p;y+=ua(r)>180?r+(r>0?360:-360):r}else v=n,d=e;fc.point(n,e),t(n,e)}function i(){fc.lineStart()}function o(){u(v,d),fc.lineEnd(),ua(y)>ka&&(l=-(h=180)),M[0]=l,M[1]=h,m=null}function a(n,t){return(t-=n)<0?t+360:t}function c(n,t){return n[0]-t[0]}function s(n,t){return t[0]<=t[1]?t[0]<=n&&n<=t[1]:n<t[0]||t[1]<n}var l,f,h,g,p,v,d,m,y,x,M,_={point:n,lineStart:e,lineEnd:r,polygonStart:function(){_.point=u,_.lineStart=i,_.lineEnd=o,y=0,fc.polygonStart()},polygonEnd:function(){fc.polygonEnd(),_.point=n,_.lineStart=e,_.lineEnd=r,0>lc?(l=-(h=180),f=-(g=90)):y>ka?g=90:-ka>y&&(f=-90),M[0]=l,M[1]=h}};return function(n){g=h=-(l=f=1/0),x=[],Zo.geo.stream(n,_);var t=x.length;if(t){x.sort(c);for(var e,r=1,u=x[0],i=[u];t>r;++r)e=x[r],s(e[0],u)||s(e[1],u)?(a(u[0],e[1])>a(u[0],u[1])&&(u[1]=e[1]),a(e[0],u[1])>a(u[0],u[1])&&(u[0]=e[0])):i.push(u=e);
    for(var o,e,p=-1/0,t=i.length-1,r=0,u=i[t];t>=r;u=e,++r)e=i[r],(o=a(u[1],e[0]))>p&&(p=o,l=e[0],h=u[1])}return x=M=null,1/0===l||1/0===f?[[0/0,0/0],[0/0,0/0]]:[[l,f],[h,g]]}}(),Zo.geo.centroid=function(n){hc=gc=pc=vc=dc=mc=yc=xc=Mc=_c=bc=0,Zo.geo.stream(n,wc);var t=Mc,e=_c,r=bc,u=t*t+e*e+r*r;return Ea>u&&(t=mc,e=yc,r=xc,ka>gc&&(t=pc,e=vc,r=dc),u=t*t+e*e+r*r,Ea>u)?[0/0,0/0]:[Math.atan2(e,t)*Ca,G(r/Math.sqrt(u))*Ca]};var hc,gc,pc,vc,dc,mc,yc,xc,Mc,_c,bc,wc={sphere:v,point:ye,lineStart:Me,lineEnd:_e,polygonStart:function(){wc.lineStart=be},polygonEnd:function(){wc.lineStart=Me}},Sc=Ae(we,Te,Re,[-ba,-ba/2]),kc=1e9;Zo.geo.clipExtent=function(){var n,t,e,r,u,i,o={stream:function(n){return u&&(u.valid=!1),u=i(n),u.valid=!0,u},extent:function(a){return arguments.length?(i=Ue(n=+a[0][0],t=+a[0][1],e=+a[1][0],r=+a[1][1]),u&&(u.valid=!1,u=null),o):[[n,t],[e,r]]}};return o.extent([[0,0],[960,500]])},(Zo.geo.conicEqualArea=function(){return He(Fe)}).raw=Fe,Zo.geo.albers=function(){return Zo.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Zo.geo.albersUsa=function(){function n(n){var i=n[0],o=n[1];return t=null,e(i,o),t||(r(i,o),t)||u(i,o),t}var t,e,r,u,i=Zo.geo.albers(),o=Zo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=Zo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),c={point:function(n,e){t=[n,e]}};return n.invert=function(n){var t=i.scale(),e=i.translate(),r=(n[0]-e[0])/t,u=(n[1]-e[1])/t;return(u>=.12&&.234>u&&r>=-.425&&-.214>r?o:u>=.166&&.234>u&&r>=-.214&&-.115>r?a:i).invert(n)},n.stream=function(n){var t=i.stream(n),e=o.stream(n),r=a.stream(n);return{point:function(n,u){t.point(n,u),e.point(n,u),r.point(n,u)},sphere:function(){t.sphere(),e.sphere(),r.sphere()},lineStart:function(){t.lineStart(),e.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),e.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),e.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),e.polygonEnd(),r.polygonEnd()}}},n.precision=function(t){return arguments.length?(i.precision(t),o.precision(t),a.precision(t),n):i.precision()},n.scale=function(t){return arguments.length?(i.scale(t),o.scale(.35*t),a.scale(t),n.translate(i.translate())):i.scale()},n.translate=function(t){if(!arguments.length)return i.translate();var s=i.scale(),l=+t[0],f=+t[1];return e=i.translate(t).clipExtent([[l-.455*s,f-.238*s],[l+.455*s,f+.238*s]]).stream(c).point,r=o.translate([l-.307*s,f+.201*s]).clipExtent([[l-.425*s+ka,f+.12*s+ka],[l-.214*s-ka,f+.234*s-ka]]).stream(c).point,u=a.translate([l-.205*s,f+.212*s]).clipExtent([[l-.214*s+ka,f+.166*s+ka],[l-.115*s-ka,f+.234*s-ka]]).stream(c).point,n},n.scale(1070)};var Ec,Ac,Cc,Nc,zc,Lc,Tc={point:v,lineStart:v,lineEnd:v,polygonStart:function(){Ac=0,Tc.lineStart=Oe},polygonEnd:function(){Tc.lineStart=Tc.lineEnd=Tc.point=v,Ec+=ua(Ac/2)}},qc={point:Ye,lineStart:v,lineEnd:v,polygonStart:v,polygonEnd:v},Rc={point:Ve,lineStart:Xe,lineEnd:$e,polygonStart:function(){Rc.lineStart=Be},polygonEnd:function(){Rc.point=Ve,Rc.lineStart=Xe,Rc.lineEnd=$e}};Zo.geo.path=function(){function n(n){return n&&("function"==typeof a&&i.pointRadius(+a.apply(this,arguments)),o&&o.valid||(o=u(i)),Zo.geo.stream(n,o)),i.result()}function t(){return o=null,n}var e,r,u,i,o,a=4.5;return n.area=function(n){return Ec=0,Zo.geo.stream(n,u(Tc)),Ec},n.centroid=function(n){return pc=vc=dc=mc=yc=xc=Mc=_c=bc=0,Zo.geo.stream(n,u(Rc)),bc?[Mc/bc,_c/bc]:xc?[mc/xc,yc/xc]:dc?[pc/dc,vc/dc]:[0/0,0/0]},n.bounds=function(n){return zc=Lc=-(Cc=Nc=1/0),Zo.geo.stream(n,u(qc)),[[Cc,Nc],[zc,Lc]]},n.projection=function(n){return arguments.length?(u=(e=n)?n.stream||Ge(n):wt,t()):e},n.context=function(n){return arguments.length?(i=null==(r=n)?new Ie:new We(n),"function"!=typeof a&&i.pointRadius(a),t()):r},n.pointRadius=function(t){return arguments.length?(a="function"==typeof t?t:(i.pointRadius(+t),+t),n):a},n.projection(Zo.geo.albersUsa()).context(null)},Zo.geo.transform=function(n){return{stream:function(t){var e=new Ke(t);for(var r in n)e[r]=n[r];return e}}},Ke.prototype={point:function(n,t){this.stream.point(n,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Zo.geo.projection=nr,Zo.geo.projectionMutator=tr,(Zo.geo.equirectangular=function(){return nr(rr)}).raw=rr.invert=rr,Zo.geo.rotation=function(n){function t(t){return t=n(t[0]*Aa,t[1]*Aa),t[0]*=Ca,t[1]*=Ca,t}return n=ir(n[0]%360*Aa,n[1]*Aa,n.length>2?n[2]*Aa:0),t.invert=function(t){return t=n.invert(t[0]*Aa,t[1]*Aa),t[0]*=Ca,t[1]*=Ca,t},t},ur.invert=rr,Zo.geo.circle=function(){function n(){var n="function"==typeof r?r.apply(this,arguments):r,t=ir(-n[0]*Aa,-n[1]*Aa,0).invert,u=[];return e(null,null,1,{point:function(n,e){u.push(n=t(n,e)),n[0]*=Ca,n[1]*=Ca}}),{type:"Polygon",coordinates:[u]}}var t,e,r=[0,0],u=6;return n.origin=function(t){return arguments.length?(r=t,n):r},n.angle=function(r){return arguments.length?(e=sr((t=+r)*Aa,u*Aa),n):t},n.precision=function(r){return arguments.length?(e=sr(t*Aa,(u=+r)*Aa),n):u},n.angle(90)},Zo.geo.distance=function(n,t){var e,r=(t[0]-n[0])*Aa,u=n[1]*Aa,i=t[1]*Aa,o=Math.sin(r),a=Math.cos(r),c=Math.sin(u),s=Math.cos(u),l=Math.sin(i),f=Math.cos(i);return Math.atan2(Math.sqrt((e=f*o)*e+(e=s*l-c*f*a)*e),c*l+s*f*a)},Zo.geo.graticule=function(){function n(){return{type:"MultiLineString",coordinates:t()}}function t(){return Zo.range(Math.ceil(i/d)*d,u,d).map(h).concat(Zo.range(Math.ceil(s/m)*m,c,m).map(g)).concat(Zo.range(Math.ceil(r/p)*p,e,p).filter(function(n){return ua(n%d)>ka}).map(l)).concat(Zo.range(Math.ceil(a/v)*v,o,v).filter(function(n){return ua(n%m)>ka}).map(f))}var e,r,u,i,o,a,c,s,l,f,h,g,p=10,v=p,d=90,m=360,y=2.5;return n.lines=function(){return t().map(function(n){return{type:"LineString",coordinates:n}})},n.outline=function(){return{type:"Polygon",coordinates:[h(i).concat(g(c).slice(1),h(u).reverse().slice(1),g(s).reverse().slice(1))]}},n.extent=function(t){return arguments.length?n.majorExtent(t).minorExtent(t):n.minorExtent()},n.majorExtent=function(t){return arguments.length?(i=+t[0][0],u=+t[1][0],s=+t[0][1],c=+t[1][1],i>u&&(t=i,i=u,u=t),s>c&&(t=s,s=c,c=t),n.precision(y)):[[i,s],[u,c]]},n.minorExtent=function(t){return arguments.length?(r=+t[0][0],e=+t[1][0],a=+t[0][1],o=+t[1][1],r>e&&(t=r,r=e,e=t),a>o&&(t=a,a=o,o=t),n.precision(y)):[[r,a],[e,o]]},n.step=function(t){return arguments.length?n.majorStep(t).minorStep(t):n.minorStep()},n.majorStep=function(t){return arguments.length?(d=+t[0],m=+t[1],n):[d,m]},n.minorStep=function(t){return arguments.length?(p=+t[0],v=+t[1],n):[p,v]},n.precision=function(t){return arguments.length?(y=+t,l=fr(a,o,90),f=hr(r,e,y),h=fr(s,c,90),g=hr(i,u,y),n):y},n.majorExtent([[-180,-90+ka],[180,90-ka]]).minorExtent([[-180,-80-ka],[180,80+ka]])},Zo.geo.greatArc=function(){function n(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),e||u.apply(this,arguments)]}}var t,e,r=gr,u=pr;return n.distance=function(){return Zo.geo.distance(t||r.apply(this,arguments),e||u.apply(this,arguments))},n.source=function(e){return arguments.length?(r=e,t="function"==typeof e?null:e,n):r},n.target=function(t){return arguments.length?(u=t,e="function"==typeof t?null:t,n):u},n.precision=function(){return arguments.length?n:0},n},Zo.geo.interpolate=function(n,t){return vr(n[0]*Aa,n[1]*Aa,t[0]*Aa,t[1]*Aa)},Zo.geo.length=function(n){return Dc=0,Zo.geo.stream(n,Pc),Dc};var Dc,Pc={sphere:v,point:v,lineStart:dr,lineEnd:v,polygonStart:v,polygonEnd:v},Uc=mr(function(n){return Math.sqrt(2/(1+n))},function(n){return 2*Math.asin(n/2)});(Zo.geo.azimuthalEqualArea=function(){return nr(Uc)}).raw=Uc;var jc=mr(function(n){var t=Math.acos(n);return t&&t/Math.sin(t)},wt);(Zo.geo.azimuthalEquidistant=function(){return nr(jc)}).raw=jc,(Zo.geo.conicConformal=function(){return He(yr)}).raw=yr,(Zo.geo.conicEquidistant=function(){return He(xr)}).raw=xr;var Hc=mr(function(n){return 1/n},Math.atan);(Zo.geo.gnomonic=function(){return nr(Hc)}).raw=Hc,Mr.invert=function(n,t){return[n,2*Math.atan(Math.exp(t))-Sa]},(Zo.geo.mercator=function(){return _r(Mr)}).raw=Mr;var Fc=mr(function(){return 1},Math.asin);(Zo.geo.orthographic=function(){return nr(Fc)}).raw=Fc;var Oc=mr(function(n){return 1/(1+n)},function(n){return 2*Math.atan(n)});(Zo.geo.stereographic=function(){return nr(Oc)}).raw=Oc,br.invert=function(n,t){return[-t,2*Math.atan(Math.exp(n))-Sa]},(Zo.geo.transverseMercator=function(){var n=_r(br),t=n.center,e=n.rotate;return n.center=function(n){return n?t([-n[1],n[0]]):(n=t(),[n[1],-n[0]])},n.rotate=function(n){return n?e([n[0],n[1],n.length>2?n[2]+90:90]):(n=e(),[n[0],n[1],n[2]-90])},e([0,0,90])}).raw=br,Zo.geom={},Zo.geom.hull=function(n){function t(n){if(n.length<3)return[];var t,u=bt(e),i=bt(r),o=n.length,a=[],c=[];for(t=0;o>t;t++)a.push([+u.call(this,n[t],t),+i.call(this,n[t],t),t]);for(a.sort(Er),t=0;o>t;t++)c.push([a[t][0],-a[t][1]]);var s=kr(a),l=kr(c),f=l[0]===s[0],h=l[l.length-1]===s[s.length-1],g=[];for(t=s.length-1;t>=0;--t)g.push(n[a[s[t]][2]]);for(t=+f;t<l.length-h;++t)g.push(n[a[l[t]][2]]);return g}var e=wr,r=Sr;return arguments.length?t(n):(t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(n){return arguments.length?(r=n,t):r},t)},Zo.geom.polygon=function(n){return sa(n,Yc),n};var Yc=Zo.geom.polygon.prototype=[];Yc.area=function(){for(var n,t=-1,e=this.length,r=this[e-1],u=0;++t<e;)n=r,r=this[t],u+=n[1]*r[0]-n[0]*r[1];return.5*u},Yc.centroid=function(n){var t,e,r=-1,u=this.length,i=0,o=0,a=this[u-1];for(arguments.length||(n=-1/(6*this.area()));++r<u;)t=a,a=this[r],e=t[0]*a[1]-a[0]*t[1],i+=(t[0]+a[0])*e,o+=(t[1]+a[1])*e;return[i*n,o*n]},Yc.clip=function(n){for(var t,e,r,u,i,o,a=Nr(n),c=-1,s=this.length-Nr(this),l=this[s-1];++c<s;){for(t=n.slice(),n.length=0,u=this[c],i=t[(r=t.length-a)-1],e=-1;++e<r;)o=t[e],Ar(o,l,u)?(Ar(i,l,u)||n.push(Cr(i,o,l,u)),n.push(o)):Ar(i,l,u)&&n.push(Cr(i,o,l,u)),i=o;a&&n.push(n[0]),l=u}return n};var Ic,Zc,Vc,Xc,$c,Bc=[],Wc=[];Ur.prototype.prepare=function(){for(var n,t=this.edges,e=t.length;e--;)n=t[e].edge,n.b&&n.a||t.splice(e,1);return t.sort(Hr),t.length},Wr.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Jr.prototype={insert:function(n,t){var e,r,u;if(n){if(t.P=n,t.N=n.N,n.N&&(n.N.P=t),n.N=t,n.R){for(n=n.R;n.L;)n=n.L;n.L=t}else n.R=t;e=n}else this._?(n=nu(this._),t.P=null,t.N=n,n.P=n.L=t,e=n):(t.P=t.N=null,this._=t,e=null);for(t.L=t.R=null,t.U=e,t.C=!0,n=t;e&&e.C;)r=e.U,e===r.L?(u=r.R,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.R&&(Kr(this,e),n=e,e=n.U),e.C=!1,r.C=!0,Qr(this,r))):(u=r.L,u&&u.C?(e.C=u.C=!1,r.C=!0,n=r):(n===e.L&&(Qr(this,e),n=e,e=n.U),e.C=!1,r.C=!0,Kr(this,r))),e=n.U;this._.C=!1},remove:function(n){n.N&&(n.N.P=n.P),n.P&&(n.P.N=n.N),n.N=n.P=null;var t,e,r,u=n.U,i=n.L,o=n.R;if(e=i?o?nu(o):i:o,u?u.L===n?u.L=e:u.R=e:this._=e,i&&o?(r=e.C,e.C=n.C,e.L=i,i.U=e,e!==o?(u=e.U,e.U=n.U,n=e.R,u.L=n,e.R=o,o.U=e):(e.U=u,u=e,n=e.R)):(r=n.C,n=e),n&&(n.U=u),!r){if(n&&n.C)return n.C=!1,void 0;do{if(n===this._)break;if(n===u.L){if(t=u.R,t.C&&(t.C=!1,u.C=!0,Kr(this,u),t=u.R),t.L&&t.L.C||t.R&&t.R.C){t.R&&t.R.C||(t.L.C=!1,t.C=!0,Qr(this,t),t=u.R),t.C=u.C,u.C=t.R.C=!1,Kr(this,u),n=this._;break}}else if(t=u.L,t.C&&(t.C=!1,u.C=!0,Qr(this,u),t=u.L),t.L&&t.L.C||t.R&&t.R.C){t.L&&t.L.C||(t.R.C=!1,t.C=!0,Kr(this,t),t=u.L),t.C=u.C,u.C=t.L.C=!1,Qr(this,u),n=this._;break}t.C=!0,n=u,u=u.U}while(!n.C);n&&(n.C=!1)}}},Zo.geom.voronoi=function(n){function t(n){var t=new Array(n.length),r=a[0][0],u=a[0][1],i=a[1][0],o=a[1][1];return tu(e(n),a).cells.forEach(function(e,a){var c=e.edges,s=e.site,l=t[a]=c.length?c.map(function(n){var t=n.start();return[t.x,t.y]}):s.x>=r&&s.x<=i&&s.y>=u&&s.y<=o?[[r,o],[i,o],[i,u],[r,u]]:[];l.point=n[a]}),t}function e(n){return n.map(function(n,t){return{x:Math.round(i(n,t)/ka)*ka,y:Math.round(o(n,t)/ka)*ka,i:t}})}var r=wr,u=Sr,i=r,o=u,a=Jc;return n?t(n):(t.links=function(n){return tu(e(n)).edges.filter(function(n){return n.l&&n.r}).map(function(t){return{source:n[t.l.i],target:n[t.r.i]}})},t.triangles=function(n){var t=[];return tu(e(n)).cells.forEach(function(e,r){for(var u,i,o=e.site,a=e.edges.sort(Hr),c=-1,s=a.length,l=a[s-1].edge,f=l.l===o?l.r:l.l;++c<s;)u=l,i=f,l=a[c].edge,f=l.l===o?l.r:l.l,r<i.i&&r<f.i&&ru(o,i,f)<0&&t.push([n[r],n[i.i],n[f.i]])}),t},t.x=function(n){return arguments.length?(i=bt(r=n),t):r},t.y=function(n){return arguments.length?(o=bt(u=n),t):u},t.clipExtent=function(n){return arguments.length?(a=null==n?Jc:n,t):a===Jc?null:a},t.size=function(n){return arguments.length?t.clipExtent(n&&[[0,0],n]):a===Jc?null:a&&a[1]},t)};var Jc=[[-1e6,-1e6],[1e6,1e6]];Zo.geom.delaunay=function(n){return Zo.geom.voronoi().triangles(n)},Zo.geom.quadtree=function(n,t,e,r,u){function i(n){function i(n,t,e,r,u,i,o,a){if(!isNaN(e)&&!isNaN(r))if(n.leaf){var c=n.x,l=n.y;if(null!=c)if(ua(c-e)+ua(l-r)<.01)s(n,t,e,r,u,i,o,a);else{var f=n.point;n.x=n.y=n.point=null,s(n,f,c,l,u,i,o,a),s(n,t,e,r,u,i,o,a)}else n.x=e,n.y=r,n.point=t}else s(n,t,e,r,u,i,o,a)}function s(n,t,e,r,u,o,a,c){var s=.5*(u+a),l=.5*(o+c),f=e>=s,h=r>=l,g=(h<<1)+f;n.leaf=!1,n=n.nodes[g]||(n.nodes[g]=ou()),f?u=s:a=s,h?o=l:c=l,i(n,t,e,r,u,o,a,c)}var l,f,h,g,p,v,d,m,y,x=bt(a),M=bt(c);if(null!=t)v=t,d=e,m=r,y=u;else if(m=y=-(v=d=1/0),f=[],h=[],p=n.length,o)for(g=0;p>g;++g)l=n[g],l.x<v&&(v=l.x),l.y<d&&(d=l.y),l.x>m&&(m=l.x),l.y>y&&(y=l.y),f.push(l.x),h.push(l.y);else for(g=0;p>g;++g){var _=+x(l=n[g],g),b=+M(l,g);v>_&&(v=_),d>b&&(d=b),_>m&&(m=_),b>y&&(y=b),f.push(_),h.push(b)}var w=m-v,S=y-d;w>S?y=d+w:m=v+S;var k=ou();if(k.add=function(n){i(k,n,+x(n,++g),+M(n,g),v,d,m,y)},k.visit=function(n){au(n,k,v,d,m,y)},g=-1,null==t){for(;++g<p;)i(k,n[g],f[g],h[g],v,d,m,y);--g}else n.forEach(k.add);return f=h=n=l=null,k}var o,a=wr,c=Sr;return(o=arguments.length)?(a=uu,c=iu,3===o&&(u=e,r=t,e=t=0),i(n)):(i.x=function(n){return arguments.length?(a=n,i):a},i.y=function(n){return arguments.length?(c=n,i):c},i.extent=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=+n[0][0],e=+n[0][1],r=+n[1][0],u=+n[1][1]),i):null==t?null:[[t,e],[r,u]]},i.size=function(n){return arguments.length?(null==n?t=e=r=u=null:(t=e=0,r=+n[0],u=+n[1]),i):null==t?null:[r-t,u-e]},i)},Zo.interpolateRgb=cu,Zo.interpolateObject=su,Zo.interpolateNumber=lu,Zo.interpolateString=fu;var Gc=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Kc=new RegExp(Gc.source,"g");Zo.interpolate=hu,Zo.interpolators=[function(n,t){var e=typeof t;return("string"===e?Ia.has(t)||/^(#|rgb\(|hsl\()/.test(t)?cu:fu:t instanceof et?cu:Array.isArray(t)?gu:"object"===e&&isNaN(t)?su:lu)(n,t)}],Zo.interpolateArray=gu;var Qc=function(){return wt},ns=Zo.map({linear:Qc,poly:Mu,quad:function(){return mu},cubic:function(){return yu},sin:function(){return _u},exp:function(){return bu},circle:function(){return wu},elastic:Su,back:ku,bounce:function(){return Eu}}),ts=Zo.map({"in":wt,out:vu,"in-out":du,"out-in":function(n){return du(vu(n))}});Zo.ease=function(n){var t=n.indexOf("-"),e=t>=0?n.substring(0,t):n,r=t>=0?n.substring(t+1):"in";return e=ns.get(e)||Qc,r=ts.get(r)||wt,pu(r(e.apply(null,Vo.call(arguments,1))))},Zo.interpolateHcl=Au,Zo.interpolateHsl=Cu,Zo.interpolateLab=Nu,Zo.interpolateRound=zu,Zo.transform=function(n){var t=$o.createElementNS(Zo.ns.prefix.svg,"g");return(Zo.transform=function(n){if(null!=n){t.setAttribute("transform",n);var e=t.transform.baseVal.consolidate()}return new Lu(e?e.matrix:es)})(n)},Lu.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var es={a:1,b:0,c:0,d:1,e:0,f:0};Zo.interpolateTransform=Du,Zo.layout={},Zo.layout.bundle=function(){return function(n){for(var t=[],e=-1,r=n.length;++e<r;)t.push(ju(n[e]));return t}},Zo.layout.chord=function(){function n(){var n,s,f,h,g,p={},v=[],d=Zo.range(i),m=[];for(e=[],r=[],n=0,h=-1;++h<i;){for(s=0,g=-1;++g<i;)s+=u[h][g];v.push(s),m.push(Zo.range(i)),n+=s}for(o&&d.sort(function(n,t){return o(v[n],v[t])}),a&&m.forEach(function(n,t){n.sort(function(n,e){return a(u[t][n],u[t][e])})}),n=(wa-l*i)/n,s=0,h=-1;++h<i;){for(f=s,g=-1;++g<i;){var y=d[h],x=m[y][g],M=u[y][x],_=s,b=s+=M*n;p[y+"-"+x]={index:y,subindex:x,startAngle:_,endAngle:b,value:M}}r[y]={index:y,startAngle:f,endAngle:s,value:(s-f)/n},s+=l}for(h=-1;++h<i;)for(g=h-1;++g<i;){var w=p[h+"-"+g],S=p[g+"-"+h];(w.value||S.value)&&e.push(w.value<S.value?{source:S,target:w}:{source:w,target:S})}c&&t()}function t(){e.sort(function(n,t){return c((n.source.value+n.target.value)/2,(t.source.value+t.target.value)/2)})}var e,r,u,i,o,a,c,s={},l=0;return s.matrix=function(n){return arguments.length?(i=(u=n)&&u.length,e=r=null,s):u},s.padding=function(n){return arguments.length?(l=n,e=r=null,s):l},s.sortGroups=function(n){return arguments.length?(o=n,e=r=null,s):o},s.sortSubgroups=function(n){return arguments.length?(a=n,e=null,s):a},s.sortChords=function(n){return arguments.length?(c=n,e&&t(),s):c},s.chords=function(){return e||n(),e},s.groups=function(){return r||n(),r},s},Zo.layout.force=function(){function n(n){return function(t,e,r,u){if(t.point!==n){var i=t.cx-n.x,o=t.cy-n.y,a=u-e,c=i*i+o*o;if(c>a*a/d){if(p>c){var s=t.charge/c;n.px-=i*s,n.py-=o*s}return!0}if(t.point&&c&&p>c){var s=t.pointCharge/c;n.px-=i*s,n.py-=o*s}}return!t.charge}}function t(n){n.px=Zo.event.x,n.py=Zo.event.y,a.resume()}var e,r,u,i,o,a={},c=Zo.dispatch("start","tick","end"),s=[1,1],l=.9,f=rs,h=us,g=-30,p=is,v=.1,d=.64,m=[],y=[];return a.tick=function(){if((r*=.99)<.005)return c.end({type:"end",alpha:r=0}),!0;var t,e,a,f,h,p,d,x,M,_=m.length,b=y.length;for(e=0;b>e;++e)a=y[e],f=a.source,h=a.target,x=h.x-f.x,M=h.y-f.y,(p=x*x+M*M)&&(p=r*i[e]*((p=Math.sqrt(p))-u[e])/p,x*=p,M*=p,h.x-=x*(d=f.weight/(h.weight+f.weight)),h.y-=M*d,f.x+=x*(d=1-d),f.y+=M*d);if((d=r*v)&&(x=s[0]/2,M=s[1]/2,e=-1,d))for(;++e<_;)a=m[e],a.x+=(x-a.x)*d,a.y+=(M-a.y)*d;if(g)for(Vu(t=Zo.geom.quadtree(m),r,o),e=-1;++e<_;)(a=m[e]).fixed||t.visit(n(a));for(e=-1;++e<_;)a=m[e],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*l,a.y-=(a.py-(a.py=a.y))*l);c.tick({type:"tick",alpha:r})},a.nodes=function(n){return arguments.length?(m=n,a):m},a.links=function(n){return arguments.length?(y=n,a):y},a.size=function(n){return arguments.length?(s=n,a):s},a.linkDistance=function(n){return arguments.length?(f="function"==typeof n?n:+n,a):f},a.distance=a.linkDistance,a.linkStrength=function(n){return arguments.length?(h="function"==typeof n?n:+n,a):h},a.friction=function(n){return arguments.length?(l=+n,a):l},a.charge=function(n){return arguments.length?(g="function"==typeof n?n:+n,a):g},a.chargeDistance=function(n){return arguments.length?(p=n*n,a):Math.sqrt(p)},a.gravity=function(n){return arguments.length?(v=+n,a):v},a.theta=function(n){return arguments.length?(d=n*n,a):Math.sqrt(d)},a.alpha=function(n){return arguments.length?(n=+n,r?r=n>0?n:0:n>0&&(c.start({type:"start",alpha:r=n}),Zo.timer(a.tick)),a):r},a.start=function(){function n(n,r){if(!e){for(e=new Array(c),a=0;c>a;++a)e[a]=[];for(a=0;s>a;++a){var u=y[a];e[u.source.index].push(u.target),e[u.target.index].push(u.source)}}for(var i,o=e[t],a=-1,s=o.length;++a<s;)if(!isNaN(i=o[a][n]))return i;return Math.random()*r}var t,e,r,c=m.length,l=y.length,p=s[0],v=s[1];for(t=0;c>t;++t)(r=m[t]).index=t,r.weight=0;for(t=0;l>t;++t)r=y[t],"number"==typeof r.source&&(r.source=m[r.source]),"number"==typeof r.target&&(r.target=m[r.target]),++r.source.weight,++r.target.weight;for(t=0;c>t;++t)r=m[t],isNaN(r.x)&&(r.x=n("x",p)),isNaN(r.y)&&(r.y=n("y",v)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(u=[],"function"==typeof f)for(t=0;l>t;++t)u[t]=+f.call(this,y[t],t);else for(t=0;l>t;++t)u[t]=f;if(i=[],"function"==typeof h)for(t=0;l>t;++t)i[t]=+h.call(this,y[t],t);else for(t=0;l>t;++t)i[t]=h;if(o=[],"function"==typeof g)for(t=0;c>t;++t)o[t]=+g.call(this,m[t],t);else for(t=0;c>t;++t)o[t]=g;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return e||(e=Zo.behavior.drag().origin(wt).on("dragstart.force",Ou).on("drag.force",t).on("dragend.force",Yu)),arguments.length?(this.on("mouseover.force",Iu).on("mouseout.force",Zu).call(e),void 0):e},Zo.rebind(a,c,"on")};var rs=20,us=1,is=1/0;Zo.layout.hierarchy=function(){function n(u){var i,o=[u],a=[];for(u.depth=0;null!=(i=o.pop());)if(a.push(i),(s=e.call(n,i,i.depth))&&(c=s.length)){for(var c,s,l;--c>=0;)o.push(l=s[c]),l.parent=i,l.depth=i.depth+1;r&&(i.value=0),i.children=s}else r&&(i.value=+r.call(n,i,i.depth)||0),delete i.children;return Bu(u,function(n){var e,u;t&&(e=n.children)&&e.sort(t),r&&(u=n.parent)&&(u.value+=n.value)}),a}var t=Gu,e=Wu,r=Ju;return n.sort=function(e){return arguments.length?(t=e,n):t},n.children=function(t){return arguments.length?(e=t,n):e},n.value=function(t){return arguments.length?(r=t,n):r},n.revalue=function(t){return r&&($u(t,function(n){n.children&&(n.value=0)}),Bu(t,function(t){var e;t.children||(t.value=+r.call(n,t,t.depth)||0),(e=t.parent)&&(e.value+=t.value)})),t},n},Zo.layout.partition=function(){function n(t,e,r,u){var i=t.children;if(t.x=e,t.y=t.depth*u,t.dx=r,t.dy=u,i&&(o=i.length)){var o,a,c,s=-1;for(r=t.value?r/t.value:0;++s<o;)n(a=i[s],e,c=a.value*r,u),e+=c}}function t(n){var e=n.children,r=0;if(e&&(u=e.length))for(var u,i=-1;++i<u;)r=Math.max(r,t(e[i]));return 1+r}function e(e,i){var o=r.call(this,e,i);return n(o[0],0,u[0],u[1]/t(o[0])),o}var r=Zo.layout.hierarchy(),u=[1,1];return e.size=function(n){return arguments.length?(u=n,e):u},Xu(e,r)},Zo.layout.pie=function(){function n(i){var o=i.map(function(e,r){return+t.call(n,e,r)}),a=+("function"==typeof r?r.apply(this,arguments):r),c=(("function"==typeof u?u.apply(this,arguments):u)-a)/Zo.sum(o),s=Zo.range(i.length);null!=e&&s.sort(e===os?function(n,t){return o[t]-o[n]}:function(n,t){return e(i[n],i[t])});var l=[];return s.forEach(function(n){var t;l[n]={data:i[n],value:t=o[n],startAngle:a,endAngle:a+=t*c}}),l}var t=Number,e=os,r=0,u=wa;return n.value=function(e){return arguments.length?(t=e,n):t},n.sort=function(t){return arguments.length?(e=t,n):e},n.startAngle=function(t){return arguments.length?(r=t,n):r},n.endAngle=function(t){return arguments.length?(u=t,n):u},n};var os={};Zo.layout.stack=function(){function n(a,c){var s=a.map(function(e,r){return t.call(n,e,r)}),l=s.map(function(t){return t.map(function(t,e){return[i.call(n,t,e),o.call(n,t,e)]})}),f=e.call(n,l,c);s=Zo.permute(s,f),l=Zo.permute(l,f);var h,g,p,v=r.call(n,l,c),d=s.length,m=s[0].length;for(g=0;m>g;++g)for(u.call(n,s[0][g],p=v[g],l[0][g][1]),h=1;d>h;++h)u.call(n,s[h][g],p+=l[h-1][g][1],l[h][g][1]);return a}var t=wt,e=ei,r=ri,u=ti,i=Qu,o=ni;return n.values=function(e){return arguments.length?(t=e,n):t},n.order=function(t){return arguments.length?(e="function"==typeof t?t:as.get(t)||ei,n):e},n.offset=function(t){return arguments.length?(r="function"==typeof t?t:cs.get(t)||ri,n):r},n.x=function(t){return arguments.length?(i=t,n):i},n.y=function(t){return arguments.length?(o=t,n):o},n.out=function(t){return arguments.length?(u=t,n):u},n};var as=Zo.map({"inside-out":function(n){var t,e,r=n.length,u=n.map(ui),i=n.map(ii),o=Zo.range(r).sort(function(n,t){return u[n]-u[t]}),a=0,c=0,s=[],l=[];for(t=0;r>t;++t)e=o[t],c>a?(a+=i[e],s.push(e)):(c+=i[e],l.push(e));return l.reverse().concat(s)},reverse:function(n){return Zo.range(n.length).reverse()},"default":ei}),cs=Zo.map({silhouette:function(n){var t,e,r,u=n.length,i=n[0].length,o=[],a=0,c=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];r>a&&(a=r),o.push(r)}for(e=0;i>e;++e)c[e]=(a-o[e])/2;return c},wiggle:function(n){var t,e,r,u,i,o,a,c,s,l=n.length,f=n[0],h=f.length,g=[];for(g[0]=c=s=0,e=1;h>e;++e){for(t=0,u=0;l>t;++t)u+=n[t][e][1];for(t=0,i=0,a=f[e][0]-f[e-1][0];l>t;++t){for(r=0,o=(n[t][e][1]-n[t][e-1][1])/(2*a);t>r;++r)o+=(n[r][e][1]-n[r][e-1][1])/a;i+=o*n[t][e][1]}g[e]=c-=u?i/u*a:0,s>c&&(s=c)}for(e=0;h>e;++e)g[e]-=s;return g},expand:function(n){var t,e,r,u=n.length,i=n[0].length,o=1/u,a=[];for(e=0;i>e;++e){for(t=0,r=0;u>t;t++)r+=n[t][e][1];if(r)for(t=0;u>t;t++)n[t][e][1]/=r;else for(t=0;u>t;t++)n[t][e][1]=o}for(e=0;i>e;++e)a[e]=0;return a},zero:ri});Zo.layout.histogram=function(){function n(n,i){for(var o,a,c=[],s=n.map(e,this),l=r.call(this,s,i),f=u.call(this,l,s,i),i=-1,h=s.length,g=f.length-1,p=t?1:1/h;++i<g;)o=c[i]=[],o.dx=f[i+1]-(o.x=f[i]),o.y=0;if(g>0)for(i=-1;++i<h;)a=s[i],a>=l[0]&&a<=l[1]&&(o=c[Zo.bisect(f,a,1,g)-1],o.y+=p,o.push(n[i]));return c}var t=!0,e=Number,r=si,u=ai;return n.value=function(t){return arguments.length?(e=t,n):e},n.range=function(t){return arguments.length?(r=bt(t),n):r},n.bins=function(t){return arguments.length?(u="number"==typeof t?function(n){return ci(n,t)}:bt(t),n):u},n.frequency=function(e){return arguments.length?(t=!!e,n):t},n},Zo.layout.pack=function(){function n(n,i){var o=e.call(this,n,i),a=o[0],c=u[0],s=u[1],l=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(a.x=a.y=0,Bu(a,function(n){n.r=+l(n.value)}),Bu(a,pi),r){var f=r*(t?1:Math.max(2*a.r/c,2*a.r/s))/2;Bu(a,function(n){n.r+=f}),Bu(a,pi),Bu(a,function(n){n.r-=f})}return mi(a,c/2,s/2,t?1:1/Math.max(2*a.r/c,2*a.r/s)),o}var t,e=Zo.layout.hierarchy().sort(li),r=0,u=[1,1];return n.size=function(t){return arguments.length?(u=t,n):u},n.radius=function(e){return arguments.length?(t=null==e||"function"==typeof e?e:+e,n):t},n.padding=function(t){return arguments.length?(r=+t,n):r},Xu(n,e)},Zo.layout.tree=function(){function n(n,u){var l=o.call(this,n,u),f=l[0],h=t(f);if(Bu(h,e),h.parent.m=-h.z,$u(h,r),s)$u(f,i);else{var g=f,p=f,v=f;$u(f,function(n){n.x<g.x&&(g=n),n.x>p.x&&(p=n),n.depth>v.depth&&(v=n)});var d=a(g,p)/2-g.x,m=c[0]/(p.x+a(p,g)/2+d),y=c[1]/(v.depth||1);$u(f,function(n){n.x=(n.x+d)*m,n.y=n.depth*y})}return l}function t(n){for(var t,e={A:null,children:[n]},r=[e];null!=(t=r.pop());)for(var u,i=t.children,o=0,a=i.length;a>o;++o)r.push((i[o]=u={_:i[o],parent:t,children:(u=i[o].children)&&u.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:o}).a=u);return e.children[0]}function e(n){var t=n.children,e=n.parent.children,r=n.i?e[n.i-1]:null;if(t.length){wi(n);var i=(t[0].z+t[t.length-1].z)/2;r?(n.z=r.z+a(n._,r._),n.m=n.z-i):n.z=i}else r&&(n.z=r.z+a(n._,r._));n.parent.A=u(n,r,n.parent.A||e[0])}function r(n){n._.x=n.z+n.parent.m,n.m+=n.parent.m}function u(n,t,e){if(t){for(var r,u=n,i=n,o=t,c=u.parent.children[0],s=u.m,l=i.m,f=o.m,h=c.m;o=_i(o),u=Mi(u),o&&u;)c=Mi(c),i=_i(i),i.a=n,r=o.z+f-u.z-s+a(o._,u._),r>0&&(bi(Si(o,n,e),n,r),s+=r,l+=r),f+=o.m,s+=u.m,h+=c.m,l+=i.m;o&&!_i(i)&&(i.t=o,i.m+=f-l),u&&!Mi(c)&&(c.t=u,c.m+=s-h,e=n)}return e}function i(n){n.x*=c[0],n.y=n.depth*c[1]}var o=Zo.layout.hierarchy().sort(null).value(null),a=xi,c=[1,1],s=null;return n.separation=function(t){return arguments.length?(a=t,n):a},n.size=function(t){return arguments.length?(s=null==(c=t)?i:null,n):s?null:c},n.nodeSize=function(t){return arguments.length?(s=null==(c=t)?null:i,n):s?c:null},Xu(n,o)},Zo.layout.cluster=function(){function n(n,i){var o,a=t.call(this,n,i),c=a[0],s=0;Bu(c,function(n){var t=n.children;t&&t.length?(n.x=Ei(t),n.y=ki(t)):(n.x=o?s+=e(n,o):0,n.y=0,o=n)});var l=Ai(c),f=Ci(c),h=l.x-e(l,f)/2,g=f.x+e(f,l)/2;return Bu(c,u?function(n){n.x=(n.x-c.x)*r[0],n.y=(c.y-n.y)*r[1]}:function(n){n.x=(n.x-h)/(g-h)*r[0],n.y=(1-(c.y?n.y/c.y:1))*r[1]}),a}var t=Zo.layout.hierarchy().sort(null).value(null),e=xi,r=[1,1],u=!1;return n.separation=function(t){return arguments.length?(e=t,n):e},n.size=function(t){return arguments.length?(u=null==(r=t),n):u?null:r},n.nodeSize=function(t){return arguments.length?(u=null!=(r=t),n):u?r:null},Xu(n,t)},Zo.layout.treemap=function(){function n(n,t){for(var e,r,u=-1,i=n.length;++u<i;)r=(e=n[u]).value*(0>t?0:t),e.area=isNaN(r)||0>=r?0:r}function t(e){var i=e.children;if(i&&i.length){var o,a,c,s=f(e),l=[],h=i.slice(),p=1/0,v="slice"===g?s.dx:"dice"===g?s.dy:"slice-dice"===g?1&e.depth?s.dy:s.dx:Math.min(s.dx,s.dy);for(n(h,s.dx*s.dy/e.value),l.area=0;(c=h.length)>0;)l.push(o=h[c-1]),l.area+=o.area,"squarify"!==g||(a=r(l,v))<=p?(h.pop(),p=a):(l.area-=l.pop().area,u(l,v,s,!1),v=Math.min(s.dx,s.dy),l.length=l.area=0,p=1/0);l.length&&(u(l,v,s,!0),l.length=l.area=0),i.forEach(t)}}function e(t){var r=t.children;if(r&&r.length){var i,o=f(t),a=r.slice(),c=[];for(n(a,o.dx*o.dy/t.value),c.area=0;i=a.pop();)c.push(i),c.area+=i.area,null!=i.z&&(u(c,i.z?o.dx:o.dy,o,!a.length),c.length=c.area=0);r.forEach(e)}}function r(n,t){for(var e,r=n.area,u=0,i=1/0,o=-1,a=n.length;++o<a;)(e=n[o].area)&&(i>e&&(i=e),e>u&&(u=e));return r*=r,t*=t,r?Math.max(t*u*p/r,r/(t*i*p)):1/0}function u(n,t,e,r){var u,i=-1,o=n.length,a=e.x,s=e.y,l=t?c(n.area/t):0;if(t==e.dx){for((r||l>e.dy)&&(l=e.dy);++i<o;)u=n[i],u.x=a,u.y=s,u.dy=l,a+=u.dx=Math.min(e.x+e.dx-a,l?c(u.area/l):0);u.z=!0,u.dx+=e.x+e.dx-a,e.y+=l,e.dy-=l}else{for((r||l>e.dx)&&(l=e.dx);++i<o;)u=n[i],u.x=a,u.y=s,u.dx=l,s+=u.dy=Math.min(e.y+e.dy-s,l?c(u.area/l):0);u.z=!1,u.dy+=e.y+e.dy-s,e.x+=l,e.dx-=l}}function i(r){var u=o||a(r),i=u[0];return i.x=0,i.y=0,i.dx=s[0],i.dy=s[1],o&&a.revalue(i),n([i],i.dx*i.dy/i.value),(o?e:t)(i),h&&(o=u),u}var o,a=Zo.layout.hierarchy(),c=Math.round,s=[1,1],l=null,f=Ni,h=!1,g="squarify",p=.5*(1+Math.sqrt(5));return i.size=function(n){return arguments.length?(s=n,i):s},i.padding=function(n){function t(t){var e=n.call(i,t,t.depth);return null==e?Ni(t):zi(t,"number"==typeof e?[e,e,e,e]:e)}function e(t){return zi(t,n)}if(!arguments.length)return l;var r;return f=null==(l=n)?Ni:"function"==(r=typeof n)?t:"number"===r?(n=[n,n,n,n],e):e,i},i.round=function(n){return arguments.length?(c=n?Math.round:Number,i):c!=Number},i.sticky=function(n){return arguments.length?(h=n,o=null,i):h},i.ratio=function(n){return arguments.length?(p=n,i):p},i.mode=function(n){return arguments.length?(g=n+"",i):g},Xu(i,a)},Zo.random={normal:function(n,t){var e=arguments.length;return 2>e&&(t=1),1>e&&(n=0),function(){var e,r,u;do e=2*Math.random()-1,r=2*Math.random()-1,u=e*e+r*r;while(!u||u>1);return n+t*e*Math.sqrt(-2*Math.log(u)/u)}},logNormal:function(){var n=Zo.random.normal.apply(Zo,arguments);return function(){return Math.exp(n())}},bates:function(n){var t=Zo.random.irwinHall(n);return function(){return t()/n}},irwinHall:function(n){return function(){for(var t=0,e=0;n>e;e++)t+=Math.random();return t}}},Zo.scale={};var ss={floor:wt,ceil:wt};Zo.scale.linear=function(){return Ui([0,1],[0,1],hu,!1)};var ls={s:1,g:1,p:1,r:1,e:1};Zo.scale.log=function(){return Vi(Zo.scale.linear().domain([0,1]),10,!0,[1,10])};var fs=Zo.format(".0e"),hs={floor:function(n){return-Math.ceil(-n)},ceil:function(n){return-Math.floor(-n)}};Zo.scale.pow=function(){return Xi(Zo.scale.linear(),1,[0,1])},Zo.scale.sqrt=function(){return Zo.scale.pow().exponent(.5)},Zo.scale.ordinal=function(){return Bi([],{t:"range",a:[[]]})},Zo.scale.category10=function(){return Zo.scale.ordinal().range(gs)},Zo.scale.category20=function(){return Zo.scale.ordinal().range(ps)},Zo.scale.category20b=function(){return Zo.scale.ordinal().range(vs)},Zo.scale.category20c=function(){return Zo.scale.ordinal().range(ds)};var gs=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(vt),ps=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(vt),vs=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(vt),ds=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(vt);Zo.scale.quantile=function(){return Wi([],[])},Zo.scale.quantize=function(){return Ji(0,1,[0,1])},Zo.scale.threshold=function(){return Gi([.5],[0,1])},Zo.scale.identity=function(){return Ki([0,1])},Zo.svg={},Zo.svg.arc=function(){function n(){var n=t.apply(this,arguments),i=e.apply(this,arguments),o=r.apply(this,arguments)+ms,a=u.apply(this,arguments)+ms,c=(o>a&&(c=o,o=a,a=c),a-o),s=ba>c?"0":"1",l=Math.cos(o),f=Math.sin(o),h=Math.cos(a),g=Math.sin(a);
    return c>=ys?n?"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"M0,"+n+"A"+n+","+n+" 0 1,0 0,"+-n+"A"+n+","+n+" 0 1,0 0,"+n+"Z":"M0,"+i+"A"+i+","+i+" 0 1,1 0,"+-i+"A"+i+","+i+" 0 1,1 0,"+i+"Z":n?"M"+i*l+","+i*f+"A"+i+","+i+" 0 "+s+",1 "+i*h+","+i*g+"L"+n*h+","+n*g+"A"+n+","+n+" 0 "+s+",0 "+n*l+","+n*f+"Z":"M"+i*l+","+i*f+"A"+i+","+i+" 0 "+s+",1 "+i*h+","+i*g+"L0,0"+"Z"}var t=Qi,e=no,r=to,u=eo;return n.innerRadius=function(e){return arguments.length?(t=bt(e),n):t},n.outerRadius=function(t){return arguments.length?(e=bt(t),n):e},n.startAngle=function(t){return arguments.length?(r=bt(t),n):r},n.endAngle=function(t){return arguments.length?(u=bt(t),n):u},n.centroid=function(){var n=(t.apply(this,arguments)+e.apply(this,arguments))/2,i=(r.apply(this,arguments)+u.apply(this,arguments))/2+ms;return[Math.cos(i)*n,Math.sin(i)*n]},n};var ms=-Sa,ys=wa-ka;Zo.svg.line=function(){return ro(wt)};var xs=Zo.map({linear:uo,"linear-closed":io,step:oo,"step-before":ao,"step-after":co,basis:po,"basis-open":vo,"basis-closed":mo,bundle:yo,cardinal:fo,"cardinal-open":so,"cardinal-closed":lo,monotone:So});xs.forEach(function(n,t){t.key=n,t.closed=/-closed$/.test(n)});var Ms=[0,2/3,1/3,0],_s=[0,1/3,2/3,0],bs=[0,1/6,2/3,1/6];Zo.svg.line.radial=function(){var n=ro(ko);return n.radius=n.x,delete n.x,n.angle=n.y,delete n.y,n},ao.reverse=co,co.reverse=ao,Zo.svg.area=function(){return Eo(wt)},Zo.svg.area.radial=function(){var n=Eo(ko);return n.radius=n.x,delete n.x,n.innerRadius=n.x0,delete n.x0,n.outerRadius=n.x1,delete n.x1,n.angle=n.y,delete n.y,n.startAngle=n.y0,delete n.y0,n.endAngle=n.y1,delete n.y1,n},Zo.svg.chord=function(){function n(n,a){var c=t(this,i,n,a),s=t(this,o,n,a);return"M"+c.p0+r(c.r,c.p1,c.a1-c.a0)+(e(c,s)?u(c.r,c.p1,c.r,c.p0):u(c.r,c.p1,s.r,s.p0)+r(s.r,s.p1,s.a1-s.a0)+u(s.r,s.p1,c.r,c.p0))+"Z"}function t(n,t,e,r){var u=t.call(n,e,r),i=a.call(n,u,r),o=c.call(n,u,r)+ms,l=s.call(n,u,r)+ms;return{r:i,a0:o,a1:l,p0:[i*Math.cos(o),i*Math.sin(o)],p1:[i*Math.cos(l),i*Math.sin(l)]}}function e(n,t){return n.a0==t.a0&&n.a1==t.a1}function r(n,t,e){return"A"+n+","+n+" 0 "+ +(e>ba)+",1 "+t}function u(n,t,e,r){return"Q 0,0 "+r}var i=gr,o=pr,a=Ao,c=to,s=eo;return n.radius=function(t){return arguments.length?(a=bt(t),n):a},n.source=function(t){return arguments.length?(i=bt(t),n):i},n.target=function(t){return arguments.length?(o=bt(t),n):o},n.startAngle=function(t){return arguments.length?(c=bt(t),n):c},n.endAngle=function(t){return arguments.length?(s=bt(t),n):s},n},Zo.svg.diagonal=function(){function n(n,u){var i=t.call(this,n,u),o=e.call(this,n,u),a=(i.y+o.y)/2,c=[i,{x:i.x,y:a},{x:o.x,y:a},o];return c=c.map(r),"M"+c[0]+"C"+c[1]+" "+c[2]+" "+c[3]}var t=gr,e=pr,r=Co;return n.source=function(e){return arguments.length?(t=bt(e),n):t},n.target=function(t){return arguments.length?(e=bt(t),n):e},n.projection=function(t){return arguments.length?(r=t,n):r},n},Zo.svg.diagonal.radial=function(){var n=Zo.svg.diagonal(),t=Co,e=n.projection;return n.projection=function(n){return arguments.length?e(No(t=n)):t},n},Zo.svg.symbol=function(){function n(n,r){return(ws.get(t.call(this,n,r))||To)(e.call(this,n,r))}var t=Lo,e=zo;return n.type=function(e){return arguments.length?(t=bt(e),n):t},n.size=function(t){return arguments.length?(e=bt(t),n):e},n};var ws=Zo.map({circle:To,cross:function(n){var t=Math.sqrt(n/5)/2;return"M"+-3*t+","+-t+"H"+-t+"V"+-3*t+"H"+t+"V"+-t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+-t+"V"+t+"H"+-3*t+"Z"},diamond:function(n){var t=Math.sqrt(n/(2*As)),e=t*As;return"M0,"+-t+"L"+e+",0"+" 0,"+t+" "+-e+",0"+"Z"},square:function(n){var t=Math.sqrt(n)/2;return"M"+-t+","+-t+"L"+t+","+-t+" "+t+","+t+" "+-t+","+t+"Z"},"triangle-down":function(n){var t=Math.sqrt(n/Es),e=t*Es/2;return"M0,"+e+"L"+t+","+-e+" "+-t+","+-e+"Z"},"triangle-up":function(n){var t=Math.sqrt(n/Es),e=t*Es/2;return"M0,"+-e+"L"+t+","+e+" "+-t+","+e+"Z"}});Zo.svg.symbolTypes=ws.keys();var Ss,ks,Es=Math.sqrt(3),As=Math.tan(30*Aa),Cs=[],Ns=0;Cs.call=pa.call,Cs.empty=pa.empty,Cs.node=pa.node,Cs.size=pa.size,Zo.transition=function(n){return arguments.length?Ss?n.transition():n:ma.transition()},Zo.transition.prototype=Cs,Cs.select=function(n){var t,e,r,u=this.id,i=[];n=b(n);for(var o=-1,a=this.length;++o<a;){i.push(t=[]);for(var c=this[o],s=-1,l=c.length;++s<l;)(r=c[s])&&(e=n.call(r,r.__data__,s,o))?("__data__"in r&&(e.__data__=r.__data__),Po(e,s,u,r.__transition__[u]),t.push(e)):t.push(null)}return qo(i,u)},Cs.selectAll=function(n){var t,e,r,u,i,o=this.id,a=[];n=w(n);for(var c=-1,s=this.length;++c<s;)for(var l=this[c],f=-1,h=l.length;++f<h;)if(r=l[f]){i=r.__transition__[o],e=n.call(r,r.__data__,f,c),a.push(t=[]);for(var g=-1,p=e.length;++g<p;)(u=e[g])&&Po(u,g,o,i),t.push(u)}return qo(a,o)},Cs.filter=function(n){var t,e,r,u=[];"function"!=typeof n&&(n=R(n));for(var i=0,o=this.length;o>i;i++){u.push(t=[]);for(var e=this[i],a=0,c=e.length;c>a;a++)(r=e[a])&&n.call(r,r.__data__,a,i)&&t.push(r)}return qo(u,this.id)},Cs.tween=function(n,t){var e=this.id;return arguments.length<2?this.node().__transition__[e].tween.get(n):P(this,null==t?function(t){t.__transition__[e].tween.remove(n)}:function(r){r.__transition__[e].tween.set(n,t)})},Cs.attr=function(n,t){function e(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function u(n){return null==n?e:(n+="",function(){var t,e=this.getAttribute(a);return e!==n&&(t=o(e,n),function(n){this.setAttribute(a,t(n))})})}function i(n){return null==n?r:(n+="",function(){var t,e=this.getAttributeNS(a.space,a.local);return e!==n&&(t=o(e,n),function(n){this.setAttributeNS(a.space,a.local,t(n))})})}if(arguments.length<2){for(t in n)this.attr(t,n[t]);return this}var o="transform"==n?Du:hu,a=Zo.ns.qualify(n);return Ro(this,"attr."+n,t,a.local?i:u)},Cs.attrTween=function(n,t){function e(n,e){var r=t.call(this,n,e,this.getAttribute(u));return r&&function(n){this.setAttribute(u,r(n))}}function r(n,e){var r=t.call(this,n,e,this.getAttributeNS(u.space,u.local));return r&&function(n){this.setAttributeNS(u.space,u.local,r(n))}}var u=Zo.ns.qualify(n);return this.tween("attr."+n,u.local?r:e)},Cs.style=function(n,t,e){function r(){this.style.removeProperty(n)}function u(t){return null==t?r:(t+="",function(){var r,u=Wo.getComputedStyle(this,null).getPropertyValue(n);return u!==t&&(r=hu(u,t),function(t){this.style.setProperty(n,r(t),e)})})}var i=arguments.length;if(3>i){if("string"!=typeof n){2>i&&(t="");for(e in n)this.style(e,n[e],t);return this}e=""}return Ro(this,"style."+n,t,u)},Cs.styleTween=function(n,t,e){function r(r,u){var i=t.call(this,r,u,Wo.getComputedStyle(this,null).getPropertyValue(n));return i&&function(t){this.style.setProperty(n,i(t),e)}}return arguments.length<3&&(e=""),this.tween("style."+n,r)},Cs.text=function(n){return Ro(this,"text",n,Do)},Cs.remove=function(){return this.each("end.transition",function(){var n;this.__transition__.count<2&&(n=this.parentNode)&&n.removeChild(this)})},Cs.ease=function(n){var t=this.id;return arguments.length<1?this.node().__transition__[t].ease:("function"!=typeof n&&(n=Zo.ease.apply(Zo,arguments)),P(this,function(e){e.__transition__[t].ease=n}))},Cs.delay=function(n){var t=this.id;return arguments.length<1?this.node().__transition__[t].delay:P(this,"function"==typeof n?function(e,r,u){e.__transition__[t].delay=+n.call(e,e.__data__,r,u)}:(n=+n,function(e){e.__transition__[t].delay=n}))},Cs.duration=function(n){var t=this.id;return arguments.length<1?this.node().__transition__[t].duration:P(this,"function"==typeof n?function(e,r,u){e.__transition__[t].duration=Math.max(1,n.call(e,e.__data__,r,u))}:(n=Math.max(1,n),function(e){e.__transition__[t].duration=n}))},Cs.each=function(n,t){var e=this.id;if(arguments.length<2){var r=ks,u=Ss;Ss=e,P(this,function(t,r,u){ks=t.__transition__[e],n.call(t,t.__data__,r,u)}),ks=r,Ss=u}else P(this,function(r){var u=r.__transition__[e];(u.event||(u.event=Zo.dispatch("start","end"))).on(n,t)});return this},Cs.transition=function(){for(var n,t,e,r,u=this.id,i=++Ns,o=[],a=0,c=this.length;c>a;a++){o.push(n=[]);for(var t=this[a],s=0,l=t.length;l>s;s++)(e=t[s])&&(r=Object.create(e.__transition__[u]),r.delay+=r.duration,Po(e,s,i,r)),n.push(e)}return qo(o,i)},Zo.svg.axis=function(){function n(n){n.each(function(){var n,s=Zo.select(this),l=this.__chart__||e,f=this.__chart__=e.copy(),h=null==c?f.ticks?f.ticks.apply(f,a):f.domain():c,g=null==t?f.tickFormat?f.tickFormat.apply(f,a):wt:t,p=s.selectAll(".tick").data(h,f),v=p.enter().insert("g",".domain").attr("class","tick").style("opacity",ka),d=Zo.transition(p.exit()).style("opacity",ka).remove(),m=Zo.transition(p.order()).style("opacity",1),y=Ti(f),x=s.selectAll(".domain").data([0]),M=(x.enter().append("path").attr("class","domain"),Zo.transition(x));v.append("line"),v.append("text");var _=v.select("line"),b=m.select("line"),w=p.select("text").text(g),S=v.select("text"),k=m.select("text");switch(r){case"bottom":n=Uo,_.attr("y2",u),S.attr("y",Math.max(u,0)+o),b.attr("x2",0).attr("y2",u),k.attr("x",0).attr("y",Math.max(u,0)+o),w.attr("dy",".71em").style("text-anchor","middle"),M.attr("d","M"+y[0]+","+i+"V0H"+y[1]+"V"+i);break;case"top":n=Uo,_.attr("y2",-u),S.attr("y",-(Math.max(u,0)+o)),b.attr("x2",0).attr("y2",-u),k.attr("x",0).attr("y",-(Math.max(u,0)+o)),w.attr("dy","0em").style("text-anchor","middle"),M.attr("d","M"+y[0]+","+-i+"V0H"+y[1]+"V"+-i);break;case"left":n=jo,_.attr("x2",-u),S.attr("x",-(Math.max(u,0)+o)),b.attr("x2",-u).attr("y2",0),k.attr("x",-(Math.max(u,0)+o)).attr("y",0),w.attr("dy",".32em").style("text-anchor","end"),M.attr("d","M"+-i+","+y[0]+"H0V"+y[1]+"H"+-i);break;case"right":n=jo,_.attr("x2",u),S.attr("x",Math.max(u,0)+o),b.attr("x2",u).attr("y2",0),k.attr("x",Math.max(u,0)+o).attr("y",0),w.attr("dy",".32em").style("text-anchor","start"),M.attr("d","M"+i+","+y[0]+"H0V"+y[1]+"H"+i)}if(f.rangeBand){var E=f,A=E.rangeBand()/2;l=f=function(n){return E(n)+A}}else l.rangeBand?l=f:d.call(n,f);v.call(n,l),m.call(n,f)})}var t,e=Zo.scale.linear(),r=zs,u=6,i=6,o=3,a=[10],c=null;return n.scale=function(t){return arguments.length?(e=t,n):e},n.orient=function(t){return arguments.length?(r=t in Ls?t+"":zs,n):r},n.ticks=function(){return arguments.length?(a=arguments,n):a},n.tickValues=function(t){return arguments.length?(c=t,n):c},n.tickFormat=function(e){return arguments.length?(t=e,n):t},n.tickSize=function(t){var e=arguments.length;return e?(u=+t,i=+arguments[e-1],n):u},n.innerTickSize=function(t){return arguments.length?(u=+t,n):u},n.outerTickSize=function(t){return arguments.length?(i=+t,n):i},n.tickPadding=function(t){return arguments.length?(o=+t,n):o},n.tickSubdivide=function(){return arguments.length&&n},n};var zs="bottom",Ls={top:1,right:1,bottom:1,left:1};Zo.svg.brush=function(){function n(i){i.each(function(){var i=Zo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",u).on("touchstart.brush",u),o=i.selectAll(".background").data([0]);o.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),i.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=i.selectAll(".resize").data(p,wt);a.exit().remove(),a.enter().append("g").attr("class",function(n){return"resize "+n}).style("cursor",function(n){return Ts[n]}).append("rect").attr("x",function(n){return/[ew]$/.test(n)?-3:null}).attr("y",function(n){return/^[ns]/.test(n)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",n.empty()?"none":null);var l,f=Zo.transition(i),h=Zo.transition(o);c&&(l=Ti(c),h.attr("x",l[0]).attr("width",l[1]-l[0]),e(f)),s&&(l=Ti(s),h.attr("y",l[0]).attr("height",l[1]-l[0]),r(f)),t(f)})}function t(n){n.selectAll(".resize").attr("transform",function(n){return"translate("+l[+/e$/.test(n)]+","+f[+/^s/.test(n)]+")"})}function e(n){n.select(".extent").attr("x",l[0]),n.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1]-l[0])}function r(n){n.select(".extent").attr("y",f[0]),n.selectAll(".extent,.e>rect,.w>rect").attr("height",f[1]-f[0])}function u(){function u(){32==Zo.event.keyCode&&(C||(x=null,z[0]-=l[1],z[1]-=f[1],C=2),y())}function p(){32==Zo.event.keyCode&&2==C&&(z[0]+=l[1],z[1]+=f[1],C=0,y())}function v(){var n=Zo.mouse(_),u=!1;M&&(n[0]+=M[0],n[1]+=M[1]),C||(Zo.event.altKey?(x||(x=[(l[0]+l[1])/2,(f[0]+f[1])/2]),z[0]=l[+(n[0]<x[0])],z[1]=f[+(n[1]<x[1])]):x=null),E&&d(n,c,0)&&(e(S),u=!0),A&&d(n,s,1)&&(r(S),u=!0),u&&(t(S),w({type:"brush",mode:C?"move":"resize"}))}function d(n,t,e){var r,u,a=Ti(t),c=a[0],s=a[1],p=z[e],v=e?f:l,d=v[1]-v[0];return C&&(c-=p,s-=d+p),r=(e?g:h)?Math.max(c,Math.min(s,n[e])):n[e],C?u=(r+=p)+d:(x&&(p=Math.max(c,Math.min(s,2*x[e]-r))),r>p?(u=r,r=p):u=p),v[0]!=r||v[1]!=u?(e?o=null:i=null,v[0]=r,v[1]=u,!0):void 0}function m(){v(),S.style("pointer-events","all").selectAll(".resize").style("display",n.empty()?"none":null),Zo.select("body").style("cursor",null),L.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),N(),w({type:"brushend"})}var x,M,_=this,b=Zo.select(Zo.event.target),w=a.of(_,arguments),S=Zo.select(_),k=b.datum(),E=!/^(n|s)$/.test(k)&&c,A=!/^(e|w)$/.test(k)&&s,C=b.classed("extent"),N=I(),z=Zo.mouse(_),L=Zo.select(Wo).on("keydown.brush",u).on("keyup.brush",p);if(Zo.event.changedTouches?L.on("touchmove.brush",v).on("touchend.brush",m):L.on("mousemove.brush",v).on("mouseup.brush",m),S.interrupt().selectAll("*").interrupt(),C)z[0]=l[0]-z[0],z[1]=f[0]-z[1];else if(k){var T=+/w$/.test(k),q=+/^n/.test(k);M=[l[1-T]-z[0],f[1-q]-z[1]],z[0]=l[T],z[1]=f[q]}else Zo.event.altKey&&(x=z.slice());S.style("pointer-events","none").selectAll(".resize").style("display",null),Zo.select("body").style("cursor",b.style("cursor")),w({type:"brushstart"}),v()}var i,o,a=M(n,"brushstart","brush","brushend"),c=null,s=null,l=[0,0],f=[0,0],h=!0,g=!0,p=qs[0];return n.event=function(n){n.each(function(){var n=a.of(this,arguments),t={x:l,y:f,i:i,j:o},e=this.__chart__||t;this.__chart__=t,Ss?Zo.select(this).transition().each("start.brush",function(){i=e.i,o=e.j,l=e.x,f=e.y,n({type:"brushstart"})}).tween("brush:brush",function(){var e=gu(l,t.x),r=gu(f,t.y);return i=o=null,function(u){l=t.x=e(u),f=t.y=r(u),n({type:"brush",mode:"resize"})}}).each("end.brush",function(){i=t.i,o=t.j,n({type:"brush",mode:"resize"}),n({type:"brushend"})}):(n({type:"brushstart"}),n({type:"brush",mode:"resize"}),n({type:"brushend"}))})},n.x=function(t){return arguments.length?(c=t,p=qs[!c<<1|!s],n):c},n.y=function(t){return arguments.length?(s=t,p=qs[!c<<1|!s],n):s},n.clamp=function(t){return arguments.length?(c&&s?(h=!!t[0],g=!!t[1]):c?h=!!t:s&&(g=!!t),n):c&&s?[h,g]:c?h:s?g:null},n.extent=function(t){var e,r,u,a,h;return arguments.length?(c&&(e=t[0],r=t[1],s&&(e=e[0],r=r[0]),i=[e,r],c.invert&&(e=c(e),r=c(r)),e>r&&(h=e,e=r,r=h),(e!=l[0]||r!=l[1])&&(l=[e,r])),s&&(u=t[0],a=t[1],c&&(u=u[1],a=a[1]),o=[u,a],s.invert&&(u=s(u),a=s(a)),u>a&&(h=u,u=a,a=h),(u!=f[0]||a!=f[1])&&(f=[u,a])),n):(c&&(i?(e=i[0],r=i[1]):(e=l[0],r=l[1],c.invert&&(e=c.invert(e),r=c.invert(r)),e>r&&(h=e,e=r,r=h))),s&&(o?(u=o[0],a=o[1]):(u=f[0],a=f[1],s.invert&&(u=s.invert(u),a=s.invert(a)),u>a&&(h=u,u=a,a=h))),c&&s?[[e,u],[r,a]]:c?[e,r]:s&&[u,a])},n.clear=function(){return n.empty()||(l=[0,0],f=[0,0],i=o=null),n},n.empty=function(){return!!c&&l[0]==l[1]||!!s&&f[0]==f[1]},Zo.rebind(n,a,"on")};var Ts={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},qs=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Rs=Qa.format=ic.timeFormat,Ds=Rs.utc,Ps=Ds("%Y-%m-%dT%H:%M:%S.%LZ");Rs.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Ho:Ps,Ho.parse=function(n){var t=new Date(n);return isNaN(t)?null:t},Ho.toString=Ps.toString,Qa.second=Dt(function(n){return new nc(1e3*Math.floor(n/1e3))},function(n,t){n.setTime(n.getTime()+1e3*Math.floor(t))},function(n){return n.getSeconds()}),Qa.seconds=Qa.second.range,Qa.seconds.utc=Qa.second.utc.range,Qa.minute=Dt(function(n){return new nc(6e4*Math.floor(n/6e4))},function(n,t){n.setTime(n.getTime()+6e4*Math.floor(t))},function(n){return n.getMinutes()}),Qa.minutes=Qa.minute.range,Qa.minutes.utc=Qa.minute.utc.range,Qa.hour=Dt(function(n){var t=n.getTimezoneOffset()/60;return new nc(36e5*(Math.floor(n/36e5-t)+t))},function(n,t){n.setTime(n.getTime()+36e5*Math.floor(t))},function(n){return n.getHours()}),Qa.hours=Qa.hour.range,Qa.hours.utc=Qa.hour.utc.range,Qa.month=Dt(function(n){return n=Qa.day(n),n.setDate(1),n},function(n,t){n.setMonth(n.getMonth()+t)},function(n){return n.getMonth()}),Qa.months=Qa.month.range,Qa.months.utc=Qa.month.utc.range;var Us=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],js=[[Qa.second,1],[Qa.second,5],[Qa.second,15],[Qa.second,30],[Qa.minute,1],[Qa.minute,5],[Qa.minute,15],[Qa.minute,30],[Qa.hour,1],[Qa.hour,3],[Qa.hour,6],[Qa.hour,12],[Qa.day,1],[Qa.day,2],[Qa.week,1],[Qa.month,1],[Qa.month,3],[Qa.year,1]],Hs=Rs.multi([[".%L",function(n){return n.getMilliseconds()}],[":%S",function(n){return n.getSeconds()}],["%I:%M",function(n){return n.getMinutes()}],["%I %p",function(n){return n.getHours()}],["%a %d",function(n){return n.getDay()&&1!=n.getDate()}],["%b %d",function(n){return 1!=n.getDate()}],["%B",function(n){return n.getMonth()}],["%Y",we]]),Fs={range:function(n,t,e){return Zo.range(Math.ceil(n/e)*e,+t,e).map(Oo)},floor:wt,ceil:wt};js.year=Qa.year,Qa.scale=function(){return Fo(Zo.scale.linear(),js,Hs)};var Os=js.map(function(n){return[n[0].utc,n[1]]}),Ys=Ds.multi([[".%L",function(n){return n.getUTCMilliseconds()}],[":%S",function(n){return n.getUTCSeconds()}],["%I:%M",function(n){return n.getUTCMinutes()}],["%I %p",function(n){return n.getUTCHours()}],["%a %d",function(n){return n.getUTCDay()&&1!=n.getUTCDate()}],["%b %d",function(n){return 1!=n.getUTCDate()}],["%B",function(n){return n.getUTCMonth()}],["%Y",we]]);Os.year=Qa.year.utc,Qa.scale.utc=function(){return Fo(Zo.scale.linear(),Os,Ys)},Zo.text=St(function(n){return n.responseText}),Zo.json=function(n,t){return kt(n,"application/json",Yo,t)},Zo.html=function(n,t){return kt(n,"text/html",Io,t)},Zo.xml=St(function(n){return n.responseXML}),"function"==typeof define&&define.amd?define(Zo):"object"==typeof module&&module.exports&&(module.exports=Zo),this.d3=Zo}();;
;/* module-key = 'com.atlassian.jira.gadgets:piechart', location = 'static/components/charts/piechart/PieChart.js' */
define("jira-dashboard-items/components/charts/piechart",["jquery"],function($){function DEFAULT_COLOUR_PICKER(colours,numberElements){var LIME_GREEN="#8eb021",BLUE="#3b7fc4",RED="#d04437",YELLOW="#f6c342",VIOLET="#654982",PINK="#f691b2",GRAY="#999999",ASH_GRAY="#cccccc",BROWN="#815b3a",CHEETO_ORANGE="#f79232",TAN="#f1a257",LIGHT_BROWN="#d39c3f",CYAN="#59afe1",SLATE="#4a6785",COOL_BLUE="#84bbc6",MID_GREEN="#67ab49",MAUVE="#ac707a",BRIGHT_PINK="#f15c75";colours=colours||[LIME_GREEN,BLUE,RED,YELLOW,VIOLET,PINK,GRAY,BROWN,CHEETO_ORANGE,CYAN,BRIGHT_PINK];function getNextColour(piechart,data,index,sectorElement){var colourIndex=index%colours.length;var isLast=(index+1===numberElements);var isFirstColour=(colourIndex===0);var oneSector=(numberElements===1);if(isLast&&isFirstColour&&!oneSector){colourIndex=1}return colours[colourIndex]}return getNextColour}function noop(){}var PieChart=function(data,options){this.radius=options.radius;this.data=data;this.getValue=options.getValue||function(dataElement){return dataElement};this.centerChart=options.centerChart||false;this.clickable=options.clickable||false;this.colourPicker=options.colourPicker||DEFAULT_COLOUR_PICKER(options.colours,this.data.length);this.hoverExpansion=options.hoverExpansion||0;this.innerRadius=options.innerRadius||0;this.sectorGap=options.sectorGap||2;this.innerCirclePadding=Math.min(10,Math.max(this.innerRadius,0));this.getPrimaryText=options.getPrimaryText||noop;this.getSecondaryText=options.getSecondaryText||noop;this.onClick=options.onClick||noop;this.onEachArc=options.onEachArc||noop;this.onMouseOver=options.onMouseOver||noop;this.onMouseOut=options.onMouseOut||noop;this.pieCenter=this.radius+this.hoverExpansion;this.width=this.pieCenter*2;this.height=this.pieCenter*2;this.render=function(element){var self=this;var chart=d3.select(element[0]).append("svg").data([this.data]).classed({piechart:true,centered:this.centerChart}).attr("width",this.width).attr("height",this.height);chart.append("g").classed({"piechart-graph":true}).attr("transform","translate("+this.pieCenter+","+this.pieCenter+")");var centerTextBlockOptions={width:2*(this.innerRadius-this.innerCirclePadding),height:Math.sqrt(2*this.innerRadius*this.innerRadius),dx:(this.pieCenter-this.innerRadius+this.innerCirclePadding),dy:(this.pieCenter-this.innerRadius+2*this.innerCirclePadding)};var arc=d3.svg.arc().outerRadius(this.radius).innerRadius(this.innerRadius);var arcLarger=d3.svg.arc().outerRadius(this.radius+this.hoverExpansion).innerRadius(this.innerRadius);var pie=d3.layout.pie().value(this.getValue);this.arcs=chart.select("g.piechart-graph").selectAll("g").data(pie).enter().append("g").classed({"piechart-arc":true,clickable:this.clickable}).each(function(sector,index){self.onEachArc(self,sector.data,index,$(d3.select(this).node()))});this.arcs.append("text").attr("width",centerTextBlockOptions.width).attr("text-anchor","middle").classed("piechart-center-primary",true).attr("y",5).attr("fill",function(sector,index){return self.colourPicker(self,sector.data,index,d3.select(this).node())}).text(function(sector,index){return self.getPrimaryText(sector.data,index)});this.arcs.append("text").attr("width",centerTextBlockOptions.width).attr("text-anchor","middle").classed("piechart-center-secondary",true).attr("fill","#333333").attr("y",25).text(function(sector,index){return self.getSecondaryText(sector.data,index)});this.arcs.append("path").attr("stroke","#fff").attr("stroke-width",this.sectorGap).attr("fill",function(sector,index){return self.colourPicker(self,sector.data,index,d3.select(this).node())}).classed({"piechart-fill":true}).attr("d",arc);this.arcs.on("click",function(sector,index){self.onClick(self,sector.data,index,d3.select(this).node())});this.mouseOver=function(dataIndex){_mouseOver.call(this.arcs[0][dataIndex],this.arcs.data()[dataIndex],dataIndex)};this.mouseOut=function(dataIndex){_mouseOut.call(this.arcs[0][dataIndex],this.arcs.data()[dataIndex],dataIndex)};var _mouseOver=function(sector,index){d3.select(this).classed({"piechart-arc-highlighted":true});d3.select(this).select("path").transition().duration(100).attr("d",arcLarger);self.onMouseOver(self,sector.data,index,d3.select(this).node())};var _mouseOut=function(sector,index){d3.select(this).classed({"piechart-arc-highlighted":false});d3.select(this).select("path").transition().duration(100).attr("d",arc);self.onMouseOut(self,sector.data,index,d3.select(this).node())};this.arcs.on("mouseover",function(sector,index){_mouseOver.call(this,sector,index)});this.arcs.on("mouseout",function(sector,index){_mouseOut.call(this,sector,index)})}};return PieChart});;
;/* module-key = 'com.atlassian.jira.gadgets:piechart-with-legend', location = 'static/components/charts/piechart/piechart-with-legend.soy' */
// This file was automatically generated from piechart-with-legend.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Charts == 'undefined') { JIRA.Charts = {}; }
if (typeof JIRA.Charts.PieChart == 'undefined') { JIRA.Charts.PieChart = {}; }
if (typeof JIRA.Charts.PieChart.Legend == 'undefined') { JIRA.Charts.PieChart.Legend = {}; }
if (typeof JIRA.Charts.PieChart.Legend.Templates == 'undefined') { JIRA.Charts.PieChart.Legend.Templates = {}; }


JIRA.Charts.PieChart.Legend.Templates.Container = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'piechart-with-legend\'><div class=\'piechart-wrapper\'></div><div class=\'legend-wrapper\'><div class="legend-title"></div><ul class=\'legend\'></ul></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Charts.PieChart.Legend.Templates.ListItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class=\'legend-item\' data-piechartsector=\'', soy.$$escapeHtml(opt_data.index), '\'></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:piechart-with-legend', location = 'static/components/charts/piechart/PieChartWithLegend.js' */
define("jira-dashboard-items/components/charts/piechart-with-legend",["jquery","jira-dashboard-items/components/charts/piechart"],function($,PieChart){function noop(){}var Templates=JIRA.Charts.PieChart.Legend.Templates;var PieChartWithLegend=function(data,options){options.legend=options.legend||{};var self=this;this.data=data;this.PieChart=new PieChart(data,options.piechart);this.renderLegendItem=options.legend.renderLegendItem||noop;this.renderLegendTitle=options.legend.renderLegendTitle||noop;function renderPieChart(element){var chartEl=$(".piechart-wrapper",element);self.PieChart.render(chartEl)}function renderLegend(element){var legendEl=$(".legend-wrapper",element);var legendTitle=$(".legend-title",legendEl);self.renderLegendTitle(legendTitle,self.data);var list=$("ul.legend",legendEl);for(var i=0;i<self.data.length;++i){var dataItem=self.data[i];var listItem=$(Templates.ListItem({index:i}));self.renderLegendItem(listItem,self.PieChart,dataItem,i);list.append(listItem)}}this.render=function(element){element=$(element);element.html(Templates.Container());renderPieChart(element);renderLegend(element);$(".legend .legend-item",element).each(function(index){$(this).mouseover(function(){self.PieChart.mouseOver(index)});$(this).mouseleave(function(){self.PieChart.mouseOut(index)})})}};return PieChartWithLegend});;
;/* module-key = 'com.atlassian.jira.gadgets:resize', location = 'static/lib/jquery.resize/jquery.resize.js' */
(function($){var attachEvent=document.attachEvent,stylesCreated=false;var jQuery_resize=$.fn.resize;$.fn.resize=function(callback){return this.each(function(){if(this==window){jQuery_resize.call(jQuery(this),callback)}else{addResizeListener(this,callback)}})};$.fn.removeResize=function(callback){return this.each(function(){removeResizeListener(this,callback)})};if(!attachEvent){var requestFrame=(function(){var raf=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(fn){return window.setTimeout(fn,20)};return function(fn){return raf(fn)}})();var cancelFrame=(function(){var cancel=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.clearTimeout;return function(id){return cancel(id)}})();function resetTriggers(element){var triggers=element.__resizeTriggers__,expand=triggers.firstElementChild,contract=triggers.lastElementChild,expandChild=expand.firstElementChild;contract.scrollLeft=contract.scrollWidth;contract.scrollTop=contract.scrollHeight;expandChild.style.width=expand.offsetWidth+1+"px";expandChild.style.height=expand.offsetHeight+1+"px";expand.scrollLeft=expand.scrollWidth;expand.scrollTop=expand.scrollHeight}function checkTriggers(element){return element.offsetWidth!=element.__resizeLast__.width||element.offsetHeight!=element.__resizeLast__.height}function scrollListener(e){var element=this;resetTriggers(this);if(this.__resizeRAF__){cancelFrame(this.__resizeRAF__)}this.__resizeRAF__=requestFrame(function(){if(checkTriggers(element)){element.__resizeLast__.width=element.offsetWidth;element.__resizeLast__.height=element.offsetHeight;element.__resizeListeners__.forEach(function(fn){fn.call(element,e)})}})}}function createStyles(){if(!stylesCreated){var css='.resize-triggers { visibility: hidden; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',head=document.head||document.getElementsByTagName("head")[0],style=document.createElement("style");style.type="text/css";if(style.styleSheet){style.styleSheet.cssText=css}else{style.appendChild(document.createTextNode(css))}head.appendChild(style)}}window.addResizeListener=function(element,fn){if(attachEvent){element.attachEvent("onresize",fn)}else{if(!element.__resizeTriggers__){if(getComputedStyle(element).position=="static"){element.style.position="relative"}createStyles();element.__resizeLast__={};element.__resizeListeners__=[];(element.__resizeTriggers__=document.createElement("div")).className="resize-triggers";element.__resizeTriggers__.innerHTML='<div class="expand-trigger"><div></div></div><div class="contract-trigger"></div>';element.appendChild(element.__resizeTriggers__);resetTriggers(element);element.addEventListener("scroll",scrollListener,true)}element.__resizeListeners__.push(fn)}};window.removeResizeListener=function(element,fn){if(attachEvent){element.detachEvent("onresize",fn)}else{element.__resizeListeners__.splice(element.__resizeListeners__.indexOf(fn),1);if(!element.__resizeListeners__.length){element.removeEventListener("scroll",scrollListener);element.__resizeTriggers__=!element.removeChild(element.__resizeTriggers__)}}}}(jQuery));;
;/* module-key = 'com.atlassian.jira.gadgets:piechart-dashboard-item-resources', location = 'static/dashboarditem/piechart/PieChart.soy' */
// This file was automatically generated from PieChart.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.PieChart == 'undefined') { JIRA.DashboardItem.PieChart = {}; }
if (typeof JIRA.DashboardItem.PieChart.Templates == 'undefined') { JIRA.DashboardItem.PieChart.Templates = {}; }


JIRA.DashboardItem.PieChart.Templates.Configuration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates.projectFilterPicker({prefix: opt_data.prefix, id: 'project-filter-picker', selectionType: opt_data.preferences.type, selectionID: opt_data.preferences.id, selectionName: opt_data.preferences.name}, param3);
  JIRA.DashboardItem.PieChart.Templates.statTypePicker({prefix: opt_data.prefix, id: 'stat-type', statTypes: opt_data.statTypes, value: opt_data.preferences.statType}, param3);
  Atlassian.DashboardItem.Common.Templates.refreshInterval({prefix: opt_data.prefix, id: 'refresh-interval', value: opt_data.preferences.refresh}, param3);
  Atlassian.DashboardItem.Common.Templates.config({fields: param3.toString(), isConfigured: opt_data.preferences.isConfigured}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.SuggestionDropdownSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h5>', soy.$$escapeHtml(opt_data.section), '</h5><ul class="aui-list-section"></ul>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.statTypePicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy26 = opt_data.prefix + opt_data.id;
  output.append('<div class="field-group"><label for="', soy.$$escapeHtml(prefixedId__soy26), '">', soy.$$escapeHtml("Statistic Type:"), '<span class="aui-icon icon-required"> ', soy.$$escapeHtml("required"), '</span></label><select id="', soy.$$escapeHtml(prefixedId__soy26), '" name="statType" class="select">');
  var typeList36 = opt_data.statTypes;
  var typeListLen36 = typeList36.length;
  for (var typeIndex36 = 0; typeIndex36 < typeListLen36; typeIndex36++) {
    var typeData36 = typeList36[typeIndex36];
    output.append('<option value="', soy.$$escapeHtml(typeData36.value), '"', (typeData36.value == opt_data.value) ? ' selected="selected"' : '', '>', soy.$$escapeHtml(typeData36.label), '</option>');
  }
  output.append('</select><div class="error"></div><div class="description">', soy.$$escapeHtml("Select which type of statistic to display for this filter."), '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.SectorInlineDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="piechart-inline-dialog"><h2 class="piechart-inline-dialog-title">', soy.$$escapeHtml(opt_data.key), '</h2><p><strong>', soy.$$escapeHtml("Total Issues"), ':</strong> ', soy.$$escapeHtml(opt_data.value), ' (', soy.$$escapeHtml(opt_data.percentage), '%)</p><p>', (opt_data.url) ? '<a href="' + soy.$$escapeHtml(opt_data.url) + '" title="' + soy.$$escapeHtml(opt_data.value) + '">' + soy.$$escapeHtml("View in Issue Navigator") + '</a>' : '', '</p></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.GroupedSectorInlineDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="piechart-inline-dialog grouped-sector-inline-dialog"><h2>', soy.$$escapeHtml(opt_data.key), ' (', soy.$$escapeHtml(opt_data.percentage), '%)</h2><p><strong>', soy.$$escapeHtml("Total Issues"), ':</strong> ', soy.$$escapeHtml(opt_data.value), '</p><ul>');
  var resultList80 = opt_data.subResults;
  var resultListLen80 = resultList80.length;
  for (var resultIndex80 = 0; resultIndex80 < resultListLen80; resultIndex80++) {
    var resultData80 = resultList80[resultIndex80];
    output.append('<li>', (resultData80.url) ? '<a class=\'grouped-list-label\' href=\'' + soy.$$escapeHtml(resultData80.url) + '\' title=\'' + soy.$$escapeHtml(resultData80.key) + '\'>' + soy.$$escapeHtml(resultData80.key) + '</a>' : '<span class=\'grouped-list-label\'>' + soy.$$escapeHtml(opt_data.key) + '</span>', '<div class=\'item-value\'>', soy.$$escapeHtml(resultData80.value), '</div></li>');
  }
  output.append('<ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.PieChart = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'piechart-gadget\'></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.Errors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param105 = new soy.StringBuilder('<ul>');
  var errorList107 = opt_data.errors;
  var errorListLen107 = errorList107.length;
  for (var errorIndex107 = 0; errorIndex107 < errorListLen107; errorIndex107++) {
    var errorData107 = errorList107[errorIndex107];
    param105.append('<li>', soy.$$escapeHtml(errorData107.message), '</li>');
  }
  param105.append('</ul>');
  aui.message.error({titleContent: "Unfortunately, one or more of your preferences are now unavailable. Please update your preferences, or remove gadget by clicking delete from the title bar above.", closeable: 'false', content: param105.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.NoPieChartContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({content: "No Data Available", closeable: 'false'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.ErrorRenderingConfiguration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.error({titleContent: "Oops - an error has occurred", content: '', closeable: 'false'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.LegendTitle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h3>', soy.$$escapeHtml(opt_data.statType), '</h3><a href=\'', soy.$$escapeHtml(opt_data.filterUrl), '\' title=\'', soy.$$escapeHtml(opt_data.filterTitle), '\'>');
  var boldedCount__soy131 = '<b>' + opt_data.issueCount + '</b>';
  output.append(AJS.format("Total Issues: {0}",boldedCount__soy131), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.LegendSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'legend-content\'></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.LegendItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="legend-item-wrapper"><div class="legend-item-value">', soy.$$escapeHtml(opt_data.value), '</div><div class="icon piechart-fill legend-icon" style="background-color: ', soy.$$escapeHtml(opt_data.colour), '"></div><div class="legend-item-label-wrapper">', (opt_data.url) ? '<a class=\'legend-item-label\' href=\'' + soy.$$escapeHtml(opt_data.url) + '\' ' + ((! opt_data.subResults) ? 'title=\'' + soy.$$escapeHtml(opt_data.key) + '\'' : '') + '>' + soy.$$escapeHtml(opt_data.key) + '</a>' : '<span class=\'legend-item-label\'>' + soy.$$escapeHtml(opt_data.key) + '</span>', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.LegendSubItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="legend-item-wrapper"><div class="legend-item-value">', soy.$$escapeHtml(opt_data.value), '</div><div class="legend-item-label-wrapper">', (opt_data.url) ? '<a class=\'legend-item-label\' href=\'' + soy.$$escapeHtml(opt_data.url) + '\' title=\'' + soy.$$escapeHtml(opt_data.key) + '\'>' + soy.$$escapeHtml(opt_data.key) + '</a>' : '<span class=\'legend-item-label\'>' + soy.$$escapeHtml(opt_data.key) + '</span>', '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.LegendMultiItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="legend-sublist-container"><ul class="legend sublist" >');
  var itemList181 = opt_data.subResults;
  var itemListLen181 = itemList181.length;
  for (var itemIndex181 = 0; itemIndex181 < itemListLen181; itemIndex181++) {
    var itemData181 = itemList181[itemIndex181];
    output.append('<li><div class=\'legend-content\'>');
    JIRA.DashboardItem.PieChart.Templates.LegendSubItem(itemData181, output);
    output.append('</div></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.PieChart.Templates.UpdateCenterBlock = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'piechart-center-primary\' style=\'color: ', soy.$$escapeHtml(opt_data.colour), '\'>', soy.$$escapeHtml(opt_data.header), '</div><div class=\'piechart-center-secondary\'>', soy.$$escapeHtml(opt_data.subheader), '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:piechart-dashboard-item-resources', location = 'static/dashboarditem/piechart/PieChart.js' */
define("jira-dashboard-items/piechart",["jquery","underscore","jira-dashboard-items/components/charts/piechart-with-legend","jira-dashboard-items/components/autocomplete/project-filter-autocomplete"],function($,_,PieChartWithLegend,ProjectFilterAutoComplete){var DashboardItem=function(API,options){this.API=API;this.options=options||{}};function parseErrorMessage(errorString){var errorArray=[];var errorJSON=JSON.parse(errorString);for(var key in errorJSON){if(errorJSON.hasOwnProperty(key)){errorArray.push({key:key,message:errorJSON[key]})}}return errorArray}DashboardItem.prototype.SECTOR_LIMIT=11;function preferencesBackwardCompatible(preferences){if(preferences.projectOrFilterId&&!preferences.type&&!preferences.id){var projectOrFilterSplit=preferences.projectOrFilterId.split("-");preferences.type=projectOrFilterSplit[0];preferences.id=projectOrFilterSplit[1];delete preferences.projectOrFilterId}return preferences}DashboardItem.prototype._renderChart=function(gadgetElement,response){var gadget=this;if(!response.results||response.results.length==0){gadgetElement.html(JIRA.DashboardItem.PieChart.Templates.NoPieChartContent())}else{var limit=gadget.SECTOR_LIMIT;if(response.results.length>limit){var other={key:"Other",percentage:0,value:0,url:"#",subResults:[]};var overflow=response.results.length-limit+1;other.subResults=response.results.splice(limit-1,overflow);other.value=_.reduce(other.subResults,function(total,entry){return total+entry.value},0);other.percentage=Math.floor(other.value*100/response.issueCount);response.results.push(other)}for(var i=0;i<response.results.length;++i){if(response.results[i].percentage===0){response.results[i].percentage="<1"}}var MAX_RADIUS=200;var radius=Math.min(MAX_RADIUS,gadgetElement.width()/2);var ellipsifyText=function(element,width){var text=element.text();while(element[0].getBBox().width>width&&text.length>0){text=text.substr(0,text.length-1);element.text(AJS.format("{0}...",text))}return element.text()};var MIN_INNER_RADIUS=40;var MAX_INNER_RADIUS=75;var INNER_RADIUS_RANGE=MAX_INNER_RADIUS-MIN_INNER_RADIUS;var innerRadius=Math.max(MIN_INNER_RADIUS,Math.min(radius/2,MAX_INNER_RADIUS));var innerRadiusMinDifference=innerRadius-MIN_INNER_RADIUS;var percentageInner=innerRadiusMinDifference/INNER_RADIUS_RANGE;var MIN_PRIMARY_FONT_SIZE=28;var MAX_PRIMARY_FONT_SIZE=48;var PRIMARY_FONT_SIZE_RANGE=MAX_PRIMARY_FONT_SIZE-MIN_PRIMARY_FONT_SIZE;var primaryFontSize=MIN_PRIMARY_FONT_SIZE+(percentageInner*PRIMARY_FONT_SIZE_RANGE);var options={piechart:{radius:radius,innerRadius:innerRadius,hoverExpansion:0,centerChart:true,clickable:true,getValue:function(dataElement){return dataElement.value},onEachArc:function(piechart,data,index,sectorElement){AJS.InlineDialog(sectorElement,"piechart-sector-"+gadget.API.getGadgetId()+"-"+index,function(content,trigger,showPopup){if(data.subResults){content.html(JIRA.DashboardItem.PieChart.Templates.GroupedSectorInlineDialog(data))}else{content.html(JIRA.DashboardItem.PieChart.Templates.SectorInlineDialog(data))}showPopup();return false},{gravity:"w",hideDelay:1000,closeOnTriggerClick:true})},getPrimaryText:function(data){return data.percentage+"%"},getSecondaryText:function(data){return data.key},onMouseOver:function(piechart,data,index,sectorElement){var primaryElement=$(sectorElement).find(".piechart-center-primary");primaryElement.css("font-size",primaryFontSize+"px");var secondaryElement=$(sectorElement).find(".piechart-center-secondary");ellipsifyText(secondaryElement,secondaryElement.attr("width"))}},legend:{renderLegendTitle:function(element,data){element.html(JIRA.DashboardItem.PieChart.Templates.LegendTitle(response))},renderLegendItem:function(element,pieChart,data,index){element.html(JIRA.DashboardItem.PieChart.Templates.LegendSection());data.colour=pieChart.colourPicker(pieChart,data,index);var legendContent=$(".legend-content",element);legendContent.html(JIRA.DashboardItem.PieChart.Templates.LegendItem(data));if(data.subResults){var grouptoggle=legendContent.find("a");grouptoggle.append("...");var dialogId="piechart-legend-"+gadget.API.getGadgetId()+"-"+index;var dialog=AJS.InlineDialog(grouptoggle,dialogId,function(content,trigger,showPopup){content.css({padding:"20px"}).html(JIRA.DashboardItem.PieChart.Templates.LegendMultiItem(data));showPopup();content.focus();return false},{onHover:true,gravity:"n",width:175,hideDelay:500,isRelativeToMouse:true});grouptoggle.click(function(event){event.preventDefault()});var isEnter=function(event){return event.keyCode===13};var isShiftTab=function(event){return event.keyCode===9&&event.shiftKey===true};var isTab=function(event){return event.keyCode===9&&event.shiftKey===false};grouptoggle.keydown(function(event){if(isEnter(event)){dialog.show();var dialogContainer=$("#inline-dialog-"+dialogId);_.defer(function(){var otherDialogFocusable=dialogContainer.find(":focusable");var firstFocusable=otherDialogFocusable.first();firstFocusable.focus();firstFocusable.keydown(function(event){if(isShiftTab(event)){event.preventDefault();dialog.hide();grouptoggle.focus()}});var lastFocusable=otherDialogFocusable.last();lastFocusable.keydown(function(event){if(isTab(event)){dialog.hide();grouptoggle.focus()}})})}})}}}};var chart=new PieChartWithLegend(response.results,options);chart.render(gadgetElement);gadget.API.setTitle(AJS.format("Pie Chart: {0}",response.filterTitle));gadget.API.forceLayoutRefresh()}};DashboardItem.prototype.render=function(element,preferences){var gadgetElement=$(".piechart-gadget",element);var gadget=this;preferences=preferencesBackwardCompatible(preferences);gadget.API.initRefresh(preferences,_.bind(gadget.render,gadget,element,preferences));gadget.API.showLoadingBar();$.ajax({method:"GET",url:AJS.contextPath()+"/rest/gadget/1.0/statistics",dataType:"json",data:{jql:preferences.type+"="+preferences.id,statType:preferences.statType}}).done(function(response){gadget.resizeHandler=_.throttle(_.bind(gadget._renderChart,gadget,gadgetElement,response),100);$(element).resize(gadget.resizeHandler);gadget._renderChart(gadgetElement,response)}).fail(function(message){var errors=parseErrorMessage(message.responseText);gadgetElement.html(JIRA.DashboardItem.PieChart.Templates.Errors({errors:errors}))}).always(function(){gadget.API.hideLoadingBar()})};DashboardItem.prototype.renderEdit=function(element,preferences){var gadget=this;var gadgetElement=$(".piechart-gadget",element);if(gadget.resizeHandler){$(element).removeResize(gadget.resizeHandler);delete gadget.resizeHandler}gadget.API.showLoadingBar();$.ajax({method:"GET",url:AJS.contextPath()+"/rest/gadget/1.0/statTypes"}).done(function(data){var prefix=gadget.API.getGadgetId()+"-";preferences=preferencesBackwardCompatible(preferences);if(!preferences.name&&preferences.type&&preferences.id){preferences.name=preferences.type+"-"+preferences.id}gadget.API.setTitle("Pie Chart");if(preferences.name){preferences.name=new soydata.SanitizedHtml(preferences.name)}gadgetElement.html(JIRA.DashboardItem.PieChart.Templates.Configuration({prefix:prefix,statTypes:data.stats,preferences:preferences}));var projectFilterOptions={fieldID:prefix+"project-filter-picker",completeField:function(selection){if(selection){gadgetElement.find("input[name=type]").val(selection.type);gadgetElement.find("input[name=id]").val(selection.id);gadgetElement.find("input[name=name]").val(selection.name);gadgetElement.find(".filterpicker-value-name").text(selection.name).addClass("success");this.field.val("");this.field.trigger("change")}},maxHeight:140};if(gadget.options.delay){projectFilterOptions.delay=gadget.options.delay}ProjectFilterAutoComplete(projectFilterOptions);var form=$("form",gadgetElement);var cancelButton=$(".cancel",form);if(cancelButton){cancelButton.click(function(){gadget.API.closeEdit()})}function completeValidation(preferences,form){if(!preferences.id||!preferences.type){$(".projectOrFilter-error",form).text("No project or filter specified.").show();return false}return true}form.on("submit",function(e){e.preventDefault();var form=$(e.target);var preferences={name:form.find("input[name=name]").val(),type:form.find("input[name=type]").val(),id:form.find("input[name=id]").val(),statType:form.find("select[name=statType]").val(),refresh:gadget.API.getRefreshFieldValue("refresh-interval")};if(completeValidation(preferences,form)){gadget.API.savePreferences(preferences)}})}).fail(function(){gadgetElement.html(JIRA.DashboardItem.PieChart.Templates.ErrorRenderingConfiguration())}).always(function(){gadget.API.hideLoadingBar()})};return DashboardItem});;
;/* module-key = 'com.atlassian.jira.gadgets:filter-picker-component', location = 'static/components/filterpicker/FilterPicker.soy' */
// This file was automatically generated from FilterPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Common == 'undefined') { JIRA.DashboardItem.Common = {}; }
if (typeof JIRA.DashboardItem.Common.Config == 'undefined') { JIRA.DashboardItem.Common.Config = {}; }
if (typeof JIRA.DashboardItem.Common.Config.Templates == 'undefined') { JIRA.DashboardItem.Common.Config.Templates = {}; }


JIRA.DashboardItem.Common.Config.Templates.filterPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy3 = opt_data.prefix + opt_data.id;
  output.append('<div class="field-group ', soy.$$escapeHtml(opt_data.id), '"><label for="', soy.$$escapeHtml(prefixedId__soy3), '">', soy.$$escapeHtml("Saved Filter:"), '<span class="aui-icon icon-required"> ', soy.$$escapeHtml("required"), '</span></label><select class="select" id="', soy.$$escapeHtml(prefixedId__soy3), '" name="', soy.$$escapeHtml(opt_data.id), '"></select><div class="error">', soy.$$escapeHtml("No Filter selected"), '</div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:filter-picker-component', location = 'static/components/filterpicker/FilterPicker.js' */
define("jira-dashboard-items/components/filter-picker",["underscore","jquery","jira/ajs/ajax/smart-ajax","jira/ajs/select/single-select"],function(_,$,SmartAjax,SingleSelect){return function(){return{init:function(options){var element=options.element;var selectedValue=options.selectedValue;var self=this;this.select=new SingleSelect({element:element,itemAttrDisplayed:"label",revertOnInvalid:true,removeDuplicates:true,submitInputVal:false,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:"(^|(.*))({0})(.*)",ajaxOptions:{url:AJS.contextPath()+"/rest/gadget/1.0/pickers/filters",query:true,data:{fieldName:"quickfind"},formatResponse:function(response){var ret=[];if(response.filters&&response.filters.length){var groupDescriptor=new AJS.GroupDescriptor();_.each(response.filters,function(filter){groupDescriptor.addItem(new AJS.ItemDescriptor({value:filter.id,label:filter.name}))});ret.push(groupDescriptor)}return ret}}});if(selectedValue){self.select.disable();SmartAjax.makeRequest({method:"GET",url:AJS.contextPath()+"/rest/api/2/filter/"+selectedValue,success:function(data){self.select.setSelection(new AJS.ItemDescriptor({value:selectedValue,label:data.name}))},complete:function(){self.select.enable()}})}this.errorField=element.parents(".field-group").find(".error");self.select.hideErrorMessage=function(){};self.select.showErrorMessage=function(){};return this},getValue:function(){if(this.select.lastSelection){return{id:this.select.lastSelection.value(),label:this.select.lastSelection.label()}}return null},validate:function(){if(this.select.lastSelection&&this.select.lastSelection.value()){this.errorField.hide();return true}else{this.errorField.show();return false}}}}});;
;/* module-key = 'com.atlassian.jira.gadgets:two-dimensional-stats-dashboard-item-resources', location = 'static/dashboarditem/two-dimensional-stats/TwoDimensionalStats.js' */
define("jira-dashboard-items/two-dimensional-stats",["jquery","underscore","jira-dashboard-items/components/filter-picker"],function($,_,FilterPicker){var DashboardItem=function(API,options){this.API=API;this.options=options||{};this.fields=createStaticSelectFieldsConfigurations();this.filterPicker=new FilterPicker()};DashboardItem.prototype.render=function(element,preferences){var $element=$(element);var self=this;self.API.initRefresh(preferences,_.bind(self.render,self,element,preferences));self.API.showLoadingBar();var normalizedFilterId=preferences.filterId!==undefined?preferences.filterId.replace("filter-",""):preferences.filterId;$.ajax({method:"GET",url:AJS.contextPath()+"/rest/gadget/1.0/twodimensionalfilterstats/generate",dataType:"json",data:{filterId:"filter-"+normalizedFilterId,xstattype:preferences.xstattype,ystattype:preferences.ystattype,sortDirection:preferences.sortDirection,sortBy:preferences.sortBy,numberToShow:(preferences.more?100:preferences.numberToShow)}}).done(function(response){self.API.setTitle(AJS.format("Two Dimensional Filter Statistics by {0}",response.xHeading));if(response.totalRows===0){$element.html(JIRA.DashboardItem.TwoDimensionalStats.Templates.EmptyResultMessage({href:AJS.contextPath()+"/issues/?filter="+normalizedFilterId}));return }prepareCssClassesToBePrinted(response);$element.html(JIRA.DashboardItem.TwoDimensionalStats.Templates.Table({yAxisLabel:response.yHeading,xHeaderLabels:response.firstRow.cells,contentRows:response.rows,totalRows:response.totalRows,filterUrl:response.filter.filterUrl,filterTitle:response.filter.filterTitle,visibleContentRows:response.rows.length-1,showMore:preferences.more}));AJS.trigger("analyticsEvent",{name:"jira.dashboard.gadgets.twodstats.rowscount",data:{value:response.rows.length}});AJS.trigger("analyticsEvent",{name:"jira.dashboard.gadgets.twodstats.colscount",data:{value:response.firstRow.cells.length}});$element.find(".content-control-link").click(function(e){preferences.more=$(e.target).data("more");if(self.API.isEditable()){self.API.savePreferences(preferences)}else{self.render(element,preferences)}})}).fail(function(){$element.html(JIRA.DashboardItem.TwoDimensionalStats.Templates.ServerErrorMessage({filterId:normalizedFilterId}))}).always(function(){self.API.hideLoadingBar();self.API.forceLayoutRefresh();$element.find(".two-d-container").toggleClass("h-scrollbar",$element.find(".table-container").width()<$element.find(".table-container > .extra-container > table").width()).toggleClass("narrow-container",$element.width()<400)})};DashboardItem.prototype.renderEdit=function(element,preferences){var $element=$(element);var self=this;self.API.setTitle("Two Dimensional Filter Statistics");self.API.showLoadingBar();$.ajax({method:"GET",url:AJS.contextPath()+"/rest/gadget/1.0/statTypes",dataType:"json"}).done(function(response){self.fields.statTypeOptions=self._updateStatTypeFieldNames(response.stats);$element.html(JIRA.DashboardItem.TwoDimensionalStats.Templates.Form({prefix:self.API.getGadgetId()+"-",preferences:preferences,fields:self.fields}));self.filterPicker.init({gadgetErrorContainer:$element.find(".dashboard-item-error"),element:$element.find("#"+self.API.getGadgetId()+"-filterId"),selectedValue:preferences.filterId!==undefined?preferences.filterId.replace("filter-",""):preferences.filterId});$element.find(".buttons-container .cancel").click(self.API.closeEdit.bind(self.API));$element.find("form").on("submit",function(e){e.preventDefault();var $form=$(e.target);var preferences=self._getPreferencesObject($form);preferences.filterId="filter-"+(self.filterPicker.validate()?self.filterPicker.getValue().id:"");preferences.refresh=self.API.getRefreshFieldValue();preferences.more=false;if(self._validPreferences($form,preferences)){self.API.savePreferences(preferences)}else{self.API.forceLayoutRefresh()}})}).fail(function(){$element.html(JIRA.DashboardItem.TwoDimensionalStats.Templates.ServerErrorMessage())}).always(function(){self.API.hideLoadingBar();self.API.forceLayoutRefresh()})};function prepareCssClassesToBePrinted(response){_.each(response.firstRow.cells,function(cell){if(cell.classes&&cell.classes.join){cell.classes=cell.classes.join(" ")}});_.each(response.rows,function(row){_.each(row.cells,function(cell){if(cell.classes&&cell.classes.join){cell.classes=cell.classes.join(" ")}})})}DashboardItem.prototype._getPreferencesObject=function($form){var formData=$form.serializeArray();var paramsWhitelist=["filterId","numberToShow","sortBy","sortDirection","xstattype","ystattype"];var preferences={};_.each(formData,function(element){if(_.indexOf(paramsWhitelist,element.name)==-1){return }preferences[element.name]=element.value});return preferences};DashboardItem.prototype._updateStatTypeFieldNames=function(statTypes){var i=statTypes.length;while(i--){statTypes[i].text=statTypes[i].label;delete statTypes[i].label}return statTypes};DashboardItem.prototype._validPreferences=function($form,preferences){$form.find(".error").remove();if(preferences.filterId===""||preferences.filterId==="filter-"){var field=$form.find("[name=filterId]");field.parent().append('<div class="error">'+"No Filter selected"+"</div>")}if(!this._validNumberToShow(preferences.numberToShow)){var field=$form.find("input[name=numberToShow]");field.after('<div class="error">'+"The value must be an integer greater than 0 and less than or equal to 50"+"</div>")}$form.find(".error").show();return $form.find(".error").size()==0};DashboardItem.prototype._validNumberToShow=function(number){return((/^\d+$/).test(number)===true&&number>=1&&number<=50)};function createStaticSelectFieldsConfigurations(){var fields={};fields.sortByOptions=[{text:"Natural",value:"natural"},{text:"Total",value:"total"}];fields.sortDirectionOptions=[{text:"Ascending",value:"asc"},{text:"Descending",value:"desc"}];return fields}return DashboardItem});;
;/* module-key = 'com.atlassian.jira.gadgets:two-dimensional-stats-dashboard-item-resources', location = 'static/dashboarditem/two-dimensional-stats/TwoDimensionalStats.soy' */
// This file was automatically generated from TwoDimensionalStats.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.TwoDimensionalStats == 'undefined') { JIRA.DashboardItem.TwoDimensionalStats = {}; }
if (typeof JIRA.DashboardItem.TwoDimensionalStats.Templates == 'undefined') { JIRA.DashboardItem.TwoDimensionalStats.Templates = {}; }


JIRA.DashboardItem.TwoDimensionalStats.Templates.Table = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="two-d-container"><div class="table-container"><div class="extra-container"><table class="aui aui-table-interactive"><thead><tr><th class="axis">', soy.$$escapeHtml(opt_data.yAxisLabel), '</th>');
  var labelList6 = opt_data.xHeaderLabels;
  var labelListLen6 = labelList6.length;
  for (var labelIndex6 = 0; labelIndex6 < labelListLen6; labelIndex6++) {
    var labelData6 = labelList6[labelIndex6];
    output.append('<th ', (labelData6.classes) ? 'class="' + soy.$$escapeHtml(labelData6.classes) + '"' : '', '>', labelData6.markup, '</th>');
  }
  output.append('</thead><tbody>');
  var rowList19 = opt_data.contentRows;
  var rowListLen19 = rowList19.length;
  for (var rowIndex19 = 0; rowIndex19 < rowListLen19; rowIndex19++) {
    var rowData19 = rowList19[rowIndex19];
    output.append('<tr>');
    var dataList21 = rowData19.cells;
    var dataListLen21 = dataList21.length;
    for (var dataIndex21 = 0; dataIndex21 < dataListLen21; dataIndex21++) {
      var dataData21 = dataList21[dataIndex21];
      output.append((dataIndex21 == 0) ? '<th class="scope ' + ((dataData21.classes) ? soy.$$escapeHtml(dataData21.classes) : '') + '">' + dataData21.markup + '</th>' : '<td ' + ((dataData21.classes) ? 'class="' + soy.$$escapeHtml(dataData21.classes) + '"' : '') + '>' + dataData21.markup + '</td>');
    }
    output.append('</tr>');
  }
  output.append('</tbody></table></div></div> <!-- .table-container --><div class="data-footer"><p class="numbers">', AJS.format("Showing {0} of {1} statistics.",'<strong>' + opt_data.visibleContentRows + '</strong>','<strong>' + opt_data.totalRows + '</strong>'), (opt_data.visibleContentRows < opt_data.totalRows) ? '<a class="content-control-link" data-more="true">' + soy.$$escapeHtml("Show more") + '</a>' : (opt_data.showMore) ? '<a class="content-control-link" data-more="false">' + soy.$$escapeHtml("Show less") + '</a>' : '', '</p><p class="filter">', soy.$$escapeHtml("Filtered by"), ': <a href="', soy.$$escapeHtml(opt_data.filterUrl), '" class="filter-link" title="', soy.$$escapeHtml(opt_data.filterTitle), '">', soy.$$escapeHtml(opt_data.filterTitle), '</a></div></div> <!-- .two-d-container -->');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.TwoDimensionalStats.Templates.Form = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="two-d-container">');
  var param69 = new soy.StringBuilder();
  JIRA.DashboardItem.Common.Config.Templates.filterPicker({prefix: opt_data.prefix, id: 'filterId'}, param69);
  aui.form.selectField({id: opt_data.prefix + 'xstattype', name: 'xstattype', labelContent: "XAxis", isRequired: true, options: opt_data.fields.statTypeOptions, value: opt_data.preferences.xstattype}, param69);
  aui.form.selectField({id: opt_data.prefix + 'ystattype', name: 'ystattype', labelContent: "YAxis", isRequired: true, options: opt_data.fields.statTypeOptions, value: opt_data.preferences.ystattype}, param69);
  aui.form.selectField({id: opt_data.prefix + 'sortBy', name: 'sortBy', labelContent: "Sort By", isRequired: true, options: opt_data.fields.sortByOptions, value: '' + opt_data.preferences.sortBy, descriptionContent: "Sort by row total or natural field order."}, param69);
  aui.form.selectField({id: opt_data.prefix + 'sortDirection', name: 'sortDirection', labelContent: "Sort Direction", isRequired: true, options: opt_data.fields.sortDirectionOptions, value: opt_data.preferences.sortDirection}, param69);
  aui.form.textField({id: opt_data.prefix + 'numberToShow', name: 'numberToShow', labelContent: "Number of Results:", isRequired: true, value: opt_data.preferences.numberToShow, descriptionContent: "Number of results to display."}, param69);
  Atlassian.DashboardItem.Common.Templates.refreshInterval({prefix: opt_data.prefix, id: 'refresh', value: opt_data.preferences.refresh}, param69);
  Atlassian.DashboardItem.Common.Templates.config({fields: param69.toString(), isConfigured: opt_data.preferences.isConfigured}, output);
  output.append('</div> <!-- .two-d-container -->');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.TwoDimensionalStats.Templates.EmptyResultMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="two-d-container"><div class="empty-results search-results-dashboard-item">');
  var filterLink__soy118 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.href), '">');
  filterLink__soy118 = filterLink__soy118.toString();
  output.append(AJS.format("No matching {0}issues{1} found.",filterLink__soy118,'</a>'), '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.TwoDimensionalStats.Templates.ServerErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="two-d-container">');
  var filterLink__soy127 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(""), '/issues/?filter=', soy.$$escapeHtml(opt_data.filterId), '">');
  filterLink__soy127 = filterLink__soy127.toString();
  aui.message.error({content: '<p>' + AJS.format("The filter configured for this gadget could not be retrieved. Please verify it is still valid on the {0}issue navigator{1}.",filterLink__soy127,'</a>') + '</p>'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-restfultable', location = 'js/experimental-events/events.js' */
(function(A){AJS.triggerEvt=function(C,B){A(AJS).trigger(C,B)};AJS.bindEvt=function(B,C){A(AJS).bind(B,C)};AJS.triggerEvtForInst=function(B,D,C){A(D).trigger(B,C);AJS.triggerEvt(B,C);if(D.id){AJS.triggerEvt(D.id+"_"+B,C)}}})(AJS.$);;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-restfultable', location = 'js-vendor/jquery/serializetoobject.js' */
jQuery.fn.serializeObject=function(){var A={};this.find(":input:not(:button):not(:submit):not(:radio):not('select[multiple]')").each(function(){if(this.name===""){return }if(this.value===null){this.value=""}A[this.name]=this.value.match(/^(tru|fals)e$/i)?this.value.toLowerCase()=="true":this.value});this.find("input:radio:checked").each(function(){A[this.name]=this.value});this.find("select[multiple]").each(function(){var B=jQuery(this),C=B.val();if(B.data("aui-ss")){if(C){A[this.name]=C[0]}else{A[this.name]=""}}else{if(C!==null){A[this.name]=C}else{A[this.name]=[]}}});return A};;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-restfultable', location = 'js/experimental-restfultable/restfultable.js' */
(function(B){AJS.RestfulTable=Backbone.View.extend({initialize:function(D){var C=this;C.options=B.extend(true,C._getDefaultOptions(D),D);C.id=this.options.id;C._event=AJS.RestfulTable.Events;C.classNames=AJS.RestfulTable.ClassNames;C.dataKeys=AJS.RestfulTable.DataKeys;this.$table=B(D.el).addClass(this.classNames.RESTFUL_TABLE).addClass(this.classNames.ALLOW_HOVER).addClass("aui").addClass(C.classNames.LOADING);this.$table.wrapAll("<form class='aui' action='#' />");this.$thead=B("<thead/>");this.$theadRow=B("<tr />").appendTo(this.$thead);this.$tbody=B("<tbody/>");if(!this.$table.length){throw new Error("AJS.RestfulTable: Init failed! The table you have specified ["+this.$table.selector+"] cannot be found.")}if(!this.options.columns){throw new Error("AJS.RestfulTable: Init failed! You haven't provided any columns to render.")}this.showGlobalLoading();B.each(this.options.columns,function(E,F){var G=B.isFunction(F.header)?F.header():F.header;if(typeof G==="undefined"){AJS.warn("You have not specified [header] for column ["+F.id+"]. Using id for now...");G=F.id}C.$theadRow.append("<th>"+G+"</th>")});C.$theadRow.append("<th></th><th></th>");this._models=this._createCollection();this._rowClass=this.options.views.row;this.editRows=[];this.$table.closest("form").submit(function(E){if(C.focusedRow){C.focusedRow.trigger(C._event.SAVE)}E.preventDefault()});if(this.options.allowReorder){this.$theadRow.prepend("<th />");this.$tbody.sortable({handle:"."+this.classNames.DRAG_HANDLE,helper:function(G,E){var F=B("<div/>").attr("class",E.attr("class")).addClass(C.classNames.MOVEABLE);E.children().each(function(I){var L=B(this);var K=parseInt(0+L.css("border-left-width"),10);var H=parseInt(0+L.css("border-right-width"),10);var J=L[0].clientWidth+K+H;F.append(B("<div/>").html(L.html()).attr("class",L.attr("class")).width(J))});F=B("<div class='aui-restfultable-readonly'/>").append(F);F.css({left:E.offset().left});F.appendTo(document.body);return F},start:function(F,G){var E=G.helper[0].clientHeight;var H=G.placeholder.find("td");G.item.addClass(C.classNames.MOVEABLE).children().each(function(J){B(this).width(H.eq(J).width())});var I='<td colspan="'+C.getColumnCount()+'">&nbsp;</td>';G.placeholder.html(I).css({height:E,visibility:"visible"});C.getRowFromElement(G.item[0]).trigger(C._event.MODAL)},stop:function(E,F){if(AJS.$(F.item[0]).is(":visible")){F.item.removeClass(C.classNames.MOVEABLE).children().attr("style","");F.placeholder.removeClass(C.classNames.ROW);C.getRowFromElement(F.item[0]).trigger(C._event.MODELESS)}},update:function(G,I){var E,F,H={},J=C.getRowFromElement(I.item[0]);if(J){if(C.options.reverseOrder){F=I.item.next();if(!F.length){H.position="First"}else{E=C.getRowFromElement(F).model;H.after=E.url()}}else{F=I.item.prev();if(!F.length){H.position="First"}else{E=C.getRowFromElement(F).model;H.after=E.url()}}B.ajax({url:J.model.url()+"/move",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(H),complete:function(){J.hideLoading()},success:function(K){AJS.triggerEvtForInst(C._event.REORDER_SUCCESS,C,[K])},error:function(L){var K=B.parseJSON(L.responseText||L.data);AJS.triggerEvtForInst(C._event.SERVER_ERROR,C,[K,L,this])}});J.showLoading()}},axis:"y",delay:0,containment:"document",cursor:"move",scroll:true,zIndex:8000});this.$tbody.bind("selectstart mousedown",function(E){return !B(E.target).is("."+C.classNames.DRAG_HANDLE)})}if(this.options.allowCreate!==false){this._createRow=new this.options.views.editRow({columns:this.options.columns,isCreateRow:true,model:this.options.model.extend({url:function(){return C.options.resources.self}}),cancelAccessKey:this.options.cancelAccessKey,submitAccessKey:this.options.submitAccessKey,allowReorder:this.options.allowReorder,fieldFocusSelector:this.options.fieldFocusSelector}).bind(this._event.CREATED,function(E){if((C.options.addPosition==undefined&&C.options.createPosition==="bottom")||C.options.addPosition==="bottom"){C.addRow(E)}else{C.addRow(E,0)}}).bind(this._event.VALIDATION_ERROR,function(){this.trigger(C._event.FOCUS)}).render({errors:{},values:{}});this.$create=B('<tbody class="'+this.classNames.CREATE+'" />').append(this._createRow.el);this._applyFocusCoordinator(this._createRow);this._createRow.trigger(this._event.FOCUS)}this._models.bind("remove",function(E){B.each(C.getRows(),function(F,G){if(G.model===E){if(G.hasFocus()&&C._createRow){C._createRow.trigger(C._event.FOCUS)}C.removeRow(G)}})});if(B.isFunction(this.options.resources.all)){this.options.resources.all(function(E){C.populate(E)})}else{B.get(this.options.resources.all,function(E){C.populate(E)})}},_createCollection:function(){var C=this;var D=this.options.Collection.extend({sort:function(E){E||(E={});if(!this.comparator){throw new Error("Cannot sort a set without a comparator")}this.tableRows=C.getRows();this.models=this.sortBy(this.comparator);this.tableRows=undefined;if(!E.silent){this.trigger("refresh",this,E)}return this},remove:function(F,E){this.tableRows=C.getRows();Backbone.Collection.prototype.remove.apply(this,arguments);this.tableRows=undefined;return this}});return new D([],{comparator:function(F){var E;B.each(this.tableRows!==undefined?this.tableRows:C.getRows(),function(G){if(this.model.id===F.id){E=G;return false}});return E}})},populate:function(C){if(this.options.reverseOrder){C.reverse()}this.hideGlobalLoading();if(C&&C.length){this._models.reset([],{silent:true});this.renderRows(C);if(this.isEmpty()){this.showNoEntriesMsg()}}else{this.showNoEntriesMsg()}this.$table.append(this.$thead);if(this.options.createPosition==="bottom"){this.$table.append(this.$tbody).append(this.$create)}else{this.$table.append(this.$create).append(this.$tbody)}this.$table.removeClass(this.classNames.LOADING).trigger(this._event.INITIALIZED,[this]);AJS.triggerEvtForInst(this._event.INITIALIZED,this,[this]);if(this.options.autoFocus){this.$table.find(":input:text:first").focus()}},showGlobalLoading:function(){if(!this.$loading){this.$loading=B('<div class="aui-restfultable-init">'+AJS.RestfulTable.throbber()+'<span class="aui-restfultable-loading">'+this.options.loadingMsg+"</span></div>")}if(!this.$loading.is(":visible")){this.$loading.insertAfter(this.$table)}return this},hideGlobalLoading:function(){if(this.$loading){this.$loading.remove()}return this},addRow:function(D,F){var C,E;if(!D.id){throw new Error("AJS.RestfulTable.addRow: to add a row values object must contain an id. Maybe you are not returning it from your restend point?Recieved:"+JSON.stringify(D))}E=new this.options.model(D);C=this._renderRow(E,F);this._models.add(E);this.removeNoEntriesMsg();AJS.triggerEvtForInst(this._event.ROW_ADDED,this,[C,this]);return this},removeRow:function(C){this._models.remove(C.model);C.remove();if(this.isEmpty()){this.showNoEntriesMsg()}AJS.triggerEvtForInst(this._event.ROW_REMOVED,this,[C,this])},isEmpty:function(){return this._models.length===0},getModels:function(){return this._models},getTable:function(){return this.$table},getTableBody:function(){return this.$tbody},getCreateRow:function(){return this._createRow},getColumnCount:function(){var C=2;if(this.allowReorder){++C}return this.options.columns.length+C},getRowFromElement:function(C){return B(C).data(this.dataKeys.ROW_VIEW)},showNoEntriesMsg:function(){if(this.$noEntries){this.$noEntries.remove()}this.$noEntries=B("<tr>").addClass(this.classNames.NO_ENTRIES).append(B("<td>").attr("colspan",this.getColumnCount()).text(this.options.noEntriesMsg)).appendTo(this.$tbody);return this},removeNoEntriesMsg:function(){if(this.$noEntries&&this._models.length>0){this.$noEntries.remove()}return this},getRows:function(){var C=this,D=[];this.$tbody.find("."+this.classNames.READ_ONLY).each(function(){var E=B(this),F=E.data(C.dataKeys.ROW_VIEW);if(F){D.push(F)}});return D},_renderRow:function(H,G){var D=this,F=this.$tbody.find("."+this.classNames.READ_ONLY),C,E;E=new this._rowClass({model:H,columns:this.options.columns,allowEdit:this.options.allowEdit,allowDelete:this.options.allowDelete,allowReorder:this.options.allowReorder,deleteConfirmation:this.options.deleteConfirmation});this.removeNoEntriesMsg();E.bind(this._event.ROW_EDIT,function(I){AJS.triggerEvtForInst(this._event.EDIT_ROW,{},[this,D]);D.edit(this,I)});C=E.render().$el;if(G!==-1){if(typeof G==="number"&&F.length!==0){C.insertBefore(F[G])}else{this.$tbody.append(C)}}C.data(this.dataKeys.ROW_VIEW,E);E.bind(this._event.MODAL,function(){D.$table.removeClass(D.classNames.ALLOW_HOVER);D.$tbody.sortable("disable");B.each(D.getRows(),function(){if(!D.isRowBeingEdited(this)){this.delegateEvents({})}})});E.bind(this._event.MODELESS,function(){D.$table.addClass(D.classNames.ALLOW_HOVER);D.$tbody.sortable("enable");B.each(D.getRows(),function(){if(!D.isRowBeingEdited(this)){this.delegateEvents()}})});this._applyFocusCoordinator(E);this.trigger(this._event.ROW_INITIALIZED,E);return E},isRowBeingEdited:function(D){var C=false;B.each(this.editRows,function(){if(this.el===D.el){C=true;return false}});return C},_applyFocusCoordinator:function(D){var C=this;if(!D.hasFocusBound){D.hasFocusBound=true;D.bind(this._event.FOCUS,function(){if(C.focusedRow&&C.focusedRow!==D){C.focusedRow.trigger(C._event.BLUR)}C.focusedRow=D;if(D instanceof AJS.RestfulTable.Row&&C._createRow){C._createRow.enable()}})}return this},_removeEditRow:function(D){var C=B.inArray(D,this.editRows);this.editRows.splice(C,1);return this},_shiftFocusAfterEdit:function(){if(this.editRows.length>0){this.editRows[this.editRows.length-1].trigger(this._event.FOCUS)}else{if(this._createRow){this._createRow.trigger(this._event.FOCUS)}}return this},_saveEditRowOnBlur:function(){return this.editRows.length<=1},dismissEditRows:function(){var C=this;B.each(this.editRows,function(){if(!this.hasUpdates()){this.trigger(C._event.FINISHED_EDITING)}})},edit:function(G,F){var C=this,E=new this.options.views.editRow({el:G.el,columns:this.options.columns,isUpdateMode:true,allowReorder:this.options.allowReorder,fieldFocusSelector:this.options.fieldFocusSelector,model:G.model,cancelAccessKey:this.options.cancelAccessKey,submitAccessKey:this.options.submitAccessKey}),D=G.model.toJSON();D.update=true;E.render({errors:{},update:true,values:D}).bind(C._event.UPDATED,function(H,I){C._removeEditRow(this);this.unbind();G.render().delegateEvents();G.trigger(C._event.UPDATED);if(I!==false){C._shiftFocusAfterEdit()}}).bind(C._event.VALIDATION_ERROR,function(){this.trigger(C._event.FOCUS)}).bind(C._event.FINISHED_EDITING,function(){C._removeEditRow(this);G.render().delegateEvents();this.unbind()}).bind(C._event.CANCEL,function(){C._removeEditRow(this);this.unbind();G.render().delegateEvents();C._shiftFocusAfterEdit()}).bind(C._event.BLUR,function(){C.dismissEditRows();if(C._saveEditRowOnBlur()){this.trigger(C._event.SAVE,false)}});this._applyFocusCoordinator(E);E.trigger(C._event.FOCUS,F);if(C._createRow){C._createRow.disable()}this.editRows.push(E);return E},renderRows:function(E){var C=this._models.comparator,D=[];this._models.comparator=undefined;var F=_.map(E,function(H){var G=new this.options.model(H);D.push(this._renderRow(G,-1).el);return G},this);this._models.add(F,{silent:true});this._models.comparator=C;this.removeNoEntriesMsg();this.$tbody.append(D);return this},_getDefaultOptions:function(C){return{model:C.model||AJS.RestfulTable.EntryModel,allowEdit:true,views:{editRow:AJS.RestfulTable.EditRow,row:AJS.RestfulTable.Row},Collection:Backbone.Collection.extend({url:C.resources.self,model:C.model||AJS.RestfulTable.EntryModel}),allowReorder:false,fieldFocusSelector:function(D){return":input[name="+D+"], #"+D},loadingMsg:C.loadingMsg||"Loading"}}});AJS.RestfulTable.throbber=function A(){return'<span class="aui-restfultable-throbber"></span>'};AJS.RestfulTable.throbber=function A(){return'<span class="aui-restfultable-throbber"></span>'};AJS.RestfulTable.DataKeys={ENABLED_SUBMIT:"enabledSubmit",ROW_VIEW:"RestfulTable_Row_View"};AJS.RestfulTable.ClassNames={NO_VALUE:"aui-restfultable-editable-no-value",NO_ENTRIES:"aui-restfultable-no-entires",RESTFUL_TABLE:"aui-restfultable",ROW:"aui-restfultable-row",READ_ONLY:"aui-restfultable-readonly",ACTIVE:"aui-restfultable-active",ALLOW_HOVER:"aui-restfultable-allowhover",FOCUSED:"aui-restfultable-focused",MOVEABLE:"aui-restfultable-movable",DISABLED:"aui-restfultable-disabled",SUBMIT:"aui-restfultable-submit",CANCEL:"aui-restfultable-cancel",EDIT_ROW:"aui-restfultable-editrow",CREATE:"aui-restfultable-create",DRAG_HANDLE:"aui-restfultable-draghandle",ORDER:"aui-restfultable-order",EDITABLE:"aui-restfultable-editable",ERROR:"error",DELETE:"aui-restfultable-delete",LOADING:"loading"};AJS.RestfulTable.Events={REORDER_SUCCESS:"RestfulTable.reorderSuccess",ROW_ADDED:"RestfulTable.rowAdded",ROW_REMOVED:"RestfulTable.rowRemoved",EDIT_ROW:"RestfulTable.switchedToEditMode",SERVER_ERROR:"RestfulTable.serverError",CREATED:"created",UPDATED:"updated",FOCUS:"focus",BLUR:"blur",SUBMIT:"submit",SAVE:"save",MODAL:"modal",MODELESS:"modeless",CANCEL:"cancel",CONTENT_REFRESHED:"contentRefreshed",RENDER:"render",FINISHED_EDITING:"finishedEditing",VALIDATION_ERROR:"validationError",SUBMIT_STARTED:"submitStarted",SUBMIT_FINISHED:"submitFinished",INITIALIZED:"initialized",ROW_INITIALIZED:"rowInitialized",ROW_EDIT:"editRow"}})(AJS.$);;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-restfultable', location = 'js/experimental-restfultable/restfultable.entrymodel.js' */
(function(A){AJS.RestfulTable.EntryModel=Backbone.Model.extend({sync:function(F,D,C){var B=this;var E=C.error;C.error=function(G){B._serverErrorHandler(G,this);if(E){E.apply(this,arguments)}};return Backbone.sync.apply(Backbone,arguments)},save:function(D,F){F=F||{};var C=this,H,B,E=F.error,G=F.success;F.error=function(I,K){var J=A.parseJSON(K.responseText||K.data);if(E){E.call(C,C,J,K)}};if(this.isNew()){Backbone.Model.prototype.save.call(this,D,F)}else{if(D){H=AJS.RestfulTable.EntryModel.extend({url:this.url()});B=new H({id:this.id});B.save=Backbone.Model.prototype.save;F.success=function(I,J){C.clear().set(I.toJSON());if(G){G.call(C,C,J)}};B.save(D,F)}}},destroy:function(D){D=D||{};var B=this,C=this.url(),E;if(D.data){E=A.param(D.data)}if(E!==""){C=C+"?"+E}A.ajax({url:C,type:"DELETE",dataType:"json",contentType:"application/json",success:function(F){if(B.collection){B.collection.remove(B)}if(D.success){D.success.call(B,F)}},error:function(F){B._serverErrorHandler(F,this);if(D.error){D.error.call(B,F)}}});return this},changedAttributes:function(B){var D={},C=this.toJSON();A.each(B,function(E,F){if(!C[E]){if(typeof F==="string"){if(A.trim(F)!==""){D[E]=F}}else{if(A.isArray(F)){if(F.length!==0){D[E]=F}}else{D[E]=F}}}else{if(C[E]&&C[E]!==F){if(typeof F==="object"){if(!_.isEqual(F,C[E])){D[E]=F}}else{D[E]=F}}}});if(!_.isEmpty(D)){this.addExpand(D);return D}},addExpand:function(B){},_serverErrorHandler:function(D,B){var C;if(D.status!==400){C=A.parseJSON(D.responseText||D.data);AJS.triggerEvtForInst(AJS.RestfulTable.Events.SERVER_ERROR,this,[C,D,B])}},fetch:function(B){B=B||{};this.clear();Backbone.Model.prototype.fetch.call(this,B)}})})(AJS.$);;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-restfultable', location = 'js/experimental-restfultable/restfultable.editrow.js' */
(function(A){AJS.RestfulTable.EditRow=Backbone.View.extend({tagName:"tr",events:{focusin:"_focus",click:"_focus",keyup:"_handleKeyUpEvent"},initialize:function(B){this.$el=A(this.el);this._event=AJS.RestfulTable.Events;this.classNames=AJS.RestfulTable.ClassNames;this.dataKeys=AJS.RestfulTable.DataKeys;this.columns=B.columns;this.isCreateRow=B.isCreateRow;this.allowReorder=B.allowReorder;this.events["click ."+this.classNames.CANCEL]="_cancel";this.delegateEvents();if(B.isUpdateMode){this.isUpdateMode=true}else{this._modelClass=B.model;this.model=new this._modelClass()}this.fieldFocusSelector=B.fieldFocusSelector;this.bind(this._event.CANCEL,function(){this.disabled=true}).bind(this._event.SAVE,function(C){if(!this.disabled){this.submit(C)}}).bind(this._event.FOCUS,function(C){this.focus(C)}).bind(this._event.BLUR,function(){this.$el.removeClass(this.classNames.FOCUSED);this.disable()}).bind(this._event.SUBMIT_STARTED,function(){this._submitStarted()}).bind(this._event.SUBMIT_FINISHED,function(){this._submitFinished()})},defaultColumnRenderer:function(B){if(B.allowEdit!==false){return A("<input type='text' />").addClass("text").attr({name:B.name,value:B.value})}else{if(B.value){return document.createTextNode(B.value)}}},renderDragHandle:function(){return'<span class="'+this.classNames.DRAG_HANDLE+'"></span></td>'},_handleKeyUpEvent:function(B){if(B.keyCode===27){this.trigger(this._event.CANCEL)}},_cancel:function(B){this.trigger(this._event.CANCEL);B.preventDefault();return this},_submitStarted:function(){this.submitting=true;this.showLoading().disable().delegateEvents({});return this},_submitFinished:function(){this.submitting=false;this.hideLoading().enable().delegateEvents(this.events);return this},_focus:function(B){if(!this.hasFocus()){this.trigger(this._event.FOCUS,B.target.name)}return this},hasFocus:function(){return this.$el.hasClass(this.classNames.FOCUSED)},focus:function(C){var D,B;this.enable();if(C){D=this.$el.find(this.fieldFocusSelector(C))}else{B=this.$el.find(this.classNames.ERROR+":first");if(B.length===0){D=this.$el.find(":input:text:first")}else{D=B.parent().find(":input")}}this.$el.addClass(this.classNames.FOCUSED);D.focus().trigger("select");return this},disable:function(){var C,B;if(A.browser.mozilla){B=this.$el.find(":submit");if(B.length){C=A("<input type='submit' class='"+this.classNames.SUBMIT+"' />").addClass(B.attr("class")).val(B.val()).data(this.dataKeys.ENABLED_SUBMIT,B);B.replaceWith(C)}}this.$el.addClass(this.classNames.DISABLED).find(":submit").attr("disabled","disabled");return this},enable:function(){var B,C;if(A.browser.mozilla){B=this.$el.find(this.classNames.SUBMIT),C=B.data(this.dataKeys.ENABLED_SUBMIT);if(C&&B.length){B.replaceWith(C)}}this.$el.removeClass(this.classNames.DISABLED).find(":submit").removeAttr("disabled");return this},showLoading:function(){this.$el.addClass(this.classNames.LOADING);return this},hideLoading:function(){this.$el.removeClass(this.classNames.LOADING);return this},hasUpdates:function(){return !!this.mapSubmitParams(this.serializeObject())},serializeObject:function(){return this.$el.serializeObject()},mapSubmitParams:function(B){return this.model.changedAttributes(B)},submit:function(D){var B=this,C;if(document.activeElement!==window){A(document.activeElement).blur()}if(this.isUpdateMode){C=this.mapSubmitParams(this.serializeObject());if(!C){return B.trigger(B._event.CANCEL)}}else{this.model.clear();C=this.mapSubmitParams(this.serializeObject())}this.trigger(this._event.SUBMIT_STARTED);this.model.save(C,{success:function(){if(B.isUpdateMode){B.trigger(B._event.UPDATED,B.model,D)}else{B.trigger(B._event.CREATED,B.model.toJSON());B.model=new B._modelClass();B.render({errors:{},values:{}});B.trigger(B._event.FOCUS)}B.trigger(B._event.SUBMIT_FINISHED)},error:function(E,F,G){if(G.status===400){B.renderErrors(F.errors).trigger(B._event.VALIDATION_ERROR,F.errors)}B.trigger(B._event.SUBMIT_FINISHED)},silent:true});return this},renderError:function(B,C){return A("<div />").attr("data-field",B).addClass(this.classNames.ERROR).text(C)},renderErrors:function(C){var B=this;this.$("."+this.classNames.ERROR).remove();if(C){A.each(C,function(D,E){B.$el.find("[name='"+D+"']").closest("td").append(B.renderError(D,E))})}return this},render:function(C){var B=this;this.$el.empty();if(this.allowReorder){A('<td  class="'+this.classNames.ORDER+'" />').append(this.renderDragHandle()).appendTo(B.$el)}A.each(this.columns,function(E,F){var G,I,H=C.values[F.id],D=[{name:F.id,value:H,allowEdit:F.allowEdit},C.values,B.model];if(H){B.$el.attr("data-"+F.id,H)}if(B.isCreateRow&&F.createView){G=new F.createView({model:B.model}).render(D[0])}else{if(F.editView){G=new F.editView({model:B.model}).render(D[0])}else{G=B.defaultColumnRenderer.apply(B,D)}}I=A("<td />");if(typeof G==="object"&&G.done){G.done(function(J){I.append(J)})}else{I.append(G)}if(F.styleClass){I.addClass(F.styleClass)}I.appendTo(B.$el)});this.$el.append(this.renderOperations(C.update,C.values)).addClass(this.classNames.ROW+" "+this.classNames.EDIT_ROW);this.trigger(this._event.RENDER,this.$el,C.values);this.$el.trigger(this._event.CONTENT_REFRESHED,[this.$el]);return this},renderOperations:function(C){var B=A('<td class="aui-restfultable-operations" />');if(C){B.append(A('<input class="aui-button" type="submit" />').attr({accesskey:this.submitAccessKey,value:"Update"})).append(A('<a class="aui-button aui-button-link" href="#" />').addClass(this.classNames.CANCEL).text("Cancel").attr({accesskey:this.cancelAccessKey}))}else{B.append(A('<input class="aui-button" type="submit" />').attr({accesskey:this.submitAccessKey,value:"Add"}))}return B.add(A('<td class="aui-restfultable-status" />').append(AJS.RestfulTable.throbber()))}})})(AJS.$);;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-restfultable', location = 'js/experimental-restfultable/restfultable.customview.js' */
AJS.RestfulTable.CustomEditView=AJS.RestfulTable.CustomCreateView=AJS.RestfulTable.CustomReadView=Backbone.View;;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-restfultable', location = 'js/experimental-restfultable/restfultable.row.js' */
(function(A){AJS.RestfulTable.Row=Backbone.View.extend({tagName:"tr",events:{"click .aui-restfultable-editable":"edit"},initialize:function(C){var B=this;C=C||{};this._event=AJS.RestfulTable.Events;this.classNames=AJS.RestfulTable.ClassNames;this.dataKeys=AJS.RestfulTable.DataKeys;this.columns=C.columns;this.allowEdit=C.allowEdit;this.allowDelete=C.allowDelete;if(!this.events["click .aui-restfultable-editable"]){throw new Error("It appears you have overridden the events property. To add events you will need to usea work around. https://github.com/documentcloud/backbone/issues/244")}this.index=C.index||0;this.deleteConfirmation=C.deleteConfirmation;this.allowReorder=C.allowReorder;this.$el=A(this.el);this.bind(this._event.CANCEL,function(){this.disabled=true}).bind(this._event.FOCUS,function(D){this.focus(D)}).bind(this._event.BLUR,function(){this.unfocus()}).bind(this._event.MODAL,function(){this.$el.addClass(this.classNames.ACTIVE)}).bind(this._event.MODELESS,function(){this.$el.removeClass(this.classNames.ACTIVE)})},renderDragHandle:function(){return'<span class="'+this.classNames.DRAG_HANDLE+'"></span></td>'},defaultColumnRenderer:function(B){if(B.value){return document.createTextNode(B.value.toString())}},sync:function(C){this.model.addExpand(C);var B=this;this.showLoading();this.model.save(C,{success:function(){B.hideLoading().render();B.trigger(B._event.UPDATED)},error:function(){B.hideLoading()}});return this},refresh:function(D,C){var B=this;this.showLoading();this.model.fetch({success:function(){B.hideLoading().render();if(D){D.apply(this,arguments)}},error:function(){B.hideLoading();if(C){C.apply(this,arguments)}}});return this},hasFocus:function(){return this.$el.hasClass(this.classNames.FOCUSED)},focus:function(){A(this.el).addClass(this.classNames.FOCUSED);return this},unfocus:function(){A(this.el).removeClass(this.classNames.FOCUSED);return this},showLoading:function(){this.$el.addClass(this.classNames.LOADING);return this},hideLoading:function(){this.$el.removeClass(this.classNames.LOADING);return this},edit:function(C){var B;if(A(C.target).is("."+this.classNames.EDITABLE)){B=A(C.target).attr("data-field-name")}else{B=A(C.target).closest("."+this.classNames.EDITABLE).attr("data-field-name")}this.trigger(this._event.ROW_EDIT,B);return this},renderOperations:function(){var B=this;if(this.allowDelete!==false){return A("<a href='#' class='aui-button' />").addClass(this.classNames.DELETE).text("Delete").click(function(C){C.preventDefault();B.destroy()})}},destroy:function(){if(this.deleteConfirmation){var B=AJS.popup(400,200,"delete-entity-"+this.model.get("id"));B.element.html(this.deleteConfirmation(this.model.toJSON()));B.show();B.element.find(".cancel").click(function(){B.hide()});B.element.find("form").submit(_.bind(function(C){B.hide();this.model.destroy();C.preventDefault()},this))}else{this.model.destroy()}},render:function(){var B=this,D=this.model.toJSON(),E=A("<td class='aui-restfultable-operations' />").append(this.renderOperations({},D)),C=A("<td class='aui-restfultable-status' />").append(AJS.RestfulTable.throbber());this.$el.removeClass(this.classNames.DISABLED+" "+this.classNames.FOCUSED+" "+this.classNames.LOADING+" "+this.classNames.EDIT_ROW).addClass(this.classNames.READ_ONLY).empty();if(this.allowReorder){A('<td  class="'+this.classNames.ORDER+'" />').append(this.renderDragHandle()).appendTo(B.$el)}this.$el.attr("data-id",this.model.id);A.each(this.columns,function(G,I){var J,L=A("<td />"),K=D[I.id],M=I.fieldName||I.id,F=[{name:M,value:K,allowEdit:I.allowEdit},D,B.model];if(K){B.$el.attr("data-"+I.id,K)}if(I.readView){J=new I.readView({model:B.model}).render(F[0])}else{J=B.defaultColumnRenderer.apply(B,F)}if(B.allowEdit!==false&&I.allowEdit!==false){var H=A("<span />").addClass(B.classNames.EDITABLE).append(aui.icons.icon({useIconFont:true,icon:"edit"})).append(J).attr("data-field-name",M);L=A("<td />").append(H).appendTo(B.$el);if(!J||A.trim(J)==""){L.addClass(B.classNames.NO_VALUE);H.html(A("<em />").text(this.emptyText||"Enter value"))}}else{L.append(J)}if(I.styleClass){L.addClass(I.styleClass)}L.appendTo(B.$el)});this.$el.append(E).append(C).addClass(this.classNames.ROW+" "+this.classNames.READ_ONLY);this.trigger(this._event.RENDER,this.$el,D);this.$el.trigger(this._event.CONTENT_REFRESHED,[this.$el]);return this}})})(AJS.$);;
;/* module-key = 'com.atlassian.jira.gadgets:column-picker-component', location = 'static/components/columnpicker/ColumnPicker.soy' */
// This file was automatically generated from ColumnPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Common == 'undefined') { JIRA.DashboardItem.Common = {}; }
if (typeof JIRA.DashboardItem.Common.Config == 'undefined') { JIRA.DashboardItem.Common.Config = {}; }
if (typeof JIRA.DashboardItem.Common.Config.Templates == 'undefined') { JIRA.DashboardItem.Common.Config.Templates = {}; }


JIRA.DashboardItem.Common.Config.Templates.columnPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var tableId__soy3 = opt_data.id + '-table';
  var selectId__soy4 = opt_data.id + '-select';
  var prefixedTableId__soy5 = opt_data.prefix + tableId__soy3;
  var prefixedSelectId__soy6 = opt_data.prefix + selectId__soy4;
  output.append('<div class="field-group ', soy.$$escapeHtml(tableId__soy3), '"><label for="', soy.$$escapeHtml(prefixedTableId__soy5), '">', soy.$$escapeHtml("Columns to display"), '<span class="aui-icon icon-required"> ', soy.$$escapeHtml("required"), '</span></label><table class="column-picker-order" id="', soy.$$escapeHtml(prefixedTableId__soy5), '"></table><div class="description">', soy.$$escapeHtml("Drag-drop to reorder the fields."), '</div><div class="error">', soy.$$escapeHtml("You must select at least one field."), '</div></div><div class="field-group ', soy.$$escapeHtml(selectId__soy4), '"><select class="select" id="', soy.$$escapeHtml(prefixedSelectId__soy6), '" name="', soy.$$escapeHtml(opt_data.id), '"></select><div class="description">', soy.$$escapeHtml("Add fields to the list above by selecting them."), '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Common.Config.Templates.deleteColumnButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button class="aui-button aui-button-subtle"><span class="aui-icon aui-icon-small aui-iconfont-delete">', soy.$$escapeHtml("Delete"), '</span></button>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:column-picker-component', location = 'static/components/columnpicker/ColumnPicker.js' */
define("jira-dashboard-items/components/column-picker",["underscore","jquery","jira/ajs/ajax/smart-ajax","jira/ajs/select/single-select"],function(_,$,SmartAjax,SingleSelect){var showAjaxError=function(container,result){$(container).empty();AJS.messages.error(container,{title:"Error",body:"<p>"+SmartAjax.buildSimpleErrorContent(result)+"</p>",closeable:false});$(container).show()};var createTable=function(tableElement){var LocalEntryModel=AJS.RestfulTable.EntryModel.extend({destroy:function(){this.collection.remove(this)}});var ReorderableRowView=AJS.RestfulTable.Row.extend({initialize:function(options){options=_.extend({},options,{allowReorder:true});AJS.RestfulTable.Row.prototype.initialize.call(this,options)},renderOperations:function(){return $(JIRA.DashboardItem.Common.Config.Templates.deleteColumnButton()).click(_.bind(function(e){e.preventDefault();this.destroy()},this))}});var table=new AJS.RestfulTable({el:tableElement,allowReorder:false,allowEdit:false,allowCreate:false,autoFocus:false,model:LocalEntryModel,resources:{all:function(populate){populate([])}},columns:[{id:"label",header:""}],views:{row:ReorderableRowView}});table.$thead.detach();table.$theadRow.prepend("<th />");table.$tbody.sortable({handle:"."+table.classNames.DRAG_HANDLE,helper:function(e,elt){var helper=$("<div/>").addClass(table.classNames.MOVEABLE+" "+elt.attr("class"));elt.children().each(function(i){var $td=$(this);var borderLeft=parseInt(0+$td.css("border-left-width"),10);var borderRight=parseInt(0+$td.css("border-right-width"),10);var width=$td[0].clientWidth+borderLeft+borderRight;helper.append($("<div/>").html($td.html()).addClass($td.attr("class")).width(width))});helper=$("<div class='aui-restfultable-readonly'/>").append(helper);helper.css({left:elt.offset().left});helper.appendTo(document.body);return helper},start:function(event,ui){var cachedHeight=ui.helper[0].clientHeight;var $this=ui.placeholder.find("td");ui.item.addClass(table.classNames.MOVEABLE).children().each(function(i){$(this).width($this.eq(i).width())});var td='<td colspan="'+table.getColumnCount()+'">&nbsp;</td>';ui.placeholder.html(td).css({height:cachedHeight,visibility:"visible"});table.getRowFromElement(ui.item[0]).trigger(table._event.MODAL)},stop:function(event,ui){if($(ui.item[0]).is(":visible")){ui.item.removeClass(table.classNames.MOVEABLE).children().attr("style","");ui.placeholder.removeClass(table.classNames.ROW);table.getRowFromElement(ui.item[0]).trigger(table._event.MODELESS)}},axis:"y",delay:0,containment:"document",cursor:"move",scroll:true,zIndex:8000});table.$tbody.bind("selectstart mousedown",function(event){return !$(event.target).is("."+table.classNames.DRAG_HANDLE)});return table};var createSelectField=function(options,table){var errorContainer=options.errorContainer;var columnNames=options.columnNames;var availableColumns=[];SmartAjax.makeRequest({url:AJS.contextPath()+"/rest/gadget/1.0/availableColumns",method:"GET",success:function(response){if(response.availableColumns&&response.availableColumns.length){_.each(response.availableColumns,function(column){availableColumns.push(new AJS.ItemDescriptor(column))})}if(columnNames=="--Default--"){_.each(response.defaultColumns,function(column){table.addRow({id:column.value,label:column.label})})}else{var columns=columnNames.split("|");_.each(columns,function(columnId){var availableColumn=_.find(availableColumns,function(availableColumn){return(availableColumn.value()===columnId)});if(availableColumn){table.addRow({id:availableColumn.value(),label:availableColumn.label()})}})}select.enable()},error:function(result){showAjaxError(errorContainer,result)},complete:function(){if(options.onContentLoaded){options.onContentLoaded()}}});var select=new SingleSelect({element:options.fieldElement,itemAttrDisplayed:"label",revertOnInvalid:true,submitInputVal:false,showDropdownButton:true,suggestions:function(query){return _.filter(availableColumns,function(columnDescriptor){var isAlreadyInTheTable=table._models.get(columnDescriptor.value());var matchesQuery=columnDescriptor.label().toLocaleLowerCase().indexOf(query.toLocaleLowerCase())>-1;return !isAlreadyInTheTable&&matchesQuery})}});select.disable();select.model.$element.on("selected",function(e,descriptor){select.clear();if(!descriptor.value()){return }if(table._models.get(descriptor.value())){return }table.addRow({id:descriptor.value(),label:descriptor.label()});if(options.onContentLoaded){options.onContentLoaded()}});return select};return function(){return{init:function(options){var self=this;this.tableElement=options.tableElement;this.table=createTable(options.tableElement);this.select=createSelectField(options,this.table);this.table.getColumnValues=function(){return _.map(self.table.$table.find("tr"),function(tr){return $(tr).attr("data-id")})};return this},getValue:function(){return this.table.getColumnValues().join("|")},validate:function(){var errorField=this.tableElement.parents(".field-group").find(".error");if(this.table._models.length>0){errorField.hide();return true}else{errorField.show();return false}}}}});;
;/* module-key = 'com.atlassian.jira.gadgets:search-results-component', location = 'static/components/searchresults/SearchResults.soy' */
// This file was automatically generated from SearchResults.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Common == 'undefined') { JIRA.DashboardItem.Common = {}; }
if (typeof JIRA.DashboardItem.Common.SearchResults == 'undefined') { JIRA.DashboardItem.Common.SearchResults = {}; }
if (typeof JIRA.DashboardItem.Common.SearchResults.Templates == 'undefined') { JIRA.DashboardItem.Common.SearchResults.Templates = {}; }


JIRA.DashboardItem.Common.SearchResults.Templates.errorResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  aui.message.error({content: '<p>' + soy.$$escapeHtml("Error occurred running search.") + '</p>'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Common.SearchResults.Templates.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">', soy.$$escapeHtml("Search returned no results."), '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Common.SearchResults.Templates.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="results-wrap search-results-dashboard-item"><div class="search-results-dashboard-item-issue-table ', (opt_data.pagination == true) ? 'paging-table' : '', '">', opt_data.table, '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Common.SearchResults.Templates.searchLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.href), '" ', (opt_data.title) ? 'title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', '>', soy.$$escapeHtml(opt_data.issueCount), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:search-results-component', location = 'static/components/searchresults/SearchResults.js' */
define("jira-dashboard-items/components/search-results",["jquery","underscore","backbone"],function($,_,Backbone){return function(options){var context=options.context;var preferences=options.preferences;var tableUrl;var dataDefaults={num:preferences.num,tableContext:options.tableContext||"jira.table.cols.dashboard",addDefault:false,columnNames:preferences.columnNames.split("|"),enableSorting:true,paging:true,showActions:true};function onSuccess(data,textStatus,jqXHR){var $resultCountLink;var $table;context.empty();data.table="<div>"+data.table+"</div>";$table=$(data.table);$table.find("#issuetable").removeAttr("id").addClass("issue-table");$table.find("[id]").removeAttr("id");data.table=$table.html();if(data.displayed!=0){var showPagination=data.displayed===data.total;context.append(JIRA.DashboardItem.Common.SearchResults.Templates.resultsTable({pagination:showPagination,table:data.table}));$resultCountLink=context.find(".results-count-link");var link;if(data.url){link=AJS.contextPath()+data.url}else{if(preferences.jql){link=AJS.contextPath()+"/issues/?jql="+encodeURIComponent(preferences.jql)}}if(link){$resultCountLink.replaceWith(JIRA.DashboardItem.Common.SearchResults.Templates.searchLink({href:link,title:data.title,issueCount:$resultCountLink.html()}))}$("th.sortable",context).each(function(){this.onclick=null}).click(function(e){e.preventDefault();context.find(".search-results-dashboard-item-issue-table").addClass("loading");preferences.sortBy=$(this).attr("rel");publicApi.trigger("sorted",{sortBy:preferences.sortBy})});$(".pagination a",context).click(function(event){event.preventDefault();context.find(".search-results-dashboard-item-issue-table").addClass("loading");preferences.startIndex=$(this).attr("rel");renderTable()});AJS.Dropdown.create({trigger:".issue-actions-trigger",autoScroll:false,ajaxOptions:{dataType:"json",cache:false,formatSuccess:JIRA.FRAGMENTS.issueActionsFragment}});if(options.onContentLoaded){setTimeout(options.onContentLoaded,500)}}else{if(options.onEmptyResult){options.onEmptyResult(data,textStatus,jqXHR)}else{context.empty().append(JIRA.DashboardItem.Common.SearchResults.Templates.noResults())}}}function renderTable(){return $.ajax({url:tableUrl,type:"GET",contentType:"application/json; charset=utf-8",dataType:"json",data:$.extend({},dataDefaults,{sortBy:(preferences.sortBy&&preferences.sortBy!=="")?preferences.sortBy:null,startIndex:preferences.startIndex?preferences.startIndex:0}),error:function(jqXHR,textStatus,errorThrown){if(options.onError){options.onError(jqXHR,textStatus,errorThrown)}else{context.empty().append(JIRA.DashboardItem.Common.SearchResults.Templates.errorResult())}},success:onSuccess,complete:options.onContentLoaded})}var publicApi=_.extend({render:function(){if(preferences.filterId){tableUrl=AJS.contextPath()+"/rest/gadget/1.0/issueTable/filter";dataDefaults.filterId=preferences.filterId;return renderTable()}else{if(preferences.jql){tableUrl=AJS.contextPath()+"/rest/gadget/1.0/issueTable/jql";dataDefaults.jql=preferences.jql;return renderTable()}else{throw new Error("Unable to render search results. filterId or jql are required.")}}}},Backbone.Events);return publicApi}});;
;/* module-key = 'com.atlassian.jira.gadgets:search-results-component', location = 'static/components/searchresults/SearchResultsConfig.soy' */
// This file was automatically generated from SearchResultsConfig.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Common == 'undefined') { JIRA.DashboardItem.Common = {}; }
if (typeof JIRA.DashboardItem.Common.SearchResults == 'undefined') { JIRA.DashboardItem.Common.SearchResults = {}; }
if (typeof JIRA.DashboardItem.Common.SearchResults.Templates == 'undefined') { JIRA.DashboardItem.Common.SearchResults.Templates = {}; }


JIRA.DashboardItem.Common.SearchResults.Templates.config = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param4 = new soy.StringBuilder('<fieldset>');
  JIRA.DashboardItem.Common.SearchResults.Templates.numberResults({prefix: opt_data.prefix, id: 'number-results', value: opt_data.preferences.num}, param4);
  JIRA.DashboardItem.Common.Config.Templates.columnPicker({prefix: opt_data.prefix, id: 'fields-to-display'}, param4);
  Atlassian.DashboardItem.Common.Templates.refreshInterval({prefix: opt_data.prefix, id: 'refresh-interval', value: opt_data.preferences.refresh}, param4);
  param4.append('</fieldset>');
  Atlassian.DashboardItem.Common.Templates.config({isConfigured: opt_data.preferences.isConfigured, fields: param4.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Common.SearchResults.Templates.numberResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy20 = opt_data.prefix + opt_data.id;
  output.append('<div class="field-group ', soy.$$escapeHtml(opt_data.id), '"><label for="', soy.$$escapeHtml(prefixedId__soy20), '">', soy.$$escapeHtml("Number of Results:"), '<span class="aui-icon icon-required"> ', soy.$$escapeHtml("required"), '</span></label><input class="text" type="text" id="', soy.$$escapeHtml(prefixedId__soy20), '" name="', soy.$$escapeHtml(opt_data.id), '" value="', soy.$$escapeHtml(opt_data.value), '"><div class="error">', soy.$$escapeHtml("The value must be an integer greater than 0 and less than or equal to 50"), '</div><div class="description">', soy.$$escapeHtml("Number of results to display (maximum of 50)."), '</div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:search-results-component', location = 'static/components/searchresults/SearchResultsConfig.js' */
define("jira-dashboard-items/components/search-results-config",["jquery","jira-dashboard-items/components/column-picker"],function($,ColumnPicker){return function(options){var context=$(options.context);var preferences=options.preferences;return{renderConfig:function(){var prefix=(Math.random()+1).toString(36).substring(7)+"-";context.empty().html(JIRA.DashboardItem.Common.SearchResults.Templates.config({prefix:prefix,preferences:{num:preferences.num,refresh:preferences.refresh,isConfigured:preferences.isConfigured}}));var form=context.find("form");var columnPicker=new ColumnPicker().init({errorContainer:context.find(".dashboard-item-error"),tableElement:form.find("#"+prefix+"fields-to-display-table"),fieldElement:form.find("#"+prefix+"fields-to-display-select"),columnNames:preferences.columnNames,onContentLoaded:options.onContentLoaded});function validateNumberResults(){var field=form.find("input[name=number-results]");var value=field.val();if(value>0&&value<=50){field.parents(".field-group").find(".error").hide();return true}else{field.parents(".field-group").find(".error").show();return false}}function validateFields(){var numberResultsIsValid=validateNumberResults();var fieldsToDisplayIsValid=columnPicker.validate();return numberResultsIsValid&&fieldsToDisplayIsValid}form.on("submit",_.bind(function(e){e.preventDefault();if(!validateFields()){options.onContentLoaded();return }var form=$(e.target);options.onSave({num:form.find("input[name=number-results]").val(),refresh:options.gadgetAPI.getRefreshFieldValue("refresh-interval"),columnNames:columnPicker.getValue()})},this));form.find(".buttons-container .cancel").on("click",_.bind(function(){options.onCancel()},this));return form}}}});;
;/* module-key = 'com.atlassian.jira.gadgets:filter-results-dashboard-item-resources', location = 'static/dashboarditem/filterresults/FilterResults.soy' */
// This file was automatically generated from FilterResults.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.FilterResults == 'undefined') { JIRA.DashboardItem.FilterResults = {}; }
if (typeof JIRA.DashboardItem.FilterResults.Templates == 'undefined') { JIRA.DashboardItem.FilterResults.Templates = {}; }


JIRA.DashboardItem.FilterResults.Templates.filterErrorResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  var filterLink__soy4 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(""), '/issues/?filter=', soy.$$escapeHtml(opt_data.filterId), '">');
  filterLink__soy4 = filterLink__soy4.toString();
  aui.message.error({content: '<p>' + AJS.format("The filter configured for this gadget could not be retrieved. Please verify it is still valid on the {0}issue navigator{1}.",filterLink__soy4,'</a>') + '</p>'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.FilterResults.Templates.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  var filterLink__soy19 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.href), '" ', (opt_data.title) ? 'title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', '>');
  filterLink__soy19 = filterLink__soy19.toString();
  output.append(AJS.format("No matching {0}issues{1} found.",filterLink__soy19,'</a>'), '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:filter-results-dashboard-item-resources', location = 'static/dashboarditem/filterresults/FilterResults.js' */
define("jira-dashboard-items/filter-results",["jquery","underscore","jira-dashboard-items/components/filter-picker","jira-dashboard-items/components/search-results-config","jira-dashboard-items/components/search-results"],function($,_,FilterPicker,SearchResultsConfig,SearchResults){var DashboardItem=function(API){this.API=API};DashboardItem.prototype.render=function(context,preferences){var self=this;self.API.showLoadingBar();var displayPrefs=$.extend({},preferences);displayPrefs.filterId=displayPrefs.filterId!==undefined?displayPrefs.filterId.replace("filter-",""):displayPrefs.filterId;this.searchResults=new SearchResults({context:context,preferences:displayPrefs,onContentLoaded:this.API.forceLayoutRefresh.bind(this.API),onEmptyResult:function(){context.append(JIRA.DashboardItem.FilterResults.Templates.noResults({href:AJS.contextPath()+"/issues/?filter="+displayPrefs.filterId}));self.API.forceLayoutRefresh()},onError:function(){context.empty().append(JIRA.DashboardItem.FilterResults.Templates.filterErrorResult({filterId:displayPrefs.filterId}));self.API.forceLayoutRefresh()}});this.searchResults.render().done(function(data){if(data&&data.title){self.API.setTitle(AJS.format("Filter Results: {0}",data.title))}}).always(this.API.hideLoadingBar.bind(this.API));this.searchResults.on("sorted",function(eventData){preferences.sortBy=eventData.sortBy;if(self.API.isEditable()){self.API.savePreferences(preferences)}else{self.render(context,preferences)}});self.API.initRefresh(displayPrefs,_.bind(self.render,self,context,displayPrefs))};DashboardItem.prototype.renderEdit=function(element,preferences){var self=this;var searchResultsConfig=new SearchResultsConfig({context:element,preferences:preferences,onContentLoaded:function(){self.API.hideLoadingBar();self.API.forceLayoutRefresh()},onCancel:this.API.closeEdit.bind(this.API),onSave:function(prefs){var validFilter=self.filterPicker.validate();if(validFilter){var selectedFilter=self.filterPicker.getValue();prefs.filterId=selectedFilter.id;self.API.savePreferences(prefs)}else{self.API.forceLayoutRefresh()}},gadgetAPI:self.API});var $form=searchResultsConfig.renderConfig();var prefix=self.API.getGadgetId()+"-";$form.find("fieldset:first").prepend(JIRA.DashboardItem.Common.Config.Templates.filterPicker({prefix:prefix,id:"saved-filter"}));this.filterPicker=new FilterPicker().init({errorContainer:element.find(".dashboard-item-error"),element:$form.find("#"+prefix+"saved-filter"),selectedValue:preferences.filterId!==undefined?preferences.filterId.replace("filter-",""):preferences.filterId});this.API.once("afterRender",function(){if(element.width()<350){$form.addClass("top-label")}self.API.showLoadingBar()})};return DashboardItem});;
;/* module-key = 'com.atlassian.jira.gadgets:assigned-to-me-dashboard-item-resources', location = 'static/dashboarditem/assignedtome/AssignedToMe.soy' */
// This file was automatically generated from AssignedToMe.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.AssignedToMe == 'undefined') { JIRA.DashboardItem.AssignedToMe = {}; }
if (typeof JIRA.DashboardItem.AssignedToMe.Templates == 'undefined') { JIRA.DashboardItem.AssignedToMe.Templates = {}; }


JIRA.DashboardItem.AssignedToMe.Templates.errorResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  aui.message.error({content: '<p>' + soy.$$escapeHtml("An unknown error occurred while trying to perform a search.") + '</p>'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.AssignedToMe.Templates.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  var filterLink__soy12 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.href), '">');
  filterLink__soy12 = filterLink__soy12.toString();
  output.append(AJS.format("You currently have no {0}issues{1} assigned to you. Enjoy your day!",filterLink__soy12,'</a>'), '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:assigned-to-me-dashboard-item-resources', location = 'static/dashboarditem/assignedtome/AssignedToMe.js' */
define("jira-dashboard-items/assigned-to-me",["jquery","underscore","jira-dashboard-items/components/search-results-config","jira-dashboard-items/components/search-results"],function($,_,SearchResultsConfig,SearchResults){var DashboardItem=function(API){this.API=API};DashboardItem.prototype.render=function(context,preferences){var self=this;self.API.showLoadingBar();self.API.setTitle("Assigned to Me");var displayPrefs=$.extend({},preferences);displayPrefs.jql="assignee = currentUser() AND resolution = unresolved ORDER BY priority DESC, created ASC";if(displayPrefs.sortColumn){displayPrefs.sortBy=displayPrefs.sortColumn}this.searchResults=new SearchResults({context:context,preferences:displayPrefs,onContentLoaded:this.API.forceLayoutRefresh.bind(this.API),onEmptyResult:function(){context.append(JIRA.DashboardItem.AssignedToMe.Templates.noResults({href:AJS.contextPath()+"/issues/?jql="+encodeURIComponent(displayPrefs.jql)}));self.API.forceLayoutRefresh()},onError:function(){context.empty().append(JIRA.DashboardItem.AssignedToMe.Templates.errorResult());self.API.forceLayoutRefresh()}});this.searchResults.on("sorted",function(eventData){preferences.sortBy=preferences.sortColumn=eventData.sortBy;if(self.API.isEditable()){self.API.savePreferences(preferences)}else{self.render(context,preferences)}});this.searchResults.render().always(this.API.hideLoadingBar.bind(this.API));self.API.initRefresh(displayPrefs,this.searchResults.render)};DashboardItem.prototype.renderEdit=function(element,preferences){var self=this;var searchResultsConfig=new SearchResultsConfig({context:element,preferences:preferences,onContentLoaded:function(){self.API.hideLoadingBar();self.API.forceLayoutRefresh()},onCancel:this.API.closeEdit.bind(this.API),onSave:this.API.savePreferences.bind(this.API),gadgetAPI:self.API});var $form=searchResultsConfig.renderConfig();this.API.once("afterRender",function(){if(element.width()<350){$form.addClass("top-label")}self.API.showLoadingBar()})};return DashboardItem});;
;/* module-key = 'com.atlassian.jira.gadgets:in-progress-dashboard-item-resources', location = 'static/dashboarditem/inprogress/InProgress.soy' */
// This file was automatically generated from InProgress.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.InProgress == 'undefined') { JIRA.DashboardItem.InProgress = {}; }
if (typeof JIRA.DashboardItem.InProgress.Templates == 'undefined') { JIRA.DashboardItem.InProgress.Templates = {}; }


JIRA.DashboardItem.InProgress.Templates.errorResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  aui.message.error({content: '<p>' + soy.$$escapeHtml("An unknown error occurred while trying to perform a search.") + '</p>'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.InProgress.Templates.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  var filterLink__soy12 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.href), '">');
  filterLink__soy12 = filterLink__soy12.toString();
  output.append(AJS.format("You currently have no {0}issues{1} in progress.",filterLink__soy12,'</a>'), '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:in-progress-dashboard-item-resources', location = 'static/dashboarditem/inprogress/InProgress.js' */
define("jira-dashboard-items/in-progress",["jquery","underscore","jira-dashboard-items/components/search-results-config","jira-dashboard-items/components/search-results"],function($,_,SearchResultsConfig,SearchResults){var DashboardItem=function(API){this.API=API};DashboardItem.prototype.render=function(context,preferences){var self=this;self.API.showLoadingBar();self.API.setTitle("Issues in progress");var displayPrefs=$.extend({},preferences);displayPrefs.jql="status = 'In Progress' AND resolution is EMPTY AND assignee = currentUser() ORDER BY priority DESC, created ASC";this.searchResults=new SearchResults({context:context,preferences:displayPrefs,onContentLoaded:this.API.forceLayoutRefresh.bind(this.API),onEmptyResult:function(){context.append(JIRA.DashboardItem.InProgress.Templates.noResults({href:AJS.contextPath()+"/issues/?jql="+encodeURIComponent(displayPrefs.jql)}));self.API.forceLayoutRefresh()},onError:function(){context.empty().append(JIRA.DashboardItem.InProgress.Templates.errorResult());self.API.forceLayoutRefresh()}});this.searchResults.render().always(this.API.hideLoadingBar.bind(this.API));this.searchResults.on("sorted",function(eventData){preferences.sortBy=eventData.sortBy;if(self.API.isEditable()){self.API.savePreferences(preferences)}else{self.render(context,preferences)}});self.API.initRefresh(displayPrefs,this.searchResults.render)};DashboardItem.prototype.renderEdit=function(element,preferences){var self=this;var searchResultsConfig=new SearchResultsConfig({context:element,preferences:preferences,onContentLoaded:function(){self.API.hideLoadingBar();self.API.forceLayoutRefresh()},onCancel:this.API.closeEdit.bind(this.API),onSave:this.API.savePreferences.bind(this.API),gadgetAPI:self.API});var $form=searchResultsConfig.renderConfig();this.API.once("afterRender",function(){if(element.width()<350){$form.addClass("top-label")}self.API.showLoadingBar()})};return DashboardItem});;
;/* module-key = 'com.atlassian.jira.gadgets:voted-dashboard-item-resources', location = 'static/dashboarditem/voted/Voted.soy' */
// This file was automatically generated from Voted.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Voted == 'undefined') { JIRA.DashboardItem.Voted = {}; }
if (typeof JIRA.DashboardItem.Voted.Templates == 'undefined') { JIRA.DashboardItem.Voted.Templates = {}; }


JIRA.DashboardItem.Voted.Templates.extraConfig = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.checkboxField({legendContent: '', fields: opt_data.checkboxes}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Voted.Templates.errorResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  aui.message.error({content: '<p>' + soy.$$escapeHtml("An unknown error occurred while trying to perform a search.") + '</p>'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Voted.Templates.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  var filterLink__soy16 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.href), '">');
  filterLink__soy16 = filterLink__soy16.toString();
  output.append(AJS.format("You are not currently voting for any {0}issues{1}.",filterLink__soy16,'</a>'), '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:voted-dashboard-item-resources', location = 'static/dashboarditem/voted/Voted.js' */
define("jira-dashboard-items/voted",["jquery","underscore","jira-dashboard-items/components/search-results-config","jira-dashboard-items/components/search-results"],function($,_,SearchResultsConfig,SearchResults){var DashboardItem=function(API){this.API=API};DashboardItem.prototype.render=function(context,preferences){var self=this;self.API.showLoadingBar();self.API.setTitle("Voted Issues");var displayPrefs=$.extend({},preferences);displayPrefs.jql=displayPrefs.showResolved?"issue in votedIssues() order by votes desc":"issue in votedIssues() AND resolution = EMPTY order by votes desc";if(displayPrefs.columnNames&&displayPrefs.columnNames.indexOf("votes")==-1){displayPrefs.columnNames+="|votes"}this.searchResults=new SearchResults({context:context,tableContext:"jira.table.cols.voted",preferences:displayPrefs,onContentLoaded:this.API.forceLayoutRefresh.bind(this.API),onEmptyResult:function(){context.append(JIRA.DashboardItem.Voted.Templates.noResults({href:AJS.contextPath()+"/issues/?jql="+encodeURIComponent(displayPrefs.jql)}));self.API.forceLayoutRefresh()},onError:function(){context.empty().append(JIRA.DashboardItem.Voted.Templates.errorResult());self.API.forceLayoutRefresh()}});this.searchResults.render().always(this.API.hideLoadingBar.bind(this.API));this.searchResults.on("sorted",function(eventData){preferences.sortBy=eventData.sortBy;if(self.API.isEditable()){self.API.savePreferences(preferences)}else{self.render(context,preferences)}});self.API.initRefresh(displayPrefs,this.searchResults.render)};DashboardItem.prototype.renderEdit=function(element,preferences){var self=this;var searchResultsConfig=new SearchResultsConfig({context:element,preferences:preferences,onContentLoaded:function(){self.API.hideLoadingBar();self.API.forceLayoutRefresh()},onCancel:this.API.closeEdit.bind(this.API),onSave:function(prefs){prefs.showResolved=element.find("input[name=showResolved]").is(":checked");self.API.savePreferences(prefs)},gadgetAPI:self.API});var $form=searchResultsConfig.renderConfig();var prefix=self.API.getGadgetId()+"-";$form.find(".field-group:last").before(JIRA.DashboardItem.Voted.Templates.extraConfig({checkboxes:[{id:prefix+"show-resolved",name:"showResolved",labelText:"Include resolved issues",isChecked:!!preferences.showResolved}]}));this.API.once("afterRender",function(){if(element.width()<350){$form.addClass("top-label")}self.API.showLoadingBar()})};return DashboardItem});;
;/* module-key = 'com.atlassian.jira.gadgets:watched-dashboard-item-resources', location = 'static/dashboarditem/watched/Watched.soy' */
// This file was automatically generated from Watched.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Watched == 'undefined') { JIRA.DashboardItem.Watched = {}; }
if (typeof JIRA.DashboardItem.Watched.Templates == 'undefined') { JIRA.DashboardItem.Watched.Templates = {}; }


JIRA.DashboardItem.Watched.Templates.extraConfig = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.checkboxField({legendContent: '', fields: opt_data.checkboxes}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Watched.Templates.errorResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  aui.message.error({content: '<p>' + soy.$$escapeHtml("An unknown error occurred while trying to perform a search.") + '</p>'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Watched.Templates.noResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="empty-results search-results-dashboard-item">');
  var filterLink__soy16 = new soy.StringBuilder('<a href="', soy.$$escapeHtml(opt_data.href), '">');
  filterLink__soy16 = filterLink__soy16.toString();
  output.append(AJS.format("You are not currently watching any {0}issues{1}.",filterLink__soy16,'</a>'), '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:watched-dashboard-item-resources', location = 'static/dashboarditem/watched/Watched.js' */
define("jira-dashboard-items/watched",["jquery","underscore","jira-dashboard-items/components/search-results-config","jira-dashboard-items/components/search-results"],function($,_,SearchResultsConfig,SearchResults){var DashboardItem=function(API){this.API=API};DashboardItem.prototype.render=function(context,preferences){var self=this;self.API.showLoadingBar();self.API.setTitle("Watched Issues");var displayPrefs=$.extend({},preferences);displayPrefs.jql=displayPrefs.showResolved?"issue in watchedIssues() order by watchers desc":"issue in watchedIssues() AND resolution = EMPTY order by watchers desc";if(displayPrefs.columnNames&&displayPrefs.columnNames.indexOf("watches")==-1){displayPrefs.columnNames+="|watches"}this.searchResults=new SearchResults({context:context,tableContext:"jira.table.cols.watched",preferences:displayPrefs,onContentLoaded:this.API.forceLayoutRefresh.bind(this.API),onEmptyResult:function(){context.append(JIRA.DashboardItem.Watched.Templates.noResults({href:AJS.contextPath()+"/issues/?jql="+encodeURIComponent(displayPrefs.jql)}));self.API.forceLayoutRefresh()},onError:function(){context.empty().append(JIRA.DashboardItem.Watched.Templates.errorResult());self.API.forceLayoutRefresh()}});this.searchResults.render().always(this.API.hideLoadingBar.bind(this.API));this.searchResults.on("sorted",function(eventData){preferences.sortBy=eventData.sortBy;if(self.API.isEditable()){self.API.savePreferences(preferences)}else{self.render(context,preferences)}});self.API.initRefresh(displayPrefs,this.searchResults.render)};DashboardItem.prototype.renderEdit=function(element,preferences){var self=this;var searchResultsConfig=new SearchResultsConfig({context:element,preferences:preferences,onContentLoaded:function(){self.API.hideLoadingBar();self.API.forceLayoutRefresh()},onCancel:this.API.closeEdit.bind(this.API),onSave:function(prefs){prefs.showResolved=element.find("input[name=showResolved]").is(":checked");self.API.savePreferences(prefs)},gadgetAPI:self.API});var $form=searchResultsConfig.renderConfig();var prefix=self.API.getGadgetId()+"-";$form.find(".field-group:last").before(JIRA.DashboardItem.Watched.Templates.extraConfig({checkboxes:[{id:prefix+"show-resolved",name:"showResolved",labelText:"Include resolved issues",isChecked:!!preferences.showResolved}]}));this.API.once("afterRender",function(){if(element.width()<350){$form.addClass("top-label")}self.API.showLoadingBar()})};return DashboardItem});;
;/* module-key = 'com.atlassian.auiplugin:aui-experimental-progress-indicator', location = 'js/aui-experimental-progress-indicator.js' */
(function(){function A(B,D,C){AJS._internal.animation.recomputeStyle(B);B.css("width",C*100+"%");D.attr("data-value",C)}AJS.progressBars={update:function(G,M){var C=AJS.$(G).first();var F=C.children(".aui-progress-indicator-value");var L=F.attr("data-value")||0;var K="aui-progress-indicator-after-update";var I="aui-progress-indicator-before-update";var D="transitionend webkitTransitionEnd";var E=!C.attr("data-value");if(E){F.css("width",0)}if(typeof M==="number"&&M<=1&&M>=0){C.trigger(I,[L,M]);var H=document.body||document.documentElement;var B=H.style;var J="transition";if(typeof B.transition==="string"||typeof B.WebkitTransition==="string"){F.one(D,function(){C.trigger(K,[L,M])});A(F,C,M)}else{A(F,C,M);C.trigger(K,[L,M])}}return C},setIndeterminate:function(D){var C=AJS.$(D).first();var B=C.children(".aui-progress-indicator-value");C.removeAttr("data-value");AJS._internal.animation.recomputeStyle(C);B.css("width","100%")}}}());;
;/* module-key = 'com.atlassian.jira.gadgets:stats-dashboard-item-resources', location = 'static/dashboarditem/stats/stats.soy' */
// This file was automatically generated from stats.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.DashboardItem == 'undefined') { JIRA.DashboardItem = {}; }
if (typeof JIRA.DashboardItem.Stats == 'undefined') { JIRA.DashboardItem.Stats = {}; }
if (typeof JIRA.DashboardItem.Stats.Templates == 'undefined') { JIRA.DashboardItem.Stats.Templates = {}; }


JIRA.DashboardItem.Stats.Templates.render = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table class="aui">');
  var statTypeId__soy4 = opt_data.prefix + 'stats-category';
  var countId__soy5 = opt_data.prefix + 'stats-count';
  var percentageId__soy6 = opt_data.prefix + 'stats-percentage';
  output.append('<thead><tr class="stats-gadget-table-header"><th id="', soy.$$escapeHtml(statTypeId__soy4), '" class="cell-type-collapsed">', soy.$$escapeHtml(opt_data.data.statTypeDescription), '</th><th id="', soy.$$escapeHtml(countId__soy5), '" class="stats-gadget-numeric">', soy.$$escapeHtml("Count"), '</th><th id="', soy.$$escapeHtml(percentageId__soy6), '" colspan="2">', soy.$$escapeHtml("Percentage"), '</th></tr></thead><tbody>');
  var rowList20 = opt_data.data.rows;
  var rowListLen20 = rowList20.length;
  for (var rowIndex20 = 0; rowIndex20 < rowListLen20; rowIndex20++) {
    var rowData20 = rowList20[rowIndex20];
    output.append('<tr><td class="cell-type-collapsed" headers="', soy.$$escapeHtml(statTypeId__soy4), '">', rowData20.html, '</td><td class="cell-type-collapsed stats-gadget-numeric" headers="', soy.$$escapeHtml(countId__soy5), '"><a href="', soy.$$escapeHtml(rowData20.url), '">', soy.$$escapeHtml(rowData20.count), '</a></td><td class="stats-gadget-progress-indicator"><div class="aui-progress-indicator" data-value="1"><span class="aui-progress-indicator-value" style="width: ', soy.$$escapeHtml(rowData20.percentage), '%"></span></div></td><td class="cell-type-collapsed stats-gadget-numeric" headers="', soy.$$escapeHtml(percentageId__soy6), '">', soy.$$escapeHtml(rowData20.percentage), '%</td></tr>');
  }
  output.append('<tr class="stats-gadget-final-row"><td headers="', soy.$$escapeHtml(statTypeId__soy4), '">', soy.$$escapeHtml("Total"), '</td><td headers="', soy.$$escapeHtml(countId__soy5), '" class="cell-type-collapsed stats-gadget-numeric"><a href="', soy.$$escapeHtml(opt_data.data.filterOrProjectLink), '">', soy.$$escapeHtml(opt_data.data.totalIssueCount), '</a></td><td colspan="2"></td></tr></tbody></table>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.NoStatsContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.info({content: "No Data Available", closeable: 'false'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.Errors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param58 = new soy.StringBuilder('<ul>');
  var errorList60 = opt_data.errors;
  var errorListLen60 = errorList60.length;
  for (var errorIndex60 = 0; errorIndex60 < errorListLen60; errorIndex60++) {
    var errorData60 = errorList60[errorIndex60];
    param58.append('<li>', soy.$$escapeHtml(errorData60.message), '</li>');
  }
  param58.append('</ul>');
  aui.message.error({titleContent: "Unfortunately, one or more of your preferences are now unavailable. Please update your preferences, or remove gadget by clicking delete from the title bar above.", closeable: 'false', content: param58.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.Configuration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param68 = new soy.StringBuilder();
  JIRA.DashboardItem.ProjectFilterAutoComplete.Config.Templates.projectFilterPicker({prefix: opt_data.prefix, id: 'project-filter-picker', selectionType: opt_data.preferences.type, selectionID: opt_data.preferences.id, selectionName: opt_data.preferences.name}, param68);
  JIRA.DashboardItem.Stats.Templates.statTypePicker({prefix: opt_data.prefix, id: 'stat-type', statTypes: opt_data.statTypes, value: opt_data.preferences.statType}, param68);
  JIRA.DashboardItem.Stats.Templates.sortBy({prefix: opt_data.prefix, value: opt_data.preferences.sortBy}, param68);
  JIRA.DashboardItem.Stats.Templates.sortDirection({prefix: opt_data.prefix, value: opt_data.preferences.sortDirection}, param68);
  JIRA.DashboardItem.Stats.Templates.showResolvedIssuesStats({prefix: opt_data.prefix, id: 'stat-type', statTypes: opt_data.statTypes, value: opt_data.preferences.includeResolvedIssues}, param68);
  Atlassian.DashboardItem.Common.Templates.refreshInterval({prefix: opt_data.prefix, id: 'refresh-interval', value: opt_data.preferences.refresh}, param68);
  Atlassian.DashboardItem.Common.Templates.config({fields: param68.toString(), isConfigured: opt_data.preferences.isConfigured}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.sortBy = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy98 = opt_data.prefix + 'stats-sort-by';
  output.append('<div class="field-group"><label for="', soy.$$escapeHtml(prefixedId__soy98), '">', soy.$$escapeHtml("Sort By"), '</label><select class="select" id="', soy.$$escapeHtml(prefixedId__soy98), '" name="sortBy"><option value="natural"', (opt_data.value == 'natural') ? ' selected="selected"' : '', '>', soy.$$escapeHtml("Natural"), '</option><option value="total"', (opt_data.value == 'total') ? ' selected="selected"' : '', '>', soy.$$escapeHtml("Total"), '</option></select><div class="description">', soy.$$escapeHtml("Sort by row total or natural field order."), '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.sortDirection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy121 = opt_data.prefix + 'stats-sort-direction';
  output.append('<div class="field-group"><label for="', soy.$$escapeHtml(prefixedId__soy121), '">', soy.$$escapeHtml("Sort Direction"), '</label><select class="select" id="', soy.$$escapeHtml(prefixedId__soy121), '" name="sortDirection"><option value="asc"', (opt_data.value == 'asc') ? ' selected="selected"' : '', '>', soy.$$escapeHtml("Ascending"), '</option><option value="desc"', (opt_data.value == 'desc') ? ' selected="selected"' : '', '>', soy.$$escapeHtml("Descending"), '</option></select></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.showResolvedIssuesStats = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy142 = opt_data.prefix + 'stats-show-resolved';
  output.append('<div class="field-group"><label for="', soy.$$escapeHtml(prefixedId__soy142), '">', soy.$$escapeHtml("Show Resolved Issue Statistics"), '</label><select class="select" id="', soy.$$escapeHtml(prefixedId__soy142), '" name="includeResolvedIssues"><option value="false"', (opt_data.value == false) ? ' selected="selected"' : '', '>', soy.$$escapeHtml("No"), '</option><option value="true"', (opt_data.value == true) ? ' selected="selected"' : '', '>', soy.$$escapeHtml("Yes"), '</option></select><div class="description">', soy.$$escapeHtml("Include resolved issues in the set of issues from which statistics are calculated."), '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.statTypePicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var prefixedId__soy165 = opt_data.prefix + opt_data.id;
  output.append('<div class="field-group"><label for="', soy.$$escapeHtml(prefixedId__soy165), '">', soy.$$escapeHtml("Statistic Type:"), '</label><select id="', soy.$$escapeHtml(prefixedId__soy165), '" name="statType" class="select">');
  var typeList173 = opt_data.statTypes;
  var typeListLen173 = typeList173.length;
  for (var typeIndex173 = 0; typeIndex173 < typeListLen173; typeIndex173++) {
    var typeData173 = typeList173[typeIndex173];
    output.append('<option value="', soy.$$escapeHtml(typeData173.value), '"', (typeData173.value == opt_data.value) ? ' selected="selected"' : '', '>', soy.$$escapeHtml(typeData173.label), '</option>');
  }
  output.append('</select><div class="error"></div><div class="description">', soy.$$escapeHtml("Select which type of statistic to display for this filter."), '</div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.ErrorRenderingConfiguration = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.error({titleContent: "Oops - an error has occurred", content: '', closeable: 'false'}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.DashboardItem.Stats.Templates.title = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(soy.$$escapeHtml("Issue Statistics"), ': ', soy.$$escapeHtml(opt_data.data.filterOrProjectName), ' (', soy.$$escapeHtml(opt_data.data.statTypeDescription), ')');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.gadgets:stats-dashboard-item-resources', location = 'static/dashboarditem/stats/stats.js' */
define("jira-dashboard-items/stats",["jquery","jira-dashboard-items/components/autocomplete/project-filter-autocomplete","underscore"],function($,ProjectFilterAutoComplete,_){var DashboardItem=function(API,options){this.API=API;this.options=options||{}};function parseErrorMessage(errorString){var errorArray=[];var errorJSON=JSON.parse(errorString);for(var key in errorJSON){if(errorJSON.hasOwnProperty(key)){errorArray.push({key:key,message:errorJSON[key]})}}return errorArray}function extractFieldsFromProjectOrFilterId(preferences){if(preferences.projectOrFilterId&&!(preferences.type&&preferences.id)){var projectOrFilterSplit=preferences.projectOrFilterId.split("-");preferences.type=projectOrFilterSplit[0];preferences.id=projectOrFilterSplit[1]}}function getPreferencesObject($form){var formData=$form.serializeArray(),paramsWhitelist=["name","type","id","statType","refresh-interval","sortBy","sortDirection","includeResolvedIssues"],preferences={};_.each(formData,function(element){if(_.indexOf(paramsWhitelist,element.name)===-1){return }if(element.name==="refresh-interval"){preferences.refresh=element.value}else{preferences[element.name]=element.value}});return preferences}function updateProjectOrFilterId(preferences){preferences.projectOrFilterId=preferences.type+"-"+preferences.id}function getTitle(response){var title="";title+="Issue Statistics"+": ";title+=response.filterOrProjectName+" ("+response.statTypeDescription+")";return title}DashboardItem.prototype.render=function(element,preferences){var gadget=this;var $gadgetElement=$(element);$gadgetElement.addClass("stats-gadget");gadget.API.showLoadingBar();extractFieldsFromProjectOrFilterId(preferences);gadget.API.initRefresh(preferences,_.bind(gadget.render,gadget,element,preferences));$.ajax({method:"GET",url:AJS.contextPath()+"/rest/gadget/1.0/stats/generate",dataType:"json",data:{includeResolvedIssues:preferences.includeResolvedIssues,projectOrFilterId:preferences.type+"-"+preferences.id,sortBy:preferences.sortBy,sortDirection:preferences.sortDirection,statType:preferences.statType}}).done(function(response){if(!response.totalIssueCount||response.totalIssueCount===0){$gadgetElement.html(JIRA.DashboardItem.Stats.Templates.NoStatsContent())}else{var prefix=gadget.API.getGadgetId()+"-";$gadgetElement.html(JIRA.DashboardItem.Stats.Templates.render({data:response,prefix:prefix}))}gadget.API.setTitle(getTitle(response))}).fail(function(message){var errors=parseErrorMessage(message.responseText);$gadgetElement.html(JIRA.DashboardItem.Stats.Templates.Errors({errors:errors}))}).always(function(){gadget.API.hideLoadingBar();gadget.API.forceLayoutRefresh()})};DashboardItem.prototype.renderEdit=function(element,preferences){var gadget=this;var $gadgetElement=$(element);$gadgetElement.addClass("stats-gadget");gadget.API.showLoadingBar();$.ajax({method:"GET",url:AJS.contextPath()+"/rest/gadget/1.0/statTypes"}).done(function(data){var prefix=gadget.API.getGadgetId()+"-";extractFieldsFromProjectOrFilterId(preferences);if(!preferences.name&&preferences.type&&preferences.id){preferences.name=preferences.type+"-"+preferences.id}if(preferences.name){preferences.name=new soydata.SanitizedHtml(preferences.name)}$gadgetElement.html(JIRA.DashboardItem.Stats.Templates.Configuration({prefix:prefix,statTypes:data.stats,preferences:preferences}));var projectFilterOptions={fieldID:prefix+"project-filter-picker",completeField:function(selection){if(selection){$gadgetElement.find("input[name=type]").val(selection.type);$gadgetElement.find("input[name=id]").val(selection.id);$gadgetElement.find("input[name=name]").val(selection.name);$gadgetElement.find(".filterpicker-value-name").text(selection.name).addClass("success");this.field.val("");this.field.trigger("change")}},maxHeight:140};if(gadget.options.delay){projectFilterOptions.delay=gadget.options.delay}ProjectFilterAutoComplete(projectFilterOptions);var form=$("form",$gadgetElement);var cancelButton=$(".cancel",form);if(cancelButton){cancelButton.click(function(){gadget.API.closeEdit()})}function completeValidation(preferences,form){if(!preferences.id||!preferences.type){$(".projectOrFilter-error",form).text("No project or filter specified.").show();return false}return true}form.on("submit",function(e){e.preventDefault();var $form=$(e.target);var preferences=getPreferencesObject($form);updateProjectOrFilterId(preferences);if(completeValidation(preferences,$form)){gadget.API.savePreferences(preferences)}})}).fail(function(){$gadgetElement.html(JIRA.DashboardItem.Stats.Templates.ErrorRenderingConfiguration())}).always(function(){gadget.API.hideLoadingBar();gadget.API.forceLayoutRefresh()})};return DashboardItem});;
;/* module-key = 'com.atlassian.gadgets.dashboard:dashboard-prod', location = 'js/dashboard-item-directory-init.js' */
AJS.toInit(function(){function trackActiveColumn(e){var colNumber=AJS.$(this).attr("id").substring(11);AJS.activeColumn=colNumber||0;return AJS.stopEvent(e)}if(!AG.param.get("writable")){return }AJS.$(".add-gadget-link").live("click",trackActiveColumn);new JIRA.Dashboard.Modules.Directory(AJS.$(".add-gadget-link"))});;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(typeof packet==="object"&&typeof packet.data==="string"){process(gadgets.json.parse(packet.data))}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"unknown origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};;
;/* module-key = 'com.atlassian.gadgets.embedded:gadget-container-resources', location = 'js/gadgets-container.js' */
gadgets.Container=function(){this.parentUrl_="http://"+document.location.host;this.country_="ALL";this.language_="ALL";this.view_="default";this.nocache_=1;this.maxheight_=2147483647};gadgets.Container.inherits(gadgets.Extensible);gadgets.Container.prototype.userPrefStore=new gadgets.DefaultUserPrefStore();gadgets.Container.prototype.gadgetService=new gadgets.GadgetService();gadgets.Container.prototype.layoutManager=new gadgets.StaticLayoutManager();gadgets.Container.prototype.setParentUrl=function(url){this.parentUrl_=url};gadgets.Container.prototype.setCountry=function(country){this.country_=country};gadgets.Container.prototype.setNoCache=function(nocache){this.nocache_=nocache};gadgets.Container.prototype.setLanguage=function(language){this.language_=language};gadgets.Container.prototype.setView=function(view){this.view_=view};gadgets.Container.prototype.setMaxHeight=function(maxheight){this.maxheight_=maxheight};gadgets.Container.prototype.getGadgetKey_=function(instanceId){return"gadget_"+instanceId};gadgets.IfrContainer=function(){gadgets.Container.call(this)};gadgets.IfrContainer.inherits(gadgets.Container);gadgets.IfrContainer.prototype.gadgetService=new gadgets.IfrGadgetService();gadgets.IfrContainer.prototype.setParentUrl=function(url){if(!url.match(/^http[s]?:\/\//)){url=document.location.href.match(/^[^?#]+\//)[0]+url}this.parentUrl_=url};gadgets.container=new gadgets.IfrContainer();;
;/* module-key = 'com.atlassian.gadgets.dashboard:gadget-dashboard-resources', location = 'js/cookies.js' */
var goog=goog||{};goog.net=goog.net||{};goog.net.cookies=goog.net.cookies||{};goog.JsType_={UNDEFINED:"undefined"};goog.isDef=function(val){return typeof val!=goog.JsType_.UNDEFINED};goog.net.cookies.set=function(name,value,opt_maxAge,opt_path,opt_domain){if(/;=/g.test(name)){throw new Error('Invalid cookie name "'+name+'"')}if(/;/g.test(value)){throw new Error('Invalid cookie value "'+value+'"')}if(!goog.isDef(opt_maxAge)){opt_maxAge=-1}var domainStr=opt_domain?";domain="+opt_domain:"";var pathStr=opt_path?";path="+opt_path:"";var expiresStr;if(opt_maxAge<0){expiresStr=""}else{if(opt_maxAge==0){var pastDate=new Date(1970,1,1);expiresStr=";expires="+pastDate.toUTCString()}else{var futureDate=new Date((new Date).getTime()+opt_maxAge*1000);expiresStr=";expires="+futureDate.toUTCString()}}document.cookie=name+"="+value+domainStr+pathStr+expiresStr};goog.net.cookies.get=function(name,opt_default){var nameEq=name+"=";var cookie=String(document.cookie);for(var pos=-1;(pos=cookie.indexOf(nameEq,pos+1))>=0;){var i=pos;while(--i>=0){var ch=cookie.charAt(i);if(ch==";"){i=-1;break}}if(i==-1){var end=cookie.indexOf(";",pos);if(end<0){end=cookie.length}return cookie.substring(pos+nameEq.length,end)}}return opt_default};goog.net.cookies.remove=function(name,opt_path,opt_domain){var rv=goog.net.cookies.containsKey(name);goog.net.cookies.set(name,"",0,opt_path,opt_domain);return rv};goog.net.cookies.getKeyValues_=function(){var cookie=String(document.cookie);var parts=cookie.split(/\s*;\s*/);var keys=[],values=[],index,part;for(var i=0;part=parts[i];i++){index=part.indexOf("=");if(index==-1){keys.push("");values.push(part)}else{keys.push(part.substring(0,index));values.push(part.substring(index+1))}}return{keys:keys,values:values}};goog.net.cookies.getKeys=function(){return goog.net.cookies.getKeyValues_().keys};goog.net.cookies.getValues=function(){return goog.net.cookies.getKeyValues_().values};goog.net.cookies.isEmpty=function(){return document.cookie==""};goog.net.cookies.getCount=function(){var cookie=String(document.cookie);if(cookie==""){return 0}var parts=cookie.split(/\s*;\s*/);return parts.length};goog.net.cookies.containsKey=function(key){var sentinel={};return goog.net.cookies.get(key,sentinel)!==sentinel};goog.net.cookies.containsValue=function(value){var values=goog.net.cookies.getKeyValues_().values;for(var i=0;i<values.length;i++){if(values[i]==value){return true}}return false};goog.net.cookies.clear=function(){var keys=goog.net.cookies.getKeyValues_().keys;for(var i=keys.length-1;i>=0;i--){goog.net.cookies.remove(keys[i])}};goog.net.cookies.MAX_COOKIE_LENGTH=3950;;
;/* module-key = 'com.atlassian.gadgets.dashboard:gadget-dashboard-resources', location = 'js/gadgets-dashboard.js' */
gadgets.callAsyncAndJoin=function(functions,continuation,opt_this){var pending=functions.length;var results=[];for(var i=0;i<functions.length;i++){var wrapper=function(index){functions[index].call(opt_this,function(result){results[index]=result;if(--pending==0){continuation(results)}})};wrapper(i)}};gadgets.IfrGadgetService.prototype.setTitle=function(title){jQuery("#"+this.f+"-chrome .dashboard-item-title").text(title)};gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}AG.Cookie.save(this.f+"-fh",height);jQuery(AG).trigger("AG.iframeResize",[element,height])};gadgets.IfrGadgetService.prototype.setUserPref=function(editToken,name,value){var nameValues=Array.prototype.slice.call(arguments,1);AJS.$("#"+this.f).trigger("setUserPref",nameValues)};;
;/* module-key = 'com.atlassian.gadgets.dashboard:gadget-dashboard-resources', location = 'js/cookiebaseduserprefstore.js' */
gadgets.CookieBasedUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.CookieBasedUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.CookieBasedUserPrefStore.prototype.USER_PREFS_PREFIX="gadgetUserPrefs-";gadgets.CookieBasedUserPrefStore.prototype.getPrefs=function(gadget){var userPrefs={};var cookieName=this.USER_PREFS_PREFIX+gadget.id;var cookie=goog.net.cookies.get(cookieName);if(cookie){var pairs=cookie.split("&");for(var i=0;i<pairs.length;i++){var nameValue=pairs[i].split("=");var name=decodeURIComponent(nameValue[0]);var value=decodeURIComponent(nameValue[1]);userPrefs[name]=value}}return userPrefs};gadgets.CookieBasedUserPrefStore.prototype.savePrefs=function(gadget){var pairs=[];for(var name in gadget.getUserPrefs()){var value=gadget.getUserPref(name);var pair=encodeURIComponent(name)+"="+encodeURIComponent(value);pairs.push(pair)}var cookieName=this.USER_PREFS_PREFIX+gadget.id;var cookieValue=pairs.join("&");goog.net.cookies.set(cookieName,cookieValue)};gadgets.Container.prototype.userPrefStore=new gadgets.CookieBasedUserPrefStore();;
;/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/singleUserPicker.soy' */
// This file was automatically generated from singleUserPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.single = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<select id="', soy.$$escapeHtml(opt_data.field.id), '" name="', soy.$$escapeHtml(opt_data.field.name), '" class="single-user-picker js-', (opt_data.type) ? soy.$$escapeHtml(opt_data.type) : 'default-user-picker', '"', (opt_data.inputText) ? ' data-input-text="' + soy.$$escapeHtml(opt_data.inputText) + '"' : '', (opt_data.editValue) ? ' data-edit-value="' + soy.$$escapeHtml(opt_data.editValue) + '"' : '', (opt_data.showDropdownButton) ? ' data-show-dropdown-button="true"' : '', (opt_data.userType) ? ' data-user-type="' + soy.$$escapeHtml(opt_data.userType) + '"' : '', (opt_data.containerClass) ? ' data-container-class="' + soy.$$escapeHtml(opt_data.containerClass) + '"' : '', '>');
  var optionList38 = opt_data.options;
  var optionListLen38 = optionList38.length;
  for (var optionIndex38 = 0; optionIndex38 < optionListLen38; optionIndex38++) {
    var optionData38 = optionList38[optionIndex38];
    if (optionData38.optionGroup) {
      output.append('<optgroup id="', soy.$$escapeHtml(opt_data.field.id), '-group-', soy.$$escapeHtml(optionData38.id), '" label="', soy.$$escapeHtml(optionData38.display), '"', (optionData38.footer) ? ' data-footer-text="' + soy.$$escapeHtml(optionData38.footer) + '"' : '', (optionData38.weight != -1) ? ' data-weight="' + soy.$$escapeHtml(optionData38.weight) + '"' : '', '>');
      var groupOptionList59 = optionData38.groupOptions;
      var groupOptionListLen59 = groupOptionList59.length;
      for (var groupOptionIndex59 = 0; groupOptionIndex59 < groupOptionListLen59; groupOptionIndex59++) {
        var groupOptionData59 = groupOptionList59[groupOptionIndex59];
        JIRA.Templates.Fields.Pickers.User.option(groupOptionData59, output);
      }
      output.append('</optgroup>');
    } else {
      JIRA.Templates.Fields.Pickers.User.option(optionData38, output);
    }
  }
  output.append('</select>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.Pickers.User.option = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option ', (opt_data.loggedInUser) ? 'class="current-user" ' : '', (opt_data.selected) ? 'selected="selected" ' : '', 'value="', soy.$$escapeHtml(opt_data.optionName), '" data-field-text="', soy.$$escapeHtml(opt_data.displayName), '" data-field-label="', soy.$$escapeHtml(opt_data.displayName), (opt_data.optionName && opt_data.optionName != '-1') ? ' - ' + soy.$$escapeHtml(opt_data.emailAddress) + ' (' + soy.$$escapeHtml(opt_data.optionName) + ')' : '', '" data-icon="', soy.$$escapeHtml(opt_data.avatarURL), '" >', soy.$$escapeHtml(opt_data.displayName), '</option>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:field-templates', location = '/includes/jira/field/templates/assigneeField.soy' */
// This file was automatically generated from assigneeField.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }
if (typeof JIRA.Templates.Fields.Pickers == 'undefined') { JIRA.Templates.Fields.Pickers = {}; }
if (typeof JIRA.Templates.Fields.Pickers.User == 'undefined') { JIRA.Templates.Fields.Pickers.User = {}; }


JIRA.Templates.Fields.Pickers.User.assignee = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.Fields.Pickers.User.single(soy.$$augmentData(opt_data, {options: opt_data.assigneeOptions.options, showDropdownButton: true, userType: 'assignee', type: 'assignee-picker', containerClass: 'long-field'}), output);
  output.append((opt_data.isLoggedInUserAssignable) ? '<a href="#' + soy.$$escapeHtml(opt_data.field.id) + '" id="assign-to-me-trigger">' + soy.$$escapeHtml("Assign to me") + '</a>' : '', '<fieldset class="hidden parameters"><input type="hidden" title="projectKeys" value="', soy.$$escapeHtml(opt_data.projectKeys), '"/>', (opt_data.issueKey) ? '<input type="hidden" title="assigneeEditIssueKey" value="' + soy.$$escapeHtml(opt_data.issueKey) + '"/>' : '', (opt_data.actionDescriptorId) ? '<input type="hidden" title="actionDescriptorId" value="' + soy.$$escapeHtml(opt_data.actionDescriptorId) + '"/>' : '', '</fieldset>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/lib/jquery.dotdotdot-1.5.7.js' */
(function(i){if(i.fn.dotdotdot){return}i.fn.dotdotdot=function(v){if(this.length==0){if(!v||v.debug!==false){b(true,'No element found for "'+this.selector+'".')}return this}if(this.length>1){return this.each(function(){i(this).dotdotdot(v)})}var r=this;if(r.data("dotdotdot")){r.trigger("destroy.dot")}r.bind_events=function(){r.bind("update.dot",function(y,A){y.preventDefault();y.stopPropagation();t.maxHeight=(typeof t.height=="number")?t.height:o(r);t.maxHeight+=t.tolerance;if(typeof A!="undefined"){if(typeof A=="string"||A instanceof HTMLElement){A=i("<div />").append(A).contents()}if(A instanceof i){w=A}}s=r.wrapInner('<div class="dotdotdot" />').children();s.empty().append(w.clone(true)).css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var z=false,x=false;if(q.afterElement){z=q.afterElement.clone(true);q.afterElement.remove()}if(k(s,t)){if(t.wrap=="children"){x=d(s,t,z)}else{x=m(s,r,s,t,z)}}s.replaceWith(s.contents());s=null;if(i.isFunction(t.callback)){t.callback.call(r[0],x,w)}q.isTruncated=x;return x}).bind("isTruncated.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],q.isTruncated)}return q.isTruncated}).bind("originalContent.dot",function(y,x){y.preventDefault();y.stopPropagation();if(typeof x=="function"){x.call(r[0],w)}return w}).bind("destroy.dot",function(x){x.preventDefault();x.stopPropagation();r.unwatch().unbind_events().empty().append(w).data("dotdotdot",false)});return r};r.unbind_events=function(){r.unbind(".dot");return r};r.watch=function(){r.unwatch();if(t.watch=="window"){var z=i(window),y=z.width(),x=z.height();z.bind("resize.dot"+q.dotId,function(){if(y!=z.width()||x!=z.height()||!t.windowResizeFix){y=z.width();x=z.height();if(p){clearInterval(p)}p=setTimeout(function(){r.trigger("update.dot")},10)}})}else{u=j(r);p=setInterval(function(){var A=j(r);if(u.width!=A.width||u.height!=A.height){r.trigger("update.dot");u=j(r)}},100)}return r};r.unwatch=function(){i(window).unbind("resize.dot"+q.dotId);if(p){clearInterval(p)}return r};var w=r.contents(),t=i.extend(true,{},i.fn.dotdotdot.defaults,v),q={},u={},p=null,s=null;q.afterElement=c(t.after,r);q.isTruncated=false;q.dotId=l++;r.data("dotdotdot",true).bind_events().trigger("update.dot");if(t.watch){r.watch()}return r};i.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",lastCharacter:{remove:[" ",",",";",".","!","?"],noEllipsis:[]},tolerance:0,callback:null,after:null,height:null,watch:false,windowResizeFix:true,debug:false};var l=1;function d(s,w,v){var u=s.children(),p=false;s.empty();for(var r=0,q=u.length;r<q;r++){var t=u.eq(r);s.append(t);if(v){s.append(v)}if(k(s,w)){t.remove();p=true;break}else{if(v){v.remove()}}}return p}function m(s,r,A,t,q){var w=s.contents(),x=false;s.empty();var z="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, select, optgroup, option, textarea, script, style";for(var y=0,u=w.length;y<u;y++){if(x){break}var v=w[y],p=i(v);if(typeof v=="undefined"){continue}s.append(p);if(q){s[(s.is(z))?"after":"append"](q)}if(v.nodeType==3){if(k(A,t)){x=e(p,r,A,t,q)}}else{x=m(p,r,A,t,q)}if(!x){if(q){q.remove()}}}return x}function e(q,r,p,w,s){var D=false,A=q[0];if(typeof A=="undefined"){return false}var E=(w.wrap=="letter")?"":" ",t=h(A).split(E),F=-1,v=-1,G=0,y=t.length-1;while(G<=y){var x=Math.floor((G+y)/2);if(x==v){break}v=x;a(A,t.slice(0,v+1).join(E)+w.ellipsis);if(!k(p,w)){F=v;G=v}else{y=v}}if(F!=-1&&!(t.length==1&&t[0].length==0)){var u=f(t.slice(0,F+1).join(E),w);D=true;a(A,u)}else{var z=q.parent();q.remove();var C=(s)?s.length:0;if(z.contents().size()>C){var B=z.contents().eq(-1-C);D=e(B,r,p,w,s)}else{var A=z.prev().contents().eq(-1)[0];if(typeof A!="undefined"){var u=f(h(A),w);a(A,u);z.remove();D=true}}}return D}function k(q,p){return q.innerHeight()>p.maxHeight}function f(p,q){while(i.inArray(p.slice(-1),q.lastCharacter.remove)>-1){p=p.slice(0,-1)}if(i.inArray(p.slice(-1),q.lastCharacter.noEllipsis)<0){p+=q.ellipsis}return p}function j(p){return{width:p.innerWidth(),height:p.innerHeight()}}function a(q,p){if(q.innerText){q.innerText=p}else{if(q.nodeValue){q.nodeValue=p}else{if(q.textContent){q.textContent=p}}}}function h(p){if(p.innerText){return p.innerText}else{if(p.nodeValue){return p.nodeValue}else{if(p.textContent){return p.textContent}else{return""}}}}function c(p,q){if(typeof p=="undefined"){return false}if(!p){return false}if(typeof p=="string"){p=i(p,q);return(p.length)?p:false}if(typeof p=="object"){return(typeof p.jquery=="undefined")?false:p}return false}function o(s){var t=s.innerHeight(),r=["paddingTop","paddingBottom"];for(var u=0,q=r.length;u<q;u++){var p=parseInt(s.css(r[u]),10);if(isNaN(p)){p=0}t-=p}return t}function b(q,p){if(!q){return false}if(typeof p=="string"){p="dotdotdot: "+p}else{p=["dotdotdot:",p]}if(typeof window.console!="undefined"){if(typeof window.console.log!="undefined"){window.console.log(p)}}return false}var n=i.fn.html;i.fn.html=function(p){if(typeof p!="undefined"){if(this.data("dotdotdot")){if(typeof p!="function"){return this.trigger("update",[p])}}return n.call(this,p)}return n.call(this)};var g=i.fn.text;i.fn.text=function(q){if(typeof q!="undefined"){if(this.data("dotdotdot")){var p=i("<div />");p.text(q);q=p.html();p.remove();return this.trigger("update",[q])}return g.call(this,q)}return g.call(this)}})(jQuery);;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogController.js' */
JPT={};(function(){JPT.DialogControllerImpl=Class.extend({WELCOME_REST_URL:AJS.contextPath()+"/rest/welcome/1.0/show/welcome",initialize:function(){_.bindAll(this,"handleProjectTemplateTriggered","openWithSelectedProjectTemplate","hideDialogFromNewUser");if(AJS.Meta.getBoolean("show-welcome-screen")){this.handleProjectTemplateTriggered()}},handleProjectTemplateTriggered:function(){this.openWithSelectedProjectTemplate()},openWithSelectedProjectTemplate:function(b){if(b&&this.dialog){this.dialog.remove()}var a=JPT.SelectProjectTemplateController.loadProjectTemplatesData();a.fail(_.bind(function(c){if(c.status===401&&c.responseText.toLowerCase().indexOf("requires websudo")>=0){this._enableWebSudo()}else{this._handleUnknownErrorOfPTRetrieval()}},this));a.done(_.bind(function(c){this.dialog=JPT.DialogView.draw();this.$dialogElement=this.dialog.popup.element;var d;if(!_.isUndefined(JPT.ConfigModel)&&!_.isUndefined(JPT.ConfigModel.selectedTemplate)){d=JPT.ConfigModel.selectedTemplate}JPT.ConfigModel=c;JPT.ConfigModel.selectedTemplate=d;JPT.SelectProjectTemplateController.init(c.projectTemplates,b)},this))},addPage:function(c){var b=this.dialog.addPage(c.name).page[this.dialog.curpage];this.dialog.addHeader(c.title,"add-project-dialog-header");this.dialog.addPanel(c.panelName,"","pt-content");if(c.backButton){this._addBackButton(b)}this.dialog.addButton(c.submitButtonText,c.submitButtonCallback,c.submitButtonClass+" pt-submit-button");var a=this.$dialogElement.find("."+c.submitButtonClass);a.removeClass("button-panel-button").addClass("aui-button aui-button-primary");a.focus();this.dialog.addCancel("Cancel",_.bind(function(d){this.hideDialogFromNewUser("dismissed");this.dialog.remove()},this));return b},_addBackButton:function(b){this.dialog.addButton("Back",_.bind(function(){var c=JPT.DialogView.get$PTContent();c.css("background-image","none");this.dialog.prevPage();b.remove();this.dialog.page.pop()},this),"add-project-back-button");var a=this.$dialogElement.find(".add-project-back-button");a.removeClass("button-panel-button").addClass("aui-button")},_enableWebSudo:function(){JIRA.SmartAjax.showWebSudoDialog({success:_.bind(function(a){this.handleProjectTemplateTriggered();a()},this)})},_handleUnknownErrorOfPTRetrieval:function(){JPT.DialogView.draw();JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA")},hideDialogFromNewUser:function(a){if(AJS.Meta.getBoolean("show-welcome-screen")){AJS.$.ajax({url:this.WELCOME_REST_URL+"/"+a,type:"DELETE",success:function(){if(AJS.isDevMode&&AJS.isDevMode()){AJS.log("don't show project template dialog anymore")}}})}}});JPT.DialogController=new JPT.DialogControllerImpl()})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/DialogView.js' */
(function(){JPT.DialogViewImpl=Backbone.View.extend({events:{"click   .add-project-trigger":"_onClickAddProject","click   #add-project-dialog .import-project-trigger":"_onClickImportProject","keydown #add-project-dialog .pt-templates-list":"_onKeydownInTemplatesList"},draw:function(){var b=new AJS.Dialog({width:840,height:400,id:"add-project-dialog",closeOnOutsideClick:false,keypressListener:_.bind(this._onKeyPressed,this)});var c=b.popup.element;b.addPage("project-templates-page");b.addHeader("Select Project Type","add-project-dialog-header");b.addPanel("ProjectTemplatesListPanel",JIRA.Templates.ProjectTemplates.loadingTemplatesList(),"pt-content");this._dialog=b;this._$dialogElement=c;b.show();return b},remove:function(){this._dialog&&this._dialog.remove()},showErrorMessage:function(b){this._dialog.getPanel(1,0).html(JIRA.Templates.errorMsg({closable:false,msg:b}))},get$PTContent:function a(){return JPT.DialogController.$dialogElement.find(".pt-content")},_onKeyPressed:function(c){var b=27;if(this._dialog){if(c.keyCode===b){JPT.DialogController.hideDialogFromNewUser("dismissed");this._dialog.remove();return false}}return true},_onKeydownInTemplatesList:function(c){var b=13;if(this._dialog){if(c.keyCode===b){this._$dialogElement.find(".pt-submit-button:visible").click();return false}}return true},_onClickAddProject:function(b){b.preventDefault();JPT.DialogController.handleProjectTemplateTriggered()},_onClickImportProject:function(b){JPT.DialogController.hideDialogFromNewUser("importproject")}});JPT.DialogView=new JPT.DialogViewImpl({el:AJS.$(document)})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateController.js' */
JPT.SelectProjectTemplateController={};JPT.SelectProjectTemplateController.init=function init(b,a){JPT.DialogController.$dialogElement.hide();JPT.SelectProjectTemplateView.draw(b);if(a){var c=_.find(b,function(d){return d.itemModuleCompleteKey===a});if(!_.isUndefined(c)){JPT.SelectProjectTemplateController.openAddProjectPage(c)}else{JPT.DialogView.showErrorMessage("Unable to find the template you were redirected to.");JPT.SelectProjectTemplateView.disableNextButton()}}JPT.DialogController.$dialogElement.show();JPT.SelectProjectTemplateView.truncateTemplateDescriptions()};JPT.SelectProjectTemplateController.loadProjectTemplatesData=function loadProjectTemplatesData(){return AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"GET",timeout:5000})};JPT.SelectProjectTemplateController.dialogSubmitted=function dialogSubmitted(){var a=JPT.SelectProjectTemplateView.getSelectedTemplateData();JPT.DialogController.hideDialogFromNewUser("templateselected");JPT.SelectProjectTemplateController.raiseAtlassianEvent(a.itemModuleCompleteKey);if(!_.isUndefined(a.infoSoyPath)){JPT.TemplateInfoController=new JPT.TemplateInfoControllerImpl();JPT.TemplateInfoController.initTemplateInfo(a)}else{JPT.SelectProjectTemplateController.openAddProjectPage(a)}};JPT.SelectProjectTemplateController.openAddProjectPage=function openAddProjectPage(a){if(!a){JPT.DialogView.showErrorMessage("An error occurred while trying to contact JIRA");return}if(a.createProject){JPT.AddProjectController.initProjectTemplate(a)}else{JPT.DialogController.dialog.addPage("blank-template-page");AJS.$("body").trigger(a.itemModuleCompleteKey,JPT.DialogController.dialog)}};JPT.SelectProjectTemplateController.raiseAtlassianEvent=function raiseAtlassianEvent(a){JPT.ConfigModel.selectedTemplate=a;if(AJS.EventQueue){AJS.EventQueue.push({name:"projecttemplates.templateselected",properties:{selectedTemplate:a}})}};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/SelectProjectTemplateView.js' */
JPT.SelectProjectTemplateView={};JPT.SelectProjectTemplateView.ROW_LENGTH=2;JPT.SelectProjectTemplateView.draw=function draw(b){this.page=JPT.DialogController.addPage({name:"project-templates-page",title:"Select Project Type",panelName:"ProjectTemplatesListPanel",backButton:false,submitButtonText:"Next",submitButtonCallback:JPT.SelectProjectTemplateController.dialogSubmitted,submitButtonClass:"create-project-dialog-create-button"});JPT.DialogController.dialog.getPanel(this.page.id,0).html(JIRA.Templates.ProjectTemplates.renderList({projectTemplates:b}));if(JPT.ConfigModel.projectCount>=2){AJS.$(JIRA.Templates.ProjectTemplates.addWorkflowsLink({baseUrl:contextPath})).appendTo(JPT.DialogController.$dialogElement.find(".dialog-title"))}var c=JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button");JPT.DialogController.$dialogElement.find(".template").click(function(){var d=AJS.$(this);d.addClass("selected").siblings().removeClass("selected")}).dblclick(function(d){c.click()}).focus(function(){AJS.$(this).click()});var a=JPT.SelectProjectTemplateView.get$TemplatesContainer();AJS.$(JIRA.Templates.ProjectTemplates.importProjectLink({baseUrl:contextPath})).prependTo(JPT.DialogController.$dialogElement.find(".dialog-button-panel"));JPT.SelectProjectTemplateView.bindKeyboardEvents(a);if(b.length==0){c.attr("disabled","disabled")}JPT.SelectProjectTemplateView.focusOnFirstTemplate(a)};JPT.SelectProjectTemplateView.get$TemplatesContainer=function getTemplatesContainer(){return JPT.DialogController.$dialogElement.find(".templates")};JPT.SelectProjectTemplateView.focusOnFirstTemplate=function focusOnFirstTemplate(a){JPT.DialogController.$dialogElement.find(".template:first-child").click();setTimeout(function(){a.focus()},0)};JPT.SelectProjectTemplateView.getSelectedTemplateData=function getSelectedTemplateData(){var a=JPT.DialogController.$dialogElement.find(".template.selected");return a.data()};JPT.SelectProjectTemplateView.getMoveDeltaForKey=function(a){switch(a){case 37:return -1;case 39:return +1;case 38:return -JPT.SelectProjectTemplateView.ROW_LENGTH;case 40:return +JPT.SelectProjectTemplateView.ROW_LENGTH}return 0};JPT.SelectProjectTemplateView.bindKeyboardEvents=function(a){a.bind("keydown",function(b){var c=JPT.SelectProjectTemplateView.getMoveDeltaForKey(b.which);if(c){JPT.SelectProjectTemplateView.moveSelection(a,c);return AJS.stopEvent(b)}})};JPT.SelectProjectTemplateView.moveSelection=function(c,f){var b=c.find(".template");var e=b.filter(".selected");var d=b.index(e)+f;if(d<b.length&&d>=0){var a=b.eq(d);a.click().focus();JPT.SelectProjectTemplateView.scrollToSelectedElement(a)}};JPT.SelectProjectTemplateView.scrollToSelectedElement=function scrollToSelectedElement(c){var f=AJS.$(".dialog-panel-body.pt-content");var a=f.offset().top;var b=c.offset().top;var e=b+c.height();var d=a+f.height();if(b<a){f.scrollTop(f.scrollTop()-(a-b))}else{if(e>(a+f.height())){f.scrollTop(f.scrollTop()+e-d)}}};JPT.SelectProjectTemplateView.get$NextButton=function getNextButton(){return JPT.DialogController.$dialogElement.find(".create-project-dialog-create-button")};JPT.SelectProjectTemplateView.disableNextButton=function disableNextButton(){JPT.SelectProjectTemplateView.get$NextButton().attr("disabled","disabled")};JPT.SelectProjectTemplateView.truncateTemplateDescriptions=function truncateTemplateDescriptions(){var a=AJS.Meta.get("user-locale");var b="word";if(a==="ja_JP"){b="letter"}JPT.DialogController.$dialogElement.find(".template-description").each(function(){AJS.$(this).dotdotdot({wrap:b,lastCharacter:{remove:[" ",",",";",".","!","?","。"],noEllipsis:[]}})})};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/ProjectTemplatesList.soy' */
// This file was automatically generated from ProjectTemplatesList.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.renderList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.projectTemplates.length == 0) {
    JIRA.Templates.errorMsg({closeable: false, msg: "No project templates could be found."}, output);
  } else {
    output.append('<div class="pt-templates-list">');
    JIRA.Templates.ProjectTemplates.renderItems(opt_data, output);
    output.append('</div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.renderItems = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol class="templates" tabindex="100">');
  var templateList15 = opt_data.projectTemplates;
  var templateListLen15 = templateList15.length;
  for (var templateIndex15 = 0; templateIndex15 < templateListLen15; templateIndex15++) {
    var templateData15 = templateList15[templateIndex15];
    output.append('<li class="template"', (templateData15.itemModuleCompleteKey) ? 'data-item-module-complete-key="' + soy.$$escapeHtml(templateData15.itemModuleCompleteKey) + '"' : '', (templateData15.projectTemplateModuleCompleteKey) ? 'data-project-template-module-complete-key="' + soy.$$escapeHtml(templateData15.projectTemplateModuleCompleteKey) + '"' : '', (templateData15.createProject) ? 'data-create-project="' + soy.$$escapeHtml(templateData15.createProject) + '"' : '', (templateData15.backgroundIconUrl) ? 'data-background-icon-url="' + soy.$$escapeHtml(templateData15.backgroundIconUrl) + '"' : '', (templateData15.name) ? 'data-name="' + soy.$$escapeHtml(templateData15.name) + '"' : '', (templateData15.description) ? 'data-description="' + soy.$$escapeHtml(templateData15.description) + '"' : '', (templateData15.longDescriptionContent) ? 'data-long-description-content="' + soy.$$escapeHtml(templateData15.longDescriptionContent) + '"' : '', (templateData15.infoSoyPath) ? 'data-info-soy-path="' + soy.$$escapeHtml(templateData15.infoSoyPath) + '"' : '', '><img class="template-preview" src="', soy.$$escapeHtml(templateData15.iconUrl), '" /><div class="template-meta"><div class="template-name" title="', soy.$$escapeHtml(templateData15.name), '">', soy.$$escapeHtml(templateData15.name), '</div><div class="template-description" title="', soy.$$escapeHtml(templateData15.description), '">', soy.$$escapeHtml(templateData15.description), '</div></div></li>');
  }
  output.append('</ol>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.loadingTemplatesList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="wait-container"><img class="wait-icon" src="', soy.$$escapeHtml(""), '/images/icons/wait.gif"><span class="wait-text">', soy.$$escapeHtml("Loading project templates"), '&hellip;</span></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.importProjectLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="import-project-trigger button-panel-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/secure/admin/views/ExternalImport1.jspa" tabindex="-1">', soy.$$escapeHtml("Import from external system"), '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.addWorkflowsLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="add-workflow-link" href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/wfshare-import?src=projecttemplates" tabindex="-1">', soy.$$escapeHtml("View Marketplace Workflows"), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoController.js' */
(function(){JPT.TemplateInfoControllerImpl=Class.extend({init:function(a){_.bindAll(this,"initTemplateInfo","next")},initTemplateInfo:function(a){this.projectTemplateData=a;JPT.TemplateInfoView=new JPT.TemplateInfoViewImpl();JPT.TemplateInfoView.draw(a.infoSoyPath,a.name)},next:function(){JPT.SelectProjectTemplateController.openAddProjectPage(this.projectTemplateData)}})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/TemplateInfoView.js' */
(function(){JPT.TemplateInfoViewImpl=Backbone.View.extend({initialize:function(a){_.bindAll(this,"draw","onNext")},draw:function(c,b){var d=JPT.DialogController.addPage({name:"template-info",title:b,panelName:"template-info",backButton:true,submitButtonText:"Select",submitButtonCallback:this.onNext,submitButtonClass:"template-info-dialog-create-button"});var a=this._nameToObj(c)();JPT.DialogController.dialog.getPanel(d.id,0).html(a);JPT.DialogController.dialog.gotoPage(d.id)},_nameToObj:function(a){return _.reduce(a.split("."),function(c,b){if(c){return c[b]}},window)},onNext:function(a){JPT.TemplateInfoController.next();return false}})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectController.js' */
(function(){JPT.AddProjectControllerImpl=Class.extend({postProjectCreationCallbacks:[],projectKeyValidationCallbacks:[],projectNamesUpperCased:[],init:function(g){this._window=g.window||window;_.bindAll(this,"projectCreatedHandler","projectValidationFailedHandler","nameTimeout","keyTimeout","submit")},initProjectTemplate:function(g){this.desiredKeyLength=4;this.lastKeyValidated="";this._getExistingProjects();JPT.ProjectKeyGenerator.init(this.desiredKeyLength,JPT.ConfigModel.maxKeyLength);this.webItemData=g;JPT.AddProjectView.prepareDialog(g.name);JPT.AddProjectView.draw({webItemData:this.webItemData,maxKeyLength:JPT.ConfigModel.maxKeyLength,maxNameLength:JPT.ConfigModel.maxNameLength,currentUserName:JPT.ConfigModel.currentUserName,currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl,errors:{}})},_resetProjectLeadValues:function(){JPT.ConfigModel.currentUserDisplayName="";JPT.ConfigModel.currentUserName="";JPT.ConfigModel.currentUserAvatarUrl=""},_hasFullyConfiguredProjectLead:function(){return JPT.AddProjectView.getLeadDisplayName()&&JPT.AddProjectView.getAvatarUrlOfSelectedLead()!=""},submit:function(g){var h=JPT.AddProjectView.getAddProjectForm().serialize();if(JPT.AddProjectView.hasInlineErrors()){return}if(JPT.AddProjectView.enterLoadingState()){if(this._hasFullyConfiguredProjectLead()){JPT.ConfigModel.currentUserDisplayName=JPT.AddProjectView.getLeadDisplayName();JPT.ConfigModel.currentUserName=JPT.ConfigModel.currentUserDisplayName?JPT.AddProjectView.getLeadUserName():"";JPT.ConfigModel.currentUserAvatarUrl=JPT.AddProjectView.getAvatarUrlOfSelectedLead()}else{this._resetProjectLeadValues()}var i=AJS.$.ajax({url:contextPath+"/rest/project-templates/1.0/templates",type:"POST",data:h,timeout:50000,headers:{"X-Atlassian-Token":"nocheck"}});i.then(this.projectCreatedHandler,this.projectValidationFailedHandler)}},registerPostProjectCreationCallback:function(g){this.postProjectCreationCallbacks.push(g)},registerProjectKeyValidationCallback:function(g){this.projectKeyValidationCallbacks.push(g)},localStoragePrefix:"jira.projecttemplates.",projectCreatedHandler:function(h){JPT.AddProjectView.avoidDirtyFormWarning();var g=this.localStoragePrefix;var i=["confluenceProject","fisheyeProject","crucibleProject","bambooProject"];_.map(i,function(j){if(h.remoteProjectLinks[j]){localStorage.setItem(g+j,h.remoteProjectLinks[j])}});if(!_.isEmpty(this.postProjectCreationCallbacks)){JPT.DialogController.dialog.addPage("post-project-created-page");_.each(this.postProjectCreationCallbacks,function(j){j(JPT.DialogController.dialog,h.returnUrl,h.projectId,h.projectKey,h.projectName)})}else{this._window.location=contextPath+h.returnUrl}},projectValidationFailedHandler:function(h,j){var i={};if(h.status===400){i=JSON.parse(h.responseText)}else{if(h.status===500&&!_.isUndefined(JSON.parse(h.responseText).message)){var g=JSON.parse(h.responseText);JIRA.Messages.showReloadErrorMsg(g.message);JPT.AddProjectView.avoidDirtyFormWarning();this._window.location=contextPath+g.returnUrl;return}else{if(j==="timeout"){i={errorMessages:["Request timeout when creating project"]}}else{i={errorMessages:[AJS.format("Error creating project, {0}",h.responseText)]}}}}JPT.AddProjectView.draw({webItemData:this.webItemData,errors:i,currentName:JPT.AddProjectView.getName(),currentKey:JPT.AddProjectView.getKey(),currentUserDisplayName:JPT.ConfigModel.currentUserDisplayName,currentUserName:JPT.ConfigModel.currentUserName,currentUserAvatarUrl:JPT.ConfigModel.currentUserAvatarUrl});JPT.AddProjectView.hideLoadingState()},_updateAndValidateKey:function e(g){JPT.AddProjectView.setKey(g);this._validateKey()},_shouldUpdateKey:function d(){return(JPT.AddProjectView.getKeyEdited()!="true")},autofillKeyIfNeeded:function b(){if(this._shouldUpdateKey()){var g=JPT.ProjectKeyGenerator.generate(JPT.AddProjectView.getName());if(g.length>1){this._updateAndValidateKey(g)}else{JPT.AddProjectView.setKey("")}}},_doesProjectNameExists:function(h){var g;for(g in this.projectNamesUpperCased){if(h.toUpperCase()==this.projectNamesUpperCased[g]){return true}}return false},_validateName:function(){var g=AJS.$.trim(JPT.AddProjectView.getName());if(!g){return}if(g.length<JPT.ConfigModel.minNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name should be at least {0} characters in length.",JPT.ConfigModel.minNameLength));return}if(g.length>JPT.ConfigModel.maxNameLength){JPT.AddProjectView.showInlineErrorForName(AJS.format("The project name must not exceed {0} characters in length.",JPT.ConfigModel.maxNameLength));return}if(this._doesProjectNameExists(g)){JPT.AddProjectView.showInlineErrorForName("A project with that name already exists.");return}JPT.AddProjectView.hideInlineErrorForName()},_performKeyValidationChecks:function(g){var h=AJS.$.ajax({url:contextPath+"/rest/api/latest/projectvalidate/key?key="+g.toUpperCase(),timeout:5000});h.done(_.bind(function(j){if(j.errors&&j.errors.projectKey){JPT.AddProjectView.showInlineErrorForKey(j.errors.projectKey)}else{var i=false;_.each(this.projectKeyValidationCallbacks,function(l){var k=l(g.toUpperCase());if(k.errors&&k.errors.projectKey){i=true;JPT.AddProjectView.showInlineErrorForKey(k.errors.projectKey)}});if(!i){JPT.AddProjectView.hideInlineErrorForKey()}}},this))},_validateKey:function a(){var g=JPT.AddProjectView.getKey();if(this.lastKeyValidated===g){return}if(g){this.lastKeyValidated=g;this._performKeyValidationChecks(g)}else{JPT.AddProjectView.hideInlineErrorForKey()}},nameTimeout:function c(){this._validateName();this.autofillKeyIfNeeded()},keyTimeout:function f(){JPT.AddProjectView.setKeyEdited();this._validateKey()},_getExistingProjects:function(){if(this.projectNamesUpperCased.length>0){return this.projectNamesUpperCased}var g=AJS.$.ajax({url:contextPath+"/rest/api/latest/project",timeout:5000});g.done(_.bind(function(h){this.projectNamesUpperCased=_.map(h,function(i){return i.name.toUpperCase()})},this))}});JPT.AddProjectController=new JPT.AddProjectControllerImpl({el:AJS.$(document)})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/AddProjectView.js' */
(function(){JPT.AddProjectViewImpl=Backbone.View.extend({TIMEOUT_MS:100,postDrawCallbacks:[],events:{"submit #add-project-form":"onSubmitForm"},page:undefined,isSubmitting:false,initialize:function(w){_.bindAll(this,"bindHook")},addPostDrawCallback:function(w){this.postDrawCallbacks.push(w)},prepareDialog:function(w){this.page=JPT.DialogController.addPage({name:"add-project",title:w,panelName:"add-project",backButton:true,submitButtonText:"Submit",submitButtonCallback:this.onSubmitForm.bind(this),submitButtonClass:"add-project-dialog-create-button"})},draw:function(C){function B(D){if(!D.errors){D.errors={}}return D}this.isSubmitting=false;JPT.DialogController.dialog.gotoPage(this.page.id);var z={maxNameLength:JPT.ConfigModel.maxNameLength,maxKeyLength:JPT.ConfigModel.maxKeyLength,shouldShowLead:JPT.ConfigModel.shouldShowProjectLead,projectTemplateWebItemKey:JPT.ConfigModel.selectedTemplate||C.webItemData.itemModuleCompleteKey,projectTemplateModuleKey:C.webItemData.projectTemplateModuleCompleteKey,projectTemplateTitle:C.webItemData.name,projectTemplateDescriptionContent:C.webItemData.longDescriptionContent||C.webItemData.description,currentKey:C.currentKey||"",currentName:C.currentName||"",errors:B(C.errors),projectLeadPickerField:{id:"lead",name:"lead"},leadOptions:[{selected:true,displayName:C.currentUserDisplayName,optionName:C.currentUserName,avatarURL:C.currentUserAvatarUrl}]};var x=JIRA.Templates.ProjectTemplates.addProjectForm(z);JPT.DialogController.dialog.getPanel(this.page.id,0).html(x);if(C.webItemData.backgroundIconUrl){var w=JPT.DialogController.$dialogElement.find(".pt-content");w.css("background-image",'url("'+C.webItemData.backgroundIconUrl+'")')}var y=AJS.$("#add-project-form");JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[y]);this.nameElement=JPT.DialogController.$dialogElement.find("#name");this.keyElement=JPT.DialogController.$dialogElement.find("#key");this.keyEditedElement=JPT.DialogController.$dialogElement.find("#keyEdited");this.leadDisplayElement=JPT.DialogController.$dialogElement.find("#lead-field");this.leadValueElement=JPT.DialogController.$dialogElement.find("#lead");var A=this.keyElement.parent().find(".aui-icon-help");if(A.length){new AJS.InlineDialog(A,"project-key-help-popup",function(F,E,D){F.html(JIRA.Templates.ProjectTemplates.keyHelp());D()},{width:330,offsetX:-30})}this.keyElement.attr("style","text-transform: uppercase");this.nameElement.focus(_.bind(function(D){this.bindHook(D,JPT.AddProjectController.nameTimeout)},this));this.nameElement.blur(function(D){JPT.AddProjectView.unbindHook(D)});this.nameElement.focus();this.keyElement.focus(_.bind(function(E){var D=AJS.$(E.target);D.data("lastValue",D.val());this.bindHook(E,JPT.AddProjectController.keyTimeout)},this));this.keyElement.blur(_.bind(function(D){this.unbindHook(D)},this));this.keyElement.blur(function(){JPT.AddProjectController.autofillKeyIfNeeded()});if(!_.isEmpty(this.postDrawCallbacks)){_.each(this.postDrawCallbacks,function(D){D()})}},onSubmitForm:function(w){JPT.AddProjectController.submit();return false},get$SubmitButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-dialog-create-button")},get$BackButton:function(){return JPT.DialogController.$dialogElement.find(".add-project-back-button")},bindHook:function j(z,x){var w=AJS.$(z.target),y;y=_.bind(function(){this.unbindHook(z);x.apply();if(w.is(":visible")){w.data("checkHook",setTimeout(y,this.TIMEOUT_MS))}},this);if(!w.data("checkHook")){w.data("checkHook",setTimeout(y,0))}},unbindHook:function(x){var w=AJS.$(x.target);clearTimeout(w.data("checkHook"));w.removeData("checkHook")},showInlineError:function(x,y){if(this.isSubmitting){return}var w=x.parent().find(".error");if(!w.length){w=AJS.$("<div class='error'></div>");x.parent().append(w)}w.text(y);w.show()},showInlineErrorForName:function v(w){this.showInlineError(this.nameElement,w)},showInlineErrorForKey:function s(w){this.showInlineError(this.keyElement,w)},hideInlineError:function r(w){w.parent().find(".error").hide()},hideInlineErrorForName:function b(){this.hideInlineError(this.nameElement)},hideInlineErrorForKey:function n(){this.hideInlineError(this.keyElement)},setName:function f(w){this.nameElement.val(w)},getName:function m(){return this.nameElement.val()},setKey:function c(w){this.keyElement.val(w)},getKey:function k(){return this.keyElement.val()},getLeadDisplayName:function o(){return this.leadDisplayElement.val()},getLeadUserName:function p(){return this.leadValueElement.val()},getAvatarUrlOfSelectedLead:function l(){var w=JPT.DialogController.$dialogElement.find("#lead-single-select .aui-ss-entity-icon").css("background-image");if(!_.isUndefined(w)){var x=w.match(/^url\((.+)\)$/);return(x&&x[1])?x[1]:""}else{return""}},setKeyEdited:function i(w){this.keyEditedElement.val(w)},getKeyEdited:function t(){return this.keyEditedElement.val()},setKeyEdited:function i(){var w=this.getKey();if(this.keyElement.data("lastValue")!==w){this.keyEditedElement.val((w)?"true":"false")}this.keyElement.data("lastValue",w)},hasNameErrors:function d(){return this.nameElement.parent().find(".error").size()>0},getAddProjectForm:function e(){return AJS.$("#add-project-form")},get$FormFields:function h(){return JPT.DialogController.$dialogElement.find(":input")},enterLoadingState:function g(){$submitButton=this.get$SubmitButton();if(!$submitButton.attr("disabled")){$backButton=this.get$BackButton();$submitButton.attr("disabled","disabled");$backButton.attr("disabled","disabled");$backButton.before(JIRA.Templates.ProjectTemplates.spinner({id:"addproject-loading"}));this.get$FormFields().attr("disabled","disabled");this.isSubmitting=true;return true}else{return false}},hideLoadingState:function q(){JPT.DialogController.$dialogElement.find("#addproject-loading").remove();this.get$SubmitButton().removeAttr("disabled");this.get$BackButton().removeAttr("disabled");this.get$FormFields().removeAttr("disabled")},avoidDirtyFormWarning:function a(){if(jQuery.fn.removeDirtyWarning){this.getAddProjectForm().removeDirtyWarning()}},hasInlineErrors:function u(){return JPT.DialogController.$dialogElement.find(".error:visible").length!=0}});JPT.AddProjectView=new JPT.AddProjectViewImpl({el:AJS.$(document),dialogView:JPT.DialogView})})();;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/soy/AddProject.soy' */
// This file was automatically generated from AddProject.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }


JIRA.Templates.ProjectTemplates.addProjectForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.errorMessages) {
    var errorList5 = opt_data.errors.errorMessages;
    var errorListLen5 = errorList5.length;
    for (var errorIndex5 = 0; errorIndex5 < errorListLen5; errorIndex5++) {
      var errorData5 = errorList5[errorIndex5];
      JIRA.Templates.errorMsg({closeable: false, msg: errorData5}, output);
    }
  }
  output.append('<div class="add-project-wrapper"><div class="add-project-form-wrapper">');
  var param11 = new soy.StringBuilder();
  var param13 = new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.longTextField({id: 'name', name: 'name', isRequired: false, maxLength: opt_data.maxNameLength, labelContent: "Name", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxNameLength), value: opt_data.currentName ? opt_data.currentName : '', errorTexts: opt_data.errors.errors.projectName ? [opt_data.errors.errors.projectName] : []}, param13);
  JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon({id: 'key', name: 'key', isRequired: false, maxLength: opt_data.maxKeyLength, labelContent: "Key", descriptionText: AJS.format("Max. {0} characters.",opt_data.maxKeyLength), helpTitle: "What\x27s a project key?", value: opt_data.currentKey ? opt_data.currentKey : '', errorTexts: opt_data.errors.errors.projectKey ? [opt_data.errors.errors.projectKey] : []}, param13);
  if (opt_data.shouldShowLead) {
    JIRA.Templates.ProjectTemplates.projectLeadField({field: opt_data.projectLeadPickerField, isRequired: false, errorTexts: opt_data.errors.errors.projectLead ? [opt_data.errors.errors.projectLead] : [], options: opt_data.leadOptions}, param13);
  }
  param13.append('<input type="hidden" name="keyEdited" id="keyEdited" value="false"><input type="hidden" name="projectTemplateWebItemKey" value="', soy.$$escapeHtml(opt_data.projectTemplateWebItemKey), '"><input type="hidden" name="projectTemplateModuleKey" value="', soy.$$escapeHtml(opt_data.projectTemplateModuleKey), '"><input type="submit" class="pt-hidden-submit offscreen-left">');
  aui.form.fieldset({legendContent: '', content: param13.toString()}, param11);
  aui.form.form({content: param11.toString(), id: 'add-project-form'}, output);
  output.append('</div>', (opt_data.projectTemplateDescriptionContent) ? '<div class="add-project-description-wrapper"><div class="project-template-title"><h3>' + soy.$$escapeHtml(opt_data.projectTemplateTitle) + '</h3></div><div class="project-template-description">' + opt_data.projectTemplateDescriptionContent + '</div></div>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.keyHelp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-key-help"><p><b>', soy.$$escapeHtml("What\x27s a project key?"), '</b></p><ul><li>', soy.$$escapeHtml("It prefixes each issue in the project"), '</li><li>', soy.$$escapeHtml("It can be changed, but this is not a trivial task"), '</li></ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.projectLeadField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param67 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.field.name + '-field', isRequired: opt_data.isRequired, content: "Project Lead"}, param67);
  JIRA.Templates.Fields.Pickers.User.single({field: opt_data.field, options: opt_data.options, editValue: opt_data.value}, param67);
  aui.form.fieldDescription({message: "Enter the username of the Project Lead."}, param67);
  if (opt_data.errorTexts) {
    var errorList80 = opt_data.errorTexts;
    var errorListLen80 = errorList80.length;
    for (var errorIndex80 = 0; errorIndex80 < errorListLen80; errorIndex80++) {
      var errorData80 = errorList80[errorIndex80];
      aui.form.fieldError({message: errorData80}, param67);
    }
  }
  aui.form.fieldGroup({content: param67.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.textFieldWithHelpIcon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param86 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param86);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value}, param86);
  param86.append('<a class="help-lnk" title="', soy.$$escapeHtml(opt_data.helpTitle), '" id="', soy.$$escapeHtml(opt_data.id), '-help-icon"><span class="aui-icon aui-icon-help">', soy.$$escapeHtml(opt_data.helpTitle), '</span></a>');
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param86);
  }
  if (opt_data.errorTexts) {
    var errorList110 = opt_data.errorTexts;
    var errorListLen110 = errorList110.length;
    for (var errorIndex110 = 0; errorIndex110 < errorListLen110; errorIndex110++) {
      var errorData110 = errorList110[errorIndex110];
      aui.form.fieldError({message: errorData110}, param86);
    }
  }
  aui.form.fieldGroup({content: param86.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.longTextField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param116 = new soy.StringBuilder();
  aui.form.label({forField: opt_data.name, isRequired: opt_data.isRequired, content: opt_data.labelContent}, param116);
  aui.form.input({id: opt_data.id, name: opt_data.name, type: 'text', maxLength: opt_data.maxLength, value: opt_data.value, extraClasses: 'long-field'}, param116);
  if (opt_data.descriptionText) {
    aui.form.fieldDescription({message: opt_data.descriptionText}, param116);
  }
  if (opt_data.errorTexts) {
    var errorList134 = opt_data.errorTexts;
    var errorListLen134 = errorList134.length;
    for (var errorIndex134 = 0; errorIndex134 < errorListLen134; errorIndex134++) {
      var errorData134 = errorList134[errorIndex134];
      aui.form.fieldError({message: errorData134}, param116);
    }
  }
  aui.form.fieldGroup({content: param116.toString()}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.spinner = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span id=\'', soy.$$escapeHtml(opt_data.id), '\' class=\'icon throbber loading\'/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.formatAnchor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.href), '"', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', '>', soy.$$escapeHtml(opt_data.body), '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/ProjectKeyGenerator.js' */
JPT.ProjectKeyGenerator={};JPT.ProjectKeyGenerator.IGNORED_WORDS=["THE","A","AN","AS","AND","OF","OR"];JPT.ProjectKeyGenerator.CHARACTER_MAP={};JPT.ProjectKeyGenerator.CHARACTER_MAP[199]="C";JPT.ProjectKeyGenerator.CHARACTER_MAP[231]="c";JPT.ProjectKeyGenerator.CHARACTER_MAP[252]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[251]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[250]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[249]="u";JPT.ProjectKeyGenerator.CHARACTER_MAP[233]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[234]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[235]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[232]="e";JPT.ProjectKeyGenerator.CHARACTER_MAP[226]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[228]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[224]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[229]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[225]="a";JPT.ProjectKeyGenerator.CHARACTER_MAP[239]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[238]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[236]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[237]="i";JPT.ProjectKeyGenerator.CHARACTER_MAP[196]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[197]="A";JPT.ProjectKeyGenerator.CHARACTER_MAP[201]="E";JPT.ProjectKeyGenerator.CHARACTER_MAP[230]="ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[198]="Ae";JPT.ProjectKeyGenerator.CHARACTER_MAP[244]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[246]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[242]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[243]="o";JPT.ProjectKeyGenerator.CHARACTER_MAP[220]="U";JPT.ProjectKeyGenerator.CHARACTER_MAP[255]="Y";JPT.ProjectKeyGenerator.CHARACTER_MAP[214]="O";JPT.ProjectKeyGenerator.CHARACTER_MAP[241]="n";JPT.ProjectKeyGenerator.CHARACTER_MAP[209]="N";JPT.ProjectKeyGenerator.desiredKeyLength=4;JPT.ProjectKeyGenerator.maxKeyLength=10;JPT.ProjectKeyGenerator.getTotalLength=function getTotalLength(a){return a.join("").length};JPT.ProjectKeyGenerator.removeIgnoredWords=function removeIgnoredWords(a){return _.reject(a,function(b){return AJS.$.inArray(b,JPT.ProjectKeyGenerator.IGNORED_WORDS)!==-1})};JPT.ProjectKeyGenerator.createAcronym=function createAcronym(b){var a="";AJS.$.each(b,function(c,d){a+=d.charAt(0)});return a};JPT.ProjectKeyGenerator.getFirstSyllable=function getFirstSyllable(c){var b=false;var a;for(a=0;a<c.length;a++){if(JPT.ProjectKeyGenerator.isVowelOrY(c[a])){b=true}else{if(b){return c.substring(0,a+1)}}}return c};JPT.ProjectKeyGenerator.isVowelOrY=function isVowelOrY(a){return a&&a.length===1&&a.search("[AEIOUY]")!==-1};JPT.ProjectKeyGenerator.init=function init(b,a){JPT.ProjectKeyGenerator.desiredKeyLength=b;JPT.ProjectKeyGenerator.maxKeyLength=a};JPT.ProjectKeyGenerator.generate=function generate(b){b=AJS.$.trim(b);if(!b){return""}var a=[];for(var d=0,f=b.length;d<f;d++){var e=JPT.ProjectKeyGenerator.CHARACTER_MAP[b.charCodeAt(d)];a.push(e?e:b[d])}b=a.join("");var h=[];AJS.$.each(b.split(/\s+/),function(j,k){if(k){k=k.replace(/[^a-zA-Z]/g,"");k=k.toUpperCase();k.length&&h.push(k)}});if(JPT.ProjectKeyGenerator.desiredKeyLength&&JPT.ProjectKeyGenerator.getTotalLength(h)>JPT.ProjectKeyGenerator.desiredKeyLength){h=JPT.ProjectKeyGenerator.removeIgnoredWords(h)}var c;if(h.length==0){c=""}else{if(h.length==1){var g=h[0];if(JPT.ProjectKeyGenerator.desiredKeyLength&&g.length>JPT.ProjectKeyGenerator.desiredKeyLength){c=JPT.ProjectKeyGenerator.getFirstSyllable(g)}else{c=g}}else{c=JPT.ProjectKeyGenerator.createAcronym(h)}}if(JPT.ProjectKeyGenerator.maxKeyLength&&c.length>JPT.ProjectKeyGenerator.maxKeyLength){c=c.substr(0,JPT.ProjectKeyGenerator.maxKeyLength)}return c};;
;/* module-key = 'com.atlassian.jira.project-templates-plugin:project-templates-plugin-resources', location = '/js/RemoteProjectsCreatedMessage.js' */
AJS.$(function(){var b=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");var h=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");var f=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");var d=localStorage.getItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"confluenceProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"fisheyeProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"crucibleProject");localStorage.removeItem(JPT.AddProjectController.localStoragePrefix+"bambooProject");var i;function c(k,j){return JIRA.Templates.ProjectTemplates.formatAnchor({href:k,body:j,title:j})}function a(l,m,k,n){var j=[];j.push("a JIRA project");if(l){j.push(c(l,"a Confluence space"))}if(m){j.push(c(m,"a FishEye repository"))}if(k){j.push(c(k,"a Crucible project"))}if(n){j.push(c(n,"a Bamboo project"))}return j}function g(k,m,j,p){var o="The following entities were created: {0} and {1}.";var l=a(k,m,j,p);var n=l.pop();return(l.length>0)?AJS.format(o,l.join(", "),n):null}function e(j){var k=AJS.$(j).offset();if(k){window.scrollTo(k.left,k.top)}}if(b||h||f||d){i=g(b,h,f,d);if(i){JIRA.Messages.showSuccessMsg(i,{closeable:true})}e("#project-config-webpanel-summary-settings")}});;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/lib/ajaxHooks/xdr.js' */
if(window.XDomainRequest){jQuery.ajaxTransport(function(b){if(b.crossDomain&&b.async){if(b.timeout){b.xdrTimeout=b.timeout;delete b.timeout}var a;return{send:function(d,c){function e(f,i,h,g){a.onload=a.onerror=a.ontimeout=jQuery.noop;a=undefined;c(f,i,h,g)}a=new XDomainRequest();a.onload=function(){e(200,"OK",{text:a.responseText},"Content-Type: "+a.contentType)};a.onerror=function(){e(404,"Not Found")};a.onprogress=jQuery.noop;a.ontimeout=function(){e(0,"timeout")};a.timeout=b.xdrTimeout||Number.MAX_VALUE;a.open(b.type,b.url);a.send((b.hasContent&&b.data)||null)},abort:function(){if(a){a.onerror=jQuery.noop;a.abort()}}}}})};;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/js/project-creation.js' */
ATLAS_PROJECT_CREATE={};(function(x){AJS.EventQueue=AJS.EventQueue||[];var u="jira.project";var G={"confluence.space":30,"bamboo.project":20,"ondemand.svn-repository":10};ATLAS_PROJECT_CREATE.getFilteredRootTypes=function C(L){var N={};for(var M in L.types){if(M!==u){N[M]=L.types[M]}}return N};ATLAS_PROJECT_CREATE.loadRemoteRoots=function p(L){var N=jQuery.Deferred(),O=[],M=[];t(L,function(P){var Q=P.capabilitiesUrl;return AJS.$.ajax(Q+"/aggregate-root",{success:function(R){var S=ATLAS_PROJECT_CREATE.getFilteredRootTypes(R);O=O.concat(_.map(S,function(U,T){return AJS.$.ajax(U.href,{xhrFields:{withCredentials:true},success:function(V){M.push(ATLAS_PROJECT_CREATE.constructFullRootType(V,U.label,T,Q,P.id))},error:function(X,V,W){AJS.log("Got "+W+" from aggregate root type "+U.href)}}).promise()}))},error:function(T,R,S){AJS.log("Got "+S+" from aggregate roots capapbility for "+Q)}}).promise()}).done(function(){o(O).done(function(){N.resolve(M)})});return N.promise()};ATLAS_PROJECT_CREATE.constructFullRootType=function n(L,M,P,O,N){return{keys:L.keys,url:L.links.self,label:M,capabilityKey:P,baseUrl:O,instanceId:N}};ATLAS_PROJECT_CREATE.createLink=function v(M,L){console.log("creating link from "+M.entityType+" to "+M.remoteEntityType);var N=JSON.stringify({local:M.baseUrl+"/aggregate-root/"+M.entityType+"/"+M.entityKey,target:M.remoteInstanceBaseUrl+"/aggregate-root/"+M.remoteEntityType+"/"+M.remoteEntityKey});AJS.$.ajax(M.baseUrl+"/aggregate-root-link",{type:"POST",contentType:"application/json",data:N,timeout:8000,complete:L})};ATLAS_PROJECT_CREATE.linkAllTheThings=function r(O,R,L,T,S){var N=[];x.each(R,function Q(U,V){N.push({baseUrl:V.type.baseUrl,entityType:V.type.capabilityKey,entityKey:V.data.key,remoteInstanceBaseUrl:h()+"/rest/capabilities",remoteEntityType:u,remoteEntityKey:L});N.push({baseUrl:h()+"/rest/capabilities",entityType:u,entityKey:L,remoteInstanceBaseUrl:V.type.baseUrl,remoteEntityType:V.type.capabilityKey,remoteEntityKey:V.data.key});AJS.$.each(R,function W(Y,X){if(X!==V){N.push({baseUrl:V.type.baseUrl,entityType:V.type.capabilityKey,entityKey:V.data.key,remoteInstanceBaseUrl:X.type.baseUrl,remoteEntityType:X.type.capabilityKey,remoteEntityKey:X.data.key})}})});var P=0;function M(Y,U){if(U!=="success"){P++;var V=Y.statusText;try{var X=JSON.parse(Y.responseText);if(X&&X.message){V=X.message}}catch(W){}AJS.messages.error(".li-linking-status",{title:"Could not create links between created projects",body:V});O.updateHeight()}if(N.length>0){ATLAS_PROJECT_CREATE.createLink(N.pop(),M)}else{if(P>0){T.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>")}else{T.find(".linking-status").html('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>")}S.prop("disabled",false);S.attr("aria-disabled","false")}}M(null,"success")};var k;function I(O,L,M){var N=L();x.when(O).then(function(P){N.getCurPanel().body.find(".field-group.loading").remove();P.sort(d);if(P.length!==0){var Q=N.getCurPanel().body.find("form");Q.append(project.creation.remoteRootsCheckboxes({rootTypes:P}));if(M){Q.find('input[type="checkbox"]').filter(".remote-root").change(M)}N.updateHeight()}f(N,true)},function(){N.getCurPanel().body.find(".field-group.loading").remove();f(N,true);N.updateHeight()})}var j;function E(L,M){var N=L();j=N.getCurPanel();j.body.find("form").append(project.creation.remoteRootsLoading({}));f(N,false);N.updateHeight();j.page.element.find(".add-project-back-button").click(function(){N.updateHeight()});b(I,L,M)}function B(M){var N=_.filter(j.body.find("input.remote-root.checkbox"),function(O){return O.checked===true});var L=_.map(N,function(O){return O.id});return _.filter(M,function(O){return _.contains(L,"capability_"+O.capabilityKey)})}var F=AJS.$('meta[name="ajs-remote-user"]');if(!F||!F[0]||!F[0].content){console.log("Project create didn't get a user META tag, or it had no content.  Bailing out");return}if(!AJS.DarkFeatures.isEnabled("rotp.project.create")){return}var w=function w(Q,N,P,M,O){var L=function L(R,S){S.prop("disabled",true);S.attr("aria-disabled","true");S.before('<span class="aui-icon aui-icon-wait project-creation-acknowledge-spinner">'+"Loading, please wait"+"</span>");R()};x.when(k).then(function(S){var R=B(S);H(R);if(R.length===0){Q.prevPage();N();return}c(Q,L,N);var T=[];var U=[];t(R,function(V){var W="creation_status_"+V.capabilityKey.replace(".","_")+"_"+V.instanceId;T.push({statusId:W,label:V.label});return AJS.$.ajax(V.url+"/"+M,{type:"PUT",data:JSON.stringify({label:O}),xhrFields:{withCredentials:true},success:function(X){U=U.concat(D(X,V));i(X,W)},error:function(Y,Z,X){l(W,V,Y,X)},contentType:"application/json",dataType:"json"}).promise()}).always(function(){s(Q);console.log("about to begin linking created objects");ATLAS_PROJECT_CREATE.linkAllTheThings(Q,U,M,AJS.$(".post-project-created-page-content"),AJS.$(".project-create-acknowledge-button"))});AJS.$(".post-project-created-page-content").append(project.creation.remoteRootsSuccess({rootTypes:T}))})};var e=function e(M){var L;x.when(k).then(function(P){var O=B(P);_.each(O,function(R){if(R.keys){for(var Q in R.keys){if(R.keys.hasOwnProperty(Q)){if(M.toUpperCase()===Q.toUpperCase()){L=R}}}}})});var N={errors:{}};if(L){N.errors.projectKey=AJS.format("{0} with that key already exists in the remote instance",L.label)}return N};function m(){return window.location.origin?window.location.origin:(window.location.protocol+"//"+window.location.host)}function h(){var L=m();return L+AJS.contextPath()}function z(M){var L=document.createElement("a");L.href=M;return{host:L.hostname,port:L.port,protocol:L.protocol.replace(":","")}}function K(M,L){var O=z(M);var N=z(L);return O.protocol==="https"&&N.protocol==="http"}function b(O,M,N){AJS.$.ajax(h()+"/rest/capabilities/awareness",{type:"GET",success:function L(Q){var R=_.partial(K,m());var P=_.chain(Q.applications).map(function(T,S){return _.extend(T,{capabilitiesUrl:S})}).filter(function(S){return R(S.capabilitiesUrl)===false}).value();P.push({id:Q.links.selfInstanceId,capabilitiesUrl:Q.links.collection});k=ATLAS_PROJECT_CREATE.loadRemoteRoots(P);A=Q.links.selfInstanceId;if(typeof O==="function"){O(k,M,N)}},error:function(R,P,Q){console.log("Project create error - error gathering roots from awareness capability");if(M){x(M().getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled","false")}}})}var A;var g=null;function t(N,M){var L=_.map(N,M);return o(L)}function o(M){var L=x.Deferred();var N=0;if(M.length===0){L.resolve()}else{_.each(M,function(O){O.always(function(){N++;if(N===M.length){L.resolve()}})})}return L.promise()}function c(N,L,M){N.addPanel("title","","post-project-created-page-content");N.addHeader("Creating and linking companions for your JIRA project");N.addButton("All done!",function(){L(M,AJS.$(this))},"project-create-acknowledge-button");AJS.$(".project-create-acknowledge-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary").attr("aria-disabled","true").prop("disabled",true)}function D(M,L){var N=[];if(L.capabilityKey==="ondemand.svn-repository"){console.log("got back created SVN repository");N.push({type:{capabilityKey:"fecru.repository",instanceId:g.id,baseUrl:g.capabilitiesUrl},data:{key:M.key}});N.push({type:{capabilityKey:"fecru.project",instanceId:g.id,baseUrl:g.capabilitiesUrl},data:{key:"CR-"+M.key}})}else{console.log("got back created thing "+L.capabilityKey);var O={type:L,data:M};N.push(O)}return N}function i(N,O){var M=AJS.$("."+O);M.empty();M.append('<span class="aui-icon aui-icon-small aui-iconfont-success">'+"Success"+"</span>");if(N.links.resource){var L=AJS.$("<a target='_blank'></a>");L.text(N.label);L.attr("href",N.links.resource);L.attr("title",N.label);M.closest("li").append(L)}}function l(S,M,R,Q){var O=AJS.$("."+S);O.empty();O.append('<span class="aui-icon aui-icon-small aui-iconfont-error">'+"Error"+"</span>");var L=Q;if(R&&R.responseText){try{var P=JSON.parse(R.responseText);if(P&&P.message){L=P.message}}catch(N){L=R.responseText}}AJS.messages.error(".li-"+S,{title:AJS.format("Could not create {0}",M.label),body:L})}function s(L){var M=L.getCurrentPanel();if(M.body.find(".aui-message.error").size()!==0){AJS.messages.warning(".project-creation-success",{title:"We were unable to create everything you requested",body:"<p>"+"However, you can create them yourself and manually set up links."+"</p>"});L.updateHeight()}}function H(L){var M=_.map(L,function(O){return O.capabilityKey});var N=(M.length==0)?"none":M.sort().join("_");AJS.EventQueue.push({name:"project.create.aggregateroots.selected",properties:{capabilitykeys:N}})}function f(M,L){x(M.getCurPanel().page.element).find(".pt-submit-button").attr("aria-disabled",!L)}function d(M,L){return J(L.capabilityKey)-J(M.capabilityKey)}function J(L){return _.has(G,L)?G[L]:0}JPT.AddProjectController.registerProjectKeyValidationCallback(e);var y=function y(){return JPT.DialogView.dialog||JPT.DialogView._dialog};var a=function a(){if(JPT.AddProjectView.getKey().length>=2){JPT.AddProjectController._performKeyValidationChecks(JPT.AddProjectView.getKey())}};JPT.AddProjectView.addPostDrawCallback(function(){E(y,a)});JPT.AddProjectController.registerPostProjectCreationCallback(function(P,Q,O,M,N){var L=function(){window.location=AJS.contextPath()+Q};w(P,L,O,M,N)});var q=function q(){var N="projectCreation";GH.StartWizardView.registerWizardStepPreRenderCallback(function M(Q){if(Q==N){b();GH.StartWizardView.registerWizardStepOnCreateCallbacks(function P(S,T,R){console.log("creating external entities");S.addPage("post-project-created-page");w(S,T,null,R.project.key,R.project.name)})}});GH.StartWizardView.registerWizardStepPostRenderCallback(function O(R,P){if(R==N){E(function Q(){return P});P.updateHeight()}});GH.StartWizardView.registerWizardStepOnValidateCallback(function L(U,R){if(U==N){var T=R.getCurPanel().body.find("#ghx-wizard-project-projectkey");var Q=e(T.val());if(Q.errors.projectKey){var P=AJS.$("<div class='error project-creation-error'></div>");var S=T.parent();S.find(".project-creation-error").remove();S.append(P);P.text(Q.errors.projectKey);P.show();return false}}return true})};x(function(){AJS.$(".add-project-trigger").live("click",b);if(typeof GH!=="undefined"){if(GH.StartWizardView&&GH.StartWizardView.registerWizardStepPreRenderCallback){q()}}});x(function(){AJS.$(".add-project-trigger").live("click",b)})})(jQuery);;
;/* module-key = 'com.atlassian.plugins.jira-project-creation:project-creation-resources', location = '/templates/project-creation.soy' */
// This file was automatically generated from project-creation.soy.
// Please don't edit this file by hand.

if (typeof project == 'undefined') { var project = {}; }
if (typeof project.creation == 'undefined') { project.creation = {}; }


project.creation.remoteRootsLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-group loading"><span class="aui-icon aui-icon-wait"/>', soy.$$escapeHtml("Retrieving additional project types you might want to create"), '</div>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsCheckboxes = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset class="group remote-root-checkboxes"><h4>', soy.$$escapeHtml("Create a linked:"), '</h4><div class=\'field-group\'>');
  var rootTypeList10 = opt_data.rootTypes;
  var rootTypeListLen10 = rootTypeList10.length;
  for (var rootTypeIndex10 = 0; rootTypeIndex10 < rootTypeListLen10; rootTypeIndex10++) {
    var rootTypeData10 = rootTypeList10[rootTypeIndex10];
    output.append('<div class="checkbox"><input class="checkbox remote-root" type="checkbox" id="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '" checked="true" data-url="', soy.$$escapeHtml(rootTypeData10.url), '"></input><label for="capability_', soy.$$escapeHtml(rootTypeData10.capabilityKey), '">', soy.$$escapeHtml(rootTypeData10.label), '</label></div>');
  }
  output.append('</div></fieldset>');
  return opt_sb ? '' : output.toString();
};


project.creation.remoteRootsSuccess = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-creation-success"><ul>');
  var rootTypeList24 = opt_data.rootTypes;
  var rootTypeListLen24 = rootTypeList24.length;
  for (var rootTypeIndex24 = 0; rootTypeIndex24 < rootTypeListLen24; rootTypeIndex24++) {
    var rootTypeData24 = rootTypeList24[rootTypeIndex24];
    output.append('<li class="li-', soy.$$escapeHtml(rootTypeData24.statusId), '"><div class="', soy.$$escapeHtml(rootTypeData24.statusId), ' created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml(rootTypeData24.label), '</div></li>');
  }
  output.append('<li class="li-linking-status"><div class="linking-status created-entity-status"><span class="aui-icon aui-icon-wait">', soy.$$escapeHtml("Loading, please wait"), '</span></div><div class="created-entity-status">', soy.$$escapeHtml("Creating links"), '</div></li></ul></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/store-1.3.1.js' */
(function(){var l={},h=window,k=h.document,c="localStorage",n="globalStorage",d="__storejs__",g;l.disabled=false;l.set=function(e,o){};l.get=function(e){};l.remove=function(e){};l.clear=function(){};l.transact=function(e,o){var p=l.get(e);if(typeof p=="undefined"){p={}}o(p);l.set(e,p)};l.serialize=function(e){return JSON.stringify(e)};l.deserialize=function(e){if(typeof e!="string"){return undefined}return JSON.parse(e)};function b(){try{return(c in h&&h[c])}catch(e){return false}}function m(){try{return(n in h&&h[n]&&h[n][h.location.hostname])}catch(e){return false}}if(b()){g=h[c];l.set=function(e,o){if(o===undefined){return l.remove(e)}g.setItem(e,l.serialize(o))};l.get=function(e){return l.deserialize(g.getItem(e))};l.remove=function(e){g.removeItem(e)};l.clear=function(){g.clear()}}else{if(m()){g=h[n][h.location.hostname];l.set=function(e,o){if(o===undefined){return l.remove(e)}g[e]=l.serialize(o)};l.get=function(e){return l.deserialize(g[e]&&g[e].value)};l.remove=function(e){delete g[e]};l.clear=function(){for(var e in g){delete g[e]}}}else{if(k.documentElement.addBehavior){var j,f;try{f=new ActiveXObject("htmlfile");f.open();f.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></frame>');f.close();j=f.w.frames[0].document;g=j.createElement("div")}catch(i){g=k.createElement("div");j=k.body}function a(e){return function(){var p=Array.prototype.slice.call(arguments,0);p.unshift(g);j.appendChild(g);g.addBehavior("#default#userData");g.load(c);var o=e.apply(l,p);j.removeChild(g);return o}}l.set=a(function(p,e,o){if(o===undefined){return l.remove(e)}p.setAttribute(e,l.serialize(o));p.save(c)});l.get=a(function(o,e){return l.deserialize(o.getAttribute(e))});l.remove=a(function(o,e){o.removeAttribute(e);o.save(c)});l.clear=a(function(q){var o=q.XMLDocument.documentElement.attributes;q.load(c);for(var p=0,e;e=o[p];p++){q.removeAttribute(e.name)}q.save(c)})}}}try{l.set(d,d);if(l.get(d)!=d){l.disabled=true}l.remove(d)}catch(i){l.disabled=true}if(typeof module!="undefined"){module.exports=l}else{if(typeof define==="function"&&define.amd){define(l)}else{this.store=l}}})();;
;/* module-key = 'com.atlassian.analytics.analytics-client:js-events', location = 'js/atlassian-analytics.js' */
(function(f){var j=AJS.$.ajax;var h="atlassian-analytics";var e=typeof AJS.contextPath=="function"?AJS.contextPath():typeof AJS.Confluence!="undefined"?AJS.Confluence.getContextPath():window.contextPath!=null?window.contextPath:"";var d=null;var m=null;var c=null;var b="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var s=Math.random()*16|0,q=t=="x"?s:(s&3|8);return q.toString(16)});var a=function(){var q="unknown";if(document.body.id=="jira"){q="jira"}else{if(document.body.id=="com-atlassian-confluence"){q="confluence"}}m=h+"."+q;c=m+".lock"};var o=function(){if(store.get(c)){return false}store.set(c,b);return(store.get(c)===b)};var k=function(){store.set(c,null)};var g=function(){var r=[],t,u,q,s;if(AJS.EventQueue.length==0){return}r=store.get(m)||r;for(q=0,s=AJS.EventQueue.length;q<s;++q){u=AJS.EventQueue[q];if(u.name){t={name:u.name,properties:u.properties,time:u.time||0};r.push(t)}}AJS.EventQueue.length=0;store.set(m,r)};var l=function(){var r;if(!o()){return}g();r=store.get(m);if(r&&r.length){store.remove(m);k();var s=new Date().getTime();for(var q=0;q<r.length;q++){if(r[q].time>0){r[q].timeDelta=r[q].time-s}else{r[q].timeDelta=q-r.length}delete r[q].time}d=j({type:"POST",url:e+"/rest/analytics/1.0/publish/bulk",data:JSON.stringify(r),contentType:"application/json",dataType:"json"});d.fail(function(){AJS.EventQueue.concat(r);g()})}else{k()}};var n=function(){if(d&&!(d.state()==="resolved"||d.state()==="rejected")){d.abort()}};AJS.EventQueue=AJS.EventQueue||[];var i=Array.prototype.push;AJS.EventQueue.push=function(q){q.time=new Date().getTime();i.call(AJS.EventQueue,q)};AJS.toInit(function(){a();setTimeout(l,500);setInterval(l,5000);p()});f(window).unload(function(){n();g()});AJS.Analytics={triggerPrivacyPolicySafeEvent:function(q,r){AJS.EventQueue.push({name:q,properties:r})}};AJS.bind("analytics",function(q,r){AJS.EventQueue.push({name:r.name,properties:r.data})});AJS.bind("analyticsEvent",function(q,r){AJS.EventQueue.push({name:r.name,properties:r.data})});var p=function(){if(window.location.pathname.indexOf("/secure/admin/ViewApplicationProperties")>-1){AJS.$("[data-property-id='analytics-enabled']").remove()}else{if(window.location.pathname.indexOf("/secure/admin/EditApplicationProperties")>-1){var r=AJS.$(":contains(Enable Atlassian analytics)");if(r.size()>0){var q=r[r.size()-2];if(q){q.remove()}}}}}}(AJS.$));;
;/* module-key = 'com.atlassian.analytics.analytics-client:policy-update', location = 'js/policy-update.js' */
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:application-header-administration-cog-resource', location = 'header/cog.js' */
var NavLinks=(function(a){a.ApplicationHeader=function(b){b.Cog=(function(){var c=function(){var d=AJS.$("#system-admin-menu-content");if(d.length>0){return d}var e=AJS.$("#admin-menu-link-content");if(e.length>0){return e}return AJS.$("#bamboo\\.global\\.header-admin\\.menu")};return{getDropdown:c}}());return b}(a.ApplicationHeader||{});return a}(NavLinks||{}));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminshortcuts.soy' */
// This file was automatically generated from adminshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.adminshortcuts == 'undefined') { navlinks.templates.adminshortcuts = {}; }


navlinks.templates.adminshortcuts.section = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param5 = new soy.StringBuilder('<ul class="aui-list-truncate">');
  var linkList7 = opt_data.links;
  var linkListLen7 = linkList7.length;
  for (var linkIndex7 = 0; linkIndex7 < linkListLen7; linkIndex7++) {
    var linkData7 = linkList7[linkIndex7];
    param5.append('<li><a href="', soy.$$escapeHtml(linkData7.link), '">', soy.$$escapeHtml(linkData7.label), '</a></li>');
  }
  param5.append('</ul>');
  aui.dropdown2.section({id: 'nl-remote-admin-section', label: "Other applications", content: param5.toString()}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts-resources', location = 'adminshortcuts/adminnavlinks.js' */
var NavLinks=(function(a){a.AdminShortcuts=(function(){var c=function(){return AJS.$.ajax({url:AJS.contextPath()+"/rest/menu/latest/admin",cache:false,dataType:"json"})};var b=function(){AJS.$("#nl-remote-admin-section").on("click","a",function(){NL.trackEvent("remoteAdminItemSelected",NL.getCurrentApplication(),$(this).attr("href"))})};return{render:function(){c().done(function(e){e=_.reject(e,function(f){return f.local===true});if(e.length){var d=navlinks.templates.adminshortcuts.section({links:e});a.ApplicationHeader.Cog.getDropdown().append(d);b()}})}}}());return a}(NavLinks||{}));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:administration-shortcuts', location = 'adminshortcuts/adminshortcuts-cdn.js' */
AJS.toInit(function(){if(AJS.DarkFeatures&&AJS.DarkFeatures.isEnabled("rotp.admin.shortcuts")){NavLinks.AdminShortcuts.render()}});;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.soy' */
// This file was automatically generated from projectshortcuts.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.projectshortcuts == 'undefined') { navlinks.templates.projectshortcuts = {}; }


navlinks.templates.projectshortcuts.dialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.localShortcuts && opt_data.localShortcuts.length > 0) {
    navlinks.templates.projectshortcuts.dialogContentShortcuts({shortcuts: opt_data.localShortcuts, listClass: 'projectshortcut-links'}, output);
  }
  if (opt_data.remoteShortcuts != null) {
    if (opt_data.remoteShortcuts.length > 0) {
      output.append('<h2 class="projectshortcuts-heading">Related Links</h2>');
      navlinks.templates.projectshortcuts.dialogContentShortcuts(soy.$$augmentData(opt_data.remoteShortcuts, {shortcuts: opt_data.remoteShortcuts, listClass: 'projectshortcut-links'}), output);
    }
  } else {
    navlinks.templates.projectshortcuts.dialogLoading(null, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.headingWrapper = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="project-dialog-header-wrapper"><div class="project-header"><img class="project-img" src="', soy.$$escapeHtml(opt_data.logoUrl), '"><h2 class="dialog-title">', soy.$$escapeHtml(opt_data.title), '</h2></div><div class="project-content-wrapper">', opt_data.contentHtml, '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcuts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
  var shortcutList35 = opt_data.shortcuts;
  var shortcutListLen35 = shortcutList35.length;
  for (var shortcutIndex35 = 0; shortcutIndex35 < shortcutListLen35; shortcutIndex35++) {
    var shortcutData35 = shortcutList35[shortcutIndex35];
    output.append('<li', (shortcutIndex35 == shortcutListLen35 - 1) ? ' class="last"' : '', '>');
    navlinks.templates.projectshortcuts.dialogContentShortcut(shortcutData35, output);
    output.append('</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogContentShortcut = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.link), '"', (opt_data.tooltip) ? ' title="' + soy.$$escapeHtml(opt_data.tooltip) + '"' : '', '>', soy.$$escapeHtml(opt_data.label), '</a>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.projectshortcuts.dialogLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="projectshortcuts-loading">', (opt_data != null && opt_data.text) ? soy.$$escapeHtml(opt_data.text) : '', '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-projectshortcuts', location = 'projectshortcuts/projectshortcuts.js' */
(function(e,g){var i,k={},m="key",b="name",j="entity-type";function f(s){var n=e(this),o=n.data(m),q=n.data(b),p=n.data(j);if(typeof o==="undefined"){return}s.preventDefault();i=new AJS.Dialog({width:600,keypressListener:function(u){if(u.which==jQuery.ui.keyCode.ESCAPE){i.remove()}},id:"project-shortcuts-dialog"}).addCancel("Close",function(){i.remove()}).addPanel("",navlinks.templates.projectshortcuts.headingWrapper({title:q,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogLoading({text:"Retrieving links…"})})).show();c(i);if(!k[o]){k[o]={entity:{title:q},localShortcuts:null,remoteShortcuts:null};d(AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+o,{entityType:p}).done(t);d(AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+o,{entityType:p}).done(r).fail(function(){var u=i.getCurrentPanel().body.find(".project-content-wrapper");u.find(".projectshortcuts-loading").remove();AJS.messages.error(u,{body:"Could not retrieve remote project shortcuts",closeable:false});c(i)})}else{l(k[o])}function t(u){k[o].localShortcuts=u.shortcuts;l(k[o])}function r(u){k[o].remoteShortcuts=u.shortcuts;l(k[o])}}function h(){return e(".project-shortcut-dialog-trigger img").attr("src")}function l(n){if(n.localShortcuts){i.getCurrentPanel().html(navlinks.templates.projectshortcuts.headingWrapper({title:n.entity.title,logoUrl:h(),contentHtml:navlinks.templates.projectshortcuts.dialogContent(n)}));c(i)}}function a(p){var o=210;if(!p||p.length<=o){return p}var n=o;while(n>0&&p.charAt(n)!=" "){n--}if(n==0){n=o}p=p.substring(0,n);if(p.length>=n){p=p+"..."}return p}function c(n){var q=n.popup.element,p=q.find(".dialog-panel-body"),o=q.find(".dialog-components");p.height("auto");q.height(o.outerHeight()-1);e(".aui-shadow").remove()}function d(n,o){return e.ajax({url:n,cache:false,data:o,dataType:"json"})}e(document).on("click",".project-shortcut-dialog-trigger",f)}(jQuery,window.NL=(window.NL||{})));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:atlassian-ui-popup-display-controller', location = 'popups/DisplayController.js' */
AJS.Popups=AJS.Popups||{};AJS.Popups.DisplayController=function(){var c=[];var a=false;var b=false;AJS.toInit(function(){setTimeout(function(){AJS.Popups.DisplayController.render()},0)});return{request:function(d){c.push(d);if(a&&b===false){this.render()}},render:function(){c.sort(function(e,d){return e.weight-d.weight});a=true;if(c.length!==0){b=true;c[0].show()}}}}();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-web-plugin:issue-link-web-link', location = 'js/issuelink-weblink.js' */
(function(){var $hiddenImg=AJS.$("<img>"),$iconUrlInput,$urlInput,faviconUrl,throbberTimeoutId;$hiddenImg.load(function(){$iconUrlInput.val(faviconUrl);$urlInput.css("background-image",'url("'+faviconUrl+'")');clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});$hiddenImg.error(function(){clearTimeout(throbberTimeoutId);$urlInput.removeClass("loading")});function init(context){$iconUrlInput=AJS.$("#web-link-icon-url",context);$urlInput=AJS.$("#web-link-url",context).bind("change",fetchFavicon);if($iconUrlInput.val()){$urlInput.css("background-image","url("+$iconUrlInput.val()+")")}}function fetchFavicon(){$hiddenImg.attr("src","");$iconUrlInput.val("");$urlInput.css("background-image","");faviconUrl=parseFaviconUrl($urlInput.val());if(!faviconUrl){return }setTimeout(function(){$urlInput.addClass("loading")},0);throbberTimeoutId=setTimeout(function(){$urlInput.removeClass("loading")},3000);$hiddenImg.attr("src",faviconUrl)}function parseFaviconUrl(url){var hostUrl=url.match(/^([^/]*\/\/[^/]+)/)[1];if(!hostUrl){return }return hostUrl+"/favicon.ico"}JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){init(context)})})();;
;/* module-key = 'com.atlassian.jconnect.jconnect-plugin:common', location = 'js/ViewLocation.js' */
(function(G){var C=window,H="onJMCGMapsLoad";
mapsCallbacks=[],googleLoaderRequested=false,googleMapsRequested=false;
function I(){var M;
while(M=mapsCallbacks.shift()){M()
}}function E(N){var M=C.google.maps&&C.google.maps.LatLng;
if(M){mapsCallbacks.push(N);
I()
}else{if(googleMapsRequested){mapsCallbacks.push(N)
}else{googleMapsRequested=true;
mapsCallbacks.push(N);
google.load("maps","3",{other_params:"sensor=false",callback:I})
}}}function F(N){if(C.google&&C.google.load){E(N)
}else{if(googleLoaderRequested){mapsCallbacks.push(N)
}else{googleLoaderRequested=true;
C[H]=function(){E(N)
};
var M=document.createElement("script");
M.src="https://www.google.com/jsapi?callback="+H;
M.type="text/javascript";
G("body").append(M)
}}}function D(M){if(M.hasClass("open")){K(M)
}else{L(M)
}}function K(M){M.removeClass("open");
B=false
}function L(N){var M=N.find(".jConnectMap");
N.addClass("open");
B=true;
if(!A){A=new google.maps.Map(M.get(0),{zoom:8,center:J[1].geometry.location,mapTypeId:google.maps.MapTypeId.ROADMAP});
new google.maps.Marker({map:A,position:J[1].geometry.location,title:J[1].formatted_address})
}}var J,A,B=false;
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(S,O,R){if(R=="panelRefreshed"||R=="pageLoad"){var P=G(".jConnectLocation.ready",O),N=P.find("> a"),M,Q;
if(N.length){F(function(){if(P.hasClass("ready")){M=new google.maps.LatLng(N.data("lat"),N.data("long"));
Q=new google.maps.Geocoder();
Q.geocode({latLng:M},function(U,T){if(T==google.maps.GeocoderStatus.OK){J=U;
if(U[1]){N.text(U[1].formatted_address)
}}});
P.removeClass("ready");
A=null;
if(B){L(P)
}N.click(function(T){T.preventDefault();
T.stopPropagation();
D(P)
})
}})
}}})
})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-core', location = '/js/core/host-debug.js' */
/*! atlassian-connect-js - v1.1.10 - 2014-12-09 */
if(!window._AP){window._AP={}
}(function(f){var e=f._AP?_AP:(f.RA=f.AP={});
var d={};
e.define=function(i,k,h){var j=c(i),g;
if(!h){h=k;
k=[]
}if(h){g=typeof h!=="function"?function(){return h
}:h;
b(k,function(){var m=g.apply(f,arguments);
if(m){if(typeof m==="function"){j.exports.__target__=m
}for(var l in m){if(m.hasOwnProperty(l)){j.exports[l]=m[l]
}}}})
}};
e.require=function(g,h){b(typeof g==="string"?[g]:g,h)
};
function b(l,m){var j=[],h=0,g=l.length;
function k(p){j.push(p);
if(j.length===g){var n=[],o=0;
for(;
o<g;
o+=1){n[o]=j[o].exports
}if(m){m.apply(f,n)
}}}if(l&&l.length>0){for(;
h<g;
h+=1){a(l[h],k)
}}else{if(m){m()
}}}function a(g,h){h(c(g))
}function c(g){return d[g]=d[g]||{name:g,exports:function(){function h(){var i=h.__target__;
if(i){return i.apply(f,arguments)
}}return h
}()}
}}(this));
_AP.define("_dollar",function(){return AJS.$
});
_AP.define("host/_util",function(){return{escapeSelector:function(a){if(!a){throw new Error("No selector to escape")
}return a.replace(/[!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~]/g,"\\$&")
}}
});
_AP.define("_rpc",["_dollar","_xdm","host/jwt-keepalive","_uri"],function(c,e,d,b){var k=c.each,j=c.extend,f=c.isFunction,l=[],g={},a=[],h={},i=[];
return{extend:function(m){if(f(m)){m=m()
}j(g,m.apis);
j(h,m.internals);
a=a.concat(m.stubs||[]);
var n=m.init;
if(f(n)){i.push(n)
}return m.apis
},init:function(o,n){var m=new b.init(n.remote),p=m.getQueryParamValue("jwt"),q;
o=o||{};
k(g,function(r){a.push(r)
});
if(p&&d.isExpired(p)){q=d.updateUrl({addonKey:n.remoteKey,moduleKey:o.ns,productContext:o.productContext||{},uiParams:n.uiParams,width:n.props.width,height:n.props.height})
}c.when(q).always(function(s){if(s){n.remote=s
}var r=new e(c,n,{remote:a,local:c.extend({},h)});
l[r.id]=r;
k(i,function(t,v){try{v(j({},o),r)
}catch(u){console.log(u)
}})
})
}}
});
_AP.define("env",["_dollar","_rpc"],function(a,b){var c;
b.extend(function(){return{init:function(d){c=d
},internals:{getLocation:function(){return window.location.href
}}}
})
});
_AP.define("resize",["_dollar","_rpc"],function(a,b){b.extend(function(){return{init:function(d,e){e.resize=AJS.debounce(function c(i,g,f){i(this.iframe).css({width:g,height:f});
var h=i(this.iframe).closest(".ap-container");
h.trigger("resized",{width:g,height:f})
})
},internals:{resize:function(d,c){if(!this.uiParams.isDialog){this.resize(a,d,c)
}},sizeToParent:AJS.debounce(function(){var c=function(e){var d=a(document).height()-a("#header > nav").outerHeight()-a("#footer").outerHeight()-20;
a(e).css({width:"100%",height:d+"px"})
};
if(this.uiParams.isGeneral){a(this.iframe).addClass("full-size-general-page");
a(window).on("resize",function(){c(this.iframe)
});
c(this.iframe)
}else{a(this.iframe).addClass("full-size-general-page-fail")
}})}}
})
});
_AP.define("loading-indicator",["_dollar","_rpc","host/_status_helper"],function(b,c,a){c.extend(function(d){return{init:function(g,f){var e=b(f.iframe).closest(".ap-container");
a.showLoadingStatus(e,0);
e.find(".ap-load-timeout a.ap-btn-cancel").click(function(){a.showLoadErrorStatus(e);
if(f.analytics&&f.analytics.iframePerformance){f.analytics.iframePerformance.cancel()
}});
f.timeout=setTimeout(function(){f.timeout=null;
a.showloadTimeoutStatus(e);
if(f.isActive()&&f.analytics&&f.analytics.iframePerformance){f.analytics.iframePerformance.timeout()
}},20000)
},internals:{init:function(){if(this.analytics&&this.analytics.iframePerformance){this.analytics.iframePerformance.end()
}var e=b(this.iframe).closest(".ap-container");
a.showLoadedStatus(e);
clearTimeout(this.timeout);
e.find(".ap-content").addClass("iframe-init")
}}}
})
});
_AP.define("host/cookie",["_dollar","_rpc"],function(b,c){var a;
c.extend(function(){function d(e,f){if(!e||e.length===0){throw new Error("addon key must be defined on cookies")
}if(!f||f.length===0){throw new Error("Name must be defined")
}return e+"$$"+f
}a={internals:{saveCookie:function(f,g,e){AJS.Cookie.save(d(this.addonKey,f),g,e)
},readCookie:function(e,g){var f=AJS.Cookie.read(d(this.addonKey,e));
if(typeof g==="function"){g(f)
}},eraseCookie:function(e){AJS.Cookie.erase(d(this.addonKey,e))
}}};
return a
});
return a
});
_AP.define("request",["_dollar","_rpc"],function(c,e){var d=["status","statusText","responseText"],a=["Content-Type"],b=null;
e.extend(function(){return{init:function(f){b=f.cp
},internals:{request:function(k,m,j){var i=b+k.url;
i=i.replace(/\/\.\.\//ig,"");
function f(o){var n={headers:{}};
c.each(d,function(q,p){n[p]=o[p]
});
c.each(a,function(q,p){n.headers[p]=o.getResponseHeader(p)
});
return n
}function h(n,p,o){m([n,p,f(o)])
}function g(o,p,n){j([f(o),p,n])
}var l={};
c.each(k.headers||{},function(o,n){l[o.toLowerCase()]=n
});
c.ajaxSettings={};
c.ajax({url:i,type:k.type||"GET",data:k.data,dataType:"text",contentType:k.contentType,cache:(typeof k.cache!=="undefined")?!!k.cache:undefined,headers:{Accept:l.accept||"*/*","AP-Client-Key":this.addonKey}}).then(h,g)
}}}
})
});
_AP.define("host/content",["_dollar","_uri"],function(f,e){function g(j){var i=j.attr("class");
var h=i?i.match(/ap-plugin-key-([^\s]*)/):null;
return f.isArray(h)?h[1]:false
}function b(j){var i=j.attr("class");
var h=i?i.match(/ap-module-key-([^\s]*)/):null;
return f.isArray(h)?h[1]:false
}function d(j){var h=b(j),i=j.hasClass("ap-inline-dialog")?"inlineDialog":"dialog";
return window._AP[i+"Options"][h]||{}
}function c(h){var i=new e.init(h).queryPairs;
var j={};
f.each(i,function(k,l){j[l[0]]=l[1]
});
return j
}function a(j,h,k){function i(p){p.preventDefault();
var o=f(p.target).closest(h),l=o.attr("href"),n=new e.init(l),m={bindTo:o,header:o.text(),width:n.getQueryParamValue("width"),height:n.getQueryParamValue("height"),cp:n.getQueryParamValue("cp"),key:g(o),productContext:c(l)};
k(l,m,p.type)
}f(window.document).on(j,h,i)
}return{eventHandler:a,getOptionsForWebItem:d,getWebItemPluginKey:g,getWebItemModuleKey:b}
});
_AP.require(["dialog/main","host/content","_uri","dialog/dialog-factory"],function(a,d,c,b){AJS.toInit(function(g){var f="click",e=".ap-dialog",h=function(l,m){var k=d.getOptionsForWebItem(m.bindTo),j=d.getWebItemModuleKey(m.bindTo),i=d.getWebItemPluginKey(m.bindTo);
g.extend(m,k);
if(!m.ns){m.ns=j
}if(!m.container){m.container=m.ns
}if(typeof m.chrome==="string"){m.chrome=(m.chrome.toLowerCase()==="false")?false:true
}if(m.chrome===undefined){m.chrome=true
}b({key:i,moduleKey:j},m,m.productContext)
};
d.eventHandler(f,e,h)
})
});
_AP.define("dialog/button",["_dollar"],function(b){function a(c){this.$el=b("<button />").text(c.text).addClass("aui-button aui-button-"+c.type).addClass(c.additionalClasses);
this.isEnabled=function(){return !(this.$el.attr("aria-disabled")==="true")
};
this.setEnabled=function(d){if(c.noDisable===true){return false
}this.$el.attr("aria-disabled",!d);
return true
};
this.setEnabled(true);
this.click=function(d){if(d){this.$el.bind("ra.dialog.click",d)
}else{this.dispatch(true)
}};
this.dispatch=function(d){var e=d?"done":"fail";
c.actions&&c.actions[e]&&c.actions[e]()
};
this.setText=function(d){if(d){this.$el.text(d)
}}
}return{submit:function(c){return new a({type:"primary",text:"Submit",additionalClasses:"ap-dialog-submit",actions:c})
},cancel:function(c){return new a({type:"link",text:"Cancel",noDisable:true,additionalClasses:"ap-dialog-cancel",actions:c})
}}
});
_AP.define("dialog/dialog-factory",["_dollar","dialog/main"],function(b,a){return function(d,e,f){var h,c,g=b.extend({isDialog:1},d.uiParams);
a.create({id:d.id,ns:d.moduleKey||d.key,chrome:e.chrome||d.chrome,header:e.header,width:e.width,height:e.height,size:e.size,submitText:e.submitText,cancelText:e.cancelText},false);
c=b(".ap-dialog-container");
if(d.url){throw new Error("Cannot retrieve dialog content by URL")
}h=window._AP.contentResolver.resolveByParameters({addonKey:d.key,moduleKey:d.moduleKey,productContext:f,uiParams:g});
h.done(function(i){var j=b(i);
j.addClass("ap-dialog-container");
c.replaceWith(j)
}).fail(function(m,i,j){var l=b("<p class='title' />").text("Unable to load add-on content. Please try again later.");
c.html("<div class='aui-message error ap-aui-message'></div>");
c.find(".error").append(l);
var k=i+(j?": "+j.toString():"");
c.find(".error").text(k);
AJS.log(k)
});
return a
}
});
_AP.define("dialog/main",["_dollar","_uri","host/_status_helper","dialog/button"],function(f,c,b,a){var l=f(window);
var m=0;
var g;
var j;
var o;
var k={submit:a.submit({done:d}),cancel:a.cancel({done:d})};
var h=function(p){if(p.keyCode===27&&j&&j.hide){j.hide();
f(document).unbind("keydown",h)
}};
function n(r,q,p){var t,s=["ap-aui-dialog2"];
if(p){s.push("ap-aui-dialog2-chromeless")
}t=f(aui.dialog.dialog2({id:r.id,titleText:r.header,titleId:r.titleId,size:r.size,extraClasses:s,removeOnHide:true,footerActionContent:true,modal:true}));
if(p){t.find("header, footer").remove()
}else{k.submit.setText(r.submitText);
k.cancel.setText(r.cancelText);
t.find(".aui-dialog2-footer-actions").empty().append(k.submit.$el,k.cancel.$el)
}t.find(".aui-dialog2-content").append(q);
q.data("ra.dialog.buttons",k);
function u(v){if(v.isEnabled()){v.$el.trigger("ra.dialog.click",v.dispatch)
}}f.each(k,function(w,v){v.$el.click(function(){u(v)
})
});
return t
}function e(q,p){q.append('<div id="embedded-'+p.ns+'" class="ap-dialog-container ap-content" />')
}function i(r,p){if(typeof r==="string"){var q=r.indexOf("%")===r.length-1;
r=parseInt(r,10);
if(q){r=r/100*p
}}return r
}function d(){if(g){g.trigger("ra.iframe.destroy").removeData("ra.dialog.buttons").unbind();
g=null
}j.hide()
}return{id:o,getButton:function(p){var q=g?g.data("ra.dialog.buttons"):null;
return(p)&&(q)?q[p]:q
},create:function(s,r){var q={width:"50%",height:"50%"},p=s.id||"ap-dialog-"+(m+=1),u=f.extend({id:p},q,s,{dlg:1}),t;
if(u.width==="100%"&&u.height==="100%"){u.size="maximum"
}u.w=i(u.width,l.width());
u.h=i(u.height,l.height());
g=f("<div />").addClass("ap-servlet-placeholder ap-container").attr("id","ap-"+s.ns).bind("ra.dialog.close",d);
if(s.chrome){t=n(u,g)
}else{t=n(u,g,true)
}if(s.size){u.w="100%";
u.h="100%"
}else{AJS.layer(t).changeSize(u.w,u.h);
t.removeClass("aui-dialog2-medium")
}j=AJS.dialog2(t);
j.on("hide",d);
f(document).on("keydown",h);
e(g,u);
if(r!==false){g.append(b.createStatusMessages())
}if(s.src){_AP.create(u)
}j.show()
},close:d}
});
_AP.define("dialog",["_dollar","_rpc","dialog/dialog-factory","dialog/main"],function(c,d,b,a){d.extend(function(){return{stubs:["dialogMessage"],init:function(g,f){if(f.uiParams.isDialog){var e=a.getButton();
if(e){c.each(e,function(h,i){i.click(function(j,k){if(f.isActive()&&f.buttonListenerBound){f.dialogMessage(h,k)
}else{k(true)
}})
})
}}},internals:{dialogListenerBound:function(){this.buttonListenerBound=true
},setDialogButtonEnabled:function(f,e){a.getButton(f).setEnabled(e)
},isDialogButtonEnabled:function(e,g){var f=a.getButton(e);
g(f?f.isEnabled():void 0)
},createDialog:function(f){var e={key:this.addonKey};
if(f.key){e.moduleKey=f.key
}else{if(f.url){throw new Error("Cannot open dialog by URL, please use module key")
}}if(c(".aui-layer :visible").length!==0){throw new Error("Cannot open dialog when a layer is already visible")
}b(e,f,this.productContext)
},closeDialog:function(){this.events.emit("ra.iframe.destroy");
a.close()
}}}
})
});
_AP.define("inline-dialog",["_dollar","_rpc","inline-dialog/simple"],function(f,h,a){function d(i){return i.closest(".contents").data("inlineDialog")
}function b(i){d(i).show()
}function c(j,k,i){j.closest(".contents").css({width:k,height:i});
g(j)
}function g(i){d(i).refresh()
}function e(i){d(i).hide()
}h.extend(function(){return{init:function(j,i){if(i.uiParams.isInlineDialog){f(i.iframe).closest(".ap-container").on("resized",function(l,k){c(f(i.iframe),k.width,k.height)
})
}},internals:{hideInlineDialog:function(){e(AJS.$(this.iframe))
}}}
});
return{showInlineDialog:b,resizeInlineDialog:c,hideInlineDialog:e}
});
_AP.require(["inline-dialog/simple","_dollar","host/content"],function(a,d,c){var b=".ap-inline-dialog";
AJS.toInit(function(f){var e="click mouseover mouseout",g=function(i,j,k){var h=c.getOptionsForWebItem(j.bindTo);
f.extend(j,h);
if(j.onHover!=="true"&&k!=="click"){return
}if(j.onHover===true&&j.bindTo.hasClass("active")){return
}a(i,j).show()
};
c.eventHandler(e,b,g)
})
});
_AP.define("inline-dialog/simple",["_dollar","host/_status_helper","host/_util","host/content"],function(d,a,b,c){return function(k,h){var i;
if(!h.bindTo||!h.bindTo.jquery){return
}var g=h.bindTo.hasClass("ap-inline-dialog")?h.bindTo:h.bindTo.closest(".ap-inline-dialog");
var j=g.attr("id");
if(!j){return
}var e=function(p,n,m){n=d(n);
p.data("inlineDialog",i);
var o=c.getWebItemPluginKey(n),l=c.getWebItemModuleKey(n),q=window._AP.contentResolver.resolveByParameters({addonKey:o,moduleKey:l,isInlineDialog:true,productContext:h.productContext});
q.done(function(r){p.empty().append(r);
if(h.width||h.height){p.css({width:h.width,height:h.height})
}}).fail(function(v,r,s){var u=d("<p class='title' />").text("Unable to load add-on content. Please try again later.");
p.html("<div class='aui-message error ap-aui-message'></div>");
p.find(".error").append(u);
var t=r+(s?": "+s.toString():"");
p.find(".error").text(t);
AJS.log(t)
}).always(function(){m()
})
};
var f="ap-inline-dialog-content-"+j;
i=d("#inline-dialog-"+b.escapeSelector(f));
if(i.length!==0){i.remove()
}i=AJS.InlineDialog(h.bindTo,f,e,h);
return{id:i.attr("id"),show:function(){i.show()
},hide:function(){i.hide()
}}
}
});
_AP.define("messages/main",["_dollar"],function(e){var b="ac-message-container",c=["generic","error","warning","success","info","hint"];
function f(g){return g.search(/^ap\-message\-[0-9]+$/)==0
}function a(){var g=e("#"+b);
if(g.length<1){g=e('<div id="'+b+'" />').appendTo("body")
}return g
}function d(g){var j,h,l={},k=["closeable","fadeout","delay","duration","id"];
for(j in k){h=k[j];
if(h in g){l[h]=g[h]
}}return l
}return{showMessage:function(j,k,g,i){var h=a();
i=d(i);
e.extend(i,{title:k,body:AJS.escapeHtml(g)});
if(e.inArray(j,c)<0){throw"Invalid message type. Must be: "+c.join(", ")
}if(f(i.id)){AJS.messages[j](h,i);
h.css("margin-left","-"+h.innerWidth()/2+"px")
}},clearMessage:function(g){if(f(g)){e("#"+g).remove()
}}}
});
_AP.define("messages-rpc",["_dollar","messages/main","_rpc"],function(b,a,c){c.extend(function(){return{internals:{showMessage:function(f,g,d,e){return a.showMessage(f,g,d,e)
},clearMessage:function(d){return a.clearMessage(d)
},}}
})
});
_AP.define("history/rpc",["_dollar","history/history","_rpc"],function(a,b,c){c.extend(function(){return{init:function(e,d){if(e.uiParams.isGeneral){a(window).on("hashchange",function(f){b.hashChange(f.originalEvent,d.historyMessage)
})
}},internals:{historyPushState:function(d){if(this.uiParams.isGeneral){return b.pushState(d)
}else{a.log("History is only available to page modules")
}},historyReplaceState:function(d){if(this.uiParams.isGeneral){return b.replaceState(d)
}else{a.log("History is only available to page modules")
}},historyGo:function(d){if(this.uiParams.isGeneral){return b.go(d)
}else{a.log("History is only available to page modules")
}}},stubs:["historyMessage"]}
})
});
_AP.define("history/history",["_dollar","_uri"],function(h,b){var k,d="!";
function e(n){if(n===undefined||n===null){return""
}return n.toString().replace(new RegExp("^"+d),"")
}function l(n){if(n===undefined||n===null){throw"You must supply text to prefix"
}return d+e(n)
}function m(n,o){var p=new b.init(window.location.href),q=new b.init(window.location.href);
q.anchor(l(n));
if(q.anchor()!==p.anchor()){k=q.anchor();
if(o){window.location.replace("#"+q.anchor())
}else{window.location.assign("#"+q.anchor())
}return q.anchor()
}}function i(n){m(n)
}function g(n){m(n,true)
}function c(n){history.go(n)
}function f(p,n){var q=new b.init(p.newURL);
var o=new b.init(p.oldURL);
if((q.anchor()!==o.anchor())&&(k!==q.anchor())){n(a(p))
}k=null
}function a(n){return{newURL:e(new b.init(n.newURL).anchor()),oldURL:e(new b.init(n.oldURL).anchor())}
}function j(){var o=new b.init(window.location.href),n=e(o.anchor());
return n
}return{pushState:i,replaceState:g,go:c,hashChange:f,getState:j}
});
(window.AP||window._AP).define("_events",["_dollar"],function(f){var b=window,d=(b.AJS&&b.AJS.log)||(b.console&&b.console.log)||(function(){});
function a(h,g){this._key=h;
this._origin=g;
this._events={};
this._any=[]
}var e=a.prototype;
e.on=function(g,h){if(g&&h){this._listeners(g).push(h)
}return this
};
e.once=function(h,i){var g=this;
var j=function(){g.off(h,j);
i.apply(null,arguments)
};
this.on(h,j);
return this
};
e.onAny=function(g){this._any.push(g);
return this
};
e.off=function(g,k){var j=this._events[g];
if(j){var h=f.inArray(k,j);
if(h>=0){j.splice(h,1)
}if(j.length===0){delete this._events[g]
}}return this
};
e.offAll=function(g){if(g){delete this._events[g]
}else{this._events={}
}return this
};
e.offAny=function(j){var h=this._any;
var g=f.inArray(j,h);
if(g>=0){h.splice(g,1)
}return this
};
e.emit=function(g){return this._emitEvent(this._event.apply(this,arguments))
};
e._event=function(g){return{name:g,args:[].slice.call(arguments,1),attrs:{},source:{key:this._key,origin:this._origin}}
};
e._emitEvent=function(h){var g=h.args.concat(h);
c(this._listeners(h.name),g);
c(this._any,[h.name].concat(g));
return this
};
e._listeners=function(g){return this._events[g]=this._events[g]||[]
};
function c(j,g){for(var h=0;
h<j.length;
++h){try{j[h].apply(null,g)
}catch(k){d(k.stack||k.message||k)
}}}return{Events:a}
});
/*!
 * jsUri
 * https://github.com/derek-watson/jsUri
 *
 * Copyright 2013, Derek Watson
 * Released under the MIT license.
 *
 * Includes parseUri regular expressions
 * http://blog.stevenlevithan.com/archives/parseuri
 * Copyright 2007, Steven Levithan
 * Released under the MIT license.
 */
(this.AP||this._AP).define("_uri",[],function(){var d={starts_with_slashes:/^\/+/,ends_with_slashes:/\/+$/,pluses:/\+/g,query_separator:/[&;]/,uri_parser:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/};
if(!Array.prototype.forEach){Array.prototype.forEach=function(j,h){for(var g=0,f=this.length;
g<f;
++g){j.call(h||this,this[g],g,this)
}}
}function e(f){if(f){f=decodeURIComponent(f);
f=f.replace(d.pluses," ")
}return f
}function c(i){var j=d.uri_parser;
var g=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];
var f=j.exec(i||"");
var h={};
g.forEach(function(l,k){h[l]=f[k]||""
});
return h
}function a(o){var h,m,l,q,g,f;
var j=[];
if(typeof(o)==="undefined"||o===null||o===""){return j
}if(o.indexOf("?")===0){o=o.substring(1)
}m=o.toString().split(d.query_separator);
for(h=0;
h<m.length;
h++){l=m[h];
q=l.indexOf("=");
if(q!==0){g=decodeURIComponent(l.substring(0,q));
f=decodeURIComponent(l.substring(q+1).replace(/\+/g," "));
j.push(q===-1?[l,null]:[g,f])
}}return j
}function b(f){this.uriParts=c(f);
this.queryPairs=a(this.uriParts.query);
this.hasAuthorityPrefixUserPref=null
}["protocol","userInfo","host","port","path","anchor"].forEach(function(f){b.prototype[f]=function(g){if(typeof g!=="undefined"){this.uriParts[f]=g
}return this.uriParts[f]
}
});
b.prototype.hasAuthorityPrefix=function(f){if(typeof f!=="undefined"){this.hasAuthorityPrefixUserPref=f
}if(this.hasAuthorityPrefixUserPref===null){return(this.uriParts.source.indexOf("//")!==-1)
}else{return this.hasAuthorityPrefixUserPref
}};
b.prototype.query=function(j){var g="",f,h;
if(typeof j!=="undefined"){this.queryPairs=a(j)
}for(f=0;
f<this.queryPairs.length;
f++){h=this.queryPairs[f];
if(g.length>0){g+="&"
}if(h[1]===null){g+=h[0]
}else{g+=h[0];
g+="=";
if(h[1]){g+=encodeURIComponent(h[1])
}}}return g.length>0?"?"+g:g
};
b.prototype.getQueryParamValue=function(g){var h,f;
for(f=0;
f<this.queryPairs.length;
f++){h=this.queryPairs[f];
if(g===h[0]){return h[1]
}}};
b.prototype.getQueryParamValues=function(h){var f=[],g,j;
for(g=0;
g<this.queryPairs.length;
g++){j=this.queryPairs[g];
if(h===j[0]){f.push(j[1])
}}return f
};
b.prototype.deleteQueryParam=function(j,m){var f=[],h,l,g,k;
for(h=0;
h<this.queryPairs.length;
h++){l=this.queryPairs[h];
g=e(l[0])===e(j);
k=l[1]===m;
if((arguments.length===1&&!g)||(arguments.length===2&&(!g||!k))){f.push(l)
}}this.queryPairs=f;
return this
};
b.prototype.addQueryParam=function(g,h,f){if(arguments.length===3&&f!==-1){f=Math.min(f,this.queryPairs.length);
this.queryPairs.splice(f,0,[g,h])
}else{if(arguments.length>0){this.queryPairs.push([g,h])
}}return this
};
b.prototype.replaceQueryParam=function(k,h,f){var g=-1,j,l;
if(arguments.length===3){for(j=0;
j<this.queryPairs.length;
j++){l=this.queryPairs[j];
if(e(l[0])===e(k)&&decodeURIComponent(l[1])===e(f)){g=j;
break
}}this.deleteQueryParam(k,f).addQueryParam(k,h,g)
}else{for(j=0;
j<this.queryPairs.length;
j++){l=this.queryPairs[j];
if(e(l[0])===e(k)){g=j;
break
}}this.deleteQueryParam(k);
this.addQueryParam(k,h,g)
}return this
};
["protocol","hasAuthorityPrefix","userInfo","host","port","path","query","anchor"].forEach(function(f){var g="set"+f.charAt(0).toUpperCase()+f.slice(1);
b.prototype[g]=function(h){this[f](h);
return this
}
});
b.prototype.scheme=function(){var f="";
if(this.protocol()){f+=this.protocol();
if(this.protocol().indexOf(":")!==this.protocol().length-1){f+=":"
}f+="//"
}else{if(this.hasAuthorityPrefix()&&this.host()){f+="//"
}}return f
};
b.prototype.origin=function(){var f=this.scheme();
if(f=="file://"){return f+this.uriParts.authority
}if(this.userInfo()&&this.host()){f+=this.userInfo();
if(this.userInfo().indexOf("@")!==this.userInfo().length-1){f+="@"
}}if(this.host()){f+=this.host();
if(this.port()){f+=":"+this.port()
}}return f
};
b.prototype.addTrailingSlash=function(){var f=this.path()||"";
if(f.substr(-1)!=="/"){this.path(f+"/")
}return this
};
b.prototype.toString=function(){var g,f=this.origin();
if(this.path()){g=this.path();
if(!(d.ends_with_slashes.test(f)||d.starts_with_slashes.test(g))){f+="/"
}else{if(f){f.replace(d.ends_with_slashes,"/")
}g=g.replace(d.starts_with_slashes,"/")
}f+=g
}else{if(this.host()&&(this.query().toString()||this.anchor())){f+="/"
}}if(this.query().toString()){if(this.query().toString().indexOf("?")!==0){f+="?"
}f+=this.query().toString()
}if(this.anchor()){if(this.anchor().indexOf("#")!==0){f+="#"
}f+=this.anchor()
}return f
};
b.prototype.clone=function(){return new b(this.toString())
};
return{init:b}
});
(window.AP||window._AP).define("host/_addons",["_dollar","_rpc"],function(b,c){var a={};
c.extend(function(){var d={_emitEvent:function(e){b.each(a[e.source.key],function(g,f){f.bus._emitEvent(e)
})
},remove:function(f){var e=a[f.addonKey][f.id];
if(e){e.bus.offAny(e.listener)
}delete a[f.addonKey][f.id];
return this
},init:function(e,g){if(!a[g.addonKey]){a[g.addonKey]={}
}var f=a[g.addonKey][g.id]={bus:g.events,listener:function(){var i=arguments[arguments.length-1];
var j=i.trace=i.trace||{};
var h=g.id+"|addon";
if(!j[h]){j[h]=true;
d._emitEvent(i)
}}};
f.bus.onAny(f.listener);
f.bus.on("ra.iframe.destroy",function(){d.remove(g)
})
}};
return d
})
});
(window.AP||window._AP).define("_base64",["_dollar"],function(e){function i(){this.buffer=[]
}i.prototype.append=function c(j){this.buffer.push(j);
return this
};
i.prototype.toString=function b(){return this.buffer.join("")
};
var f={codex:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(l){var j=new i();
var k=new d(l);
while(k.moveNext()){var s=k.current;
k.moveNext();
var q=k.current;
k.moveNext();
var o=k.current;
var r=s>>2;
var p=((s&3)<<4)|(q>>4);
var n=((q&15)<<2)|(o>>6);
var m=o&63;
if(isNaN(q)){n=m=64
}else{if(isNaN(o)){m=64
}}j.append(this.codex.charAt(r)+this.codex.charAt(p)+this.codex.charAt(n)+this.codex.charAt(m))
}return j.toString()
},decode:function(l){var k=new i();
var o=new h(l);
while(o.moveNext()){var j=o.current;
if(j<128){k.append(String.fromCharCode(j))
}else{if((j>191)&&(j<224)){o.moveNext();
var n=o.current;
k.append(String.fromCharCode(((j&31)<<6)|(n&63)))
}else{o.moveNext();
var n=o.current;
o.moveNext();
var m=o.current;
k.append(String.fromCharCode(((j&15)<<12)|((n&63)<<6)|(m&63)))
}}}return k.toString()
}};
function d(j){this._input=j;
this._index=-1;
this._buffer=[]
}d.prototype={current:Number.NaN,moveNext:function(){if(this._buffer.length>0){this.current=this._buffer.shift();
return true
}else{if(this._index>=(this._input.length-1)){this.current=Number.NaN;
return false
}else{var j=this._input.charCodeAt(++this._index);
if((j==13)&&(this._input.charCodeAt(this._index+1)==10)){j=10;
this._index+=2
}if(j<128){this.current=j
}else{if((j>127)&&(j<2048)){this.current=(j>>6)|192;
this._buffer.push((j&63)|128)
}else{this.current=(j>>12)|224;
this._buffer.push(((j>>6)&63)|128);
this._buffer.push((j&63)|128)
}}return true
}}}};
function h(j){this._input=j;
this._index=-1;
this._buffer=[]
}h.prototype={current:64,moveNext:function(){if(this._buffer.length>0){this.current=this._buffer.shift();
return true
}else{if(this._index>=(this._input.length-1)){this.current=64;
return false
}else{var p=f.codex.indexOf(this._input.charAt(++this._index));
var o=f.codex.indexOf(this._input.charAt(++this._index));
var n=f.codex.indexOf(this._input.charAt(++this._index));
var m=f.codex.indexOf(this._input.charAt(++this._index));
var l=(p<<2)|(o>>4);
var k=((o&15)<<4)|(n>>2);
var j=((n&3)<<6)|m;
this.current=l;
if(n!=64){this._buffer.push(k)
}if(m!=64){this._buffer.push(j)
}return true
}}}};
function g(j){return window.btoa?window.btoa(j):f.encode(j)
}function a(j){return window.atob?window.atob(j):f.decode(j)
}return{encode:g,decode:a}
});
_AP.define("analytics/analytics",["_dollar"],function(e){var b=["resize","init"];
var d=20000;
var g=100;
function f(){return window.performance&&window.performance.now?window.performance.now():new Date().getTime()
}function a(h,i){var j={};
this.addonKey=h;
this.moduleKey=i;
this.iframePerformance={start:function(){j.startLoading=f()
},end:function(){var k=f()-j.startLoading;
c.track("iframe.performance.load",{addonKey:h,moduleKey:i,value:k>d?"x":Math.ceil((k)/g)});
delete j.startLoading
},timeout:function(){c.track("iframe.performance.timeout",{addonKey:h,moduleKey:i});
this.end()
},cancel:function(){c.track("iframe.performance.cancel",{addonKey:h,moduleKey:i})
}}
}var c=a.prototype;
c.getKey=function(){return this.addonKey+":"+this.moduleKey
};
c.track=function(h,j){var i="connect.addon."+h;
if(AJS.Analytics){AJS.Analytics.triggerPrivacyPolicySafeEvent(i,j)
}else{if(AJS.trigger){AJS.trigger("analyticsEvent",{name:i,data:j})
}else{return false
}}return true
};
c.trackBridgeMethod=function(h){if(e.inArray(h,b)!==-1){return false
}this.track("bridge.invokemethod",{name:h,addonKey:this.addonKey,moduleKey:this.moduleKey})
};
return{get:function(h,i){return new a(h,i)
}}
});
(window.AP||window._AP).define("_jwt",["_base64"],function(b){function d(e){return a(e)["iss"]
}function a(h){if(null===h||""===h){throw ("Invalid JWT: must be neither null nor empty-string.")
}var g=h.indexOf(".");
var f=h.indexOf(".",g+1);
if(g<0||f<=g){throw ('Invalid JWT: must contain 2 period (".") characters.')
}var i=h.substring(g+1,f);
if(null===i||""===i){throw ("Invalid JWT: encoded claims must be neither null nor empty-string.")
}var e=b.decode(i);
return JSON.parse(e)
}function c(h,f){if(f===undefined){f=60
}var i=a(h),e=0,g=Math.floor(Date.now()/1000);
if(i&&i.exp){e=i.exp
}if((e-g)<f){return true
}return false
}return{parseJwtIssuer:d,parseJwtClaims:a,isJwtExpired:c}
});
_AP.define("host/jwt-keepalive",["_dollar","_jwt"],function(c,a){function b(d){var e=c.Deferred(function(g){var f=window._AP.contentResolver.resolveByParameters({addonKey:d.addonKey,moduleKey:d.moduleKey,productContext:d.productContext,uiParams:d.uiParams,width:d.width,height:d.height,classifier:"json"});
f.done(function(i){var h=JSON.parse(i);
g.resolve(h.src)
})
});
return e
}return{updateUrl:b,isExpired:a.isJwtExpired}
});
var deps=["_events","_jwt","_uri","_ui-params","host/_util"];
if(this.AP){deps=["_events","_jwt","_uri","_ui-params"]
}(this.AP||this._AP).define("_xdm",deps,function(b,d,f,g,a){var e=0;
function c(G,L,Q){var o,I,h,k,K,S,J,P,t,M=window,q=M.location.toString(),u=Q.local||{},C=Q.remote||[],E=B(q);
var j=function(){var w={};
return{add:function(V,U,T){w[V]={done:U||null,fail:T||null,async:!!U}
},invoke:function(V,U,T){var W;
if(w[U]){if(w[U][V]){w[U][V](T);
W=true
}else{W=!w[U].async&&V!=="fail"
}delete w[U]
}return W
}}
}();
if(!/xdm_e/.test(q)){G("#"+a.escapeSelector(L.container)).find("iframe").trigger("ra.iframe.destroy");
var p=y(L);
h=p.contentWindow;
J=m(L.remote,"oauth_consumer_key")||m(L.remote,"jwt");
P=L.remoteKey;
t=P;
k=B(L.remote).toLowerCase();
K=L.channel;
S={isHost:true,iframe:p,uiParams:L.uiParams,destroy:function(){window.clearTimeout(o.timeout);
x();
if(o.iframe){G(o.iframe).remove();
delete o.iframe
}},isActive:function(){return G.contains(document.documentElement,o.iframe)
}};
G(p).on("ra.iframe.destroy",S.destroy)
}else{h=M.parent;
J="local";
var v=m(q,"jwt");
P=v?d.parseJwtIssuer(v):m(q,"oauth_consumer_key");
if(null===P){P=Math.random()
}t=J;
k=m(q,"xdm_e").toLowerCase();
K=m(q,"xdm_c");
S={isHost:false,isActive:function(){return true
}}
}I=t+"|"+(e+=1);
o=G.extend({id:I,remoteOrigin:k,channel:K,addonKey:t},S);
function D(w,U,V){try{h.postMessage(JSON.stringify({c:K,i:w,t:U,m:V}),k)
}catch(T){n(A(T))
}}function R(V,W,U,T){var w=Math.floor(Math.random()*1000000000).toString(16);
j.add(w,U,T);
D(w,"request",{n:V,a:W})
}function N(w,T){D(w,"done",T)
}function O(w,T){D(w,"fail",T)
}function i(Z){try{var ad=JSON.parse(Z.data),X=ad.i,Y=ad.c,af=ad.t,ae=ad.m;
if(Z.source!==h&&Z.origin.toLowerCase()===k&&Y===K){h=Z.source
}if(Z.source!==h||Z.origin.toLowerCase()!==k||Y!==K){return
}if(af==="request"){var w=ae.n,ab=ae.a,ac=u[w],W,U,V;
if(ac){W=function(ag){N(X,ag)
};
U=function(ag){O(X,ag)
};
V=(ab?ab.length:0)<ac.length;
var T=u;
if(o.isHost===true){T=o;
if(T.analytics){T.analytics.trackBridgeMethod(w)
}}else{T.isHost=false
}try{if(V){ac.apply(T,ab.concat([W,U]))
}else{W(ac.apply(T,ab))
}}catch(aa){U(A(aa))
}}else{z("Unhandled request:",ad)
}}else{if(af==="done"||af==="fail"){if(!j.invoke(af,X,ae)){z("Unhandled response:",af,X,ae)
}}}}catch(aa){n(A(aa))
}}function r(w){return function(){var V=[].slice.call(arguments),U,T;
function W(){if(G.isFunction(V[V.length-1])){return V.pop()
}}T=W();
U=W();
if(!U){U=T;
T=undefined
}R(w,V,U,T)
}
}G.each(C,function(T,w){if(typeof T==="number"){T=w
}o[T]=r(T)
});
var s=o.events=new b.Events(J,E);
s.onAny(function(){var T=arguments[arguments.length-1];
var U=T.trace=T.trace||{};
var w=o.id+"|xdm";
if((o.isHost&&!U[w]&&T.source.channel!==o.id)||(!o.isHost&&T.source.key===J)){U[w]=true;
T=G.extend({},T);
delete T.trace;
z("Forwarding "+(o.isHost?"host":"addon")+" event:",T);
R("_event",[T])
}});
u._event=function(w){delete w.trace;
if(this.isHost){w.source={channel:this.id||I,key:this.addonKey,origin:this.remoteOrigin||k}
}z("Receiving as "+(this.isHost?"host":"addon")+" event:",w);
s._emitEvent(w)
};
function F(w){if(o.isActive()){i(w.originalEvent?w.originalEvent:w)
}else{x()
}}function l(){G(window).bind("message",F)
}function x(){G(window).unbind("message",F)
}function m(T,w){return new f.init(T).getQueryParamValue(w)
}function B(w){return new f.init(w).origin()
}function H(T,U){var w=new f.init(T);
G.each(U,function(W,V){w.addQueryParam(W,V)
});
return w.toString()
}function y(T){if(!T.container){throw new Error("config.container must be defined")
}var U=document.createElement("iframe"),V="easyXDM_"+T.container+"_provider",w="";
if(T.uiParams){w=g.encode(T.uiParams)
}G.extend(U,{id:V,name:w,frameBorder:"0"},T.props);
U.setAttribute("rel","nofollow");
G("#"+a.escapeSelector(T.container)).append(U);
U.src=T.remote;
return U
}function A(w){return w.message||w.toString()
}function z(){if(c.debug){n.apply(M,["DEBUG:"].concat([].slice.call(arguments)))
}}function n(){var w=G.log||(M.AJS&&M.AJS.log);
if(w){w.apply(M,arguments)
}}l();
return o
}return c
});
(this.AP||this._AP).define("_ui-params",["_dollar","_base64","_uri"],function(c,a,b){return{encode:function(d){if(d){return a.encode(JSON.stringify(d))
}},fromUrl:function(d){var d=new b.init(d),e=d.getQueryParamValue("ui-params");
return this.decode(e)
},fromWindowName:function(d,f){d=d||window;
var e=this.decode(d.name);
if(!f){return e
}return(e)?e[f]:undefined
},decode:function(g){var f={};
if(g&&g.length>0){try{f=JSON.parse(a.decode(g))
}catch(d){if(console&&console.log){console.log("Cannot decode passed ui params",g)
}}}return f
}}
});
_AP.define("host/_status_helper",["_dollar"],function(e){var b={loading:{descriptionHtml:'<div class="small-spinner"></div>Loading add-on...'},"load-timeout":{descriptionHtml:'<div class="small-spinner"></div>Add-on is not responding. Wait or <a href="#" class="ap-btn-cancel">cancel</a>?'},"load-error":{descriptionHtml:"Add-on failed to load."}};
function d(j){if(j.data("loadingStatusTimer")){clearTimeout(j.data("loadingStatusTimer"));
j.removeData("loadingStatusTimer")
}j.find(".ap-status").addClass("hidden")
}function f(k,j){d(k);
k.closest(".ap-container").removeClass("hidden");
k.find(".ap-stats").removeClass("hidden");
k.find(".ap-"+j).removeClass("hidden");
setTimeout(function(){var l=k.find(".small-spinner",".ap-"+j);
if(l.length&&l.spin){l.spin({zIndex:"1"})
}},10)
}function g(j){d(j)
}function c(k,j){if(!j){f(k,"loading")
}else{var l=setTimeout(f.bind(null,k,"loading"),j);
k.data("loadingStatusTimer",l)
}}function h(j){f(j,"load-timeout")
}function i(j){f(j,"load-error")
}function a(){var l,k=e('<div class="ap-stats" />');
for(l in b){var j=e('<div class="ap-'+l+' ap-status hidden" />');
j.append("<small>"+b[l].descriptionHtml+"</small>");
k.append(j)
}return k
}return{createStatusMessages:a,showLoadingStatus:c,showloadTimeoutStatus:h,showLoadErrorStatus:i,showLoadedStatus:g}
});;
;/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:remote-condition', location = 'js/condition/remote.js' */
_AP.define("condition/remote",["_dollar"],function(c){var b;
function a(){if(!b){b=true;
c(".remote-condition, #issue-tabs a[id$='-remote-condition'], .tabs a[id$='-remote-condition-panel']").each(function(d,f){var g=c(f),e=g.parent();
g.addClass("hidden");
if(e[0].tagName=="LI"){e.addClass("hidden")
}})
}}AJS.toInit(a);
return{hide:a}
});
if(!_AP.RemoteConditions){_AP.require(["condition/remote"],function(a){_AP.RemoteConditions=a
})
};;
;/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:ap-user', location = '/js/iframe/host/user.js' */
_AP.define("user",["_dollar","_rpc"],function(a,b){var c;
b.extend(function(d){return{init:function(e){c=e
},internals:{getUser:function(){var e=AJS.Meta,f=e?e.get("remote-user-fullname"):null;
if(!f){f=a("a#header-details-user-fullname, .user.ajs-menu-title, a#user").text()
}if(!f){f=a("a#user-menu-link").attr("title")
}return{fullName:f,id:c.uid,key:c.ukey}
},getTimeZone:function(){return c.timeZone
}}}
})
});;
;/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/main.js' */
_AP.define("host/main",["_dollar","_xdm","host/_addons","_rpc","_ui-params","analytics/analytics","host/_util","host/content-resolver"],function(c,f,k,h,e,i,g,j){var a=window.requestAnimationFrame||function(l){setTimeout(l,10)
};
window._AP.contentResolver=j;
function b(l){if(!l){throw new Error("ns undefined")
}return c("#embedded-"+g.escapeSelector(l))
}function d(w){if(typeof w.uiParams!=="object"){w.uiParams=e.fromUrl(w.src)
}var u=w.ns,o=b(u),n="embedded-"+u,q="channel-"+u,m=w.w||"100%",t=w.h||"0",p=new Date().getTime(),l=(o.closest(".aui-inline-dialog").length>0),v=!!w.simpleDlg,s;
if(typeof w.uiParams!=="object"){w.uiParams={}
}if(!!w.general){w.uiParams.isGeneral=true
}if(w.dlg){w.uiParams.isDialog=true
}if(w.isInlineDialog||l){w.uiParams.isInlineDialog=true
}var r={remote:w.src,remoteKey:w.key,container:n,channel:q,props:{width:m,height:t},uiParams:w.uiParams};
if(w.productCtx&&!w.productContext){w.productContext=JSON.parse(w.productCtx)
}h.extend({init:function(y,x){x.analytics=i.get(x.addonKey,u);
x.analytics.iframePerformance.start();
x.productContext=w.productContext
}});
h.init(w,r)
}return function(m){var n=0;
function l(){if(b(m.ns).length===0&&n<10){setTimeout(function(){n++;
l()
},50);
return
}d(m)
}if(typeof ConfluenceMobile!=="undefined"){l()
}else{if(AJS.$.isReady){a(l)
}else{c(l)
}}}
});
if(!_AP.create){_AP.require(["host/main"],function(a){_AP.create=a
})
}if(typeof ConfluenceMobile!=="undefined"){AJS.log("Connect add-ons on confluence mobile are temporarily disabled., See: https://ecosystem.atlassian.net/browse/AC-1210")
};;
;/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:iframe-host-js', location = '/js/iframe/host/content-resolver.js' */
_AP.define("host/content-resolver",["_dollar","_ui-params"],function(b,c){function a(e,d){return AJS.contextPath()+"/plugins/servlet/ac/"+encodeURIComponent(e)+"/"+encodeURIComponent(d)
}return{resolveByUrl:function(d){var e=jQuery.Deferred(function(f){f.resolve(d)
}).promise();
return e
},resolveByParameters:function(d){return b.ajax(a(d.addonKey,d.moduleKey),{dataType:"html",data:{"ui-params":c.encode(d.uiParams),"plugin-key":d.addonKey,"product-context":JSON.stringify(d.productContext),key:d.moduleKey,width:d.width||"100%",height:d.height||"100%",classifier:d.classifier||"raw"}})
}}
});;
;/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:jira-workflow-post-function', location = 'js/jira/workflow-post-function/workflow-post-function.js' */
_AP.define("jira/workflow-post-function",["_dollar"],function(c){function d(f,g){var e=c("#postFunction-config-"+f);
if(g){e.val(g)
}return e.val()
}function b(){return(c("input[name='postFunction.id']").length>0)
}function a(g,h,f){if(!b()){throw"Not on a workflow configuration page"
}var e=false;
c(document).delegate("#add_submit, #update_submit","click",function(i){if(!e||f){i.preventDefault();
h(function(j){if(j.valid){d(g,j.value);
e=true;
c(i.target).click()
}})
}})
}return{postFunctionConfigInput:d,isOnWorkflowPostFunctionPage:b,registerSubmissionButton:a}
});;
;/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:jira-workflow-post-function', location = 'js/jira/workflow-post-function/workflow-post-function-rpc.js' */
_AP.define("jira/workflow-post-function/rpc",["_dollar","_rpc","jira/workflow-post-function"],function(a,b,c){b.extend(function(){return{init:function(e,d){if(!c.isOnWorkflowPostFunctionPage()){return
}var f=d.setWorkflowConfigurationMessage;
c.registerSubmissionButton(e.productContext["postFunction.id"],f)
},internals:{getWorkflowConfiguration:function(e){var d=c.postFunctionConfigInput(this.productContext["postFunction.id"]);
if(e){e(d)
}return d
}},stubs:["setWorkflowConfigurationMessage"]}
})
});;
;/* module-key = 'com.atlassian.plugins.atlassian-connect-plugin:jira-events', location = '/js/jira/events.js' */
_AP.define("jira/events",["_dollar","_rpc"],function(b,c){var a={refreshIssuePage:function(){try{JIRA.trigger(JIRA.Events.REFRESH_ISSUE_PAGE,[JIRA.Issue.getIssueId()])
}catch(d){throw new Error("Failed to refresh the issue page")
}}};
c.extend(function(){return{internals:{triggerJiraEvent:function(){a.refreshIssuePage()
}}}
});
return a
});;
;/* module-key = 'com.atlassian.jira.plugins.jira-software-plugin:jira-software-project-template-resources', location = '/projecttemplates/soy/SoftwareDevelopmentTemplate.soy' */
// This file was automatically generated from SoftwareDevelopmentTemplate.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.SoftwareTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.SoftwareTemplates = {}; }


JIRA.Templates.ProjectTemplates.SoftwareTemplates.renderSoftwareDevelopmentExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="software-development-info"><div class="left-info"><p>', soy.$$escapeHtml("Select this project to work on new features for your product and to also track any bugs. JIRA will provide you with a basic workflow with the following issue types. You can optionally configure these later."), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">', soy.$$escapeHtml("Improvement"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">', soy.$$escapeHtml("New Feature"), '</span></span></li></ul></div><div class="right-info software-development-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/fecru-compatibility.js' */
if(jQuery!=undefined&&AJS!=undefined){jQuery=AJS.$};;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/rest-service.js' */
AppLinks=AJS.$.extend(window.AppLinks||{},{Event:{NAMESPACE:"applinks",}});AppLinks.Event=AJS.$.extend(window.AppLinks.Event,{PREREADY:AppLinks.Event.NAMESPACE+".preready",READY:AppLinks.Event.NAMESPACE+".ready"});if(AJS.AppLinksInitialisationBinder){AppLinks.initialisationBinder=AJS.AppLinksInitialisationBinder}else{AppLinks.initialisationBinder=function(a){AJS.toInit(a)}}AppLinks.initialisationBinder(function(){var b=AJS.$;AppLinks=b.extend(window.AppLinks||{},{failure:function(e){if(e.status==401){window.location.reload()}else{var c=AppLinks.parseError(e);var d=b(".page-error");if(d.length>0){d.html(c).fadeIn("slow")}else{alert("REST request failed: "+c)}}},jsonRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"json",contentType:"application/json; charset=utf-8",cache:false,success:g,error:c})},xmlRequest:function(d,e,f,g,c){if(f){f=JSON.stringify(f)}b(".page-error").fadeOut("fast");if(!c){c=AppLinks.failure}return jQuery.ajax({url:d,type:e,data:f,dataType:"xml",contentType:"application/xml; charset=utf-8",cache:false,success:g,error:c})},parseError:function(f){var c;try{c=JSON.parse(f.responseText)}catch(d){if(f.statusText){return c=f.statusText}else{return f}}if(c.message){if(b.isArray(c.message)){return c.message.join(" ")}return c.message}else{return f.statusText}},put:function(d,e,f,c){return AppLinks.jsonRequest(d,"PUT",e,f,c)},post:function(d,e,f,c){return AppLinks.jsonRequest(d,"POST",e,f,c)},update:function(d,e,c){AppLinks.put(AppLinks.self_link(d),d,e,c)},get:function(d,e,c){return AppLinks.jsonRequest(d,"GET",null,e,c)},getXml:function(d,e,c){return AppLinks.xmlRequest(d,"GET",null,e,c)},self_link:function(e){for(var c=0,f=e.link.length;c<f;c++){var d=e.link[c];if(d.rel=="self"){return d.href}}throw"No self-link found"},del:function(f,e,d){var c;if(typeof(f)=="string"){c=f}else{c=AppLinks.self_link(f)}return AppLinks.jsonRequest(c,"DELETE",null,e,d)},SPI:b.extend({},{API_VERSION:"1.0",REST_RESOURCE_URL:AJS.contextPath()+"/rest/applinks/",BASE_URL:AJS.contextPath()+"/rest/applinks/1.0",setApiVersion:function(c){AppLinks.SPI.API_VERSION=c;AppLinks.SPI.setBaseUrl(AppLinks.SPI.REST_RESOURCE_URL+AppLinks.SPI.API_VERSION)},setBaseUrl:function(c){AppLinks.SPI.BASE_URL=c},getRemoteRestBaseUrl:function(c){return c+"/rest/applinks/"+AppLinks.SPI.API_VERSION},getRemotePluginServletBaseUrl:function(c){return c+"/plugins/servlet"},getAllLinks:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink";return AppLinks.get(c,e,d)},getAllLinksWithAuthInfo:function(e,d){var c=AppLinks.SPI.BASE_URL+"/listApplicationlinks";return AppLinks.get(c,e,d)},getLinksOfType:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/type/"+e;return AppLinks.get(c,f,d)},tryToFetchManifest:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/manifest.json?url="+encodeURIComponent(e);return AppLinks.get(c,f,d)},getManifestFor:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/manifest/"+f+".json";return AppLinks.get(c,e,d)},getLocalManifest:function(e,d){var c=AppLinks.SPI.BASE_URL+"/manifest.json";return AppLinks.get(c,e,d)},getRemoteManifest:function(e,f,d){var c=AppLinks.SPI.getRemoteRestBaseUrl(e)+"/manifest.json";return AppLinks.get(c,f,d)},getRemoteOAuthConsumerInfo:function(e,f,d){var c=AppLinks.SPI.getRemotePluginServletBaseUrl(e)+"/oauth/consumer-info";return AppLinks.getXml(c,f,d)},createStaticUrlAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createStaticUrlAppLink?typeId="+f;return AppLinks.post(c,null,e,d)},createLink:function(j,h,l,d,i,k,f,m,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:l,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f};return AppLinks.post(c,g,m,e)},createLinkWithOrphanedTrust:function(j,h,m,d,i,k,f,l,n,e){var c=AppLinks.SPI.BASE_URL+"/applicationlinkForm/createAppLink";var g={applicationLink:j,username:h,password:m,createTwoWayLink:d,customRpcURL:i,rpcUrl:k,configFormValues:f,orphanedTrust:l};return AppLinks.post(c,g,n,e)},verifyTwoWayLinkDetails:function(c,i,j,f,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlinkForm/details";var g={username:j,password:f,remoteUrl:c,rpcUrl:i};return AppLinks.post(d,g,h,e)},getApplicationLinkInfo:function(e,f,d){var c=AppLinks.SPI.BASE_URL+"/applicationlinkInfo/id/"+e;return AppLinks.get(c,f,d)},deleteLink:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+g.id;if(c){d+="?reciprocate=true"}return AppLinks.del(d,f,e)},makePrimary:function(e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/primary/"+e.id;return AppLinks.post(c,null,d)},relocate:function(h,f,c,g,e){var d=AppLinks.SPI.BASE_URL+"/relocateApplicationlink/"+h.id+"?newUrl="+encodeURIComponent(f)+"&nowarning="+(c?"true":"false");return AppLinks.post(d,null,g,e)},legacyUpgrade:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/upgrade/legacy/"+f.id;return AppLinks.post(c,null,e,d)},ualUpgrade:function(g,c,f,e){var d=AppLinks.SPI.BASE_URL+"/upgrade/ual/"+g.id;return AppLinks.post(d,c,f,e)},getEntityTypesForApplicationType:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/type/entity/"+f;return AppLinks.get(c,e,d)},getLocalEntitiesWithLinksToApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/localEntitiesWithLinksTo/"+c+".json";return AppLinks.get(d,f,e)},getEntityLinksForApplication:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/"+c+".json";AppLinks.get(d,f,e)},getEntityLinksForApplicationUsingAnonymousAccess:function(c,f,e){var d=AppLinks.SPI.BASE_URL+"/entities/anonymous/"+c+".json";return AppLinks.get(d,f,e)},createNonUalEntityLink:function(l,g,d,f,j,e,k,i){var c=AppLinks.SPI.BASE_URL+"/entitylink/"+l+"/"+g+"?reciprocate=false";var h={applicationId:d,typeId:f,key:j,name:e,isPrimary:false};return AppLinks.put(c,h,k,i)},createEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?reciprocate=";e+=(c?"true":"false");return AppLinks.put(e,d,i,f)},getConfiguredEntityLinks:function(f,e,g,d){var c=AppLinks.SPI.BASE_URL+"/entitylink/primaryLinks/"+f+"/"+e+".json";return AppLinks.get(c,g,d)},deleteEntityLink:function(h,g,d,c,i,f){var e=AppLinks.SPI.BASE_URL+"/entitylink/"+h+"/"+g+"?typeId="+d.typeId+"&key="+d.key+"&applicationId="+d.applicationId+"&reciprocate="+c;return AppLinks.del(e,i,f)},makePrimaryEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/entitylink/primary/"+g+"/"+f+"?typeId="+c.typeId+"&key="+c.key+"&applicationId="+c.applicationId;return AppLinks.post(d,null,h,e)},canDeleteAppLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-application-delete/"+f;return AppLinks.get(c,e,d)},canDeleteEntityLink:function(g,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-delete/"+c.applicationId+"/"+g+"/"+f+"/"+c.typeId+"/"+c.key;return AppLinks.get(d,h,e)},canCreateReciprocateEntityLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/permission/reciprocate-entity-create/"+f;return AppLinks.get(c,e,d)},processPermissionCode:function(d){var c={noPermission:function(){},missing:function(){},credentialsRequired:function(e){},authenticationFailed:function(e){},noAuthentication:function(e){},noAuthenticationConfigured:function(){},noConnection:function(){},allowed:function(){},unrecognisedCode:function(e){},updateView:function(g,f,e){}};if(!d){d={}}d=b.extend(c,d);return function(f){var e=f.code;if(e=="NO_PERMISSION"){d.noPermission()}else{if(e=="MISSING"){d.missing()}else{if(e=="CREDENTIALS_REQUIRED"){d.credentialsRequired(f.url)}else{if(e=="AUTHENTICATION_FAILED"){d.authenticationFailed(f.url)}else{if(e=="NO_AUTHENTICATION"){d.noAuthentication(f.url)}else{if(e=="NO_AUTHENTICATION_CONFIGURED"){d.noAuthenticationConfigured()}else{if(e=="NO_CONNECTION"){d.noConnection()}else{if(e=="ALLOWED"){d.allowed()}else{d.unrecognisedCode(f.code)}}}}}}}}}},addAuthenticationTrigger:function(e,c,d){if(!d){d={}}if(typeof d.onSuccess=="undefined"){d.onSuccess=function(){location.reload()}}if(typeof d.onFailure=="undefined"){d.onFailure=function(){return true}}b(e).unbind("click");b(e).click(function(){if(d.before){d.before()}AppLinks.authenticateRemoteCredentials(c,d.onSuccess,d.onFailure)})},deleteOrphanedTrust:function(g,e,f,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/"+e+"/"+g;return AppLinks.del(c,f,d)},getOrphanedTrust:function(e,d){var c=AppLinks.SPI.BASE_URL+"/orphaned-trust/";return AppLinks.get(c,e,d)},showCreateEntityLinkSuggestion:function(){return true},getApplicationLink:function(f,e,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+f;return AppLinks.get(c,e,d)},createApplicationLink:function(f,d,i,j,c,k,g){var e=AppLinks.SPI.BASE_URL+"/applicationlink";var h={id:f,name:d,rpcUrl:i,displayUrl:j,typeId:c};return AppLinks.put(e,h,k,g)},createConsumer:function(e,n,d,m,i,l,g,p,h,k,o,f){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+e+"/authentication/consumer";var j={key:n,name:d,description:m,sharedSecret:i,publicKey:l,outgoing:k,twoLOAllowed:g,executingTwoLOUser:p,twoLOImpersonationAllowed:h};return AppLinks.put(c,j,o,f)},createConsumerAutoConfigure:function(j,i,f,c,h,e){var d=AppLinks.SPI.BASE_URL+"/applicationlink/"+j+"/authentication/consumer?autoConfigure=true";var g={twoLOAllowed:i,executingTwoLOUser:f,twoLOImpersonationAllowed:c};return AppLinks.put(d,g,h,e)},registerProvider:function(i,h,e,g,d){var c=AppLinks.SPI.BASE_URL+"/applicationlink/"+i+"/authentication/provider";var f={config:e,provider:h};return AppLinks.put(c,f,g,d)}},(window.AppLinks&&window.AppLinks.SPI)||{})});var a="applinks";AppLinks.UI={showInfoBox:function(c){b(".aui-message.success").remove();AppLinks.UI.createMessage("success",c,"page-info")},hideInfoBox:function(){b(".aui-message.success").remove()},showErrorBox:function(c){AppLinks.UI.createMessage("error",c,"page-error")},hideErrorBox:function(){b(".aui-message.error").remove()},showWarningBox:function(d){if(b.isArray(d)&&d.length>0){var c=b("<ul></ul>");b(d).each(function(f){c.append(b("<li/>",{text:d[f]}))});var e=b('<div class="page-warning"></div>').append(c);AppLinks.UI.createMessage("warning",e.html(),"page-warning")}else{AppLinks.UI.createMessage("warning",d,"page-warning")}},hideWarningBox:function(){b(".aui-message.warning").remove()},shortenString:function(d,c){if(d.length>c){d=d.substring(0,c)+"..."}return d},createMessage:function(d,e,c){var f=b('<div class="'+c+'">');f.html(e);AJS.messages[d](".applinks-message-bar",{title:"",body:f.wrap("<div></div>").parent().html(),closeable:true})},displayValidationErrorMessages:function(c,f,e){if(b.isArray(e)){b(e).each(function(j,h){var k=b('<div class="error applinks-error">');k.text(h);b(f).find("."+c).append(k)})}else{if(typeof e!="undefined"){var g=b('<div class="error applinks-error">');g.text(e.toString());b(f).find("."+c).append(g)}}},displayValidationError:function(c,d,e){return function(j){if(j.status==401){window.location.reload();return}b(".applinks-error").remove();b(".loading").remove();var h=j.responseText;var i=b.parseJSON(h);var g=i.message;if(typeof i.fields=="undefined"){AppLinks.UI.displayValidationErrorMessages(c,d,g)}else{var f=i.fields;b(f).each(function(k){var l=b('<div class="error applinks-error" id="'+f[k]+'-error">');l.text(g[k]);if(b(d).find("."+f[k]).length>0){l.insertAfter(b(d).find("."+f[k]))}else{l.insertAfter(b(d).find("."+c).append(l))}})}b(d).find("."+c).addClass("fully-populated-errors");if(e){e()}}},addProtocolToURL:function(c){var f=b.trim(c);var e=f.toLowerCase();var d=false;if(e.length>=7){if(e.substring(0,7).indexOf("http")!=-1){d=true}}if(!d){f="http://"+f}return f},prettyJoin:function(d,g,f){if(!f){f=AppLinks.I18n.getText("applinks.and")}var c=d.length;var e="";b.each(d,function(h,i){if(h==(c-1)&&c>1){e+=" "+f+"  "+g(i)}else{e+=g(i);if(h+2<c){e+=", "}}});return e},showLoadingIcon:function(c){b('<span class="loading">&nbsp;</span>').insertAfter(c)},hideLoadingIcon:function(c){b(c).next(".loading").remove()},findUrl:function(f){var e=undefined;var g=f.toLowerCase();var d=g.indexOf("http:");if(d==-1){d=g.indexOf("https:")}if(d>-1){var c=g.indexOf(" ",d);if(c==-1){c=g.length}e=f.substring(d,c)}return e},findApplicationType:function(c){c=c.toLowerCase();if(c.indexOf("jira")!=-1){return"jira"}else{if(c.indexOf("fisheye")!=-1){return"fecru"}else{if(c.indexOf("confluence")!=-1){return"confluence"}else{if(c.indexOf("refapp")!=-1){return"refapp"}else{return undefined}}}}},escapeSelector:function(c){return c.replace(/([#;&,\.\+\*\~':"\!\^$\[\]\(\)=>\|])/g,"\\$1")},sanitiseHTML:function(c){var d={"<":"&lt;",'"':"&quot;","&":"&amp;"};return c.replace(/[<"&]/g,function(e){return d[e]})},refreshOrphanedTrust:function(){var c=function(d){b("tr.orphaned-trust-row").each(function(){var j=b(this);var k=j.attr("data-id");var g=j.attr("data-type");var f=false;for(var e=0;e<d.orphanedTrust.length;e++){var h=d.orphanedTrust[e];if(k==h.id&&g==h.type){f=true;break}}if(!f){j.remove();if(d.orphanedTrust.length==0){b(".orphaned-trust-warning").hide()}}})};AppLinks.SPI.getOrphanedTrust(c)},removeCssClass:function(c,d){b(c).removeClass(function(f,h){var g=h.split(" ");var e="";b.each(g,function(i,j){if(j.indexOf(d)!=-1){e=j}});return e})}};(function(){var c=b({});b.each(["bind","unbind","trigger"],function(d,e){AppLinks.UI[e]=function(){return c[e].apply(c,arguments)}})})();AppLinks.I18n={interpolate:function(d,c){if(c){if(!b.isArray(c)){c=[new String(c)]}c.unshift(d);d=AJS.format.apply(AJS,c)}return d},getTextWithPrefix:function(c,d){return AppLinks.I18n.interpolate(appLinksI18n.entries[a+"."+c],d)},getText:function(c,d){return AppLinks.I18n.interpolate(AppLinks.I18n.resolveValue(c),d)},getApplicationTypeName:function(c){return appLinksI18n.entries["applinks.application.type."+c]},getEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type."+c]},getPluralizedEntityTypeName:function(c){return appLinksI18n.entries["applinks.entity.type.plural."+c]},getAuthenticationTypeName:function(c){return appLinksI18n.entries["applinks.auth.provider."+c]},resolveValue:function(c){var d=appLinksI18n.entries[c];return typeof d=="undefined"?c:d}};AppLinks.Docs={createDocLink:function(d,e,c){if(!c){c=""}else{c=" "+c}return b("<a/>",{"class":"ual-help-link"+c,href:AppLinks.Docs.getDocHref(d,e),target:"_blank",text:AppLinks.I18n.getText("applinks.help"),title:AppLinks.I18n.getText("applinks.help")})},getDocHref:function(d,e){var c=AppLinks.Docs.resolveValue("applinks.docs.root")+"/"+AppLinks.Docs.resolveValue(d);if(e){c+="#"+AppLinks.Docs.resolveValue(e)}return c},resolveValue:function(c){var d=applinksDocs.entries[c];return typeof d=="undefined"?c:d}};b(document).trigger(AppLinks.Event.PREREADY);b(document).trigger(AppLinks.Event.READY)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/json2.js' */
if(!this.JSON){this.JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){k=rep[i];if(typeof k==="string"){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/autocomplete.js' */
AJS.$(document).bind(AppLinks.Event.READY,function(){AppLinks.autoComplete={cacheManager:function(c){var a={},b=[],c=c||30;return{get:function(d){return a[d]},put:function(d,e){a[d]=e;b.push(d);if(b.length>c){delete a[b.shift()]}},clear:function(){a={};b=[]}}}};(function(d){var c=function(f){AJS.log("InputDrivenDropDown: truncating text");var h=f.$.closest(".aui-dropdown").width(),g=20;d("a span:not(.icon)",f.$).each(function(){var j=d(this),i=AJS("var","&#8230;"),l=i.width(),k=false;j.wrapInner(d("<em>"));d("em",j).each(function(){var m=d(this);m.show();if(this.offsetLeft+this.offsetWidth>h){var t=this.childNodes,s=false;for(var o=t.length-1;o>=0;o--){var p=t[o],n=1,r=(p.nodeType==3)?"nodeValue":"innerHTML",q=p[r];do{if(n<=q.length){p[r]=q.substr(0,q.length-n++)}else{break}}while(this.offsetLeft+this.offsetWidth+l>h-g);if(n<=q.length){s=true;break}}if(s){k=true}else{m.hide()}}});if(k){j.append(i);this.elpss=i}})};var b=function(f,l){if(!l.length||!l[0]){return}AJS.log("InputDrivenDropDown: highlighting tokens");for(var h=0,j=l.length;h<j;h++){var g=l[h];l[h]=g?g.replace(/[\.\*\+\?\|\(\)\[\]{}\\]/g,"\\$"):""}var k=new RegExp("("+l.join("|")+")","gi");d("li a:not(.dropdown-prevent-highlight) span",f.$).each(function(){var m=d(this),i=m.html().replace(k,"<strong>$1</strong>");m.html(i)})};var e=function(j,g){var i=j.options,h=j.dd;if(h){h.hide();h.$.remove()}i.ajsDropDownOptions=i.ajsDropDownOptions||{};if(i.ajsDropDownOptions&&!i.ajsDropDownOptions.alignment){i.ajsDropDownOptions.alignment="left"}i.ajsDropDownOptions.selectionHandler=i.ajsDropDownOptions.selectionHandler||function(l,k){if(l.type!="click"){l.preventDefault();d("a",k).click();document.location=d("a",k).attr("href")}};i.ajsDropDownOptions.displayHandler=function(k){return AJS.escapeHtml(k.name)};var f=j.dd=new AJS.dropDown(g.matrix,i.ajsDropDownOptions)[0];if(i.ajsDropDownOptions&&i.ajsDropDownOptions.className){f.$.addClass(i.ajsDropDownOptions.className)}if(i.dropdownPlacement){i.dropdownPlacement(f.$)}else{AJS.log("No dropdownPlacement function specified. Appending dropdown to the body.");d("body").append(f.$)}b(f,g.queryTokens||[g.query]);c(f);if(i.dropdownPostprocess){i.dropdownPostprocess(f.$)}f.show(j._effect);if(typeof i.onShow=="function"){i.onShow.call(f,f.$)}return f};function a(g,f){this._effect="appear";this._timer=null;this.id=g;this.options=f;this.inactive=false;this.busy=false;this.cacheManager=AppLinks.autoComplete.cacheManager()}a.prototype.clearCache=function(){this.cacheManager.clear()};a.prototype.change=function(h,g){var f=this;if(h!=f._value||g){f._value=h;f.busy=false;clearTimeout(f._timer);if(g||(/\S{0,}/).test(h)){var i=f.cacheManager.get(h);if(i){e(f,i)}else{f.busy=true;f._timer=setTimeout(function(){f.options.getDataAndRunCallback.call(f,h,f.show)},200)}}else{f.dd&&f.dd.hide()}}};a.prototype.dropDownLength=function(){return this.dd.links?this.dd.links.length:0};a.prototype.dropDownItem=function(f){return this.dropDownLength()>f?this.dd.links[f]:null};a.prototype.hide=function(){this.dd&&this.dd.hide()};a.prototype.remove=function(){var f=this.dd;if(f){this.hide();f.$.remove()}this.inactive=true;this.options.onDeath&&this.options.onDeath()};a.prototype.show=function(g,i,h){if(this.inactive){AJS.log("Quick search abandoned before server response received, ignoring. "+this);return}var f={matrix:g,query:i,queryTokens:h};this.cacheManager.put(i,f);e(this,f);this.busy=false};AppLinks.inputDrivenDropdown=function(f){return new a("inputdriven-dropdown",f)}})(jQuery)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/wizard.js' */
AJS.$(document).bind(AppLinks.Event.PREREADY,function(){(function(d){d.fn.wizard=function(v){var u={width:500,height:350,onshow:function(w,x){return true},aftershow:function(){return true},oncancel:function(){return true},onsubmit:function(){return true},aftersubmit:function(){return true},onnext:function(){return true},onprevious:function(){return true},cancelLabel:AppLinks.I18n.getText("applinks.cancel"),submitLabel:AppLinks.I18n.getText("applinks.create"),nextLabel:AppLinks.I18n.getText("applinks.next"),previousLabel:AppLinks.I18n.getText("applinks.previous"),id:""};if(!v){v={}}v=d.extend(u,v);var t=this;this.each(function(){var D=d(this);var w=new AJS.Dialog(v.width,v.height,v.id);var L=q(w,v.onshow,v.aftershow);var K=c(w,v.oncancel);var z=h(w,v.onsubmit,v.aftersubmit);var M=a(w,v.onprevious);var I=m(w,v.onnext);var G=k(w);var B=o(w);var C=g(w);var H=l(w);var J=s(w);var E=n(w);if(v.showButtonId){d("#"+v.showButtonId).click(L)}var y=f(D);for(var A=0;A<y.length;A++){var F=y[A];j(w,F);if(F.className){w.addHeader(F.title,F.className+"-header")}else{w.addHeader(F.title)}if(A!=0&&d(F.div).attr("previous")!="false"){w.addButton(v.previousLabel,M,"applinks-previous-button")}if(A<y.length-1&&d(F.div).attr("submit")!="true"&&d(F.div).attr("next")!="false"){w.addButton(v.nextLabel,I,"applinks-next-button")}if(d(F.div).attr("submit")=="true"){w.addButton(v.submitLabel,z,"wizard-submit")}if(!w.getPage(A).buttonpanel){w.addButton("",null);d(w.getPage(A).buttonpanel).empty();var x=d('<a class="button-panel-button applinks-cancel-link">'+v.cancelLabel+"</a>");w.getPage(A).buttonpanel.append(x);x.click(K)}else{var x=d('<a class="button-panel-link button-panel-cancel-link applinks-cancel-link">'+v.cancelLabel+"</a>");d(w.getPage(A).buttonpanel).append(x);x.click(K)}if(A<y.length-1){w.addPage()}}t={dialog:w,nextPage:I,prevPage:M,submit:z,cancel:K,show:L,disableNextBtn:G,enableNextBtn:B,disableSubmitBtn:C,enableSubmitBtn:H,disablePreviousBtn:J,enablePreviousBtn:E};w.gotoPage(0);w.gotoPanel(0)});return t};function s(t){return function(){b(r(t,"applinks-previous-button"))}}function n(t){return function(){i(r(t,"applinks-previous-button"))}}function k(t){return function(){b(r(t,"applinks-next-button"))}}function o(t){return function(){i(r(t,"applinks-next-button"))}}function g(t){return function(v){var u=r(t,"wizard-submit");b(u);if(typeof(v)=="undefined"||v){d('<span class="loading">&nbsp;</span>').insertBefore(u)}else{u.parent().find(".loading").remove()}}}function l(t){return function(){var u=r(t,"wizard-submit");i(u);u.parent().find(".loading").remove()}}function r(u,t){return d(u.getPage(u.curpage).buttonpanel).find("."+t)}function p(t){d(t.popup.element).find("form").each(function(){this.reset()})}function i(t){t.attr("disabled",false)}function b(t){t.attr("disabled",true)}function q(t,u,v){return function(w){if(u(t,w)!==false){t.gotoPage(0);t.gotoPanel(0);d(document).unbind("keydown.ual.dialog");d(document).bind("keydown.ual.dialog",e(t));t.show();v()}}}function c(t,u){return function(){if(u(t)!==false){t.hide();p(t)}}}function a(t,u){return function(){if(u(t)!==false){t.prevPage()}}}function m(t,u){return function(){if(u(t)!==false){t.nextPage()}}}function e(t){return function(u){if(u.keyCode===27){p(t);d(document).unbind("keydown.ual.dialog")}}}function h(u,v,t){return function(){if(v(u)!==false){t(u);p(u)}}}function j(v,w){var u=d("> div[panel]",w.div);if(u.length>0){u.each(function(y,z){var x=v.addPanel(z.title,null,z.className,"menu-"+z.id);x.getCurrentPanel().body.append(u[y])})}else{var t=v.addPanel(w.title);t.getCurrentPanel().body.append(w.div)}}function f(v){var u=d(" > div",v);var t=[];u.each(function(x){var w=d(this);t[x]={title:w.attr("title")||null,className:w.attr("class"),div:w}});return t}})(jQuery)});;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/applinkwizard.js' */
(function(a){AppLinks.Wizard={getWizard:function(){return a("#create-application-link-container").data("wizard")},initAuthenticationUI:function(d){var h=a(d);var f=h.find(".create-reciprocal-link");var c=h.find(".ual-arrow");var l=h.find(".two-way-link-details");var j=h.find(".reciprocal-link-description");var b=h.find(".no-reciprocal-link-description");f.click(function(){if(f.is(":checked")){c.removeClass("no-background");l.show();j.show();b.hide()}else{c.addClass("no-background");l.hide();j.hide();b.show()}});var i=h.find(".same-user-radio-btn");var k=h.find(".different-user-radio-btn");var e=h.find(".different-userbase-image");var g=h.find(".same-userbase-image");i.click(function(){e.addClass("different-userbase-image-grey");g.removeClass("same-userbase-image-grey")});k.click(function(){g.addClass("same-userbase-image-grey");e.removeClass("different-userbase-image-grey")})},initNonUALUI:function(e){var c=a(e);var b=c.find(".application-types");for(var d=0;d<nonAppLinksApplicationTypes.length;d++){a('<option value="'+nonAppLinksApplicationTypes[d].typeId+'">'+nonAppLinksApplicationTypes[d].label+"</option>").appendTo(b)}},fetchManifest:function(e,h,d,b){var i=h.find("#application-url");if(i.val()==""){var c=h.find("#application-types");if(c.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(i);return false}var g=function(j){e.enableSubmitBtn();e.enablePreviousBtn();e.cancel();AppLinks.UI.listApplicationLinks(j.applicationLink.id,"new",j)};AppLinks.SPI.createStaticUrlAppLink(c.val(),g,null);return true}var f=AppLinks.UI.addProtocolToURL(i.val());AppLinks.UI.showLoadingIcon(i);var g=function(l){var k=l;e.enableNextBtn();h.find(".loading").remove();h.find(".reciprocal-rpc-url").val(a("#baseUrl").val());if(typeof l.typeId!="undefined"){AppLinks.Wizard.handleUALManifest(k,h);e.dialog.gotoPage(2);h.find(".reciprocal-link-username").focus();if(d){d(k)}}else{if(l.code=="applinks.warning.redirected.host"&&!i.data("hasWarnedAboutRedirection")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("hasWarnedAboutRedirection","true");var m=function(){a(i).removeData("hasWarnedAboutRedirection");a(i).unbind("change",m)};i.bind("change",m)}else{if(l.code=="applinks.warning.unknown.host"&&!i.data("forceWhenHostIsOffline")){AppLinks.UI.displayValidationErrorMessages("manifest-validation-errors",h,l.warning);i.data("forceWhenHostIsOffline","true");var j=function(){a(i).removeData("forceWhenHostIsOffline");a(i).unbind("change",j)};i.bind("change",j)}else{if(k.code=="applinks.warning.unknown.host"||k.code=="applinks.warning.redirected.host"){delete k.warning;delete k.code}AppLinks.Wizard.handleNonUALManifest(k,f,h);e.dialog.gotoPage(1);h.find(".application-name").focus();if(b){b(k)}}}}};e.disableNextBtn();AppLinks.SPI.tryToFetchManifest(f,g,AppLinks.UI.displayValidationError("manifest-validation-errors",h,function(){e.enableNextBtn()}));return f},handleUALManifest:function(f,e){var c=a(e);c.find(".remote-app-image").removeClass(function(j,l){var k=l.split(" ");var i="";a.each(k,function(m,n){if(n.indexOf("application-type-image-")!=-1){i=n}});return i});c.find(".remote-app-image").addClass("application-type-image-"+f.typeId);c.find(".link-to-app-type").html(AppLinks.I18n.getText("applinks.create.title.link.to",AppLinks.I18n.getApplicationTypeName(f.typeId)));c.find(".remote-app-name").text(AppLinks.UI.shortenString(f.name,20));c.find(".create-reciprocal-link").attr("checked",true);c.find("#reciprocal-link-back-to-server").html(AppLinks.I18n.getText("applinks.create.link.back.to.server",AJS.escapeHtml(f.name)));var d=["administrator",AJS.escapeHtml(f.name),'<a target="_blank" href="'+AppLinks.Docs.getDocHref("applinks.docs.adding.application.link")+'">',"</a>"];var h=f.applinksVersion.split(".");var b=parseInt(h[0]);var g=parseInt(h[1]);if((f.typeId=="jira"||f.typeId=="confluence")&&(b==3&&g<10)){d[0]="system administrator"}c.find(".reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.link",d));c.find(".no-reciprocal-link-description").hide();c.find(".no-reciprocal-link-description").html(AppLinks.I18n.getText("applinks.create.two.way.no.link",AJS.escapeHtml(f.name)));c.find(".reciprocal-link-username").val("");c.find(".reciprocal-link-password").val("");c.find(".ual-arrow").removeClass("no-background");c.find(".two-way-link-details").show();c.find(".reciprocal-link-description").show();c.find(".no-reciprocal-link-description").hide()},handleNonUALManifest:function(d,e,c){var b=a(c);b.find(".application-name").val("");b.find(".application-types option:first-child").attr("selected","selected");b.find(".non-ual-application-url").text(e);if(d.warning){b.find(".create-non-ual-warning").show();b.find(".create-non-ual-warning").html(d.warning)}else{b.find(".create-non-ual-warning").hide()}},checkReciprocalLinkFormThreeStepMode:function(c,d,g,j,f){var h=a(c);if(h.find(".create-reciprocal-link").is(":checked")){var k=a.trim(h.find(".reciprocal-rpc-url").val());if(k==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(h.find(".reciprocal-rpc-url"));if(f){f()}return}var e=h.find(".reciprocal-link-username");var b=h.find(".reciprocal-link-password");if(e.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(e);if(f){f()}return false}var i=function(l){h.find(".same-user-description").find("input").attr("checked",true);h.find(".trust-radio-btn").attr("checked",true);h.find(".same-user-radio-btn").click();g(l)};k=AppLinks.UI.addProtocolToURL(k);AppLinks.SPI.verifyTwoWayLinkDetails(j,k,e.val(),b.val(),i,AppLinks.UI.displayValidationError("two-way-link-errors",c,f));return false}else{d();return false}},checkReciprocalLinkFormTwoStepMode:function(f,h,b,i){var c=a(f);var g=a.trim(c.find(".reciprocal-rpc-url").val());if(g==""){a("<div class='error applinks-error'>"+AppLinks.I18n.getText("applinks.error.url.field.empty")+"</div>").insertAfter(c.find(".reciprocal-rpc-url"));if(i){i()}return}var d=c.find(".reciprocal-link-username");var e=c.find(".reciprocal-link-password");if(d.val()==""){a('<div class="error applinks-error">'+AppLinks.I18n.getText("applinks.error.username.empty")+"</div>").insertAfter(d);if(i){i()}return false}g=AppLinks.UI.addProtocolToURL(g);AppLinks.SPI.verifyTwoWayLinkDetails(h,g,d.val(),e.val(),b,AppLinks.UI.displayValidationError("two-way-link-errors",f,i));return false}}})(AJS.$);;
;/* module-key = 'com.atlassian.applinks.applinks-plugin:applinks-util-js', location = 'js/urls.js' */
(function(){AppLinks.Urls={generateUrl:function(b,a){var c=b;if(typeof a=="undefined"){return c}else{AJS.$.each(a,function(d,e){if(c.indexOf("?")<0){c=c+"?"}else{c=c+"&"}c=c+d+"="+encodeURIComponent(JSON.stringify(e))});return c}},generateApplinksAdminUrl:function(d,c,a){var b=d+"/plugins/servlet/applinks/listApplicationLinks";if(c==="confluence"){b=d+"/admin/listapplicationlinks.action"}return AppLinks.Urls.generateUrl(b,a)}}})();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-applinks-common-plugin:issue-link-applinks', location = 'js/issuelink-applinks.js' */
var IssueLinkAppLinks=IssueLinkAppLinks||(function($){function createHelper(servers,context,settings){var helper={};var selectedServer=null;function selectServer(appId){selectedServer=getServer(servers,appId);var authenticationRequired=selectedServer&&selectedServer.requireCredentials;doAuthenticationRequired(authenticationRequired,context);return{authenticationRequired:authenticationRequired}}function setAuthenticationRequired(appId,authenticationRequired){var server=getServer(servers,appId);if(server){server.requireCredentials=authenticationRequired;if(selectedServer&&selectedServer.id===appId){doAuthenticationRequired(authenticationRequired,context)}}}function doAuthenticationRequired(required,context){$(".issue-link-applinks-authentication-message",context).empty();if(required){createAuthRequiredBanner($(".issue-link-applinks-authentication-message",context),context);$(".issue-link-oauth-toggle").hide();$(".buttons-container input[type=submit]",context).attr("disabled","disabled")}else{$(".issue-link-oauth-toggle").show();$(".buttons-container input[type=submit]",context).removeAttr("disabled")}}function createAuthRequiredBanner($container,context){var oauthCallbacks={onSuccess:function(){selectedServer.requireCredentials=false;doAuthenticationRequired(false,context);if(settings.onAuthenticationSuccessCallback){settings.onAuthenticationSuccessCallback(context,selectedServer.id,helper)}},onFailure:function(){if(settings.onAuthenticationFailedCallback){settings.onAuthenticationFailedCallback(context,selectedServer.id,helper)}}};var encodedServerName=AJS.escapeHtml(selectedServer.name);if(selectedServer.authUrl){var $banner=$('<div class="aui-message warning closeable shadowed applinks-auth-request"><p><span class="aui-icon icon-applinks-key"></span></p></div>');$banner.append(AJS.format("Authorization required to create issue link. Please \u003ca href=\"{0}\" class=\"applink-authenticate\"\u003eauthenticate\u003c/a\u003e with \u003ca href=\"{1}\"\u003e{2}\u003c/a\u003e.",selectedServer.authUrl,selectedServer.url,encodedServerName));$("a",$banner).addClass("applink-authenticate");$(".applink-authenticate",$banner).click(function(e){authenticateRemoteCredentials(selectedServer.authUrl,oauthCallbacks.onSuccess,oauthCallbacks.onFailure);e.preventDefault()});$container.append($banner)}else{var warningMessage=AJS.format("Unable to create a link to \u003ca href=\"{0}\"\u003e{1}\u003c/a\u003e as the application does not have any authentication configured.",selectedServer.url,encodedServerName);AJS.messages.warning($container,{body:warningMessage})}}function createOAuthCallback(){if(!AppLinks.OAuthCallback&&typeof (oauthCallback)==="undefined"){AppLinks.OAuthCallback=function(){};AppLinks.OAuthCallback.prototype.success=function(){this.aouthWindow.close();this.onSuccess();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.failure=function(){this.aouthWindow.close();this.onFailure();delete oauthCallback;delete AppLinks.OAuthCallback};AppLinks.OAuthCallback.prototype.show=function(url,onSuccess,onFailure){this.onSuccess=onSuccess;this.onFailure=onFailure;this.aouthWindow=window.open(url,"com_atlassian_applinks_authentication")};oauthCallback=new AppLinks.OAuthCallback()}}function authenticateRemoteCredentials(url,onSuccess,onFailure){createOAuthCallback();$(".applinks-error").remove();oauthCallback.show(url,onSuccess,onFailure)}return $.extend(helper,{selectServer:selectServer,setAuthenticationRequired:setAuthenticationRequired})}function getServer(servers,appId){var i;if(servers.length){for(i=0;i<servers.length;i++){if(servers[i].id===appId){return servers[i]}}}return null}function initApplinkServers(settings,context,deferred){var currentAppId=settings.getCurrentAppId(context);var applicationType=$(".issue-link-applinks-application-type",context).val();var issueId=settings.getIssueId(context);$.get(AJS.contextPath()+"/rest/issueLinkAppLink/1/appLink/info",{type:applicationType,issueIdOrKey:issueId},function(servers){var helper=createHelper(servers,context,settings);var currentRequiresCredentials;if(servers&&servers.length){var currentServer=getServer(servers,currentAppId);if(currentServer){currentRequiresCredentials=$(".issue-link-applinks-authentication-message",context).hasClass("required");if(currentRequiresCredentials){currentServer.requireCredentials=true}helper.selectServer(currentAppId)}deferred.resolve(context,helper)}else{deferred.reject(context)}})}function init(settings,context){var deferred=$.Deferred();var isIssueLinkAppLinkContent=$(".issue-link-applinks-authentication-message",context).length!==0;if(isIssueLinkAppLinkContent&&settings.shouldExecute(context)){initApplinkServers(settings,context,deferred)}return deferred.promise()}return{init:init}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-remote-jira-js', location = 'js/issuelink-jira.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#jira-app-link",context).val()},shouldExecute:function(context){return $("#jira-app-link",context).length!==0},getIssueId:function(context){return $("input[name=id]",context).val()}};var updateIssuePicker=function($select,appId){if($select.length){$select.attr("data-ajax-options.data.app-id",appId);if(appId&&appId!==""){$select.attr("data-ajax-options.url",contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/picker")}else{$select.attr("data-ajax-options.url",contextPath+"/rest/api/2/issue/picker")}$select.trigger("updateOptions");$select.trigger("clearSelection")}};var updateCreateReciprocalCheckbox=function(appId,context){var $reciprocalCheckbox=$("#create-reciprocal",context);if($reciprocalCheckbox.length){if(appId&&appId!==""){var defaultChoice=($("#create-reciprocal-default",context).val()=="true");if(defaultChoice){$reciprocalCheckbox.attr("checked","checked")}else{$reciprocalCheckbox.removeAttr("checked")}$reciprocalCheckbox.removeAttr("disabled");$("#create-reciprocal-fieldset",context).removeClass("disabled")}else{$reciprocalCheckbox.attr("checked","checked");$reciprocalCheckbox.attr("disabled","disabled");$("#create-reciprocal-fieldset",context).addClass("disabled")}}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){var $select=$("#jira-issue-keys",context);if($select.length){var appId=$("#jira-app-link",context).val();updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)}IssueLinkAppLinks.init(settings,context).done(function(context,helper){$("#jira-app-link",context).change(function(){var appId=$(this).val();helper.selectServer(appId);updateIssuePicker($select,appId);updateCreateReciprocalCheckbox(appId,context)})})})})(AJS.$);;
;/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/JQLAutoComplete.js' */
define("jira/jql/jql-grammar",function(){var grammar={};grammar.jql_order_by=[{value:"ORDER BY",displayName:"ORDER BY"}];grammar.jql_operators=[{value:"=",displayName:"="},{value:"!=",displayName:"!="},{value:"~",displayName:"~"},{value:"<=",displayName:"&lt;="},{value:">=",displayName:"&gt;="},{value:">",displayName:"&gt;"},{value:"<",displayName:"&lt;"},{value:"!~",displayName:"!~"},{value:"is not",displayName:"is not"},{value:"is",displayName:"is"},{value:"not in",displayName:"not in"},{value:"in",displayName:"in"},{value:"was",displayName:"was"},{value:"was not",displayName:"was not"},{value:"was in",displayName:"was in"},{value:"was not in",displayName:"was not in"},{value:"changed",displayName:"changed"}];grammar.jql_logical_operators=[{value:"AND",displayName:"AND"},{value:"OR",displayName:"OR"}];grammar.jql_logical_operators_and_order_by=grammar.jql_logical_operators.concat(grammar.jql_order_by);grammar.jql_order_by_direction=[{value:"ASC",displayName:"ASC"},{value:"DESC",displayName:"DESC"}];grammar.empty_operand=[{value:"EMPTY",displayName:"EMPTY",types:["java.lang.Object"]}];grammar.jql_not_logical_operator=[{value:"NOT",displayName:"NOT"}];grammar.jql_was_predicates=[{value:"AFTER",displayName:"AFTER",type:"java.util.Date",supportsList:"false"},{value:"BEFORE",displayName:"BEFORE",type:"java.util.Date",supportsList:"false"},{value:"BY",displayName:"BY",type:"com.atlassian.crowd.embedded.api.User",supportsList:"false",auto:"true"},{value:"DURING",displayName:"DURING",type:"java.util.Date",supportsList:"true"},{value:"ON",displayName:"ON",type:"java.util.Date",supportsList:"false"}];grammar.jql_changed_predicates=grammar.jql_was_predicates.concat([{value:"FROM",displayName:"FROM",type:"java.lang.String",supportsList:"true",auto:"true"},{value:"TO",displayName:"TO",type:"java.lang.String",supportsList:"true",auto:"true"}]);grammar.jql_was_predicates_and_order_by=grammar.jql_was_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_was_predicates_and_logical_operators=grammar.jql_was_predicates.concat(grammar.jql_logical_operators);grammar.jql_changed_predicates_and_order_by=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators_and_order_by);grammar.jql_changed_predicates_and_logical_operators=grammar.jql_changed_predicates.concat(grammar.jql_logical_operators);grammar.REGEXP_ANDS=/^AND\s/i;grammar.REGEXP_ORS=/^OR\s/i;grammar.REGEXP_NOTS=/^NOT\s/i;grammar.REGEXP_SNOT=/^\s+not/i;grammar.REGEXP_SIN=/^\s+in/i;grammar.REGEXP_SNOT_IN=/^\s+(not\s+in|not|in)/i;grammar.REGEXP_COMMA_DELIMITER=/^\s*,/;grammar.REGEXP_ASCENDING=/^\s+asc/i;grammar.REGEXP_DESCENDING=/^\s+desc/i;grammar.REGEXP_ORDER_BY=/^order\s+by/i;grammar.REGEXP_WHITESPACE=/^\s/;grammar.REGEXP_UNICODE=/^u[a-fA-F0-9]{4}/;grammar.REGEXP_FIELD_NAME=/^\s-\scf\[\d\d\d\d\d\]/;grammar.REGEXP_NEW_LINE=/[\r\n]/;grammar.REGEXP_NUMBER=/\d/;grammar.REGEXP_TOKEN_CHAR=/[^=!~<>(),\s&|\]]/;grammar.REGEXP_SPECIAL_CHAR=/[{}*\/%+$#@?;\][]/;grammar.REGEXP_SPACE_OR_ELSE=/[\s(]/;grammar.REGEXP_CHARS_TO_ESCAPE=/[^trn"'\\\s]/;grammar.REGEXP_NOTSTART=/^NO?$/i;grammar.REGEXP_INSTART=/^IN?$/i;grammar.REGEXP_PREDICATE=/^(after|before|by|during|from|on|to)/i;return grammar});define("jira/autocomplete/jql-autocomplete",["jira/autocomplete/autocomplete","jira/jql/jql-grammar","jira/jql/util","jira/jql/operator-util","jira/util/data/meta","jira/util/objects","jquery"],function(AutoComplete,grammar,Util,OperatorUtil,Meta,Objects,jQuery){var JQLAutoComplete=function(options){var that=Objects.begetObject(AutoComplete);var parser=options.parser;var result;var jql_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.searchable});var jql_order_by_field_names=jQuery.grep(options.jqlFieldNames,function(arrValue){return arrValue.orderable});var jql_function_names=options.jqlFunctionNames;var PARSE_INDICATOR=jQuery("#"+options.errorID);var suggestionCount=0;var jqlcolumnnum=jQuery("#jqlcolumnnum");var jqlrownum=jQuery("#jqlrownum");var autoCompleteUrl=options.autoCompleteUrl||contextPath+"/rest/api/1.0/jql/autocomplete";that.textToSuggestionCursorPosition=function(){return that.field.selectionRange().textBefore};that.pushSuggestionsOnHtmlStack=function(suggestions,suggestionNodes,htmlParts,listItemIdentifier,mayNeedParenthesis){var length=Math.min(15,suggestions.length);for(var i=0;i<length;i++){var actualValueSug;var displayNameSug;if(suggestions[i].value){var resultSug=suggestions[i];if(result&&mayNeedParenthesis){actualValueSug=((result.getNeedsOpenParen())?"(":"")+resultSug.value}else{actualValueSug=resultSug.value}displayNameSug=resultSug.displayName}else{displayNameSug=suggestions[i];actualValueSug=displayNameSug}suggestionNodes.push(actualValueSug);htmlParts.push('<li id="',listItemIdentifier,i,'">',displayNameSug,"</li>")}};that.renderSuggestions=function(suggestions,moreSuggestions,operatorSuggestions){var suggestionNodes=[];if(suggestions instanceof Array){if(suggestions.length<1&&(moreSuggestions&&moreSuggestions.length<1)&&(operatorSuggestions&&operatorSuggestions.length<1)){return suggestionNodes}var htmlParts=["<ul>"];if(operatorSuggestions&&operatorSuggestions.length>0){that.pushSuggestionsOnHtmlStack(operatorSuggestions,suggestionNodes,htmlParts,"jql_operator_suggest_",false)}that.pushSuggestionsOnHtmlStack(suggestions,suggestionNodes,htmlParts,"jql_value_suggest_",true);if(moreSuggestions&&moreSuggestions.length>0){that.pushSuggestionsOnHtmlStack(moreSuggestions,suggestionNodes,htmlParts,"jql_function_suggest_",false)}htmlParts.push("</ul>");var syntaxHelpLink=jQuery('<a class="syntax-help" target="_jiraHelp"></a>').attr("title",Meta.get("advanced-search-help-title")).attr("href",Meta.get("advanced-search-help-url")).text("Syntax Help");var syntaxHelpContainer=jQuery('<div class="syntax-help-container">').append(syntaxHelpLink);that.responseContainer.html(htmlParts.join("")).append(syntaxHelpContainer).find("li").each(function(i){suggestionNodes[i]=[jQuery(this),suggestionNodes[i]]});that.addSuggestionControls(suggestionNodes)}return suggestionNodes};that.completeField=function(value){var start=that.getReplacementStartIndex(result,value);var end=that.getReplacementEndIndex(result,start);that.replaceValue(start,end,value);var newToken=parser.parse(that.field.val());that.updateParseIndicator(newToken)};that.prepareOperandSuggestions=function(canAutoComplete,fieldName,functionSuggestions,operatorSuggestions,suggestedValue){if(canAutoComplete){var currentSuggestionCount=suggestionCount;var fieldValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var fieldNameValueKey=fieldName+":"+fieldValue;var data={fieldName:Util.stripEscapeCharacters(fieldName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.fieldValue=fieldValue}var includeEmpty=OperatorUtil.isWasOperator(result.getLastOperator());if(!that.getSavedResponse(fieldNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}if(includeEmpty){var suggestion=data.fieldValue;results=that.appendEmpty(suggestion,results)}that.saveResponse(fieldNameValueKey,results);that.renderSuggestionsForOperands(fieldValue,results,functionSuggestions,operatorSuggestions,currentSuggestionCount)},error:function(){that.renderSuggestionsForOperands(fieldValue,[],functionSuggestions,operatorSuggestions,currentSuggestionCount)}})},that.queryDelay)}else{that.renderSuggestionsForOperands(fieldValue,that.getSavedResponse(fieldNameValueKey),functionSuggestions,operatorSuggestions,currentSuggestionCount)}}else{that.renderSuggestionsForOperands(Util.stripEscapeCharacters(result.getLastOperand()),[],functionSuggestions,operatorSuggestions,suggestionCount)}};that.preparePredicateSuggestions=function(predicateName,suggestedValue){var currentSuggestionCount=suggestionCount;if(typeof suggestedValue=="undefined"){suggestedValue=null}var functionSuggestions=that.slimListForPredicates(suggestedValue,jql_function_names,predicateName);that.boldMatchingString(suggestedValue,functionSuggestions);var predicateValue=(suggestedValue==null)?((result.getLastOperand()===null)?"":Util.stripEscapeCharacters(result.getLastOperand())):suggestedValue;var predicateNameValueKey=predicateName+":"+predicateValue;var data={predicateName:Util.stripEscapeCharacters(predicateName)};if(result.getLastOperand()!==null||suggestedValue!==null){data.predicateValue=predicateValue}if(result.getLastFieldName()!==null){data.fieldName=result.getLastFieldName();predicateNameValueKey=result.getLastFieldName()+":"+predicateNameValueKey}if(that.predicateSupportsAutoComplete(predicateName)){if(!that.getSavedResponse(predicateNameValueKey)){that.dropdownController.dropdown.removeClass("dropdown-ready");that.delay(function(){that._makeRequest({url:autoCompleteUrl,dataType:"json",data:data,success:function(response){var results;if(response!==null&&response.results!==null){results=response.results}else{results=[]}var suggestion=data.predicateValue;results=that.appendEmpty(suggestion,results);that.saveResponse(predicateNameValueKey,results);that.renderSuggestions(results,functionSuggestions)},error:function(){that.renderSuggestionsForOperands(predicateValue,[])}})},that.queryDelay)}else{that.renderSuggestions(that.getSavedResponse(predicateNameValueKey),functionSuggestions)}}else{that.renderSuggestions([],functionSuggestions)}};that.incompleteOperator=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<2){return""}else{tokens=that.textToSuggestionCursorPosition().split(" ");if(tokens.length>2){return tokens[tokens.length-1]}}return""};that.incompletePredicateValue=function(){var tokens=result.getTokens();if(tokens==null||tokens.length<3){return""}else{tokens=that.textToSuggestionCursorPosition().split(/[\s(,]+/);if(tokens.length>3){return tokens[tokens.length-1]}}return""};that.appendEmpty=function(suggestion,results){var empty_list=that.slimListForMapResults(suggestion,grammar.empty_operand,true);if(suggestion!=null){that.boldMatchingString(suggestion,empty_list)}if(results.length<15){results=results.concat(empty_list)}else{results[14]=empty_list[0]}return results};that.dispatcher=function(val){var selectionRange=jQuery(that.field).selectionRange();var parseValue=val.substring(0,selectionRange.start);var value;var functionSuggestions;var token=parser.parse(parseValue);result=token.getResult();suggestionCount++;if(result.getNeedsField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastFieldName()),jql_field_names,grammar.jql_not_logical_operator,true)}else{if(result.getNeedsOperatorOrOperand()){functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;token.calcLastOperandStartIndex();var parsedOperator=token.getParsedOperator();var operatorSuggestions=that.getSuggestionsForOperators(parsedOperator,grammar.jql_operators);if(operatorSuggestions&&operatorSuggestions.length>0){var operandSuggestion=that.incompleteOperator();that.prepareOperandSuggestions(true,result.getLastFieldName(),functionSuggestions,operatorSuggestions,operandSuggestion)}}else{if(result.getNeedsOperator()){that.renderSuggestionsForOperators(result.getLastOperator(),grammar.jql_operators)}else{if(result.getNeedsPredicateOperand()){var predicate=result.getLastWasPredicate();that.preparePredicateSuggestions(predicate,Util.stripEscapeCharacters(result.getLastOperand()))}else{if(result.getNeedsLogicalOperator()){if(result.getNeedsWasPredicate()){if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastWasPredicate():result.getLastOrderBy();if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(value,grammar.jql_was_predicates_and_order_by,false)}else{that.renderSuggestionsFromMap(value,grammar.jql_changed_predicates_and_order_by,false)}}else{if(result.getLastOperator()=="was"){that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_was_predicates_and_logical_operators,false)}else{that.renderSuggestionsFromMap(result.getLastWasPredicate(),grammar.jql_changed_predicates_and_logical_operators,false)}}}else{if(result.getNeedsOrderBy()){value=(result.getLastOrderBy()===null)?result.getLastLogicalOperator():result.getLastOrderBy();that.renderSuggestionsFromMap(value,grammar.jql_logical_operators_and_order_by,false)}else{that.renderSuggestionsFromMap(result.getLastLogicalOperator(),grammar.jql_logical_operators,false)}}}else{if(result.getNeedsOrderByField()){that.renderSuggestionsFromMap(Util.stripEscapeCharacters(result.getLastOrderByFieldName()),jql_order_by_field_names,true)}else{if(result.getNeedsOrderByDirection()){that.renderSuggestionsFromMap(result.getLastOrderByDirection(),grammar.jql_order_by_direction,false)}else{if(result.getNeedsOperand()){var fieldName=result.getLastFieldName();var canAutoComplete=false;if(!OperatorUtil.isEmptyOnlyOperator(result.getLastOperator())){for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){canAutoComplete=jql_field_names[i].auto;break}}}functionSuggestions=(OperatorUtil.isEmptyOnlyOperator(result.getLastOperator()))?grammar.empty_operand:jql_function_names;that.prepareOperandSuggestions(canAutoComplete,fieldName,functionSuggestions,{})}else{if(result.getNeedsOrderBy()){that.renderSuggestionsFromMap(result.getLastOrderBy(),grammar.jql_logical_operators_and_order_by,false)}else{that.dropdownController.hideDropdown()}}}}}}}}}that.parse(val)};that.parse=function(val){var newToken=parser.parse(val);that.updateParseIndicator(newToken);that.updateColumnLineCount();return newToken.getResult()};that.renderSuggestionsFromMap=function(stringVal,list,otherSuggestions,showFull){if(!otherSuggestions){otherSuggestions={}}var suggestions=that.slimListForMapResults(stringVal,list,showFull);var relevantOtherSuggestions=that.slimListForMapResults(stringVal,otherSuggestions,showFull);that.boldMatchingString(stringVal,relevantOtherSuggestions);that.boldMatchingString(stringVal,suggestions);that.renderSuggestions(suggestions,relevantOtherSuggestions);if(suggestions.length===0&&relevantOtherSuggestions.length===0){that.dropdownController.hideDropdown()}};that.getSuggestionsForOperators=function(stringVal,list){var suggestions=that.slimListForMapResults(stringVal,list,false);var fieldName=result.getLastFieldName();var supportedOperators;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedOperators=jql_field_names[i].operators;break}}if(supportedOperators){suggestions=jQuery.grep(suggestions,function(arrValue){return jQuery.inArray(arrValue.value,supportedOperators)>-1})}that.boldMatchingString(stringVal,suggestions);return suggestions};that.renderSuggestionsForOperators=function(stringVal,list){var suggestions=that.getSuggestionsForOperators(stringVal,list);that.renderSuggestions(suggestions);if(suggestions.length===0){that.dropdownController.hideDropdown()}};that.renderSuggestionsForOperands=function(stringVal,ajaxSuggestions,functions,operatorSuggestions,providedSuggestionCount){if(providedSuggestionCount===suggestionCount){var functionsSuggestions=that.slimListForFunctionResults(stringVal,functions,result.getLastOperator());that.boldMatchingString(stringVal,functionsSuggestions);that.renderSuggestions(ajaxSuggestions,functionsSuggestions,operatorSuggestions);if(ajaxSuggestions.length===0&&functionsSuggestions.length===0&&operatorSuggestions.length==0){that.dropdownController.hideDropdown()}}};that.boldMatchingString=function(stringVal,list){if(stringVal==null||list.length===0){return }var boldLength=stringVal.length;for(var j=0,n=boldLength;j<n;j++){switch(stringVal.charAt(j)){case"<":case">":boldLength+=3;break;case"&":boldLength+=4;break;case'"':boldLength+=5;break}}for(var i=0;i<list.length;i++){if(list[i].displayName){var origVal=list[i].displayName;list[i]={value:list[i].value,displayName:"<b>"+origVal.substring(0,boldLength)+"</b>"+origVal.substring(boldLength)}}else{list[i]={value:list[i],displayName:"<b>"+list[i].substring(0,boldLength)+"</b>"+list[i].substring(boldLength)}}}};that.getReplacementStartIndex=function(result,value){var jQueryReference=jQuery(that.field);var start;if(result.getNeedsField()){start=result.getLastFieldNameStartIndex()}else{if(result.getNeedsOperatorOrOperand()){if(result.getNeedsOperator()&&OperatorUtil.isWasOperator(value)){start=result.getLastOperatorStartIndex()}else{start=result.getLastOperandStartIndex()}}else{if(result.getNeedsOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsOperator()){start=result.getLastOperatorStartIndex()}else{if(result.getNeedsOrderByField()){start=result.getLastOrderByFieldNameStartIndex()}else{if(result.getNeedsOrderByDirection()){start=result.getLastOrderByDirectionStartIndex()}else{if(result.getNeedsPredicateOperand()){start=result.getLastOperandStartIndex()}else{if(result.getNeedsLogicalOperator()){if(result.getLastLogicalOperatorStartIndex()!==null&&result.getLastLogicalOperatorStartIndex()!==0){start=result.getLastLogicalOperatorStartIndex()}else{if(result.getLastOrderBy()!==null&&result.getLastOrderByStartIndex()!==0){start=result.getLastOrderByStartIndex()}else{if(result.getLastWasPredicate()!=null&&result.getLastWasPredicateStartIndex()!==0){start=result.getLastWasPredicateStartIndex()}else{if(result.getMustBeOperatorOrPredicate()===true){start=jQueryReference.selectionRange().start}else{start=jQueryReference.selectionRange().start-1}}}}}else{if(result.getNeedsWasPredicate()){start=result.getLastWasPredicateStartIndex()}else{if(result.getNeedsOrderBy()){start=result.getLastOrderByStartIndex()}else{start=jQueryReference.selectionRange().start-1}}}}}}}}}}return start!=null?start:jQueryReference.selectionRange().start};that.getReplacementEndIndex=function(result,start){var jQueryReference=jQuery(that.field);var selectionRange=jQueryReference.selectionRange();var end=null;if(selectionRange.start===selectionRange.end&&selectionRange.end!==that.field.val().length){var currentTokenIdx=result.getTokens().length-1;var token=parser.parse(that.field.val());if(!token.getParseError()){var fullTokenValue=token.getResult().getTokens()[currentTokenIdx];if(fullTokenValue!==null&&fullTokenValue!=="("&&fullTokenValue!==")"){var fullTextVal=that.field.val();var remainingString=fullTextVal.substring(start,fullTextVal.length);var remainingStringArr=remainingString.split("");var whitespaceCount=0;for(var i=0;i<remainingStringArr.length;i++){if(grammar.REGEXP_WHITESPACE.test(remainingStringArr[i])){whitespaceCount++}else{break}}end=start+fullTokenValue.length+whitespaceCount}}}if(end===null){end=selectionRange.end}if(end<start){that.replaceValue(start,end," ");end=start}return end};that.replaceValue=function(start,end,newValue){var jQueryReference=jQuery(that.field);jQueryReference.selectionRange(start,end);jQueryReference.selection(newValue);var newEnd=jQueryReference.selectionRange().end;jQueryReference.selectionRange(newEnd,newEnd)};that.slimListForMapResults=function(stringVal,list,showFull){var escString=Util.htmlEscape(stringVal);var slimedList=jQuery.grep(list,function(arrValue){return Util.startsWithIgnoreCaseNullsMeanAll(escString,arrValue.displayName)});if(!showFull){if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(escString,slimedList[0].displayName)){return{}}}return slimedList};that.slimListForFunctionResults=function(stringVal,list,operator){var fieldName=result.getLastFieldName();var supportedTypes;for(var i=0;i<jql_field_names.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(jql_field_names[i].value),fieldName)||(jql_field_names[i].cfid&&Util.equalsIgnoreCase(jql_field_names[i].cfid,fieldName))){supportedTypes=jql_field_names[i].types;break}}var slimedList=jQuery.grep(list,function(arrValue){if((arrValue.isList&&!OperatorUtil.isListSupportingOperator(operator))||(!arrValue.isList&&OperatorUtil.isListSupportingOperator(operator))){return false}if(supportedTypes){var supportsFunction=jQuery.inArray("java.lang.Object",arrValue.types)>-1||jQuery.inArray("java.lang.Object",supportedTypes)>-1;for(var i=0;i<supportedTypes.length&&!supportsFunction;i++){supportsFunction=jQuery.inArray(supportedTypes[i],arrValue.types)!==-1}if(!supportsFunction){return false}}else{return false}return Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName)});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.slimListForPredicates=function(stringVal,list,predicate){var supportedType;var supportsList;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){supportedType=grammar.jql_changed_predicates[i].type;supportsList=grammar.jql_changed_predicates[i].supportsList;break}}var slimedList=jQuery.grep(list,function(arrValue){if(typeof arrValue.isList!="undefined"){if((arrValue.isList&&!!supportsList)||(!arrValue.isList&&supportsList)){return false}}var supportsFunction=jQuery.inArray(supportedType,arrValue.types)!==-1;return supportsFunction?Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.value)||Util.startsWithIgnoreCaseNullsMeanAll(stringVal,arrValue.displayName):false});if(slimedList.length===1&&!Util.startsWithNotEqualsIgnoreCaseNullMeansAll(stringVal,slimedList[0].displayName)){return{}}return slimedList};that.predicateSupportsAutoComplete=function(predicate){var auto;for(var i=0;i<grammar.jql_changed_predicates.length;i++){if(Util.equalsIgnoreCase(result.getUnquotedString(grammar.jql_changed_predicates[i].value),predicate)){auto=grammar.jql_changed_predicates[i].auto;break}}return auto};that.getSavedResponse=function(val){if(!this.requested){this.requested={}}return this.requested[val]};that.saveResponse=function(val,response){if(typeof val==="string"&&typeof response==="object"){if(!this.requested){this.requested={}}this.requested[val]=response}};that.startsWithIgnoreCase=function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};that.updateParseIndicator=function(token){if(token.getParseError()){PARSE_INDICATOR.attr("title",token.getResult().getParseErrorMsg()).removeClass("jqlgood").addClass("jqlerror")}else{PARSE_INDICATOR.attr("title","").removeClass("jqlerror").addClass("jqlgood")}};that.updateColumnLineCount=function(){var jQueryReference=jQuery(that.field);var totalCharCountToCursor=0;if(that.field[0]===document.activeElement){var selectionRange=jQueryReference.selectionRange();totalCharCountToCursor=selectionRange.start}else{totalCharCountToCursor=that.field[0].value.length}var rowCount=1;var colCount=1;var fieldValue=that.field.val();for(var i=0;i<totalCharCountToCursor;i++){if(grammar.REGEXP_NEW_LINE.test(fieldValue.charAt(i))){rowCount++;colCount=1}else{colCount++}}jqlcolumnnum.text(colCount);jqlrownum.text(rowCount)};that.init(options);return that};return JQLAutoComplete});define("jira/jql/util",["jira/jql/jql-grammar"],function(grammar){var JQLAutoCompleteUtil={};JQLAutoCompleteUtil.htmlEscape=function(stringVal){if(stringVal==null){return null}var escapedVal="";var strArr=stringVal.split("");for(var j=0;j<strArr.length;j++){if(strArr[j]==="<"){escapedVal+="&lt;"}else{if(strArr[j]===">"){escapedVal+="&gt;"}else{if(strArr[j]==="&"){escapedVal+="&amp;"}else{if(strArr[j]==='"'){escapedVal+="&quot;"}else{escapedVal+=strArr[j]}}}}}return escapedVal};JQLAutoCompleteUtil.stripEscapeCharacters=function(val){if(val==null){return val}var newVal="";var strArr=val.split("");for(var i=0;i<strArr.length;i++){if(strArr[i]=="\\"){if(!grammar.REGEXP_UNICODE.test(val.substring(i,val.length))){i++;if(i>=val.length){break}}}newVal+=strArr[i]}return newVal};JQLAutoCompleteUtil.equalsIgnoreCase=function(str1,str2){if(str1===null&&str2===null){return true}else{if(str1===null||str1===null){return false}else{return str1.toLowerCase()===str2.toLowerCase()}}};JQLAutoCompleteUtil.startsWithIgnoreCaseNullsMeanAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}};JQLAutoCompleteUtil.startsWithNotEqualsIgnoreCaseNullMeansAll=function(startStr,str){if(str===null||startStr===null){return true}if(str.length<startStr.length){return false}else{var subStrEquals=startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase();if(subStrEquals){var equalsString=null;if(grammar.REGEXP_FIELD_NAME.test(str.substr(startStr.length,str.length))){equalsString=str.substr(0,startStr.length)}else{equalsString=str}return startStr.toLowerCase()!=equalsString.toLowerCase()}return false}};return JQLAutoCompleteUtil});define("jira/jql/operator-util",function(){var that={};that.isListSupportingOperator=function(operator){return operator==="in"||operator==="not in"||operator=="was not in"||operator=="was in"};that.isEmptyOnlyOperator=function(operator){return operator==="is"||operator==="is not"};that.isWasOperator=function(operator){return operator==="was"||operator==="was in"||operator=="was not in"||operator=="was not"};that.isChangedOperator=function(operator){return operator==="changed"};that.isHistoryOperator=function(operator){return that.isWasOperator(operator)||that.isChangedOperator(operator)};return that});define("jira/jql/jql-parser",["jira/jql/jql-grammar","jira/jql/jql-parse-token","jira/jql/operator-util","jquery"],function(grammar,Token,OperatorUtil,jQuery){return function(jqlReservedWords){var jql_reserved_words=jqlReservedWords;return{parse:function(input){var token=Token();token.init(input);this.jql(token);return token},orderByClause:function(token){var remainingString=token.remainingString();var matchArray=remainingString.match(grammar.REGEXP_ORDER_BY);if(matchArray){var orderByString=remainingString.substring(0,matchArray[0].length);token.consumeCharacters(orderByString.length);token.getResult().setLastOrderBy(orderByString,token);if(!token.isComplete()){remainingString=token.remainingString();if(grammar.REGEXP_WHITESPACE.test(remainingString)){this.chewWhitespace(token);this.orderByFields(token)}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.getResult().resetLogicalOperators();token.setParseError()}}else{token.consumeCharacters(remainingString.length);token.getResult().setLastOrderBy(remainingString,token);token.setParseError()}},orderByFields:function(token){this.orderByField(token);this.chewWhitespace(token);if(token.isComplete()){if(!token.getResult().getNeedsOrderByField()){token.getResult().setLastOrderByDirection("",token)}}else{var remainingString=token.remainingString();if(this.startsWithIgnoreCase(",",remainingString)){token.consumeCharacter();this.orderByFields(token);this.chewWhitespace(token)}else{remainingString=token.remainingString();if(remainingString!==null){token.consumeCharacters(remainingString.length)}token.getResult().setNeedsOrderByDirection();token.getResult().setLastOrderByDirection(remainingString,token);token.setParseError()}}},orderByField:function(token){this.chewWhitespace(token);var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastOrderByFieldName(fieldName,token);var remainingString=token.remainingString();if(!token.isComplete()&&!grammar.REGEXP_COMMA_DELIMITER.test(remainingString)){if(grammar.REGEXP_ASCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(3);token.getResult().setLastOrderByDirection("asc",token);token.getResult().setNeedsOrderByComma()}else{if(grammar.REGEXP_DESCENDING.test(remainingString)){this.chewWhitespace(token);token.consumeCharacters(4);token.getResult().setLastOrderByDirection("desc",token);token.getResult().setNeedsOrderByComma()}else{token.getResult().setNeedsOrderByDirection()}}}else{token.getResult().setNeedsOrderByField();this.chewWhitespace(token)}}else{token.getResult().setLastOrderByFieldName("",token);token.getResult().setNeedsOrderByField();token.setParseError()}},jql:function(token){this.orClause(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){this.orderByClause(token)}},orClause:function(token){while(!token.isComplete()&&!this.startsWithIgnoreCase(")",token.remainingString())){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}if(token.getResult().getMustBeOperatorOrPredicate()){token.getResult().resetLastPredicates()}else{token.getResult().resetLogicalOperators();this.andClause(token)}if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){if(token.getResult().getNeedsWasPredicate()){this.predicateClause(token)}if(token.isComplete()){return }remainingString=token.remainingString();if(this.startsWithIgnoreCase("ord",remainingString)){break}else{if(remainingString!==null&&(grammar.REGEXP_ORS.test(remainingString)||this.startsWithIgnoreCase("|",remainingString)||this.startsWithIgnoreCase("||",remainingString))){if(this.startsWithIgnoreCase("||",remainingString)){token.getResult().setLastLogicalOperator("||",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(grammar.REGEXP_ORS.test(remainingString)){token.getResult().setLastLogicalOperator("OR",token.getTokenStringIdx());token.consumeCharacters(3)}else{token.getResult().setLastLogicalOperator("|",token.getTokenStringIdx());token.consumeCharacters(1)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{if(!this.startsWithIgnoreCase(")",remainingString)||!token.getInParens()){this.chewWhitespace(token);var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;var tokens;if(remainingString!=null){tokens=remainingString.split(" ");token.getResult().setLastLogicalOperator(tokens[0],errorIdx);token.getResult().setLastWasPredicate(tokens[0],token);token.getResult().setNeedsLogicalOperator(token)}if(token.getResult().getLastWasOperator()==null){token.setParseError()}else{if(tokens!=null){if(grammar.REGEXP_PREDICATE.test(tokens[0])){token.getResult().setLastLogicalOperator(null);token.getResult().resetNeedsPredicateOperand()}else{if(grammar.REGEXP_ANDS.test(remainingString)){token.consumeCharacters(4);token.getResult().resetTerminalClause();token.getResult().setNeedsField()}if(token.isComplete()||tokens.length==1){token.setParseError()}}}}}}}}}},andClause:function(token){this.chewWhitespace(token);this.notClause(token);if(!token.isComplete()&&token.getResult().getLastLogicalOperator()===null){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_ANDS.test(remainingString)||this.startsWithIgnoreCase("&",remainingString)||this.startsWithIgnoreCase("&&",remainingString))){if(this.startsWithIgnoreCase("&&",remainingString)){token.getResult().setLastLogicalOperator("&&",token.getTokenStringIdx());token.consumeCharacters(2)}else{if(this.startsWithIgnoreCase("&",remainingString)){token.getResult().setLastLogicalOperator("&",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("AND",token.getTokenStringIdx());token.consumeCharacters(4)}}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{token.getResult().setNeedsLogicalOperator(token);if(token.isComplete()){token.getResult().setLastLogicalOperator(null,token.getMaxTokenStringIdx())}}}},notClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){this.chewWhitespace(token);var remainingString=token.remainingString();if(remainingString!==null&&(grammar.REGEXP_NOTS.test(remainingString)||this.startsWithIgnoreCase("!",remainingString))){token.getResult().needsField=false;if(this.startsWithIgnoreCase("!",remainingString)){token.getResult().setLastLogicalOperator("!",token.getTokenStringIdx());token.consumeCharacters(1)}else{token.getResult().setLastLogicalOperator("NOT",token.getTokenStringIdx());token.consumeCharacters(4)}token.getResult().resetTerminalClause();if(token.isComplete()){token.setParseError()}token.getResult().setNeedsField()}else{this.terminalClause(token)}}else{this.terminalClause(token);token.setParseError()}},predicateClause:function(token){this.chewWhitespace(token);if(!token.isComplete()){var remainingString=token.remainingString();var tokens=remainingString.split(/[\s(]+/);if(remainingString!==null){token.getResult().setMustBeOperatorOrPredicate(false);if(this.startsWithLogicalOperator(remainingString)){if(tokens.length==1){token.getResult().setLastWasPredicate(tokens[0],token);token.setParseError();return }return }token.getResult().resetNeedsPredicateOperand();token.consumeCharacters(tokens[0].length);token.getResult().setLastWasPredicate(tokens[0],token);if(tokens.length==1){token.setParseError();return }if(this.wasPredicateComplete(tokens[0])){token.getResult().setNeedsPredicateOperand();token.getResult().setLastOperand(null,token);this.predicateOperand(token)}else{token.setParseError()}}}else{token.setParseError()}},predicateOperand:function(token){this.chewWhitespace(token);var predicateOperand=this.collectPredicateOperands(token);if(predicateOperand==null||predicateOperand==""){token.getResult().setLastOperandStartIndex(token.getTokenStringIdx());token.setParseError()}if(token.remainingString()!=null){token.getResult().resetNeedsPredicateOperand();token.getResult().resetLastPredicates();token.getResult().setMustBeOperatorOrPredicate(true);token.getResult().setNeedsLogicalOperator(token);this.chewWhitespace(token)}},collectPredicateOperands:function(token){if(token.getResult().getLastWasPredicate()==="DURING"){token.getResult().setNeedsOpenParen(true)}var predicateOperand=this.listOperand(token,true);if(predicateOperand.length===0){predicateOperand=this.functionOperand(token);if(predicateOperand.length===0){predicateOperand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}return token.getResult().getUnquotedString(predicateOperand)},terminalClause:function(token){token.getResult().resetTerminalClause();this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("(",remainingString)){token.getResult().addToken("(");token.setInParens();token.consumeCharacter();this.orClause(token);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase(")",remainingString)){token.getResult().addToken(")");token.consumeCharacter();token.setOutOfParens();if(token.isComplete()){token.getResult().resetLogicalOperators();token.getResult().resetLastPredicates()}}else{token.setParseError()}}else{this.field(token);if(!token.isComplete()){this.oper(token);if(!token.isComplete()){if(token.getResult().getLastWasOperator()==="changed"){token.getResult().setNeedsLogicalOperator(token);return }this.operand(token);if(token.getResult().getOperandComplete()){var lastWasOperator=token.getResult().getLastWasOperator();token.getResult().setNeedsNothing();if(lastWasOperator){token.getResult().setLastWasOperator(lastWasOperator)}}else{if(token.isComplete()&&!token.getResult().getNeedsListComma()){token.getResult().setNeedsOperand()}}}else{if(token.getResult().getLastOperator()=="was"||token.getResult().getLastOperator()=="was not"){token.getResult().setNeedsOperandOrOperator()}else{if(token.getResult().getLastWasOperator()==="changed"){var currentChar=token.currentCharacter();if(currentChar!==null&&grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().resetLogicalOperators();token.getResult().setNeedsOrderBy(false)}return }else{token.getResult().setNeedsOperator()}}token.setParseError()}}else{token.getResult().setNeedsField();token.setParseError()}}},field:function(token){var fieldName=this.fieldName(token);if(fieldName.length!==0){token.getResult().setLastFieldName(fieldName,token)}else{if(token.getResult().getLastFieldName()===null){var remainingString=token.remainingString();token.getResult().setNeedsField();token.getResult().setLastFieldName(remainingString,token);token.setParseError()}}},fieldName:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("cf",remainingString)){var origIdx=token.getTokenStringIdx();var origString=token.remainingString();token.consumeCharacters(2);this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();remainingString=token.remainingString();var custFieldId=this.numberValue(token);if(custFieldId.length!==0){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();return origString.substring(0,token.getTokenStringIdx()-origIdx)}}}token.setParseError();return origString}else{if(this.startsWithIgnoreCase("issue.property",remainingString)){return this.entityPropertyName("issue.property",token)}else{return this.fieldOrFunctionName(token)}}},entityPropertyName:function(propertyPrefix,token){token.consumeCharacters(propertyPrefix.length);this.chewWhitespace(token);var remainingString=token.remainingString();if(this.startsWithIgnoreCase("[",remainingString)){token.consumeCharacter();var propertyKeys=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyKeys[propertyKeys.length]=this.stringValue(token)}if(propertyKeys.length!==0&&propertyKeys[0].length!==0&&!this.startsWithIgnoreCase(".",propertyKeys[0])){this.chewWhitespace(token);remainingString=token.remainingString();if(this.startsWithIgnoreCase("]",remainingString)){token.consumeCharacter();var propertyPaths=[this.stringValue(token)];while(!token.parseError&&this.startsWithIgnoreCase(".",token.remainingString())){token.consumeCharacter();propertyPaths[propertyPaths.length]=this.stringValue(token)}return propertyPrefix+"["+propertyKeys.join(".")+"]"+propertyPaths.join(".")}}}token.setParseError();return""},oper:function(token){this.chewWhitespace(token);var remainingString=token.remainingString();var operator=this.getLongestOperatorMatch(remainingString,grammar.jql_operators);if(operator!==null){token.getResult().setLastOperator(operator,token.getTokenStringIdx());if(OperatorUtil.isWasOperator(operator)||OperatorUtil.isChangedOperator(operator)){token.getResult().setLastWasOperator(operator)}token.consumeCharacters(operator.length);if(operator=="in"||operator=="is"||operator=="is not"||operator=="not in"||operator=="was"||operator=="was not"||operator=="was in"||operator=="was not in"){var currentChar=token.currentCharacter();if(currentChar!==null&&!grammar.REGEXP_SPACE_OR_ELSE.test(currentChar)){token.setParseError()}}if(operator=="was"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_NOTSTART.test(remainingString)||grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="was not"){token.getResult().setNeedsOperandOrOperator();this.chewWhitespace(token);remainingString=token.remainingString();if(remainingString!=null&&(grammar.REGEXP_INSTART.test(remainingString))){token.setParseError()}}else{if(operator=="changed"){token.getResult().setNeedsLogicalOperator(token)}else{token.getResult().setNeedsOperand()}}}}else{if(token.getResult().getLastOperator()===null){var errorIdx=(remainingString===null)?token.getMaxTokenStringIdx():token.getMaxTokenStringIdx()-remainingString.length;token.getResult().setLastOperator(remainingString,errorIdx);token.getResult().setNeedsOperator();token.setParseError()}}},operand:function(token){this.chewWhitespace(token);if(token.getResult().getLastOperator()==="in"||token.getResult().getLastOperator()==="not in"||token.getResult().getLastOperator()==="was not in"||token.getResult().getLastOperator()==="was in"){token.getResult().setNeedsOpenParen(true)}var operand=this.listOperand(token,true);if(operand.length===0){operand=this.functionOperand(token);if(operand.length===0){operand=this.singleValueOperand(token)}else{token.getResult().setNeedsOpenParen(false)}}else{token.getResult().setNeedsOpenParen(false)}if(operand===null||operand.length===0){var remainingString=token.remainingString();token.getResult().setLastOperand(remainingString,token);token.getResult().setNeedsOperand();token.setParseError()}if(operand.length!==0){return operand}return""},singleValueOperand:function(token){var operand=this.stringValue(token);if(operand.length!==0){token.getResult().setLastOperand(operand,token);if(operand.toLowerCase()!="empty"&&operand.toLowerCase()!="null"&&this.isReservedWord(operand.toLowerCase())){token.setParseError()}return operand}return""},functionOperand:function(token){var startIdx=token.getTokenStringIdx();var functionName=this.fieldOrFunctionName(token);this.chewWhitespace(token);var listArguments=this.listOperand(token,false);if(functionName.length!==0&&listArguments.length!==0){var operand=functionName+listArguments;token.getResult().setLastOperand(operand,token);return operand}else{token.backTrackToIdx(startIdx);return""}},listOperand:function(token,treatAsOperands){if(token.currentCharacter()=="("){token.consumeCharacter();var listValue=this.collectListValues(token,treatAsOperands);var operandVal="("+listValue;this.chewWhitespace(token);if(token.currentCharacter()==")"){token.consumeCharacter();operandVal+=")";if(operandVal=="()"&&treatAsOperands){token.getResult().setLastOperand(operandVal,token)}if(treatAsOperands){token.getResult().setOperandComplete();token.getResult().resetNeedsPredicateOperand()}}else{token.setParseError()}return operandVal}else{return""}},collectListValues:function(token,treatAsOperands){if(treatAsOperands){token.getResult().setNeedsOperand()}this.chewWhitespace(token);var currentOperand=(treatAsOperands)?this.operand(token):this.stringValue(token);if(currentOperand.length!==0){if(this.chewWhitespace(token)&&treatAsOperands){token.getResult().setNeedsListComma()}if(token.currentCharacter()==","){token.consumeCharacter();var nextValue=this.collectListValues(token,treatAsOperands);if(nextValue.length===0){token.setParseError()}return currentOperand+", "+nextValue}else{return currentOperand}}else{return""}},startsWithIgnoreCase:function(startStr,str){if(str===null||startStr===null||str.length<startStr.length){return false}else{return startStr.toLowerCase()==str.substr(0,startStr.length).toLowerCase()}},startsWithLogicalOperator:function(str){if(str===null){return false}else{return this.startsWithOr(str)||this.startsWithAnd(str)||this.startsWithNot(str)||this.startsWithBraces(str)}},startsWithOr:function(str){return this.startsWithIgnoreCase("|",str)||this.startsWithIgnoreCase("||",str)||this.startsWithIgnoreCase("or",str)},startsWithAnd:function(str){return this.startsWithIgnoreCase("&",str)||this.startsWithIgnoreCase("&&",str)||this.startsWithIgnoreCase("and",str)},startsWithNot:function(str){return this.startsWithIgnoreCase("!",str)||this.startsWithIgnoreCase("not",str)},startsWithBraces:function(str){return this.startsWithIgnoreCase("(",str)||this.startsWithIgnoreCase(")",str)},chewWhitespace:function(token){var foundWhiteSpace=false;var currentChar=token.currentCharacter();while(currentChar!==null&&grammar.REGEXP_WHITESPACE.test(currentChar)){token.consumeCharacter();currentChar=token.currentCharacter();foundWhiteSpace=true}return foundWhiteSpace},getLongestOperatorMatch:function(value,listOfValues){var longestMatch=null;var matchArray;if(this.startsWithIgnoreCase("is",value)){matchArray=value.substring(2).match(grammar.REGEXP_SNOT);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+2)}else{longestMatch="is"}}if(this.startsWithIgnoreCase("was",value)){matchArray=value.substring(3).match(grammar.REGEXP_SNOT_IN);if(matchArray){longestMatch=value.substring(0,matchArray[0].length+3)}else{longestMatch="was"}}else{if(this.startsWithIgnoreCase("not",value)){var matchArrayNot=value.substring(3).match(grammar.REGEXP_SIN);if(matchArrayNot){longestMatch=value.substring(0,matchArrayNot[0].length+3)}}else{for(var i=0;i<listOfValues.length;i++){if(this.startsWithIgnoreCase(listOfValues[i].value,value)){if(longestMatch===null||grammar.jql_operators[i].value.length>longestMatch){longestMatch=grammar.jql_operators[i].value}}}}}return longestMatch},getValueMinusExtraWhitespace:function(value){if(value===null){return null}var newValue="";var firstWhitespace=true;var valueArr=value.split("");for(var i=0;i<valueArr.length;i++){var currentChar=valueArr[i];if(grammar.REGEXP_WHITESPACE.test(currentChar)){if(firstWhitespace){firstWhitespace=false;newValue=newValue+currentChar}}else{firstWhitespace=true;newValue=newValue+currentChar}}return newValue},fieldOrFunctionName:function(token){var stringValue=this.stringValue(token);if(stringValue==='""'||stringValue==="''"){token.setParseError()}if(this.isReservedWord(stringValue.toLowerCase())){token.setParseError()}return stringValue},isReservedWord:function(word){return jQuery.inArray(word,jql_reserved_words)!==-1},stringValue:function(token){var stringValue="";var inQuote=false;var inSingleQuote=false;var currentChar=token.currentCharacter();while(currentChar!==null&&(inQuote||inSingleQuote||grammar.REGEXP_TOKEN_CHAR.test(currentChar))){stringValue=stringValue+currentChar;token.consumeCharacter();if(currentChar=="\\"){currentChar=token.currentCharacter();if(currentChar===null){token.setParseError();break}else{if(grammar.REGEXP_CHARS_TO_ESCAPE.test(currentChar)){var remainingString=token.remainingString();if(!grammar.REGEXP_UNICODE.test(remainingString)){token.setParseError();break}}}stringValue=stringValue+currentChar;token.consumeCharacter()}else{if(grammar.REGEXP_SPECIAL_CHAR.test(currentChar)&&!(inQuote||inSingleQuote)){token.setParseError();break}else{if(currentChar=='"'&&!inSingleQuote){inQuote=!inQuote}else{if(currentChar=="'"&&!inQuote){inSingleQuote=!inSingleQuote}}}}currentChar=token.currentCharacter()}if(token.isComplete()&&(inQuote||inSingleQuote)){token.setParseError()}return stringValue},numberValue:function(token){var numberVal="";this.chewWhitespace(token);var currentChar=token.currentCharacter();while(currentChar!==null){if(grammar.REGEXP_NUMBER.test(currentChar)){numberVal=numberVal+currentChar;token.consumeCharacter()}else{break}currentChar=token.currentCharacter()}return numberVal},wasPredicateComplete:function(predicate){var foundPredicate=false;var arLen=grammar.jql_changed_predicates.length;for(var i=0;i<arLen;++i){if(predicate.toLowerCase()==grammar.jql_changed_predicates[i].value.toLowerCase()){foundPredicate=true;break}}return foundPredicate}}}});define("jira/jql/jql-parse-result",function(){return function(){var tokens=[];var tokenIdx=0;return{getTokens:function(){return tokens},addToken:function(token){tokens[tokenIdx++]=token},setLastFieldName:function(lastFieldName,token){this.fieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastFieldName=this.getUnquotedString(lastFieldName);tokens[tokenIdx++]=lastFieldName},getLastFieldName:function(){return this.lastFieldName},getLastFieldNameStartIndex:function(){return this.fieldNameStartIndex},setLastOrderByFieldName:function(lastFieldName,token){this.orderByFieldNameStartIndex=(lastFieldName===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastFieldName.length);this.lastOrderByFieldName=this.getUnquotedString(lastFieldName);this.lastOrderByDirection=null;tokens[tokenIdx++]=lastFieldName},getLastOrderByFieldName:function(){return this.lastOrderByFieldName},getLastOrderByFieldNameStartIndex:function(){return this.orderByFieldNameStartIndex},setLastOrderByDirection:function(lastDirection,token){this.orderByDirectionStartIndex=(lastDirection===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastDirection.length);this.lastOrderByDirection=lastDirection;tokens[tokenIdx++]=lastDirection},getLastOrderByDirection:function(){return this.lastOrderByDirection},getLastOrderByDirectionStartIndex:function(){return this.orderByDirectionStartIndex},setNeedsField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsWasPredicate=false;this.lastWasOperator=null},getNeedsField:function(){return this.needsField},setNeedsOrderByField:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=true;this.needsOrderByDirection=false;this.lastOrderByDirection=null;this.needsListComma=false},getNeedsOrderByField:function(){return this.needsOrderByField},setNeedsOrderByDirection:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=true;this.needsListComma=false},getNeedsOrderByDirection:function(){return this.needsOrderByDirection},setNeedsOrderByComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsListComma:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=true},getNeedsListComma:function(){return this.needsListComma},setLastOperator:function(lastOperator,startIndex){this.lastOperator=lastOperator;this.operatorStartIndex=startIndex;tokens[tokenIdx++]=lastOperator},setLastWasOperator:function(lastWasOperator){this.lastWasOperator=lastWasOperator},getLastWasOperator:function(){return this.lastWasOperator},getLastOperator:function(){return this.lastOperator},getLastOperatorStartIndex:function(){return this.operatorStartIndex},setLastOperand:function(lastOperand,token){this.operandStartIndex=(lastOperand===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOperand.length);this.lastOperand=this.getUnquotedString(lastOperand);tokens[tokenIdx++]=lastOperand},getLastOperand:function(){return this.lastOperand},setNeedsOperand:function(){this.needsField=false;this.needsOperator=false;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},setNeedsOperandOrOperator:function(){this.needsField=false;this.needsOperator=true;this.needsLogicalOperator=false;this.needsOperand=true;this.needsOrderBy=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperand:function(){return this.needsOperand},setNeedsPredicateOperand:function(){this.needsPredicateOperand=true},resetNeedsPredicateOperand:function(){this.needsPredicateOperand=false;this.needsOperand=false},getNeedsPredicateOperand:function(){return this.needsPredicateOperand},getLastOperandStartIndex:function(){return this.operandStartIndex},setLastOperandStartIndex:function(index){this.operandStartIndex=index},setLastLogicalOperator:function(lastLogicalOperator,startIndex){this.lastLogicalOperator=lastLogicalOperator;this.logicalOperatorStartIndex=startIndex;tokens[tokenIdx++]=lastLogicalOperator},setNeedsOperator:function(){this.needsField=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsOperator=true;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false},getNeedsOperatorOrOperand:function(){return this.needsOperator&&this.needsOperand},getNeedsOperator:function(){return this.needsOperator},getLastLogicalOperator:function(){return this.lastLogicalOperator},getLastLogicalOperatorStartIndex:function(){return this.logicalOperatorStartIndex},setNeedsLogicalOperator:function(token){this.needsLogicalOperator=true;this.needsOperator=false;this.needsOperand=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsListComma=false;this.needsOrderBy=!token.getInParens();if(this.lastWasOperator!=null){this.needsWasPredicate=true}},setNeedsOpenParen:function(value){this.needsOpenParen=value},getNeedsOpenParen:function(){return this.needsOpenParen},getNeedsLogicalOperator:function(){return this.needsLogicalOperator},setNeedsOrderBy:function(value){this.needsOrderBy=value},getNeedsOrderBy:function(){return this.needsOrderBy},getNeedsWasPredicate:function(){return this.needsWasPredicate},setLastWasPredicate:function(lastWasPredicate,token){this.wasPredicateStartIndex=(lastWasPredicate===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastWasPredicate.length);this.lastWasPredicate=lastWasPredicate;tokens[tokenIdx++]=lastWasPredicate},getLastWasPredicate:function(){return this.lastWasPredicate},resetLastPredicates:function(){this.lastLogicalOperator=null;this.lastWasPredicate=null;this.lastOperand=null;this.wasPredicateStartIndex=null;this.operandStartIndex=null},getLastWasPredicateStartIndex:function(){return this.wasPredicateStartIndex},setLastOrderBy:function(lastOrderBy,token){this.orderByStartIndex=(lastOrderBy===null)?token.getMaxTokenStringIdx():(token.getTokenStringIdx()-lastOrderBy.length);this.lastOrderBy=lastOrderBy;tokens[tokenIdx++]=lastOrderBy},getLastOrderBy:function(){return this.lastOrderBy},getLastOrderByStartIndex:function(){return this.orderByStartIndex},resetLogicalOperators:function(){this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.needsLogicalOperator=null},getUnquotedString:function(value){var secondToLastNotEsacape=value!=null&&value.length>=3&&value.charAt(value.length-2)!="\\";if(value!=null&&value.charAt(0)=='"'){value=value.substring(1,value.length);if(value.charAt(value.length-1)=='"'&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}else{if(value!=null&&value.charAt(0)=="'"){value=value.substring(1,value.length);if(value.charAt(value.length-1)=="'"&&secondToLastNotEsacape){value=value.substring(0,value.length-1)}}}return value},setParseError:function(message){this.parseError=true;this.parseErrorMsg=message},getParseError:function(){return this.parseError},getParseErrorMsg:function(){return this.parseErrorMsg},setNeedsNothing:function(){this.needsOperator=false;this.needsOperand=false;this.needsLogicalOperator=false;this.needsOrderBy=false;this.needsField=false;this.needsOrderByField=false;this.needsOrderByDirection=false;this.needsOpenParen=false;this.needsListComma=false;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null},setOperandComplete:function(){this.operandComplete=true},getOperandComplete:function(){return this.operandComplete},setMustBeOperatorOrPredicate:function(state){this.mustBeOperatorOrPredicate=state},getMustBeOperatorOrPredicate:function(){return this.mustBeOperatorOrPredicate},resetTerminalClause:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=false;this.mustBeOperatorOrPredicate=null},init:function(){this.lastFieldName=null;this.fieldNameStartIndex=null;this.needsField=null;this.lastOperator=null;this.operatorStartIndex=null;this.needsOperator=null;this.lastOperand=null;this.operandStartIndex=null;this.needsOperand=null;this.lastLogicalOperator=null;this.logicalOperatorStartIndex=null;this.lastOrderByFieldName=null;this.lastOrderByFieldNameStartIndex=null;this.lastOrderByDirection=null;this.lastOrderByDirectionStartIndex=null;this.orderByStartIndex=null;this.lastOrderBy=null;this.needsOrderBy=null;this.needsOrderByField=null;this.needsOrderByDirection=null;this.operandComplete=null;this.needsOpenParen=null;this.needsListComma=null;this.wasPredicateStartIndex=null;this.lastWasPredicate=null;this.needsWasPredicate=null;this.needsPredicateOperand=null;this.mustBeOperatorOrPredicate=null;this.lastWasOperator=null}}}});define("jira/jql/jql-parse-token",["jira/jql/jql-parse-result"],function(ParseResult){return function(){return{init:function(tokenString){this.tokenStringIdx=0;this.tokenString=tokenString;this.parseError=false;this.parseErrorMsg=null;this.result=ParseResult();this.result.init();this.inParens=0},consumeCharacter:function(){this.tokenStringIdx++},consumeCharacters:function(numChars){this.tokenStringIdx=this.tokenStringIdx+numChars},backTrackToIdx:function(backTrackIdx){this.tokenStringIdx=backTrackIdx;this.parseError=false;this.parseErrorMsg=null;this.result.parseError=false;this.result.parseErrorMsg=null},getTokenStringIdx:function(){return this.tokenStringIdx},currentCharacter:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.charAt(this.tokenStringIdx)},remainingString:function(){if(this.tokenStringIdx>=this.tokenString.length){return null}return this.tokenString.substr(this.tokenStringIdx,this.tokenString.length)},getMaxTokenStringIdx:function(){return this.tokenString.length},isComplete:function(){if(this.parseError){return true}return this.tokenStringIdx>=this.tokenString.length},setInParens:function(){this.inParens++},setOutOfParens:function(){if(this.inParens!==0){this.inParens--}},getInParens:function(){return this.inParens!==0},setParseError:function(){this.parseError=true;var preFixIdx=((this.tokenStringIdx-9)<0)?0:this.tokenStringIdx-9;var errorPrefix=this.tokenString.substring(preFixIdx,this.tokenStringIdx-1);this.result.setParseError("..."+errorPrefix+"^"+this.tokenString.substring(this.tokenStringIdx,this.tokenString.length))},getParseError:function(){return this.parseError},calcLastOperandStartIndex:function(){var result=this.getResult();var operator=result.getLastOperator();if(operator.length>0){var numSpaces=operator.length-(operator.replace(/\s+/g,"")).length;result.setLastOperandStartIndex(result.getLastOperatorStartIndex()+operator.length+numSpaces+1)}},getParsedOperator:function(){var result=this.getResult();return(result.getLastOperator().length>0)?this.tokenString.substr(result.getLastOperatorStartIndex()):null},getResult:function(){return this.result}}}});AJS.namespace("jira.widget.autocomplete.JQL",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete",null,require("jira/autocomplete/jql-autocomplete"));AJS.namespace("JIRA.JQLAutoComplete.MyParser",null,require("jira/jql/jql-parser"));AJS.namespace("JIRA.JQLAutoComplete.ParseResult",null,require("jira/jql/jql-parse-result"));AJS.namespace("JIRA.JQLAutoComplete.Token",null,require("jira/jql/jql-parse-token"));;
;/* module-key = 'jira.webresources:jqlautocomplete', location = '/includes/jira/autocomplete/initJQLAutoComplete.js' */
(function(){var JQLAutoComplete=require("jira/autocomplete/jql-autocomplete");var JQLParser=require("jira/jql/jql-parser");var Forms=require("jira/util/forms");var jQuery=require("jquery");jQuery(function(){jQuery(".jql-autocomplete-params").each(function(){var params={};jQuery(this).find("input").each(function(){var $this=jQuery(this);params[$this.attr("id")]=$this.val()});var jqlFieldNames=JSON.parse(jQuery("#jqlFieldz").text());var jqlFunctionNames=JSON.parse(jQuery("#jqlFunctionNamez").text());var jqlReservedWords=JSON.parse(jQuery("#jqlReservedWordz").text());var jqlAutoComplete=JQLAutoComplete({fieldID:"jqltext",parser:JQLParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:"jqlerrormsg"});var jQueryRef=jQuery("#jqltext");jQueryRef.unbind("keypress",Forms.submitOnEnter).keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode===13&&!e.ctrlKey&&!e.shiftKey){jQuery("#jqlform").submit();return false}else{return true}}});jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse(jQueryRef.text());jqlAutoComplete.updateColumnLineCount();jQueryRef.click(function(){jqlAutoComplete.dropdownController.hideDropdown()})})})})();;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-jqlautocomplete.js' */
var IssueLinkJQLAutoComplete=IssueLinkJQLAutoComplete||(function($){function initialize(options){var fieldID=options.fieldID;var errorID=options.errorID;var autoCompleteUrl=options.autoCompleteUrl;var autoCompleteData=options.autoCompleteData;var formSubmitFunction=options.formSubmitFunction;var $field=$("#"+fieldID);var hasFocus=$field.length>0&&$field[0]==document.activeElement;var jqlFieldNames=autoCompleteData.visibleFieldNames||[];var jqlFunctionNames=autoCompleteData.visibleFunctionNames||[];var jqlReservedWords=autoCompleteData.jqlReservedWords||[];var jqlAutoComplete=JIRA.JQLAutoComplete({fieldID:fieldID,parser:JIRA.JQLAutoComplete.MyParser(jqlReservedWords),queryDelay:0.65,jqlFieldNames:jqlFieldNames,jqlFunctionNames:jqlFunctionNames,minQueryLength:0,allowArrowCarousel:true,autoSelectFirst:false,errorID:errorID,autoCompleteUrl:autoCompleteUrl});$field.unbind("keypress",submitOnEnter);if(formSubmitFunction){$field.keypress(function(e){if(jqlAutoComplete.dropdownController===null||!jqlAutoComplete.dropdownController.displayed||jqlAutoComplete.selectedIndex<0){if(e.keyCode==13&&!e.ctrlKey&&!e.shiftKey){formSubmitFunction();return false}else{return true}}})}jqlAutoComplete.buildResponseContainer();jqlAutoComplete.parse($field.text());jqlAutoComplete.updateColumnLineCount();$field.click(function(){jqlAutoComplete.dropdownController.hideDropdown()});if(hasFocus){$field.select()}}return{initialize:initialize}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'js/issuelink-jira-search.js' */
AJS.$(function($){var remoteJiraSearchDialog=new JIRA.FormDialog({id:"remote-jira-search-dialog",trigger:"#link-jira-issue .remote-jira-search-trigger",widthClass:"large",content:function(render){render(JIRA.Templates.RemoteJiraIssueSearch.dialog());initSearchDialog(this.$popup)},submitHandler:function(e,callback){e.preventDefault();$("#simple-search-panel-button").removeAttr("disabled");$("#advanced-search-panel-button").removeAttr("disabled");if($(e.target).attr("id")=="remote-jira-simple-search-form"){$("#simple-search-panel-button").click()}else{$("#advanced-search-panel-button").click()}callback()}});function initSearchDialog($dialog){var appId=$("#jira-app-link").val();var autoCompletePromise=getJqlAutoCompleteData(appId);$("#simple-search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSimpleSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false});$("#advanced-search-panel-button",$dialog).click(function(){advancedSearchButtonClick($dialog);return false});$("#simple-search-toggle",$dialog).click(function(){$("#remote-jira-simple-search-form",$dialog).show();$("#remote-jira-advanced-search-form",$dialog).hide();return false});$("#linkjiraissue-add-selected",$dialog).click(function(){$("table tbody tr:visible  td.selection input:checked",$dialog).each(function(){var issueKey=$(this).parent().data("key");$("#jira-issue-keys").trigger("selectOption",[{value:issueKey}])});$("#link-issue-dialog .error").hide();remoteJiraSearchDialog.hide();$("#link-issue-dialog").show().trigger("multiSelectRevealed");$("#jira-issue-keys-textarea").focus().select()});$("#advanced-search-toggle",$dialog).click(function(){$("#remote-jira-advanced-search-form",$dialog).show();$("#remote-jira-simple-search-form",$dialog).hide();var $jqlSearchText=$("#jql-search-text");if(!$jqlSearchText.attr("jql-initialized")){setAutoCompleteLoadingIconVisible(true,$dialog);autoCompletePromise.done(function(smartAjaxResult){if(smartAjaxResult.successful){IssueLinkJQLAutoComplete.initialize({fieldID:"jql-search-text",errorID:"jql-search-error",autoCompleteUrl:getAutoCompleteUrl(appId),autoCompleteData:smartAjaxResult.data,formSubmitFunction:function(){advancedSearchButtonClick($dialog)}})}else{setJQLErrorVisible(false,$dialog);setAutoCompleteFailedIconVisible(true,$dialog)}setAutoCompleteLoadingIconVisible(false,$dialog);$jqlSearchText.attr("jql-initialized",1)})}$jqlSearchText.focus();return false});$("#simple-search-toggle",$dialog).trigger("click")}function getAutoCompleteUrl(appId){if(appId&&appId!==""){return contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocomplete?appId="+appId}return""}function advancedSearchButtonClick($dialog){$("#search-results-table",$dialog).empty();var searchText=$("#jql-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doAdvancedSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteLoadingIconVisible(visible,$context){$("#autocomplete-loading",$context).toggleClass("hidden",!visible)}function setAutoCompleteFailedIconVisible(visible,$context){$("#autocomplete-failed",$context).toggleClass("hidden",!visible)}function setJQLErrorVisible(visible,$context){$("#jql-search-error",$context).toggleClass("hidden",!visible)}function doSimpleSearch(searchText,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();var issueKeyJql='key = "'+searchText+'"';var projectJql='project = "'+searchText+'"';var plainTextJql='summary ~ "'+searchText+'" OR description ~ "'+searchText+'" OR comment ~ "'+searchText+'"';jqlSearch(issueKeyJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(projectJql,appId).done(function(smartAjaxResult){if(smartAjaxResult.successful&&smartAjaxResult.data.issues.length>0){setLoadingIconVisible(false,$context);showResults(smartAjaxResult,$context)}else{jqlSearch(plainTextJql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{showResultsError(smartAjaxResult)}})}})}})}function doAdvancedSearch(jql,$context){setLoadingIconVisible(true,$context);var appId=$("#jira-app-link").val();jqlSearch(jql,appId).done(function(smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){showResults(smartAjaxResult,$context)}else{if(smartAjaxResult.status===400){AJS.messages.warning("#search-results-table",{body:"Invalid JQL query.",closeable:false})}else{showResultsError(smartAjaxResult)}}})}function jqlSearch(jql,appId){var deferred=$.Deferred();var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/search?jql="+jql+"&appId="+appId+"&maxResults=10"}else{var currentIssueKey=$("#current-issue-key").val();jql="("+jql+") and key != "+currentIssueKey;url=contextPath+"/rest/api/2/search?jql="+jql+"&maxResults=10"}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}});return deferred.promise()}function getJqlAutoCompleteData(appId){var deferred=$.Deferred();var remote;var url;if(appId&&appId!==""){url=contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata?appId="+appId;remote=true}else{url=contextPath+"/rest/api/2/jql/autocompletedata";remote=false}JIRA.SmartAjax.makeRequest({url:url,complete:function(xhr,textStatus,smartAjaxResult){if(!smartAjaxResult.successful&&remote){JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/remoteJiraIssueLink/1/remoteJira/autocompletedata/legacy?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){deferred.resolve(smartAjaxResult)}})}else{deferred.resolve(smartAjaxResult)}}});return deferred.promise()}function showResults(smartAjaxResult,$context){var resultHtml=JIRA.Templates.RemoteJiraIssueSearch.resultsTable({result:smartAjaxResult.data});$("#search-results-table",$context).html(resultHtml);$("#linkjiraissue-select-all",$context).click(function(){var $masterStatus=$(this).prop("checked");$("tbody tr td.selection input",$context).prop("checked",$masterStatus)});$("tbody tr",$context).click(function(e){if($(e.target).is(":checkbox")){return }var checkbox=$(this).find("td.selection input");checkbox.prop("checked",!checkbox.prop("checked"))})}function showResultsError(smartAjaxResult){AJS.messages.error("#search-results-table",{body:JIRA.SmartAjax.buildSimpleErrorContent(smartAjaxResult),closeable:false})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-link-remote-jira-plugin:issue-link-jira-search-js', location = 'templates/dialog/linkjiraissue-search.soy' */
// This file was automatically generated from linkjiraissue-search.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.RemoteJiraIssueSearch == 'undefined') { JIRA.Templates.RemoteJiraIssueSearch = {}; }


JIRA.Templates.RemoteJiraIssueSearch.dialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find JIRA issues"), '</h2><form class="aui search-form" id="remote-jira-simple-search-form" action="#" method="post"><div class="field-group"><label for="link-search-text">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" size="50"> <input type="submit" tabindex="0" class="button" id="simple-search-panel-button" value="', soy.$$escapeHtml("Search"), '"> <a id="advanced-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a JQL search"), '">', soy.$$escapeHtml("Advanced Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><form class="aui search-form" id="remote-jira-advanced-search-form" action="#" method="post"><div class="field-group"><label for="jql-search-text">', soy.$$escapeHtml("JQL Search"), '<span id="autocomplete-loading" class="hidden"><span class="icon loading throbber"/>', soy.$$escapeHtml("Loading auto-complete"), '</span><span id="autocomplete-failed" class="hidden">', soy.$$escapeHtml("(auto-complete unavailable)"), '</span></label><div id="jql-search-container"><span id="jql-search-error" class="icon jqlgood" /><div class="atlassian-autocomplete"><textarea id="jql-search-text" class="text full-width-field" tabindex="0" /></div><button class="aui-button aui-button-primary search-button" id="advanced-search-panel-button" type="submit"><span class="aui-icon aui-icon-small aui-iconfont-search" title="', soy.$$escapeHtml("Search"), '"></span></button></div> <a id="simple-search-toggle" href="#" title="', soy.$$escapeHtml("Perform a plain text search"), '">', soy.$$escapeHtml("Simple Search"), '</a><span id="link-search-loading" class="icon loading throbber hidden"/></div></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button type="button" class="aui-button" id="linkjiraissue-add-selected">', soy.$$escapeHtml("Add"), '</button><button class="aui-button aui-button-link cancel" href="#" id="remote-jira-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.result.issues.length > 0) {
    output.append('<table id="remote-jira-searchresult" class="aui"><thead><tr><th class="selection" ><input id="linkjiraissue-select-all" type="checkbox"/></th><th class="type">', soy.$$escapeHtml("Type"), '</th><th class="key">', soy.$$escapeHtml("Key"), '</th><th class="summary">', soy.$$escapeHtml("Summary"), '</th><th class="status">', soy.$$escapeHtml("Status"), '</th></tr></thead><tbody>');
    var issueList44 = opt_data.result.issues;
    var issueListLen44 = issueList44.length;
    for (var issueIndex44 = 0; issueIndex44 < issueListLen44; issueIndex44++) {
      var issueData44 = issueList44[issueIndex44];
      output.append('<tr title="', soy.$$escapeHtml(issueData44.key), '"><td class="selection" data-key="', soy.$$escapeHtml(issueData44.key), '"><input type="checkbox"/></td><td class="type">');
      JIRA.Templates.RemoteJiraIssueSearch.issueType({issueType: issueData44.fields.issuetype}, output);
      output.append('</td><td class="key" title="', soy.$$escapeHtml(issueData44.key), '">', soy.$$escapeHtml(issueData44.key), '</td><td class="summary" title="', soy.$$escapeHtml(issueData44.fields.summary), '">', soy.$$escapeHtml(issueData44.fields.summary), '</td><td class="status">');
      JIRA.Templates.RemoteJiraIssueSearch.status({status: issueData44.fields.status}, output);
      output.append('</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.issueType = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<img src="', soy.$$escapeHtml(opt_data.issueType.iconUrl), '" alt="', soy.$$escapeHtml(opt_data.issueType.name), '" title="', soy.$$escapeHtml(opt_data.issueType.name), ' - ', soy.$$escapeHtml(opt_data.issueType.description), '"/>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.RemoteJiraIssueSearch.status = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Template.Util.Issue.Status.issueStatusResolver({issueStatus: opt_data.status}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.shipit.click-listener-plugin:heat-mapper-events-resources', location = 'js/heat-mapper-dom.js' */
(function(G){try{if(window.AJS&&!AJS.DarkFeatures.isEnabled("heatmapper")){return 
}window.HeatMapper=window.HeatMapper||{};
var E="\"#$%&'()*+,./:;<=>?@[\\]^`{|}~";
function C(J,I,L,K){if(window.AJS&&window.AJS.log){window.AJS.log(J,I,L,K)
}}function D(I){if(!I){return null
}var N="",K;
var M=I.split(" ");
for(var L=0,J=M.length;
L<J;
L++){K=G.trim(M[L]);
if(K.length){N+="."+K
}}return N
}function F(L){var J="";
for(var K=0,I=L.length;
K<I;
K++){var M=L.charAt(K);
if(E.indexOf(M)>=0){J+="\\"
}J+=M
}return J
}function A(I){var K=[];
for(var J in I){if(I.hasOwnProperty(J)&&(J==="name"||J.indexOf("id")>=0)){K.push(J)
}}return K
}var B={click:"a,input,button,textarea",mousedown:"select"};
HeatMapper.DOM={find:function(){return G.find(HeatMapper.DOM.findSelector)
},findSelector:G.map(B,function(I){return I
}).join(","),eventSelectors:B,findAsSelectors:function(){return HeatMapper.DOM.mapToUniqueSelectors(HeatMapper.DOM.find())
},uniqueSelector:function(I){try{if(!I.jquery){I=G(I)
}if(I.attr("id")){return"#"+I.attr("id")
}var K=I.closest("[id]").attr("id")||"";
if(K.length){K="#"+K+" "
}var R=D(I.attr("class"));
var L=K+R;
if(R&&R.length&&G(L).length===1){return L
}var S=HeatMapper.DOM.getAttributes(I);
var T=A(S);
var N;
for(var M=0,J=T.length;
M<J;
M++){N=K+"["+T[M]+'="'+F(S[T[M]])+'"]';
if(G(N).length===1){return N
}}var P=K+I[0].nodeName;
if(R){P+=R
}var Q=G(P).index(I);
return P+":eq("+Q+")"
}catch(O){C("Failed to get selector for:");
C(I);
C(O);
return null
}},mapToUniqueSelectors:function(I){return G.map(I,function(J){return HeatMapper.DOM.uniqueSelector(J)
})
},getAttributes:function(M){if(!M||!M.length){return{}
}var N={};
var K=M[0].attributes;
for(var L=0,J=K.length;
L<J;
L++){var I=K[L];
N[I.name]=I.value
}return N
}}
}catch(H){if(AJS){AJS.log("heat-mapper-dom.js - unexpected exception");
AJS.log(H)
}}})(window.jQuery);;
;/* module-key = 'com.atlassian.shipit.click-listener-plugin:heat-mapper-events-resources', location = 'js/heat-mapper-events.js' */
AJS.toInit(function(C){try{if(window.AJS&&!AJS.DarkFeatures.isEnabled("heatmapper")){return 
}window.HeatMapper=window.HeatMapper||{};
if(!AJS.EventQueue&&!HeatMapper.Events){AJS.log("Analytics support not installed. Not tracking click events.");
return 
}function A(I){var H=window.location;
return{selector:HeatMapper.DOM.uniqueSelector(I),element:I[0].nodeName,hostname:H.hostname,port:H.port,protocol:H.protocol,path:H.pathname,userAgent:navigator.userAgent}
}function G(H){if(AJS.EventQueue){AJS.trigger("analyticsEvent",{name:"heatmapper-click",data:H})
}else{if(HeatMapper.Events){HeatMapper.Events.publish("heatmapper",H)
}}}function B(J){var I=C(J.currentTarget);
var H=A(I);
J.heatMapperHandled=true;
G(H)
}var E=C(document);
E.delegate(HeatMapper.DOM.eventSelectors.click,"click",B);
E.delegate(HeatMapper.DOM.eventSelectors.mousedown,"mousedown",B);
var F=jQuery.Event.prototype.stopPropagation;
jQuery.Event.prototype.stopPropagation=function(){try{if(this.currentTarget&&!this.heatMapperHandled&&this.type==="click"){var H=C(this.currentTarget);
if(H.is(HeatMapper.DOM.findSelector)){B(this)
}}}catch(I){AJS.log("Failed to intercept stopPropagation properly - skipping event capture");
AJS.log(I)
}return F.call(this)
}
}catch(D){AJS.log("heat-mapper-events.js - unexpected exception");
AJS.log(D)
}});;
;/* module-key = 'com.atlassian.growth.product-growth-jira-plugin:growth-web-resources', location = 'js/growth-helper.js' */
var GROW=GROW||{};(function(a){GROW.isLoggedIn=function(){if(AJS.Meta.get("remote-user")){return true}return false};GROW.isAdmin=function(){return a("#system-admin-menu").length!==0};AJS.toInit(function(){if(location.search.indexOf("triggerCreateProject=true")>-1){JPT.DialogController.handleProjectTemplateTriggered()}})})(AJS.$);;
;/* module-key = 'com.atlassian.growth.product-growth-jira-plugin:growth-web-resources', location = 'js/store.js' */
var GROW=GROW||{};GROW.Store=GROW.Store||{};(function(a){GROW.Store.get=function(b){return AJS.Meta.get(b)};GROW.Store.getNumber=function(b){return AJS.Meta.getNumber(b)};GROW.Store.getBoolean=function(b){return AJS.Meta.getBoolean(b)};GROW.Store.set=function(c,d,b){AJS.Meta.set(c,d);return a.ajax({url:contextPath+"/rest/growth/1/store",type:"PUT",contentType:"application/json",data:JSON.stringify({key:c,value:d,eventName:b})})};GROW.Store.setGlobal=function(c,d,b){AJS.Meta.set(c,d);return a.ajax({url:contextPath+"/rest/growth/1/store/global",type:"PUT",contentType:"application/json",data:JSON.stringify({key:c,value:d,eventName:b})})};GROW.Store.remove=function(c,b){AJS.Meta.set(c,null);return a.ajax({url:contextPath+"/rest/growth/1/store",type:"DELETE",contentType:"application/json",data:JSON.stringify({key:c,eventName:b})})};GROW.Store.removeGlobal=function(c,b){AJS.Meta.set(c,null);return a.ajax({url:contextPath+"/rest/growth/1/store/global",type:"DELETE",contentType:"application/json",data:JSON.stringify({key:c,eventName:b})})}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-invite-user-plugin:inviteuser-signup-resources', location = 'js/inviteuser-signup.js' */
(function(a){JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(c,b){a("#consolation-login-link").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"invitationsignupconsolationlogin",properties:{}})})})})(AJS.$);;
;/* module-key = 'com.atlassian.crowd.user-provisioning-plugin:adminmenu-analytics', location = 'js/atlassian/events.js' */
(function(){var a=function(c,d){AJS.trigger("analytics",{name:"unified.admin."+c,data:d||{}})};var b=function(){var c=AJS.contextPath();var d="Unknown";if(c===""){d="jira"}else{if(c==="/builds"){d="bamboo"}else{if(c==="/wiki"){d="confluence"}else{if(c==="/admin"){d="userManagement"}}}}return d};AJS.$(document).on("click","#admin-billing-link",function(){a("menu.billing.click",{product:b()})}).on("click","#admin-discovernewapps-link",function(){a("menu.addApplications.click",{product:b()})}).on("click","#admin-management-link",function(){a("menu.userManagement.click",{product:b()})}).on("click","#admin_billing_section",function(){a("menu.billing.click",{product:b()})}).on("click","#admin_discovernewapps_section",function(){a("menu.addApplications.click",{product:b()})}).on("click","#user_management_section",function(){a("menu.userManagement.click",{product:b()})})})();;
;/* module-key = 'com.atlassian.pas:pas-everypage-static', location = 'js/store_js/store.js' */
(function(){var c=function(g,h){return Object.prototype.hasOwnProperty.call(g,h)};var b=function(g){var i=0;for(var h in g){if(c(g,h)){i++}}return i};var d=function(l,j,k){var h=l.length>>>0;for(var g=(k<0)?Math.max(0,h+k):k||0;g<h;g++){if(l[g]===j){return g}}return -1};var f=function(i,g,h){return d(i,g,h)!==-1};var a=function(h,g){if(!f(h,g)){h.push(g)}return h};var e=this.Store=function(g,i,h){this.name=g;this.defaults=i||{};this.watcherSpeed=h||500;this.listeners={};this.applyDefaults()};e.clear=function(){localStorage.clear()};e.prototype.applyDefaults=function(){for(var g in this.defaults){if(c(this.defaults,g)&&this.get(g)===undefined){this.set(g,this.defaults[g])}}return this};e.prototype.watcher=function(i){if(this.watcherTimer){clearTimeout(this.watcherTimer)}if(b(this.listeners)||i){this.newObject=this.toObject();if(this.oldObject){for(var g in this.newObject){if(c(this.newObject,g)&&this.newObject[g]!==this.oldObject[g]){this.fireEvent(g,this.newObject[g])}}for(var g in this.oldObject){if(c(this.oldObject,g)&&!c(this.newObject,g)){this.fireEvent(g,this.newObject[g])}}}this.oldObject=this.newObject;var h=this;this.watcherTimer=setTimeout(function(){h.watcher()},this.watcherSpeed)}return this};e.prototype.get=function(g){var h=localStorage.getItem("store."+this.name+"."+g);if(h===null){return undefined}try{return JSON.parse(h)}catch(i){return null}};e.prototype.set=function(g,h){if(h===undefined){this.remove(g)}else{if(typeof h==="function"){h=null}try{h=JSON.stringify(h)}catch(i){h=null}localStorage.setItem("store."+this.name+"."+g,h)}return this};e.prototype.remove=function(g){localStorage.removeItem("store."+this.name+"."+g);return this.applyDefaults()};e.prototype.reset=function(){var g="store."+this.name+".";for(var h=(localStorage.length-1);h>=0;h--){if(localStorage.key(h).substring(0,g.length)===g){localStorage.removeItem(localStorage.key(h))}}return this.applyDefaults()};e.prototype.toObject=function(){var g={};var h="store."+this.name+".";for(var k=(localStorage.length-1);k>=0;k--){if(localStorage.key(k).substring(0,h.length)===h){var j=localStorage.key(k).substring(h.length);var l=this.get(j);if(l!==undefined){g[j]=l}}}return g};e.prototype.fromObject=function(g,i){if(!i){this.reset()}for(var h in g){if(c(g,h)){this.set(h,g[h])}}return this};e.prototype.addEvent=function(g,h){this.watcher(true);if(!this.listeners[g]){this.listeners[g]=[]}a(this.listeners[g],h);return this};e.prototype.removeEvent=function(g,j){for(var h=(this.listeners[g].length-1);h>=0;h--){if(this.listeners[g][h]===j){this.listeners[g].splice(h,1)}}if(!this.listeners[g].length){delete this.listeners[g]}return this};e.prototype.fireEvent=function(k,n){var m=[k,"*"];for(var l=0;l<m.length;l++){var g=m[l];if(this.listeners[g]){for(var h=0;h<this.listeners[g].length;h++){this.listeners[g][h](n,k,this.name)}}}return this}}());;
;/* module-key = 'com.atlassian.pas:pas-everypage-static', location = 'js/pasConfig.js' */
var Atlassian=Atlassian||{};Atlassian.PAS={timeUpdateInterval:60000,pollingInterval:15*60*1000,url:AJS.contextPath()+"/rest/pas/latest/announcement",store:new Store("Atlassian.PAS.Announcements."+document.location.hostname+AJS.contextPath()+"."+AJS.$("meta[name='ajs-remote-user']").attr("content")),nextAnnouncementKey:"nextAnnouncement",timeStampKey:"timeStamp",config:{url:AJS.contextPath()+"/rest/pas/latest/settings",timeStampKey:"configTimeStampKey",pollingInterval:30*60*1000,currentConfigKey:"currentConfigKey"},cookieKey:AJS.contextPath().replace("/","")+"_pas.dismiss",ace:{aceCookieKey:AJS.contextPath().replace("/","")+"_ace.dismiss",acePath:"/j/",aceHost:"ace.atlassian.com",nextAnnouncementKey:"aceNextAnnouncement",timeStampKey:"aceTimeStamp"}};;
;/* module-key = 'com.atlassian.pas:pas-everypage-static', location = 'js/pas.js' */
(function(){function a(){AJS.$.ajaxSetup({cache:false});var k=null;var o=null;var c=null;var f=0;var t=[".atlassian.net",".jira.com",".jira-dev.com"];var x=function(){Atlassian.PAS.announcement=AJS.$("<div id='pas-announcement'/>");Atlassian.PAS.announcementText=AJS.$("<span/>").appendTo(Atlassian.PAS.announcement);Atlassian.PAS.announcementUrl=AJS.$("<a id='more-info' target='_blank'>(more info)</a>").appendTo(Atlassian.PAS.announcement);AJS.$("<button id='dismiss-announcement' class='pas-announcement-right'>&#x2716;</button>").click(j).appendTo(Atlassian.PAS.announcement);Atlassian.PAS.announcementTime=AJS.$("<span class='pas-announcement-right'/>").appendTo(Atlassian.PAS.announcement);Atlassian.PAS.announcement.hide();AJS.$("#header").before(Atlassian.PAS.announcement)};var q=function(E){var H=function(M,N,L){M=""+M;while(M.length<L){M=N+M}return M};var G=function(N,M){var L=N+" "+M;if(N!=1){L+="s"}return L};var K=60000;var I=3600000;var F=86400000;if(E<K){return"in less than a minute"}else{if(E<I){return"in "+G(Math.round(E/K),"min")}else{if(E<F){return"in "+G(Math.round(E/I),"hour")+" "+G(Math.round((E%I)/K),"minute")}else{var J=new Date();J.setSeconds(J.getSeconds()+Math.round(E/1000));return(H(J.getFullYear(),"0",4)+"/"+H(J.getMonth()+1,"0",2)+"/"+H(J.getDate(),"0",2)+" "+H(J.getHours(),"0",2)+":"+H(J.getMinutes(),"0",2))}}}};var d=function(){if(AJS.$(window).scrollTop()>0){Atlassian.PAS.announcement.addClass("pas-persistent-header")}else{Atlassian.PAS.announcement.removeClass("pas-persistent-header");AJS.trigger("confluence.header-resized")}};var s=function(){if(k!=null){clearTimeout(k)}if(o!=null){clearTimeout(o)}if(c!=null){clearInterval(c)}Atlassian.PAS.announcement.hide();AJS.$(window).unbind("scroll",d)};var z=function(F){d();var E=function(){Atlassian.PAS.announcement.show();AJS.trigger("confluence.header-resized")};if(F==true){Atlassian.PAS.announcement.slideDown("fast",function(){E()})}else{E()}};var j=function(){Atlassian.PAS.announcement.slideUp("fast",function(){Atlassian.PAS.announcement.hide();AJS.trigger("confluence.header-resized")});var F=Atlassian.PAS.announcement.attr("announcementId");var E=new Date();if(F=="ace"){E.setDate(E.getDate()+7);var G=F+"; expires="+E.toUTCString();document.cookie=Atlassian.PAS.ace.aceCookieKey+"="+G+"; path=/";AJS.trigger("analyticsEvent",{name:"com.atlassian.plugins.pas.dismiss-ace-announcement.click",data:{message:AJS.$("#pas-announcement span:first").text()}})}else{E.setDate(E.getDate()+1);var G=F+"; "+E.toUTCString();document.cookie=Atlassian.PAS.cookieKey+"="+G+"; path=/";AJS.trigger("analyticsEvent",{name:"com.atlassian.plugins.pas.dismiss-announcement.click",data:{message:AJS.$("#pas-announcement span:first").text()}})}};var g=function(J,K){var H=document.cookie.split(";");for(var G=0;G<H.length;G++){var F=H[G];var L=F.indexOf("=");var E=AJS.$.trim(F.substr(0,L));var I=AJS.$.trim(F.substr(L+1));if(E==K){return I==J}}return false};var i=function(){if(f>0){var E=f-Atlassian.PAS.timeUpdateInterval;f=E;Atlassian.PAS.announcementTime.text(q(E))}else{clearInterval(c);c=null}};function l(){var L=m(Atlassian.PAS.config.currentConfigKey);if(L.aceEnabled){var F=(location.protocol=="https:"?"https://"+Atlassian.PAS.ace.aceHost+Atlassian.PAS.ace.acePath:"http://"+Atlassian.PAS.ace.aceHost+Atlassian.PAS.ace.acePath);var I=Math.floor(Math.random()*99999999999);if(!document.MAX_used){document.MAX_used=","}var E=(document.MAX_used!=","?"&exclude="+document.MAX_used:"");var K=(document.charset?"&charset="+document.charset:(document.characterSet?"&charset="+document.characterSet:""));var H=(document.URL?"&referer="+escape(document.URL):"");var G=(document.context?"&context="+escape(document.context):"");var J=F+"?zoneid="+L.zoneId+"&cb="+I+E+K+"&loc="+escape(window.location)+H+G;AJS.log("Polling ACE...");AJS.$.ajax({url:J,dataType:"jsonp",contentType:"application/json",success:function(M){y(Atlassian.PAS.ace.timeStampKey,D());y(Atlassian.PAS.ace.nextAnnouncementKey,M);e()},error:function(O,M,N){AJS.log("Could not get banner from ace: "+N)}})}else{AJS.log("Polling to ACE is disabled.")}}var e=function(){var F=AJS.Meta.get("remote-user");var E=m(Atlassian.PAS.ace.nextAnnouncementKey);if(E&&E.html!=null&&E.html!=""&&F!=null&&F!=""){Atlassian.PAS.announcementText.html(E.html);Atlassian.PAS.announcementUrl.hide();Atlassian.PAS.announcement.attr("announcementId","ace");z(true)}};var p=function(){var F=location.hostname;var E;for(E=0;E<t.length;++E){if(A(F,t[E])){return true}}return false};var A=function(F,E){var G=F.length-E.length;return G>=0&&F.lastIndexOf(E)===G};var w=function(){var F=function(){return G.timeToStart-r()};var G=m(Atlassian.PAS.nextAnnouncementKey);if(G==null||G.message==null||g(G.id,Atlassian.PAS.cookieKey)){if(p()){if(!g("ace",Atlassian.PAS.ace.aceCookieKey)){if(B()){l()}else{e()}}}return}f=G.timeLeft;AJS.$(window).bind("scroll",d);Atlassian.PAS.announcementText.html(G.message);Atlassian.PAS.announcementTime.text(q(f));c=setInterval(i,Atlassian.PAS.timeUpdateInterval);if(G.url){Atlassian.PAS.announcementUrl.attr("href",G.url);Atlassian.PAS.announcementUrl.show()}else{Atlassian.PAS.announcementUrl.hide()}var H=Atlassian.PAS.announcement.attr("announcementId");var I=(H&&H!=G.id);Atlassian.PAS.announcement.attr("announcementId",G.id);var E=G.duration;G.timeToStart=F();if(G.timeToStart>0){E+=G.timeToStart;k=setTimeout(function(){z(I)},G.timeToStart)}else{z(I)}if(E>0){o=setTimeout(function(){s()},E)}};function v(){AJS.$.ajax({type:"GET",contentType:"application/json",url:Atlassian.PAS.url,cache:false,global:false,timeout:5000,async:false,success:function(E,F){y(Atlassian.PAS.timeStampKey,D());y(Atlassian.PAS.nextAnnouncementKey,E)},error:function(G,E,F){AJS.log("Could not get announcement from server: "+F)}})}function b(){AJS.$.ajax({type:"GET",contentType:"application/json",url:Atlassian.PAS.config.url,cache:false,global:false,timeout:5000,async:false,success:function(E,F){y(Atlassian.PAS.config.timeStampKey,D());y(Atlassian.PAS.config.currentConfigKey,E)},error:function(G,E,F){AJS.log("Could not get configuration from server: "+F)}})}var D=function(){return new Date().getTime()};var r=function(){return(D()-m(Atlassian.PAS.timeStampKey))};function m(E){return Atlassian.PAS.store.get(E)}function y(E,F){return Atlassian.PAS.store.set(E,F)}function u(G,H){var F=m(G);var E=D()-F;return F==undefined||E>H}function n(){return u(Atlassian.PAS.timeStampKey,Atlassian.PAS.pollingInterval)}function C(){return u(Atlassian.PAS.config.timeStampKey,Atlassian.PAS.config.pollingInterval)}function B(){return true}function h(){AJS.$("#more-info").live("click",function(E){AJS.trigger("analyticsEvent",{name:"com.atlassian.plugins.pas.more-info.click",data:{message:AJS.$("#pas-announcement span:first").text()}})})}h();x();if(C()){b()}if(n()){v()}w()}AJS.toInit(a)})();;
;/* module-key = 'jira.webresources:jira-analytics', location = '/includes/jira/analytics/analytics.js' */
AJS.toInit(function($){function getBrowseProjectTab(){return $("li.active a.browse-tab").attr("id")}_.defer(function(){if(AJS.EventQueue){$(document).delegate("#project-admin-link","click",function(){var selectedTab=getBrowseProjectTab();AJS.EventQueue.push({name:"browseproject.administerproject",properties:{selectedtab:selectedTab}})});$(document).delegate("#browse-projects-create-project","click",function(){AJS.EventQueue.push({name:"browseprojects.createproject",properties:{}})});$(document).delegate("#no-issues-create-issue","click",function(){AJS.EventQueue.push({name:"browseproject.issuesblankslate.createissue",properties:{}})});$(document).delegate("a.issue-filter-link","click",function(){var $el=$(this);var id=$el.attr("id").replace("filter_","");var type=$el.attr("data-type");AJS.EventQueue.push({name:"browse"+type+".issuefilter."+id,properties:{}})});$(document).on("click","#project_import_link_lnk",function(){AJS.EventQueue.push({name:"topnav.jim",properties:{}})});$(document).on("click",".issueaction-viewworkflow",function(){var isNew=AJS.$(this).attr("class").indexOf("new-workflow-designer")>-1;var version=isNew?"new":"old";var newEnabled=AJS.DarkFeatures.isEnabled("casper.VIEW_ISSUE");AJS.EventQueue.push({name:"issue.viewworkflow",properties:{version:version,newEnabled:newEnabled}})});$.fn.ready(function captureWindowSize(){var width,height,shouldCapture=false;shouldCapture=shouldCapture||$(document.body).hasClass("page-type-navigator");if(!shouldCapture){return }width=$(window).width();height=$(window).height();AJS.EventQueue.push({name:"browserWindowSize",properties:{width:width,height:height}})})}})});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/jquery/plugins/avataror/avataror.js' */
jQuery.fn.avataror=function(options){var $=jQuery,$document=$(document);this.each(function(){var $this=$(this);var imgsrc=$this.find("img").attr("src");$this.css({"-moz-border-radius":"10px","-webkit-border-radius":"10px"});$this.html("<p>Loading?</p>");var avataror={previewSize:48};avataror.preview=$("<div/>").addClass("avataror-preview").css({border:"solid 1px #000","float":"left",height:avataror.previewSize+"px",overflow:"hidden",width:avataror.previewSize+"px",position:"relative",top:"-9999em",left:"-9999em"});avataror.preview.prependTo(options.previewElement);avataror.img=$('<img src="'+imgsrc+'" alt="Avatar Source"/>');avataror.img.load(function(){avataror.image=$("<div/>").css({background:"url('"+imgsrc+"') no-repeat",clear:"left",position:"relative"});avataror.marker=$("<div/>").css({cursor:"move",position:"relative"});avataror.dash=$("<div/>");avataror.shadow=$("<div/>");avataror.dash.add(avataror.shadow).css({cursor:"move",opacity:0.5,left:0,top:0,position:"absolute"});avataror.image.append(avataror.shadow).append(avataror.dash).append(avataror.marker);$this.append(avataror.image);avataror.marker.html("<div></div><div></div><div></div><div></div>");$("div",avataror.marker).each(function(i){var $this=$(this);$this.css({background:"#000",border:"solid 1px #fff",width:"10px",height:"10px",position:"absolute","font-size":"1px"});$this.css(["left","right","right","left"][i],"-6px");$this.css(["top","top","bottom","bottom"][i],"-6px");$this.css("cursor",["nw-resize","ne-resize","se-resize","sw-resize"][i]);$this.mousedown(function(e){e.preventDefault();e.stopPropagation();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height,i:i+1};avataror.shadow.hide()})});avataror.marker.add(avataror.image).mousedown(function(e){e.preventDefault();avataror.dragging={x:e.pageX,y:e.pageY,ax:avataror.x,ay:avataror.y,w:avataror.width,h:avataror.height};avataror.shadow.hide()});$document.mouseup(function(e){avataror.handleMouseUp(e)});$document.mousemove(function(e){if(avataror.dragging){avataror.handleMouseMove(e.pageX,e.pageY);e.preventDefault()}});avataror.imgwidth=avataror.img.width();avataror.imgheight=avataror.img.height();avataror.x=parseInt($("#avatar-offsetX").val());avataror.y=parseInt($("#avatar-offsetY").val());avataror.width=parseInt($("#avatar-width").val());avataror.height=avataror.width;avataror.image.css({width:avataror.imgwidth+"px",height:avataror.imgheight+"px"});avataror.setMarker();$this.css({width:avataror.imgwidth+"px"});avataror.preview.css({position:"static"});$("p",$this).remove();$this.trigger("AvatarImageLoaded")});avataror.preview.append(avataror.img);avataror.setMarker=function(){avataror.marker.css("border","dashed 1px #fff");avataror.dash.css("border","solid 1px #000");avataror.shadow.css("border","solid 1px #000");avataror.marker.add(this.dash).css("left",this.x-1+"px");avataror.marker.add(avataror.dash).css("top",avataror.y-1+"px");avataror.shadow.css("border-left-width",avataror.x+"px");avataror.shadow.css("border-right-width",avataror.imgwidth-avataror.x-avataror.width+"px");avataror.shadow.css("border-top-width",avataror.y+"px");avataror.shadow.css("border-bottom-width",avataror.imgheight-avataror.y-avataror.height+"px");avataror.shadow.css("width",avataror.width+"px");avataror.shadow.css("height",avataror.height+"px");avataror.marker.add(avataror.dash).css("width",avataror.width+"px");avataror.marker.add(avataror.dash).css("height",avataror.height+"px")};avataror.adjustPreview=function(){avataror.img.attr("width",avataror.imgwidth*avataror.previewSize/avataror.width);avataror.img.attr("height",avataror.imgheight*avataror.previewSize/avataror.height);avataror.img.css("margin-left","-"+avataror.x*avataror.previewSize/avataror.width+"px");avataror.img.css("margin-top","-"+avataror.y*avataror.previewSize/avataror.height+"px");avataror.preview.select()};avataror.handleMouseMove=function(newX,newY){avataror.dragging.nextExec=avataror.dragging.nextExec||0;if(avataror.dragging.nextExec==0){avataror.dragging.nextExec=3}else{avataror.dragging.nextExec--;return }var dx=newX-avataror.dragging.x;var dy=newY-avataror.dragging.y;if(this.dragging.i){var handler=avataror.resizeHandlers[this.dragging.i-1];handler(dx,dy)}else{avataror.x=avataror.dragging.ax+dx;avataror.y=avataror.dragging.ay+dy;if(avataror.x+avataror.width>avataror.imgwidth){avataror.x=avataror.imgwidth-avataror.width}if(avataror.y+avataror.height>avataror.imgheight){avataror.y=avataror.imgheight-avataror.height}if(avataror.x<0){avataror.x=0}if(avataror.y<0){avataror.y=0}}avataror.setMarker();avataror.adjustPreview()};avataror.handleMouseUp=function(e){$("#avatar-offsetX").val(avataror.x);$("#avatar-offsetY").val(avataror.y);$("#avatar-width").val(avataror.width);avataror.dragging=null;avataror.shadow.show()};avataror.originX=function(){return avataror.dragging.ax};avataror.originY=function(){return avataror.dragging.ay};avataror.originBottomX=function(){return avataror.dragging.ax+avataror.dragging.w};avataror.originBottomY=function(){return avataror.dragging.ay+avataror.dragging.h};avataror.originNw=function(){return{x:avataror.originX(),y:avataror.originY()}};avataror.originNe=function(){return{x:avataror.originBottomX(),y:avataror.originY()}};avataror.originSe=function(){return{x:avataror.originBottomX(),y:avataror.originBottomY()}};avataror.originSw=function(){return{x:avataror.originX(),y:avataror.originBottomY()}};avataror.nwHandler=function(dx,dy){var anchor=avataror.originSe();var tmpBase={x:avataror.originX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.x=anchor.x-newSize;avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.neHandler=function(dx,dy){var anchor=avataror.originSw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y-newSize<0){newSize=anchor.y}avataror.y=anchor.y-newSize;avataror.width=avataror.height=newSize};avataror.seHandler=function(dx,dy){var anchor=avataror.originNw();var tmpBase={x:avataror.originBottomX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x+newSize>avataror.imgwidth){newSize=avataror.imgwidth-anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.width=avataror.height=newSize};avataror.swHandler=function(dx,dy){var anchor=avataror.originNe();var tmpBase={x:avataror.originX()+dx,y:avataror.originBottomY()+dy};var diffX=Math.abs(tmpBase.x-anchor.x),diffY=Math.abs(tmpBase.y-anchor.y);var newSize=Math.min(diffX,diffY);if(newSize<20){newSize=20}if(anchor.x-newSize<0){newSize=anchor.x}if(anchor.y+newSize>avataror.imgheight){newSize=avataror.imgheight-anchor.y}avataror.x=anchor.x-newSize;avataror.width=avataror.height=newSize};avataror.resizeHandlers=[avataror.nwHandler,avataror.neHandler,avataror.seHandler,avataror.swHandler]})};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/Avatar.js' */
JIRA.Avatar=Class.extend({init:function(options){this._id=options.id;this._isSystemAvatar=options.isSystemAvatar;this._isSelected=options.isSelected;this._urls=options.urls},setUnSelected:function(){this._isSelected=false},setSelected:function(){this._isSelected=true},isSelected:function(){return !!this._isSelected},isSystemAvatar:function(){return this._isSystemAvatar},getId:function(){return this._id},getUrl:function(size){return this._urls[size]},toJSON:function(){return{id:this._id,isSystemAvatar:this._isSystemAvatar,isSelected:this._isSelected,urls:this._urls}}});JIRA.Avatar.createCustomAvatar=function(descriptor){descriptor.isSystemAvatar=false;return new JIRA.Avatar(descriptor)};JIRA.Avatar.createSystemAvatar=function(descriptor){descriptor.isSystemAvatar=true;return new JIRA.Avatar(descriptor)};JIRA.Avatar.getSizeObjectFromName=function(name){if("object"===typeof name){return name}var nameTrimmed="string"===typeof name?jQuery.trim(name):"";if(JIRA.Avatar.LARGE.param===name){return JIRA.Avatar.LARGE}else{if(JIRA.Avatar.MEDIUM.param===name){return JIRA.Avatar.MEDIUM}else{if(JIRA.Avatar.SMALL.param===name){return JIRA.Avatar.SMALL}else{if("xsmall"===name){return JIRA.Avatar.SMALL}else{return JIRA.Avatar.LARGE}}}}};JIRA.Avatar.LARGE={param:"large",height:48,width:48};JIRA.Avatar.MEDIUM={param:"medium",width:32,height:32};JIRA.Avatar.SMALL={param:"small",width:16,height:16};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarManager.js' */
JIRA.AvatarManager=Class.extend({init:function(options){this.store=options.store;this.ownerId=options.ownerId;this.username=options.username;this.anonymousAvatarId=options.anonymousAvatarId;this.avatarSrcBaseUrl=options.avatarSrcBaseUrl},selectAvatar:function(avatar,options){return this.store.selectAvatar(avatar,options)},getById:function(id){return this.store.getById(id)},destroy:function(avatar,options){this.store.destroy(avatar,options)},update:function(avatar,options){this.store.update(avatar,options)},add:function(avatar,options){this.store._add(avatar,options)},getAllSystemAvatars:function(){return this.store.getAllSystemAvatars()},getAllCustomAvatars:function(){return this.store.getAllCustomAvatars()},getSelectedAvatar:function(){return this.store.getSelectedAvatar()},getAllAvatars:function(){return this.store.getAllAvatars()},getAllAvatarsRenderData:function(size){var i,instance=this,avatars=this.getAllAvatars(),renderData={system:[],custom:[]};for(i=0;i<avatars.system.length;i++){renderData.system.push(instance.getAvatarRenderData(avatars.system[i],size))}for(i=0;i<avatars.custom.length;i++){renderData.custom.push(instance.getAvatarRenderData(avatars.custom[i],size))}return renderData},getAvatarRenderData:function(avatar,size){var data=avatar.toJSON();data.src=this.getAvatarSrc(avatar,size);data.width=size.width;data.height=size.height;return data},refreshStore:function(options){this.store.refresh(options)},getAvatarSrc:function(avatar,size){if(this.store.isTempAvatar(avatar)){return contextPath+"/secure/temporaryavatar?"+jQuery.param({cropped:true,magic:new Date().getTime(),size:size.param})}return avatar.getUrl(AJS.format("{0}x{1}",size.height,size.width))},createTemporaryAvatar:function(field,options){this.store.createTemporaryAvatar(field,options)},createAvatarFromTemporary:function(instructions,options){this.store.createAvatarFromTemporary(instructions,options)},getAnonymousAvatarId:function(){return this.anonymousAvatarId}});JIRA.AvatarManager.createUniversalAvatarManager=function(options){var restQueryUrl,restUpdateUrl="",restCreateTempUrl="",restUpdateTempUrl="",restSingleAvatarUrl="";if(options.projectId){var urlAvatarOwnerPrefix=contextPath+"/rest/api/latest/universal_avatar/type/"+options.avatarType+"/owner/"+options.projectId;restQueryUrl=urlAvatarOwnerPrefix;var avatarCreateUrl=urlAvatarOwnerPrefix+"/avatar";restUpdateUrl=null;restCreateTempUrl=urlAvatarOwnerPrefix+"/temp";restUpdateTempUrl=avatarCreateUrl;restSingleAvatarUrl=avatarCreateUrl}else{restQueryUrl=contextPath+"/rest/api/latest/avatar/project/system";restCreateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporary";restUpdateTempUrl=contextPath+"/rest/api/latest/avatar/project/temporaryCrop"}var store=new JIRA.AvatarStore({restQueryUrl:restQueryUrl,restUpdateUrl:restUpdateUrl,restCreateTempUrl:restCreateTempUrl,restUpdateTempUrl:restUpdateTempUrl,restSingleAvatarUrl:restSingleAvatarUrl,defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,ownerId:options.projectId,avatarSrcBaseUrl:contextPath+"/secure/projectavatar"})};JIRA.AvatarManager.createProjectAvatarManager=function(options){options.avatarType="project";return JIRA.AvatarManager.createUniversalAvatarManager(options)};JIRA.AvatarManager.createUserAvatarManager=function(options){var userRestUrl=contextPath+"/rest/api/latest/user";var store=new JIRA.AvatarStore({restQueryUrl:userRestUrl+"/avatars",restUpdateUrl:userRestUrl+"/avatar",restCreateTempUrl:userRestUrl+"/avatar/temporary",restUpdateTempUrl:userRestUrl+"/avatar",restSingleAvatarUrl:userRestUrl+"/avatar",restParams:{"username":options.username},defaultAvatarId:options.defaultAvatarId});return new JIRA.AvatarManager({store:store,username:options.username,avatarSrcBaseUrl:contextPath+"/secure/useravatar"})};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarStore.js' */
JIRA.AvatarStore=Class.extend({TEMP_ID:"TEMP",init:function(options){if(!options.restQueryUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restQueryUrl], The rest url for querying avatars (see class description)")}if(!options.restCreateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restCreateTempUrl], The rest url for creating a temporary avatar (see class description)")}if(!options.restUpdateTempUrl){throw new Error("JIRA.AvatarStore.init: You must specify [restUpdateTempUrl], The rest url for updating a temporary avatar (see class description)")}if(!options.defaultAvatarId){throw new Error("JIRA.AvatarStore.init: You must specify [defaultAvatarId] to the contructor so the store "+"knows what to select if you delete the selected one")}this.restQueryUrl=options.restQueryUrl;this.restUpdateUrl=options.restUpdateUrl;this.restCreateTempUrl=options.restCreateTempUrl;this.restUpdateTempUrl=options.restUpdateTempUrl;this.restSingleAvatarUrl=options.restSingleAvatarUrl;this.restParams=options.restParams||{};this.restParams.atl_token=atl_token();this.defaultAvatarId=options.defaultAvatarId;this.avatars={system:[],custom:[]}},_buildCompleteUrl:function(url){var completeUrl=url;if(this.restParams){var queryParams="";for(var name in this.restParams){queryParams+=AJS.format("&{0}={1}",encodeURIComponent(name),encodeURIComponent(this.restParams[name]))}completeUrl+=("?"+queryParams.substr(1))}return completeUrl},getById:function(avatarId){var match;jQuery.each(this.avatars.system,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}});if(!match){jQuery.each(this.avatars.custom,function(i,avatar){if(this.getId()===avatarId){match=avatar;return false}})}return match},isTempAvatar:function(avatar){return(avatar.getId()===this.TEMP_ID)},_selectAvatar:function(avatar){var selected=this.getSelectedAvatar();if(selected){selected.setUnSelected()}avatar.setSelected()},selectAvatar:function(avatar,options){var instance=this;if(!avatar){throw new Error("JIRA.AvatarStore.selectAvatar: Cannot select Avatar that does not exist")}if(this.restUpdateUrl){JIRA.SmartAjax.makeRequest({type:"PUT",contentType:"application/json",dataType:"json",url:this._buildCompleteUrl(this.restUpdateUrl),data:JSON.stringify(avatar.toJSON()),success:function(){instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}},error:options.error})}else{instance._selectAvatar(avatar);if(options.success){options.success.call(this,avatar)}}},_destory:function(avatar){var index=jQuery.inArray(avatar,this.avatars.custom);if(index!==-1){this.avatars.custom.splice(index,1)}else{throw new Error("JIRA.AvatarStore._destroy: Cannot remove avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},destroy:function(avatar,options){var instance=this;options=options||{};if(!avatar){throw new Error("JIRA.AvatarStore.destroy: Cannot delete Avatar that does not exist")}JIRA.SmartAjax.makeRequest({type:"DELETE",url:this.getRestUrlForAvatar(avatar),success:function(){instance._destory(avatar);if(avatar.isSelected()){instance.selectAvatar(instance.getById(instance.defaultAvatarId),options)}else{if(options.success){options.success.apply(this,arguments)}}},error:options.error})},getSelectedAvatar:function(){for(var i=0;i<this.avatars.custom.length;i++){if(this.avatars.custom[i].isSelected()){return this.avatars.custom[i]}}for(i=0;i<this.avatars.system.length;i++){if(this.avatars.system[i].isSelected()){return this.avatars.system[i]}}},_update:function(avatar){var instance=this;if(this.getById(avatar.getId())){jQuery.each(this.avatars.custom,function(i){if(this.getId()===avatar.getId()){instance.avatars.custom[i]=avatar}})}else{throw new Error("JIRA.AvatarStore._update: Cannot update avatar ["+avatar.getId()+"], "+"it might be a system avatar (readonly) or does not exist.")}},update:function(avatar,options){var instance=this;options=options||{};JIRA.SmartAjax.makeRequest({type:"PUT",url:this.getRestUrlForAvatar(avatar),error:options.error,success:function(){instance._update(avatar);if(options.success){options.success.apply(this,arguments)}}})},_add:function(avatar){if(avatar.isSystemAvatar()){this.avatars.system.push(avatar)}else{this.avatars.custom.push(avatar)}},createAvatarFromTemporary:function(instructions,options){var instance=this;options=options||{};if(this.restUpdateTempUrl){JIRA.SmartAjax.makeRequest({type:"POST",url:this._buildCompleteUrl(this.restUpdateTempUrl),data:JSON.stringify(instructions),contentType:"application/json",dataType:"json",success:function(data){if(!data){data={id:instance.TEMP_ID,isSelected:true}}var avatar=JIRA.Avatar.createCustomAvatar(data);instance._add(avatar);if(options.success){options.success.call(this,data)}},error:options.error})}},createTemporaryAvatar:function(fileInput,options){options=AJS.$.extend(true,{},options,{params:this.restParams});JIRA.AvatarUtil.uploadTemporaryAvatar(this.restCreateTempUrl,fileInput,options)},_refresh:function(avatars){var instance=this;instance.avatars.system=[];instance.avatars.custom=[];if(avatars.system){jQuery.each(avatars.system,function(i,descriptor){instance.avatars.system.push(JIRA.Avatar.createSystemAvatar(descriptor))})}if(avatars.custom){jQuery.each(avatars.custom,function(i,descriptor){instance.avatars.custom.push(JIRA.Avatar.createCustomAvatar(descriptor))})}},refresh:function(options){var instance=this;var tempAvatar=this.getById(instance.TEMP_ID);options=options||{};JIRA.SmartAjax.makeRequest({url:this._buildCompleteUrl(this.restQueryUrl),error:options.error,success:function(avatars){instance._refresh(avatars);if(tempAvatar){instance._add(tempAvatar)}if(options.success){options.success.apply(this,arguments)}}})},getAllAvatars:function(){return this.avatars},getAllSystemAvatars:function(){return this.avatars.system},getAllCustomAvatars:function(){return this.avatars.custom},getRestUrlForAvatar:function(avatar){return this._buildCompleteUrl(this.restSingleAvatarUrl+"/"+avatar.getId())}});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarUtil.js' */
JIRA.AvatarUtil={uploadUsingIframeRemoting:function(url,field,options){options=options||{};var fileName=field.val(),form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addStaticProgress(fileName);var $oldInput=form.cloneFileInput();form.fileSelector.clear();var timer=new AJS.InlineAttach.Timer(function(){!this.cancelled&&progress.show()},this);var upload=new AJS.InlineAttach.FormUpload({$input:$oldInput,url:url,params:AJS.$.extend({},options.params,{filename:fileName,atl_token:atl_token()}),scope:this,before:function(){!this.cancelled&&progress.start()},success:function(val,status){if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],fileName,JIRA.AvatarUtil.getErrorTarget(form))}else{if(options.success){options.success(val,status)}}},error:function(text){console.log(text);if(this.cancelled){return }if(text.indexOf("SecurityTokenMissing")>=0){form.addError(AJS.InlineAttach.Text.tr("upload.xsrf.timeout",fileName),JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",fileName),JIRA.AvatarUtil.getErrorTarget(form))}},after:function(){timer.cancel();progress.remove();if(!this.cancelled){form.enable()}}});progress.onCancel(function(){upload.abort()});upload.upload()},uploadUsingFileApi:function(url,field,options){var timer,upload,cancelled,file=field[0].files[0],form=new AJS.InlineAttach.Form(new AJS.InlineAttach.FileInput(field,false)),progress=form.addProgress(file);options=options||{};timer=new AJS.InlineAttach.Timer(function(){if(!cancelled){progress.show()}});upload=new AJS.InlineAttach.AjaxUpload({file:file,params:AJS.$.extend({},options.params,{filename:file.name,size:file.size,atl_token:atl_token()}),scope:this,url:url,before:function(){field.hide();!cancelled&&progress.start()},progress:function(val){progress.progress.$progress.parent().parent().show();!cancelled&&progress.update(val)},success:function(val,status){if(cancelled){return }if(val.errorMessages&&val.errorMessages.length){form.addErrorWithFileName(val.errorMessages[0],file.name,JIRA.AvatarUtil.getErrorTarget(form))}else{if(status===201){options.success(val,status)}}},error:function(text,status){if(status<0){form.addError(text,JIRA.AvatarUtil.getErrorTarget(form))}else{form.addError(AJS.InlineAttach.Text.tr("upload.error.unknown",file.name),JIRA.AvatarUtil.getErrorTarget(form))}if(options.error){options.error(text,status)}},after:function(){timer.cancel();progress.finish().remove();field.val("").show()}});upload.upload();progress.onCancel(function(){upload.abort()})},getErrorTarget:function(form){return{$element:form.$form.find(".error")}},uploadTemporaryAvatar:function(url,field,options){if(AJS.InlineAttach.AjaxPresenter.isSupported(field)){this.uploadUsingFileApi(url,field,options)}else{this.uploadUsingIframeRemoting(url,field,options)}}};;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.js' */
JIRA.AvatarPicker=AJS.Control.extend({init:function(options){this.avatarManager=options.avatarManager;this.avatarRenderer=options.avatarRenderer;this.imageEditor=options.imageEditor;this.size=options.size;this.selectCallback=options.select;this.cropperDialog=null;this.initialSelection=options.initialSelection},render:function(ready){var instance=this;this.avatarManager.refreshStore({success:function(){if(instance.cropperDialog instanceof JIRA.Dialog){instance.cropperDialog.hide();delete instance.cropperDialog}instance.element=jQuery('<div id="jira-avatar-picker" />');instance.element.html(JIRA.Templates.AvatarPicker.picker({avatars:instance.avatarManager.getAllAvatarsRenderData(instance.size)}));instance._assignEvents("selectAvatar",instance.element.find(".jira-avatar img"));instance._assignEvents("deleteAvatar",instance.element.find(".jira-delete-avatar"));instance._assignEvents("uploader",instance.element.find("#jira-avatar-uploader"));if(undefined!=instance.initialSelection){instance.getAvatarElById(instance.initialSelection).addClass("jira-selected-avatar")}ready(instance.element)},error:function(xhr,error,textStatus,smartAjaxResult){instance.appendErrorContent(instance.element,smartAjaxResult);ready(instance.element)}})},appendErrorContent:function(el,smartAjaxResult){try{var errors=JSON.parse(smartAjaxResult.data);if(errors&&errors.errorMessages){jQuery.each(errors.errorMessages,function(i,message){AJS.messages.error(el,{body:AJS.escapeHTML(message),closeable:false,shadowed:false})})}else{el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}}catch(e){el.append(JIRA.SmartAjax.buildDialogErrorContent(smartAjaxResult,true))}},uploadTempAvatar:function(field){var instance=this;this.avatarManager.createTemporaryAvatar(field,{success:function(data){if(data.id){instance.render(function(){instance.selectAvatar(data.id)})}else{field.val("");instance.cropperDialog=new JIRA.Dialog({id:"project-avatar-cropper",width:560,content:function(ready){var $el=instance.imageEditor.render(data);instance.imageEditor.edit({confirm:function(instructions){instance.avatarManager.createAvatarFromTemporary(instructions,{success:function(data){instance.render(function(){instance.selectAvatar(data.id)})}})}});$el.find(".cancel").click(function(){instance.cropperDialog.hide()});ready($el)}});instance.cropperDialog.bind("dialogContentReady",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.LOADED)});instance.cropperDialog.bind("Dialog.hide",function(){AJS.$(instance).trigger(JIRA.AvatarPicker.ImageEditor.DISMISSED)});instance.cropperDialog.show()}},error:function(){console.log(arguments)}})},getAvatarElById:function(id){return this.element.find(".jira-avatar[data-id='"+id+"']")},selectAvatar:function(id){var avatar,instance=this;avatar=this.avatarManager.getById(id);this.avatarManager.selectAvatar(this.avatarManager.getById(id),{error:function(){},success:function(){instance.getAvatarElById(id).remove();if(instance.selectCallback){instance.selectCallback.call(instance,avatar,instance.avatarManager.getAvatarSrc(avatar,instance.size))}}})},deleteAvatar:function(id){var instance=this;if(confirm("Are you sure you want to delete avatar?")){this.avatarManager.destroy(this.avatarManager.getById(id),{error:function(){},success:function(){var selectedAvatar=instance.avatarManager.getSelectedAvatar(),$avatar=instance.getAvatarElById(id);$avatar.fadeOut(function(){$avatar.remove()});if(selectedAvatar.getId()!==id){instance.getAvatarElById(selectedAvatar.getId()).addClass("jira-selected-avatar");instance.selectCallback.call(instance,selectedAvatar,instance.avatarManager.getAvatarSrc(selectedAvatar,instance.size),true)}}})}},_events:{uploader:{change:function(e,el){this.uploadTempAvatar(el)}},deleteAvatar:{click:function(e,el){this.deleteAvatar(el.attr("data-id"))}},selectAvatar:{click:function(e,el){if(e.target===el[0]){this.selectAvatar(el.attr("data-id"))}}}}});JIRA.AvatarPicker.ImageEditor=AJS.Control.extend({render:function(data){this.element=jQuery('<div id="avatar-picker-image-editor"/>').html(JIRA.Templates.AvatarPicker.imageEditor(data));return this.element},edit:function(options){var instance=this,avator=this.element.find(".avataror");options=options||{};avator.unbind();avator.bind("AvatarImageLoaded",function(){if(options.ready){options.ready()}});avator.find("img").load(function(){avator.avataror({previewElement:instance.element.find(".jira-avatar-cropper-header"),parent:instance.element})});this.element.find("#avataror").submit(function(e){e.preventDefault();if(options.confirm){options.confirm({cropperOffsetX:jQuery("#avatar-offsetX").val(),cropperOffsetY:jQuery("#avatar-offsetY").val(),cropperWidth:jQuery("#avatar-width").val()})}}).find(".cancel").click(function(e){e.preventDefault();if(options.cancel){options.cancel()}})}});JIRA.AvatarPicker.ImageEditor.LOADED="imageEditorLoaded";JIRA.AvatarPicker.ImageEditor.DISMISSED="imageEditorDismissed";JIRA.AvatarPicker.createUniversalAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUniversalAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,avatarType:options.avatarType}),initialSelection:options.initialSelection,imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:options.hasOwnProperty("avatarSize")?options.avatarSize:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createProjectAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createProjectAvatarManager({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.AvatarPicker.createUserAvatarPicker=function(options){return new JIRA.AvatarPicker({avatarManager:JIRA.AvatarManager.createUserAvatarManager({username:options.username,defaultAvatarId:options.defaultAvatarId}),imageEditor:new JIRA.AvatarPicker.ImageEditor(),size:JIRA.Avatar.LARGE,select:options.select})};JIRA.createUniversalAvatarPickerDialog=function(options){var lastSelection=options.initialSelection||options.defaultAvatarId;var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text(options.title||"Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUniversalAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,initialSelection:lastSelection,avatarType:options.avatarType,avatarSize:options.avatarSize,select:function(avatar,src,implicit){lastSelection=String(avatar.getId());if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createProjectAvatarPickerDialog=function(options){var projectAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"project-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="projectavatar-content-wrapper"/>');jQuery("<h2 />").text("Select a Project Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectKey:options.projectKey,projectId:options.projectId,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){projectAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});projectAvatarDialog._focusFirstField=function(){}};JIRA.createUserAvatarPickerDialog=function(options){var userAvatarDialog=new JIRA.FormDialog({trigger:options.trigger,id:"user-avatar-picker",width:560,stacked:true,content:function(ready){var avatarPicker,$dialogWrapper;$dialogWrapper=jQuery('<div id="useravatar-content-wrapper"/>');jQuery("<h2 />").text("Select a User Avatar").appendTo($dialogWrapper);avatarPicker=JIRA.AvatarPicker.createUserAvatarPicker({username:options.username,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}jQuery(".avatar-image").attr("src",src);if(!implicit){userAvatarDialog.hide()}}});avatarPicker.render(function(content){$dialogWrapper.append(content);ready($dialogWrapper)})}});userAvatarDialog._focusFirstField=function(){}};jQuery(function(){JIRA.createUserAvatarPickerDialog({trigger:"#user_avatar_image",username:jQuery("#avatar-owner-id").text(),defaultAvatarId:jQuery("#default-avatar-id").text()})});;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/GravatarUtil.js' */
(function(){AJS.namespace("JIRA.GravatarUtil");JIRA.GravatarUtil.showGravatarHelp=function(data){if(typeof (data)!=="undefined"&&typeof (data.entry)!=="undefined"){AJS.$(".gravatar-signup-text").addClass("hidden");AJS.$(".gravatar-login-text").removeClass("hidden")}};var displayGravatarHelp=function(){var gravatarJsonUrl=AJS.$("#gravatar_json_url");if(gravatarJsonUrl.length){AJS.$.ajax(gravatarJsonUrl.val(),{dataType:"jsonp",success:JIRA.GravatarUtil.showGravatarHelp})}};AJS.$(document).ready(function(){if(AJS.$("#gravatar_help_params")){displayGravatarHelp()}})}());;
;/* module-key = 'jira.webresources:avatar-picker', location = '/includes/ajs/avatarpicker/AvatarPicker.soy' */
// This file was automatically generated from AvatarPicker.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AvatarPicker == 'undefined') { JIRA.Templates.AvatarPicker = {}; }


JIRA.Templates.AvatarPicker.picker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="jira-avatar-upload-form" action="#"><input name="id" value="10000" type="hidden" ><input name="pid" value="10000" type="hidden" ><div class="field-group"><label>', soy.$$escapeHtml("Upload a new avatar"), '</label><input type="file" class="ignore-inline-attach" name="avatar" id="jira-avatar-uploader" /><div class="error"></div></div></form><div class="form-body"><ul class="jira-avatars">');
  var avatarList6 = opt_data.avatars.system;
  var avatarListLen6 = avatarList6.length;
  for (var avatarIndex6 = 0; avatarIndex6 < avatarListLen6; avatarIndex6++) {
    var avatarData6 = avatarList6[avatarIndex6];
    output.append('<li class="jira-avatar jira-system-avatar ', (avatarData6.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this Avatar" data-id="', soy.$$escapeHtml(avatarData6.id), '"><span><img id="avatar-', soy.$$escapeHtml(avatarData6.id), '" data-id="', soy.$$escapeHtml(avatarData6.id), '" src="', soy.$$escapeHtml(avatarData6.src), '" width="', soy.$$escapeHtml(avatarData6.width), '" height="', soy.$$escapeHtml(avatarData6.height), '" /></span></li>');
  }
  var avatarList25 = opt_data.avatars.custom;
  var avatarListLen25 = avatarList25.length;
  for (var avatarIndex25 = 0; avatarIndex25 < avatarListLen25; avatarIndex25++) {
    var avatarData25 = avatarList25[avatarIndex25];
    output.append('<li class="jira-avatar jira-custom-avatar ', (avatarData25.isSelected) ? 'jira-selected-avatar' : '', '" title="Select this avatar" data-id="', soy.$$escapeHtml(avatarData25.id), '"><span><img id="avatar-', soy.$$escapeHtml(avatarData25.id), '" data-id="', soy.$$escapeHtml(avatarData25.id), '" src="', soy.$$escapeHtml(avatarData25.src), '" width="', soy.$$escapeHtml(avatarData25.width), '" height="', soy.$$escapeHtml(avatarData25.height), '" /></span><span class="jira-delete-avatar" data-id="', soy.$$escapeHtml(avatarData25.id), '" title="', soy.$$escapeHtml("Delete this Avatar"), '">Delete</span></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AvatarPicker.imageEditor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form id="avataror" class="jira-avatar-cropper-form aui" action="/jira/secure/project/AvatarPicker.jspa"><input type="hidden" name="cropperOffsetX" id="avatar-offsetX" value="', soy.$$escapeHtml(opt_data.cropperOffsetX), '"><input type="hidden" name="cropperOffsetY" id="avatar-offsetY" value="', soy.$$escapeHtml(opt_data.cropperOffsetY), '"><input type="hidden" name="cropperWidth" id="avatar-width"  value="', soy.$$escapeHtml(opt_data.cropperWidth), '"><div class="jira-avatar-cropper-header"><p>', soy.$$escapeHtml("Please select which part of the uploaded image you wish to use as the avatar."), '</p></div><div class="form-body"><div class="avataror"><img src="', soy.$$escapeHtml(opt_data.url), '" height="300" /></div></div><div class="form-footer buttons-container"><div class="buttons"><input type="submit" class="aui-button" value="', soy.$$escapeHtml("Confirm"), '"><a class="aui-button aui-button-link cancel" href="#">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:avatar-picker-trigger', location = '/includes/jira/admin/initAvatarPickerTrigger.js' */
(function(){var AvatarPickerContentRetriever=AJS.ContentRetriever.extend({init:function(avatarPicker){this.avatarPicker=avatarPicker},content:function(finished){this.avatarPicker.render(function(el){finished(jQuery("<div />").html(el))})},cache:function(){return false},isLocked:function(){},startingRequest:function(){},finishedRequest:function(){}});var InlineAvatarPicker=AJS.InlineLayer.extend({init:function(options){var instance=this;this.avatarPicker=JIRA.AvatarPicker.createProjectAvatarPicker({projectId:options.projectId,projectKey:options.projectKey,defaultAvatarId:options.defaultAvatarId,select:function(avatar,src,implicit){if(options.select){options.select.apply(this,arguments)}if(!implicit){instance.hide()}instance.offsetTarget().attr("src",src);instance.offsetTarget().trigger("AvatarSelected")}});options.contentRetriever=new AvatarPickerContentRetriever(this.avatarPicker);jQuery(this.avatarPicker.imageEditor).bind(JIRA.AvatarPicker.ImageEditor.LOADED,function(){instance.setWidth(instance.layer().attr("scrollWidth"))});this._super(options);var $triggerImg=this.offsetTarget();var $triggerContainer=jQuery("<span class='jira-avatar-picker-trigger'></span>");$triggerContainer.insertBefore($triggerImg).append($triggerImg);this._assignEvents("offsetTarget",$triggerContainer)},_events:{offsetTarget:{click:function(e){this.show()}}}});function initProjectAvatarPicker(ctx){var trigger=jQuery(".jira-avatar-picker-trigger");var triggerImg=jQuery(".jira-avatar-picker-trigger img, img.jira-avatar-picker-trigger",ctx);var avatarIdField=jQuery(ctx).find("#avatar-picker-avatar-id");var avatarIconurlField=jQuery(ctx).find("#avatar-picker-iconurl");var avatarTypeElement=jQuery(ctx).find("#avatar-type");if(""===avatarTypeElement.text()){return }JIRA.createUniversalAvatarPickerDialog({trigger:trigger,title:jQuery(ctx).find("#avatar-dialog-title").text(),projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),initialSelection:avatarIdField.val(),avatarSize:JIRA.Avatar.getSizeObjectFromName(jQuery(ctx).find("#avatar-size").text()),avatarType:avatarTypeElement.text(),select:function(avatar,src){triggerImg.attr("src",src);avatarIconurlField.val(src);avatarIdField.val(avatar.getId())}})}function initProjectInlineAvatarPicker(ctx){var $triggerImg=jQuery(".jira-inline-avatar-picker-trigger",ctx);if($triggerImg.length){new InlineAvatarPicker({offsetTarget:$triggerImg,projectId:jQuery(ctx).find("#avatar-owner-id").text(),projectKey:jQuery(ctx).find("#avatar-owner-key").text(),defaultAvatarId:jQuery(ctx).find("#default-avatar-id").text(),alignment:AJS.LEFT,width:420,allowDownsize:true})}}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initProjectAvatarPicker(context);initProjectInlineAvatarPicker(context)}})})();;
;/* module-key = 'jira.webresources:croneditor', location = '/includes/js/cron/croneditor.js' */
function hideCronEdit(elementid){document.getElementById(elementid).style.display="none"}function showCronEdit(elementid){document.getElementById(elementid).style.display=""}function toggleFrequencyControl(paramPrefix,setOriginal){var select=document.getElementById(paramPrefix+"interval");if(select.value==0){switchToOnce(paramPrefix,setOriginal)}else{switchToMany(paramPrefix,setOriginal)}}function switchToOnce(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runMany");showCronEdit(paramPrefix+"runOnce");if(setOriginal){timesOnce[paramPrefix]=true}}function switchToMany(paramPrefix,setOriginal){hideCronEdit(paramPrefix+"runOnce");showCronEdit(paramPrefix+"runMany");if(setOriginal){timesOnce[paramPrefix]=false}}function switchToDaysOfMonth(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");showCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");hideCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOnce(paramPrefix,false)}function switchToDaysOfWeek(paramPrefix){showCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToDaily(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");showCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"innerFreqDiv");hideCronEdit(paramPrefix+"advanced");switchToOriginal(paramPrefix)}function switchToAdvanced(paramPrefix){hideCronEdit(paramPrefix+"daysOfWeek");hideCronEdit(paramPrefix+"daysOfMonth");hideCronEdit(paramPrefix+"runOnce");hideCronEdit(paramPrefix+"runMany");hideCronEdit(paramPrefix+"freqDiv");showCronEdit(paramPrefix+"advanced")}function switchToOriginal(paramPrefix){if(timesOnce[paramPrefix]){switchToOnce(paramPrefix,false)}else{switchToMany(paramPrefix,false)}};;
;/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.js' */
Calendar=function(firstDayOfWeek,dateStr,onSelected,onClose){this.activeDiv=null;this.currentDateEl=null;this.getDateStatus=null;this.getDateToolTip=null;this.getDateText=null;this.timeout=null;this.onSelected=onSelected||null;this.onClose=onClose||null;this.dragging=false;this.hidden=false;this.minYear=1970;this.maxYear=2050;this.dateFormat=Calendar._TT["DEF_DATE_FORMAT"];this.ttDateFormat=Calendar._TT["TT_DATE_FORMAT"];this.isPopup=true;this.weekNumbers=true;this.firstDayOfWeek=typeof firstDayOfWeek=="number"?firstDayOfWeek:Calendar._FD;this.showsOtherMonths=false;this.dateStr=dateStr;this.ar_days=null;this.showsTime=false;this.time24=true;this.yearStep=2;this.hiliteToday=true;this.multiple=null;this.table=null;this.element=null;this.tbody=null;this.firstdayname=null;this.monthsCombo=null;this.yearsCombo=null;this.hilitedMonth=null;this.activeMonth=null;this.hilitedYear=null;this.activeYear=null;this.dateClicked=false;if(typeof Calendar._SDN=="undefined"){if(typeof Calendar._SDN_len=="undefined"){Calendar._SDN_len=3}var ar=new Array();for(var i=8;i>0;){ar[--i]=Calendar._DN[i].substr(0,Calendar._SDN_len)}Calendar._SDN=ar;if(typeof Calendar._SMN_len=="undefined"){Calendar._SMN_len=3}ar=new Array();for(var i=12;i>0;){ar[--i]=Calendar._MN[i].substr(0,Calendar._SMN_len)}Calendar._SMN=ar}};Calendar._C=null;Calendar.is_ie=(/msie/i.test(navigator.userAgent)&&!/opera/i.test(navigator.userAgent));Calendar.is_ie5=(Calendar.is_ie&&/msie 5\.0/i.test(navigator.userAgent));Calendar.is_ie6=(Calendar.is_ie&&/msie 6\.0/i.test(navigator.userAgent));Calendar.is_opera=/opera/i.test(navigator.userAgent);Calendar.is_khtml=/Konqueror|Safari|KHTML/i.test(navigator.userAgent);Calendar.getAbsolutePos=function(el){var coords=jQuery(el).offset();coords.x=coords.left;coords.y=coords.top;return coords};Calendar.isRelated=function(el,evt){var related=evt.relatedTarget;if(!related){var type=evt.type;if(type=="mouseover"){related=evt.fromElement}else{if(type=="mouseout"){related=evt.toElement}}}while(related){if(related==el){return true}related=related.parentNode}return false};Calendar.removeClass=function(el,className){if(!(el&&el.className)){return }var cls=el.className.split(" ");var ar=new Array();for(var i=cls.length;i>0;){if(cls[--i]!=className){ar[ar.length]=cls[i]}}el.className=ar.join(" ")};Calendar.addClass=function(el,className){Calendar.removeClass(el,className);el.className+=" "+className};Calendar.getElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.currentTarget;while(f.nodeType!=1||/^div$/i.test(f.tagName)){f=f.parentNode}return f};Calendar.getTargetElement=function(ev){var f=Calendar.is_ie?window.event.srcElement:ev.target;while(f.nodeType!=1){f=f.parentNode}return f};Calendar.stopEvent=function(ev){if(!ev){ev=window.event}if(ev.stopPropagation){ev.preventDefault();ev.stopPropagation()}else{ev.cancelBubble=true;ev.returnValue=false}return false};Calendar.addEvent=function(el,evname,func){if(el.attachEvent){el.attachEvent("on"+evname,func)}else{if(el.addEventListener){el.addEventListener(evname,func,true)}else{el["on"+evname]=func}}};Calendar.removeEvent=function(el,evname,func){if(el.detachEvent){el.detachEvent("on"+evname,func)}else{if(el.removeEventListener){el.removeEventListener(evname,func,true)}else{el["on"+evname]=null}}};Calendar.createElement=function(type,parent){var el=null;if(document.createElementNS){el=document.createElementNS("http://www.w3.org/1999/xhtml",type)}else{el=document.createElement(type)}if(typeof parent!="undefined"){parent.appendChild(el)}return el};Calendar._add_evs=function(el){with(Calendar){addEvent(el,"mouseover",dayMouseOver);addEvent(el,"mousedown",dayMouseDown);addEvent(el,"mouseout",dayMouseOut);if(is_ie){addEvent(el,"dblclick",dayMouseDblClick);el.setAttribute("unselectable",true)}}};Calendar.findMonth=function(el){if(typeof el.month!="undefined"){return el}else{if(typeof el.parentNode.month!="undefined"){return el.parentNode}}return null};Calendar.findYear=function(el){if(typeof el.year!="undefined"){return el}else{if(typeof el.parentNode.year!="undefined"){return el.parentNode}}return null};Calendar.showMonthsCombo=function(){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var mc=cal.monthsCombo;if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}if(cal.activeMonth){Calendar.removeClass(cal.activeMonth,"active")}var mon=cal.monthsCombo.getElementsByTagName("div")[cal.date.getMonth()];Calendar.addClass(mon,"active");cal.activeMonth=mon;var s=mc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var mcw=mc.offsetWidth;if(typeof mcw=="undefined"){mcw=50}s.left=(cd.offsetLeft+cd.offsetWidth-mcw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"};Calendar.showYearsCombo=function(fwd){var cal=Calendar._C;if(!cal){return false}var cal=cal;var cd=cal.activeDiv;var yc=cal.yearsCombo;if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}if(cal.activeYear){Calendar.removeClass(cal.activeYear,"active")}cal.activeYear=null;var Y=cal.date.getFullYear()+(fwd?1:-1);var yr=yc.firstChild;var show=false;for(var i=12;i>0;--i){if(Y>=cal.minYear&&Y<=cal.maxYear){yr.innerHTML=Y;yr.year=Y;yr.style.display="block";show=true}else{yr.style.display="none"}yr=yr.nextSibling;Y+=fwd?cal.yearStep:-cal.yearStep}if(show){var s=yc.style;s.display="block";if(cd.navtype<0){s.left=cd.offsetLeft+"px"}else{var ycw=yc.offsetWidth;if(typeof ycw=="undefined"){ycw=50}s.left=(cd.offsetLeft+cd.offsetWidth-ycw)+"px"}s.top=(cd.offsetTop+cd.offsetHeight)+"px"}};Calendar.tableMouseUp=function(ev){var cal=Calendar._C;if(!cal){return false}if(cal.timeout){clearTimeout(cal.timeout)}var el=cal.activeDiv;if(!el){return false}var target=Calendar.getTargetElement(ev);ev||(ev=window.event);Calendar.removeClass(el,"active");if(target==el||target.parentNode==el){Calendar.cellClick(el,ev)}var mon=Calendar.findMonth(target);var date=null;if(mon){date=new Date(cal.date);if(mon.month!=date.getMonth()){date.setMonth(mon.month);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}else{var year=Calendar.findYear(target);if(year){date=new Date(cal.date);if(year.year!=date.getFullYear()){date.setFullYear(year.year);cal.setDate(date);cal.dateClicked=false;cal.callHandler()}}}with(Calendar){removeEvent(document,"mouseup",tableMouseUp);removeEvent(document,"mouseover",tableMouseOver);removeEvent(document,"mousemove",tableMouseOver);cal._hideCombos();_C=null;return stopEvent(ev)}};Calendar.tableMouseOver=function(ev){var cal=Calendar._C;if(!cal){return }var el=cal.activeDiv;var target=Calendar.getTargetElement(ev);if(target==el||target.parentNode==el){Calendar.addClass(el,"hilite active");Calendar.addClass(el.parentNode,"rowhilite")}else{if(typeof el.navtype=="undefined"||(el.navtype!=50&&(el.navtype==0||Math.abs(el.navtype)>2))){Calendar.removeClass(el,"active")}Calendar.removeClass(el,"hilite");Calendar.removeClass(el.parentNode,"rowhilite")}ev||(ev=window.event);if(el.navtype==50&&target!=el){var pos=Calendar.getAbsolutePos(el);var w=el.offsetWidth;var x=ev.clientX;var dx;var decrease=true;if(x>pos.x+w){dx=x-pos.x-w;decrease=false}else{dx=pos.x-x}if(dx<0){dx=0}var range=el._range;var current=el._current;var count=Math.floor(dx/10)%range.length;for(var i=range.length;--i>=0;){if(range[i]==current){break}}while(count-->0){if(decrease){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime()}var mon=Calendar.findMonth(target);if(mon){if(mon.month!=cal.date.getMonth()){if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}Calendar.addClass(mon,"hilite");cal.hilitedMonth=mon}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}}}else{if(cal.hilitedMonth){Calendar.removeClass(cal.hilitedMonth,"hilite")}var year=Calendar.findYear(target);if(year){if(year.year!=cal.date.getFullYear()){if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}Calendar.addClass(year,"hilite");cal.hilitedYear=year}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}else{if(cal.hilitedYear){Calendar.removeClass(cal.hilitedYear,"hilite")}}}return Calendar.stopEvent(ev)};Calendar.tableMouseDown=function(ev){if(Calendar.getTargetElement(ev)==Calendar.getElement(ev)){return Calendar.stopEvent(ev)}};Calendar.calDragIt=function(ev){var cal=Calendar._C;if(!(cal&&cal.dragging)){return false}var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posX=ev.pageX;posY=ev.pageY}var st=cal.element.style;st.left=(posX-cal.xOffs)+"px";st.top=(posY-cal.yOffs)+"px";return Calendar.stopEvent(ev)};Calendar.calDragEnd=function(ev){var cal=Calendar._C;if(!cal){return false}cal.dragging=false;with(Calendar){removeEvent(document,"mousemove",calDragIt);removeEvent(document,"mouseup",calDragEnd);tableMouseUp(ev)}};Calendar.dayMouseDown=function(ev){var el=Calendar.getElement(ev);if(el.disabled){return false}var cal=el.calendar;cal.activeDiv=el;Calendar._C=cal;if(el.navtype!=300){with(Calendar){if(el.navtype==50){el._current=el.innerHTML;addEvent(document,"mousemove",tableMouseOver)}else{addEvent(document,Calendar.is_ie5?"mousemove":"mouseover",tableMouseOver)}addClass(el,"hilite active");addEvent(document,"mouseup",tableMouseUp)}}else{if(cal.isPopup){cal._dragStart(ev)}}if(el.navtype==-1||el.navtype==1){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout("Calendar.showMonthsCombo()",250)}else{if(el.navtype==-2||el.navtype==2){if(cal.timeout){clearTimeout(cal.timeout)}cal.timeout=setTimeout((el.navtype>0)?"Calendar.showYearsCombo(true)":"Calendar.showYearsCombo(false)",250)}else{cal.timeout=null}}return Calendar.stopEvent(ev)};Calendar.dayMouseDblClick=function(ev){Calendar.cellClick(Calendar.getElement(ev),ev||window.event);if(Calendar.is_ie){document.selection.empty()}};Calendar.dayMouseOver=function(ev){var el=Calendar.getElement(ev);if(Calendar.isRelated(el,ev)||Calendar._C||el.disabled){return false}if(el.ttip){if(el.ttip.substr(0,1)=="_"){el.ttip=el.caldate.print(el.calendar.ttDateFormat)+el.ttip.substr(1)}el.calendar.tooltips.innerHTML=el.ttip}if(el.navtype!=300){Calendar.addClass(el,"hilite");if(el.caldate){Calendar.addClass(el.parentNode,"rowhilite")}}return Calendar.stopEvent(ev)};Calendar.dayMouseOut=function(ev){with(Calendar){var el=getElement(ev);if(isRelated(el,ev)||_C||el.disabled){return false}removeClass(el,"hilite");if(el.caldate){removeClass(el.parentNode,"rowhilite")}if(el.calendar){el.calendar.tooltips.innerHTML=_TT["SEL_DATE"]}return stopEvent(ev)}};Calendar.cellClick=function(el,ev){var cal=el.calendar;var closing=false;var newdate=false;var date=null;if(typeof el.navtype=="undefined"){if(cal.currentDateEl){Calendar.removeClass(cal.currentDateEl,"selected");Calendar.addClass(el,"selected");closing=(cal.currentDateEl==el);if(!closing){cal.currentDateEl=el}}cal.date.setDateOnly(el.caldate);date=cal.date;var other_month=!(cal.dateClicked=!el.otherMonth);if(!other_month&&!cal.currentDateEl){cal._toggleMultipleDate(new Date(date))}else{newdate=!el.disabled}if(other_month){cal._init(cal.firstDayOfWeek,date)}}else{if(el.navtype==200){Calendar.removeClass(el,"hilite");cal.callCloseHandler();return }date=new Date(cal.date);if(el.navtype==0){date.setDateOnly(new Date())}cal.dateClicked=false;var year=date.getFullYear();var mon=date.getMonth();function setMonth(m){var day=date.getDate();var max=date.getMonthDays(m);if(day>max){date.setDate(max)}date.setMonth(m)}switch(el.navtype){case 400:Calendar.removeClass(el,"hilite");var text=Calendar._TT["ABOUT"];if(typeof text!="undefined"){text+=cal.showsTime?Calendar._TT["ABOUT_TIME"]:""}else{text="Help and about box text is not translated into this language.\n"+"If you know this language and you feel generous please update\n"+'the corresponding file in "lang" subdir to match calendar-en.js\n'+"and send it back to <mihai_bazon@yahoo.com> to get it into the distribution  ;-)\n\n"+"Thank you!\n"+"http://dynarch.com/mishoo/calendar.epl\n"}alert(text);return ;case -2:if(year>cal.minYear){date.setFullYear(year-1)}break;case -1:if(mon>0){setMonth(mon-1)}else{if(year-->cal.minYear){date.setFullYear(year);setMonth(11)}}break;case 1:if(mon<11){setMonth(mon+1)}else{if(year<cal.maxYear){date.setFullYear(year+1);setMonth(0)}}break;case 2:if(year<cal.maxYear){date.setFullYear(year+1)}break;case 100:cal.setFirstDayOfWeek(el.fdow);return ;case 50:var range=el._range;var current=el.innerHTML;for(var i=range.length;--i>=0;){if(range[i]==current){break}}if(ev&&ev.shiftKey){if(--i<0){i=range.length-1}}else{if(++i>=range.length){i=0}}var newval=range[i];el.innerHTML=newval;cal.onUpdateTime();return ;case 0:if((typeof cal.getDateStatus=="function")&&cal.getDateStatus(date,date.getFullYear(),date.getMonth(),date.getDate())){return false}break}if(!date.equalsTo(cal.date)){cal.setDate(date);newdate=true}else{if(el.navtype==0){newdate=closing=true}}}if(newdate){ev&&cal.callHandler()}if(closing){Calendar.removeClass(el,"hilite");ev&&cal.callCloseHandler()}};Calendar.prototype.create=function(_par){var parent=null;if(!_par){parent=document.getElementsByTagName("body")[0];this.isPopup=true}else{parent=_par;this.isPopup=false}if(this.dateStr){this.date=new Date(this.dateStr)}if(!this.date||isNaN(this.date)){this.date=new Date()}var table=Calendar.createElement("table");this.table=table;table.cellSpacing=0;table.cellPadding=0;table.calendar=this;Calendar.addEvent(table,"mousedown",Calendar.tableMouseDown);var div=Calendar.createElement("div");this.element=div;div.className="calendar";if(this.isPopup){div.style.position="absolute";div.style.display="none"}div.appendChild(table);var thead=Calendar.createElement("thead",table);var cell=null;var row=null;var cal=this;var hh=function(text,cs,navtype){cell=Calendar.createElement("td",row);cell.colSpan=cs;cell.className="button";if(navtype!=0&&Math.abs(navtype)<=2){cell.className+=" nav"}Calendar._add_evs(cell);cell.calendar=cal;cell.navtype=navtype;cell.innerHTML="<div unselectable='on'>"+text+"</div>";return cell};row=Calendar.createElement("tr",thead);var title_length=6;(this.isPopup)&&--title_length;(this.weekNumbers)&&++title_length;hh("?",1,400).ttip=Calendar._TT["INFO"];this.title=hh("",title_length,300);this.title.className="title";if(this.isPopup){this.title.ttip=Calendar._TT["DRAG_TO_MOVE"];this.title.style.cursor="move";hh("&#x00d7;",1,200).ttip=Calendar._TT["CLOSE"]}row=Calendar.createElement("tr",thead);row.className="headrow";this._nav_py=hh("&#x00ab;",1,-2);this._nav_py.ttip=Calendar._TT["PREV_YEAR"];this._nav_pm=hh("&#x2039;",1,-1);this._nav_pm.ttip=Calendar._TT["PREV_MONTH"];this._nav_now=hh(Calendar._TT["TODAY"],this.weekNumbers?4:3,0);this._nav_now.ttip=Calendar._TT["GO_TODAY"];this._nav_nm=hh("&#x203a;",1,1);this._nav_nm.ttip=Calendar._TT["NEXT_MONTH"];this._nav_ny=hh("&#x00bb;",1,2);this._nav_ny.ttip=Calendar._TT["NEXT_YEAR"];row=Calendar.createElement("tr",thead);row.className="daynames";if(this.weekNumbers){cell=Calendar.createElement("td",row);cell.className="name wn";cell.innerHTML=Calendar._TT["WK"]}for(var i=7;i>0;--i){cell=Calendar.createElement("td",row);if(!i){cell.navtype=100;cell.calendar=this;Calendar._add_evs(cell)}}this.firstdayname=(this.weekNumbers)?row.firstChild.nextSibling:row.firstChild;this._displayWeekdays();var tbody=Calendar.createElement("tbody",table);this.tbody=tbody;for(i=6;i>0;--i){row=Calendar.createElement("tr",tbody);if(this.weekNumbers){cell=Calendar.createElement("td",row)}for(var j=7;j>0;--j){cell=Calendar.createElement("td",row);cell.calendar=this;Calendar._add_evs(cell)}}if(this.showsTime){row=Calendar.createElement("tr",tbody);row.className="time";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;cell.innerHTML=Calendar._TT["TIME"]||"&nbsp;";cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=this.weekNumbers?4:3;(function(){function makeTimePart(className,init,range_start,range_end){var part=Calendar.createElement("span",cell);part.className=className;part.innerHTML=init;part.calendar=cal;part.ttip=Calendar._TT["TIME_PART"];part.navtype=50;part._range=[];if(typeof range_start!="number"){part._range=range_start}else{for(var i=range_start;i<=range_end;++i){var txt;if(i<10&&range_end>=10){txt="0"+i}else{txt=""+i}part._range[part._range.length]=txt}}Calendar._add_evs(part);return part}var hrs=cal.date.getHours();var mins=cal.date.getMinutes();var t12=!cal.time24;var pm=(hrs>12);if(t12&&pm){hrs-=12}var H=makeTimePart("hour",hrs,t12?1:0,t12?12:23);var span=Calendar.createElement("span",cell);span.innerHTML=":";span.className="colon";var M=makeTimePart("minute",mins,0,59);var AP=null;cell=Calendar.createElement("td",row);cell.className="time";cell.colSpan=2;if(t12){AP=makeTimePart("ampm",pm?Calendar._TT["PM"]:Calendar._TT["AM"],[Calendar._TT["am"],Calendar._TT["pm"]])}else{cell.innerHTML="&nbsp;"}cal.onSetTime=function(){var pm,hrs=this.date.getHours(),mins=this.date.getMinutes();if(t12){pm=(hrs>=12);if(pm){hrs-=12}if(hrs==0){hrs=12}AP.innerHTML=pm?Calendar._TT["pm"]:Calendar._TT["am"]}H.innerHTML=(hrs<10)?("0"+hrs):hrs;M.innerHTML=(mins<10)?("0"+mins):mins};cal.onUpdateTime=function(){var date=this.date;var h=parseInt(H.innerHTML,10);if(t12){if(new RegExp(Calendar._TT["pm"],"i").test(AP.innerHTML)&&h<12){h+=12}else{if(new RegExp(Calendar._TT["am"],"i").test(AP.innerHTML)&&h==12){h=0}}}var d=date.getDate();var m=date.getMonth();var y=date.getFullYear();date.setHours(h);date.setMinutes(parseInt(M.innerHTML,10));date.setFullYear(y);date.setMonth(m);date.setDate(d);this.dateClicked=false;this.callHandler()}})()}else{this.onSetTime=this.onUpdateTime=function(){}}var tfoot=Calendar.createElement("tfoot",table);row=Calendar.createElement("tr",tfoot);row.className="footrow";cell=hh(Calendar._TT["SEL_DATE"],this.weekNumbers?8:7,300);cell.className="ttip";if(this.isPopup){cell.ttip=Calendar._TT["DRAG_TO_MOVE"];cell.style.cursor="move"}this.tooltips=cell;div=Calendar.createElement("div",this.element);this.monthsCombo=div;div.className="combo";for(i=0;i<Calendar._MN.length;++i){var mn=Calendar.createElement("div");mn.className=Calendar.is_ie?"label-IEfix":"label";mn.month=i;mn.innerHTML=Calendar._SMN[i];div.appendChild(mn)}div=Calendar.createElement("div",this.element);this.yearsCombo=div;div.className="combo";for(i=12;i>0;--i){var yr=Calendar.createElement("div");yr.className=Calendar.is_ie?"label-IEfix":"label";div.appendChild(yr)}this._init(this.firstDayOfWeek,this.date);parent.appendChild(this.element);Calendar.addEvent(this.element,"mousedown",function(ev){ev.preventDefault?ev.preventDefault():ev.returnValue=false})};Calendar._upkeyEvent=function(e){if(e.keyCode===27){window.setTimeout(function(){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}else{cal.callCloseHandler()}},0)}};Calendar._keyEvent=function(ev){var cal=window._dynarch_popupCalendar;if(!cal||cal.multiple){return false}var act=(Calendar.is_ie||ev.type=="keydown"),K=ev.keyCode;if(ev.ctrlKey){switch(K){case 37:act&&Calendar.cellClick(cal._nav_pm);break;case 38:act&&Calendar.cellClick(cal._nav_py);break;case 39:act&&Calendar.cellClick(cal._nav_nm);break;case 40:act&&Calendar.cellClick(cal._nav_ny);break}}else{switch(K){case 32:Calendar.cellClick(cal._nav_now);break;case 37:case 38:case 39:case 40:if(act){var prev,x,y,ne,el,step;prev=K==37||K==38;step=(K==37||K==39)?1:7;function setVars(){el=cal.currentDateEl;var p=el.pos;x=p&15;y=p>>4;ne=cal.ar_days[y][x]}setVars();function prevMonth(){var date=new Date(cal.date);date.setDate(date.getDate()-step);cal.setDate(date)}function nextMonth(){var date=new Date(cal.date);date.setDate(date.getDate()+step);cal.setDate(date)}while(1){switch(K){case 37:if(--x>=0){ne=cal.ar_days[y][x]}else{x=6;K=38;continue}break;case 38:if(--y>=0){ne=cal.ar_days[y][x]}else{prevMonth();setVars()}break;case 39:if(++x<7){ne=cal.ar_days[y][x]}else{x=0;K=40;continue}break;case 40:if(++y<cal.ar_days.length){ne=cal.ar_days[y][x]}else{nextMonth();setVars()}break}break}if(ne){if(!ne.disabled){Calendar.cellClick(ne)}else{if(prev){prevMonth()}else{nextMonth()}}}}break;case 13:if(act){Calendar.cellClick(cal.currentDateEl,ev)}break}}return Calendar.stopEvent(ev)};Calendar.prototype._init=function(firstDayOfWeek,seedDate){var date=new Date(seedDate);date.setHours(13);var today=new Date(),TY=today.getFullYear(),TM=today.getMonth(),TD=today.getDate();this.table.style.visibility="hidden";var year=date.getFullYear();if(year<this.minYear){year=this.minYear;date.setFullYear(year)}else{if(year>this.maxYear){year=this.maxYear;date.setFullYear(year)}}this.firstDayOfWeek=firstDayOfWeek;var month=date.getMonth();var mday=date.getDate();var no_days=date.getMonthDays();date.setDate(1);var day1=(date.getDay()-this.firstDayOfWeek)%7;if(day1<0){day1+=7}date.setDate(-day1);date.setDate(date.getDate()+1);var row=this.tbody.firstChild;var MN=Calendar._SMN[month];var ar_days=this.ar_days=new Array();var weekend=Calendar._TT["WEEKEND"];var dates=this.multiple?(this.datesCells={}):null;for(var i=0;i<6;++i,row=row.nextSibling){var cell=row.firstChild;if(this.weekNumbers){cell.className="day wn";var monthStartDate=date;if(month==0&&i==0&&Date.useISO8601WeekNumbers==false){monthStartDate=new Date(year,month,1)}cell.innerHTML=monthStartDate.getWeekNumber(this.firstDayOfWeek);cell=cell.nextSibling}row.className="daysrow";var hasdays=false,iday,dpos=ar_days[i]=[];for(var j=0;j<7;++j,cell=cell.nextSibling,date.setDate(iday+1)){iday=date.getDate();var wday=date.getDay();cell.className="day day-"+iday;cell.pos=i<<4|j;dpos[j]=cell;var current_month=(date.getMonth()==month);if(!current_month){if(this.showsOtherMonths){cell.className+=" othermonth";cell.otherMonth=true}else{cell.className="emptycell";cell.innerHTML="&nbsp;";cell.disabled=true;continue}}else{cell.otherMonth=false;hasdays=true}cell.disabled=false;cell.innerHTML=this.getDateText?this.getDateText(date,iday):iday;if(dates){dates[date.print("%Y%m%d")]=cell}if(this.getDateStatus){var status=this.getDateStatus(date,year,month,iday);if(this.getDateToolTip){var toolTip=this.getDateToolTip(date,year,month,iday);if(toolTip){cell.title=toolTip}}if(status===true){cell.className+=" disabled";cell.disabled=true}else{if(/disabled/i.test(status)){cell.disabled=true}cell.className+=" "+status}}if(!cell.disabled){cell.caldate=new Date(date);cell.ttip="_";if(!this.multiple&&current_month&&iday==mday&&this.hiliteToday){cell.className+=" selected";this.currentDateEl=cell}if(date.getFullYear()==TY&&date.getMonth()==TM&&iday==TD){cell.className+=" today";cell.ttip+=Calendar._TT["PART_TODAY"]}if(weekend.indexOf(wday.toString())!=-1){cell.className+=cell.otherMonth?" oweekend":" weekend"}}}if(!(hasdays||this.showsOtherMonths)){row.className="emptyrow"}}this.date=new Date(seedDate);this.onSetTime();this.title.innerHTML=Calendar._MN[month]+", "+year;this.table.style.visibility="visible";this._initMultipleDates()};Calendar.prototype._initMultipleDates=function(){if(this.multiple){for(var i in this.multiple){var cell=this.datesCells[i];var d=this.multiple[i];if(!d){continue}if(cell){cell.className+=" selected"}}}};Calendar.prototype._toggleMultipleDate=function(date){if(this.multiple){var ds=date.print("%Y%m%d");var cell=this.datesCells[ds];if(cell){var d=this.multiple[ds];if(!d){Calendar.addClass(cell,"selected");this.multiple[ds]=date}else{Calendar.removeClass(cell,"selected");delete this.multiple[ds]}}}};Calendar.prototype.setDateToolTipHandler=function(unaryFunction){this.getDateToolTip=unaryFunction};Calendar.prototype.setDate=function(date){if(!date.equalsTo(this.date)){this._init(this.firstDayOfWeek,date)}};Calendar.prototype.refresh=function(){this._init(this.firstDayOfWeek,this.date)};Calendar.prototype.setFirstDayOfWeek=function(firstDayOfWeek){this._init(firstDayOfWeek,this.date);this._displayWeekdays()};Calendar.prototype.setDateStatusHandler=Calendar.prototype.setDisabledHandler=function(unaryFunction){this.getDateStatus=unaryFunction};Calendar.prototype.setRange=function(a,z){this.minYear=a;this.maxYear=z};Calendar.prototype.callHandler=function(){if(this.onSelected){this.onSelected(this,this.date.print(this.dateFormat))}};Calendar.prototype.callCloseHandler=function(){if(this.onClose){this.onClose(this)}};Calendar.prototype.destroy=function(){var el=this.element.parentNode;el.removeChild(this.element);Calendar._C=null;window._dynarch_popupCalendar=null};Calendar.prototype.reparent=function(new_parent){var el=this.element;el.parentNode.removeChild(el);new_parent.appendChild(el)};Calendar._checkCalendar=function(ev){var calendar=window._dynarch_popupCalendar;if(!calendar){return false}var el=Calendar.is_ie?Calendar.getElement(ev):Calendar.getTargetElement(ev);for(;el!=null&&el!=calendar.element;el=el.parentNode){}if(el==null){window._dynarch_popupCalendar.callCloseHandler();return Calendar.stopEvent(ev)}};Calendar.prototype.show=function(){if(this.params.inputField.disabled){return }var rows=this.table.getElementsByTagName("tr");for(var i=rows.length;i>0;){var row=rows[--i];Calendar.removeClass(row,"rowhilite");var cells=row.getElementsByTagName("td");for(var j=cells.length;j>0;){var cell=cells[--j];Calendar.removeClass(cell,"hilite");Calendar.removeClass(cell,"active")}}Calendar.current=this;this.element.style.display="block";this.element.className+=" active";this.hidden=false;if(this.isPopup){window._dynarch_popupCalendar=this;Calendar.addEvent(document,"keyup",Calendar._upkeyEvent);Calendar.addEvent(document,"keydown",Calendar._keyEvent);Calendar.addEvent(document,"mousedown",Calendar._checkCalendar)}};Calendar.prototype.hide=function(){if(this.isPopup){Calendar.removeEvent(document,"keyup",Calendar._upkeyEvent);Calendar.removeEvent(document,"keydown",Calendar._keyEvent);Calendar.removeEvent(document,"mousedown",Calendar._checkCalendar)}Calendar.current=null;this.element.style.display="none";this.element.className=this.element.className.replace(/active/gi,"");this.hidden=true};Calendar.prototype.showAt=function(x,y){var s=this.element.style;s.left=x+"px";s.top=y+"px";this.show()};Calendar.prototype.showAtElement=function(el,opts){var self=this;var p=Calendar.getAbsolutePos(el);if(!opts||typeof opts!="string"){this.showAt(p.x,p.y+el.offsetHeight);return true}function fixPosition(box){if(box.x<0){box.x=0}if(box.y<0){box.y=0}var cp=document.createElement("div");var s=cp.style;s.position="absolute";s.right=s.bottom=s.width=s.height="0px";document.body.appendChild(cp);var br=Calendar.getAbsolutePos(cp);document.body.removeChild(cp);br.y+=jQuery(window).scrollTop();br.x+=jQuery(window).scrollLeft();var tmp=box.x+box.width-br.x;if(tmp>0){box.x-=tmp}tmp=box.y+box.height-br.y;if(tmp>0){box.y-=tmp}}this.element.style.display="block";Calendar.continuation_for_the_khtml_browser=function(){var w=jQuery(self.element).outerWidth();var h=jQuery(self.element).outerHeight();self.element.style.display="none";var valign=opts.substr(0,1);var halign="l";if(opts.length>1){halign=opts.substr(1,1)}switch(valign){case"T":p.y-=h;break;case"B":p.y+=jQuery(el).outerHeight();break;case"C":p.y+=(jQuery(el).outerHeight()-h)/2;break;case"t":p.y+=jQuery(el).outerHeight()-h;break;case"b":break}switch(halign){case"L":p.x-=w;break;case"R":p.x+=jQuery(el).outerWidth();break;case"C":p.x+=(jQuery(el).outerWidth()-w)/2;break;case"l":p.x+=jQuery(el).outerWidth()-w;break;case"r":break}p.width=w;p.height=h+40;self.monthsCombo.style.display="none";fixPosition(p);self.showAt(p.x,p.y)};Calendar.continuation_for_the_khtml_browser()};Calendar.prototype.setDateFormat=function(str){this.dateFormat=str};Calendar.prototype.setTtDateFormat=function(str){this.ttDateFormat=str};Calendar.prototype.parseDate=function(str,fmt){if(!fmt){fmt=this.dateFormat}this.setDate(Date.parseDate(str,fmt))};Calendar.prototype._displayWeekdays=function(){var fdow=this.firstDayOfWeek;var cell=this.firstdayname;var weekend=Calendar._TT["WEEKEND"];for(var i=0;i<7;++i){cell.className="day name";var realday=(i+fdow)%7;if(i){cell.ttip=Calendar._TT["DAY_FIRST"].replace("%s",Calendar._DN[realday]);cell.navtype=100;cell.calendar=this;cell.fdow=realday;Calendar._add_evs(cell)}if(weekend.indexOf(realday.toString())!=-1){Calendar.addClass(cell,"weekend")}cell.innerHTML=Calendar._SDN[(i+fdow)%7];cell=cell.nextSibling}};Calendar.prototype._hideCombos=function(){this.monthsCombo.style.display="none";this.yearsCombo.style.display="none"};Calendar.prototype._dragStart=function(ev){if(this.dragging){return }this.dragging=true;var posX;var posY;if(Calendar.is_ie){posY=window.event.clientY+document.body.scrollTop;posX=window.event.clientX+document.body.scrollLeft}else{posY=ev.clientY+window.scrollY;posX=ev.clientX+window.scrollX}var st=this.element.style;this.xOffs=posX-parseInt(st.left);this.yOffs=posY-parseInt(st.top);with(Calendar){addEvent(document,"mousemove",calDragIt);addEvent(document,"mouseup",calDragEnd)}};Date._MD=new Array(31,28,31,30,31,30,31,31,30,31,30,31);Date.SECOND=1000;Date.MINUTE=60*Date.SECOND;Date.HOUR=60*Date.MINUTE;Date.DAY=24*Date.HOUR;Date.WEEK=7*Date.DAY;Date._multisplit=function(s,seps){if(s==null){return null}if(seps==null){seps=""}var arr=[];var len=s.length;var token="";var inWord=false;for(i=0;i<len;i++){var c=s.charAt(i);if(seps.indexOf(c)==-1){inWord=true;token+=c}else{if(inWord){arr[arr.length]=token;token="";inWord=false}}}if(token.length>0){arr[arr.length]=token}if(arr.length==0){arr[arr.length]=""}return arr};Date._parseNonDateFormatChars=function(s){var magicChars="aAbBCdeHIJklmMnpPRSstUWVuwyY%";var nonMagicChars="";var len=s.length;var inMagic=false;for(i=0;i<len;i++){var c=s.charAt(i);if(c=="%"){var peekc="";if(i+1<len){peekc=s.charAt(i+1)}i=i+1;if(peekc.length>0&&magicChars.indexOf(peekc)!=-1){continue}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}if(peekc.length>0&&nonMagicChars.indexOf(peekc)==-1){nonMagicChars+=peekc}}}else{if(nonMagicChars.indexOf(c)==-1){nonMagicChars+=c}}}return nonMagicChars};Date.parseDate=function(str,fmt){var today=new Date();var y=0;var m=-1;var d=0;var seps=Date._parseNonDateFormatChars(fmt);var a=Date._multisplit(str,seps);var b=fmt.match(/%./g);var i=0,j=0;var hr=0;var min=0;for(i=0;i<a.length;++i){if(!a[i]){continue}switch(b[i]){case"%d":case"%e":d=parseInt(a[i],10);break;case"%m":m=parseInt(a[i],10)-1;break;case"%Y":case"%y":y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000);break;case"%b":case"%B":var monthName=a[i].toLowerCase();var found=false;if(b[i]=="%b"){for(j=0;j<12;++j){if(Calendar._SMN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;found=true;break}}}if(!found){for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,monthName.length).toLowerCase()==monthName){m=j;break}}}break;case"%H":case"%I":case"%k":case"%l":hr=parseInt(a[i],10);break;case"%P":case"%p":if(/pm/i.test(a[i])&&hr<12){hr+=12}else{if(/am/i.test(a[i])&&hr>=12){hr-=12}}break;case"%M":min=parseInt(a[i],10);break;case"%R":var hrMinString=a[i];var hrMinSeparator=hrMinString.indexOf(":");var hrString=hrMinString.substring(0,hrMinSeparator);var minString=hrMinSeparator==-1?0:hrMinString.substring(hrMinSeparator+1);hr=parseInt(hrString,10);min=parseInt(minString,10);break}}if(isNaN(y)){y=today.getFullYear()}if(isNaN(m)){m=today.getMonth()}if(isNaN(d)){d=today.getDate()}if(isNaN(hr)){hr=today.getHours()}if(isNaN(min)){min=today.getMinutes()}if(y!=0&&m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}y=0;m=-1;d=0;for(i=0;i<a.length;++i){if(a[i].search(/[a-zA-Z]+/)!=-1){var t=-1;for(j=0;j<12;++j){if(Calendar._MN[j].substr(0,a[i].length).toLowerCase()==a[i].toLowerCase()){t=j;break}}if(t!=-1){if(m!=-1){d=m+1}m=t}}else{if(parseInt(a[i],10)<=12&&m==-1){m=a[i]-1}else{if(parseInt(a[i],10)>31&&y==0){y=parseInt(a[i],10);(y<100)&&(y+=(y>29)?1900:2000)}else{if(d==0){d=a[i]}}}}}if(y==0){y=today.getFullYear()}if(m!=-1&&d!=0){return new Date(y,m,d,hr,min,0)}return today};Date.prototype.getMonthDays=function(month){var year=this.getFullYear();if(typeof month=="undefined"){month=this.getMonth()}if(((0==(year%4))&&((0!=(year%100))||(0==(year%400))))&&month==1){return 29}else{return Date._MD[month]}};Date.prototype.getDayOfYear=function(){var now=new Date(this.getFullYear(),this.getMonth(),this.getDate(),13,0,0);var then=new Date(this.getFullYear(),0,0,13,0,0);var time=now-then;return Math.floor(time/Date.DAY)};Date.prototype.getWeekNumber=function(startOfWeek){if(Date.useISO8601WeekNumbers){return this.getISO8601WeekNumber()}else{return this.getSimpleWeekNumber(startOfWeek)}};Date.prototype.getISO8601WeekNumber=function(){function gregdaynumber(year,month,day){y=year;m=month;if(month<3){y=y-1}if(month<3){m=m+12}return Math.floor(365.25*y)-Math.floor(y/100)+Math.floor(y/400)+Math.floor(30.6*(m+1))+day-62}function isocalendar1(date){year=date.getFullYear();month=date.getMonth();day=date.getDate();wday=date.getDay();weekday=((wday+6)%7)+1;isoyear=year;d0=gregdaynumber(year,1,0);weekday0=((d0+4)%7)+1;d=gregdaynumber(year,month+1,day);isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);if((month==11)&&((day-weekday)>27)){isoweeknr=1;isoyear=isoyear+1}if((month==0)&&((weekday-day)>3)){d0=gregdaynumber(year-1,1,0);weekday0=((d0+4)%7)+1;isoweeknr=Math.floor((d-d0+weekday0+6)/7)-Math.floor((weekday0+3)/7);isoyear=isoyear-1}return isoweeknr}return isocalendar1(this)};Date.prototype.getSimpleWeekNumber=function(startOfWeek){function OddWkNo1(D,d1,d2){var Yr=D.getFullYear(),Jan1=new Date(Yr,0,1),Q;Q=Math.round((D-Jan1)/86400000);if(d1!=null){Q-=(7+d1-Jan1.getDay())%7}if(d2!=null){Q+=d2}return[Yr,1+Q/7|0,1+(7+Q)%7]}return OddWkNo1(this,startOfWeek?startOfWeek:6,6)[1]};Date.prototype.equalsTo=function(date){return((this.getFullYear()==date.getFullYear())&&(this.getMonth()==date.getMonth())&&(this.getDate()==date.getDate())&&(this.getHours()==date.getHours())&&(this.getMinutes()==date.getMinutes()))};Date.prototype.setDateOnly=function(date){var tmp=new Date(date);this.setDate(1);this.setFullYear(tmp.getFullYear());this.setMonth(tmp.getMonth());this.setDate(tmp.getDate())};Date.prototype.print=function(str){var m=this.getMonth();var d=this.getDate();var y=this.getFullYear();var wn=this.getWeekNumber();var w=this.getDay();var s={};var hr=this.getHours();var pm=(hr>=12);var ir=(pm)?(hr-12):hr;var dy=this.getDayOfYear();if(ir==0){ir=12}var min=this.getMinutes();var sec=this.getSeconds();s["%a"]=Calendar._SDN[w];s["%A"]=Calendar._DN[w];s["%b"]=Calendar._SMN[m];s["%B"]=Calendar._MN[m];s["%C"]=1+Math.floor(y/100);s["%d"]=(d<10)?("0"+d):d;s["%e"]=d;s["%H"]=(hr<10)?("0"+hr):hr;s["%I"]=(ir<10)?("0"+ir):ir;s["%j"]=(dy<100)?((dy<10)?("00"+dy):("0"+dy)):dy;s["%k"]=hr;s["%l"]=ir;s["%m"]=(m<9)?("0"+(1+m)):(1+m);s["%M"]=(min<10)?("0"+min):min;s["%n"]="\n";s["%p"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%P"]=pm?Calendar._TT["PM"]:Calendar._TT["AM"];s["%R"]=s["%k"]+":"+s["%M"];s["%s"]=Math.floor(this.getTime()/1000);s["%S"]=(sec<10)?("0"+sec):sec;s["%t"]="\t";s["%U"]=s["%W"]=s["%V"]=(wn<10)?("0"+wn):wn;s["%u"]=w+1;s["%w"]=w;s["%y"]=(""+y).slice(-2);s["%Y"]=y;s["%%"]="%";var re=/%./g;if(!Calendar.is_ie5&&!Calendar.is_khtml){return str.replace(re,function(par){return s[par]||par})}var a=str.match(re);for(var i=0;i<a.length;i++){var tmp=s[a[i]];if(tmp){re=new RegExp(a[i],"g");str=str.replace(re,tmp)}}return str};Date.prototype.__msh_oldSetFullYear=Date.prototype.setFullYear;Date.prototype.setFullYear=function(y){var d=new Date(this);d.__msh_oldSetFullYear(y);if(d.getMonth()!=this.getMonth()){this.setDate(28)}this.__msh_oldSetFullYear(y)};window._dynarch_popupCalendar=null;;
;/* module-key = 'jira.webresources:calendar', location = '/includes/lib/calendar/Calendar.setup.js' */
Calendar.setup=function(params){params=params||{};function param_default(pname,def){if(typeof params[pname]=="undefined"){params[pname]=def}}param_default("inputField",null);param_default("context",null);param_default("displayArea",null);param_default("button",null);param_default("eventName","click");param_default("ifFormat","%Y/%m/%d");param_default("daFormat","%Y/%m/%d");param_default("singleClick",true);param_default("disableFunc",null);param_default("dateStatusFunc",params["disableFunc"]);param_default("dateText",null);param_default("firstDay",null);param_default("align","Br");param_default("range",[1900,2999]);param_default("weekNumbers",true);param_default("useISO8601WeekNumbers",false);param_default("flat",null);param_default("flatCallback",null);param_default("onSelect",null);param_default("onClose",null);param_default("onUpdate",null);param_default("date",null);param_default("showsTime",false);param_default("timeFormat","24");param_default("electric",true);param_default("step",1);param_default("position",null);param_default("cache",false);param_default("showOthers",false);param_default("multiple",null);var i,item;var unwrap=["context","inputField","button","displayArea"];for(i in unwrap){item=unwrap[i];if(params[item] instanceof jQuery){params[item]=params[item][0]}}var tmp=["inputField","displayArea","button"];for(i in tmp){item=tmp[i];if(typeof params[item]==="string"){var escapedSelector="#"+params[item].escapejQuerySelector();var el=jQuery(params.context||document.body).find(escapedSelector);params[item]=el[0]}}if(!(params.flat||params.multiple||params.inputField||params.displayArea||params.button)){AJS.log("Calendar.setup:\n  Nothing to setup (no fields found).  Please check your code");return false}if(params.firstDay&&params.firstDay!==null){params.firstDay=+params.firstDay}function onSelect(cal){var p=cal.params;var update=(cal.dateClicked||p.electric);if(update&&p.inputField){p.inputField.value=cal.date.print(p.ifFormat);jQuery(p.inputField).change()}if(update&&p.displayArea){p.displayArea.innerHTML=cal.date.print(p.daFormat)}if(update&&typeof p.onUpdate=="function"){p.onUpdate(cal)}if(update&&p.flat){if(typeof p.flatCallback=="function"){p.flatCallback(cal)}}if(p.singleClick==="true"){p.singleClick=true}else{if(p.singleClick==="false"){p.singleClick=false}}if(update&&p.singleClick&&cal.dateClicked){cal.callCloseHandler()}}if(params.flat!=null){if(typeof params.flat=="string"){params.flat=document.getElementById(params.flat)}if(!params.flat){AJS.log("Calendar.setup:\n  Flat specified but can't find parent.");return false}var cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect);cal.showsOtherMonths=params.showOthers;cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.params=params;cal.weekNumbers=params.weekNumbers;cal.setRange(params.range[0],params.range[1]);cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;if(params.ifFormat){cal.setDateFormat(params.ifFormat)}if(params.inputField&&typeof params.inputField.value=="string"){cal.parseDate(params.inputField.value)}cal.create(params.flat);cal.show();return false}var triggerEl=params.button||params.displayArea||params.inputField;jQuery(triggerEl).bind(params.eventName,function(e){e.preventDefault();createCalendar()});if(params.inputField){enhanceInputField()}function createCalendar(){if(Calendar._UNSUPPORTED===true){alert("The JIRA Calendar does not currently support your language.");return }var dateEl=params.inputField||params.displayArea;var dateFmt=params.inputField?params.ifFormat:params.daFormat;var mustCreate=false;var cal=window.calendar;if(cal){cal.hide()}if(dateEl){if(dateEl.value||dateEl.innerHTML){params.date=Date.parseDate(dateEl.value||dateEl.innerHTML,dateFmt)}}if(!(cal&&params.cache)){window.calendar=cal=new Calendar(params.firstDay,params.date,params.onSelect||onSelect,params.onClose||function(cal){cal.hide()});cal.showsTime=params.showsTime;cal.time24=(params.timeFormat=="24");cal.weekNumbers=params.weekNumbers;Date.useISO8601WeekNumbers=params.useISO8601WeekNumbers;if(params.useISO8601WeekNumbers){cal.firstDayOfWeek=1}mustCreate=true}else{if(params.date){cal.setDate(params.date)}cal.hide()}if(params.multiple){cal.multiple={};for(var i=params.multiple.length;--i>=0;){var d=params.multiple[i];var ds=d.print("%Y%m%d");cal.multiple[ds]=d}}cal.showsOtherMonths=params.showOthers;cal.yearStep=params.step;cal.setRange(params.range[0],params.range[1]);cal.params=params;cal.setDateStatusHandler(params.dateStatusFunc);cal.getDateText=params.dateText;cal.setDateFormat(dateFmt);if(mustCreate){cal.create()}cal.refresh();if(!params.position){cal.showAtElement(params.button||params.displayArea||params.inputField,params.align)}else{cal.showAt(params.position[0],params.position[1])}return false}function enhanceInputField(){var $inputField=jQuery(params.inputField);if(params.button){jQuery(params.button).mousedown(function(e){e.preventDefault();if(!$inputField.is(":focus")&&$inputField.is(":enabled")){$inputField.focus()}})}$inputField.keydown(function(e){var cal=window.calendar;if(e.keyCode===40){if(!cal||cal.hidden){setTimeout(function(){createCalendar()},1)}}})}return cal};;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/groupPickerUtil.js' */
JIRA.GroupPickerUtil={formatResponse:function(data){var ret=[];AJS.$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.header});AJS.$(suggestions.groups).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.name,html:this.html,highlighted:true}))});ret.push(groupDescriptor)});return ret}};;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initMultiGroupPickers.js' */
(function(){function initMultiGroupPickers(ctx){ctx.find(".js-default-multi-group-picker").each(function(){var $el=jQuery(this);new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:contextPath+"/rest/api/2/groups/picker",query:true,formatResponse:JIRA.GroupPickerUtil.formatResponse}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiGroupPickers(context)}})})();;
;/* module-key = 'jira.webresources:group-pickers', location = '/includes/jira/field/initSingleGroupPickers.js' */
(function(){var SingleSelect=require("jira/ajs/select/single-select");function initSingleGroupPickers(ctx){ctx.find(".js-default-single-group-picker").each(function(){var $el=jQuery(this);var $emptyValue=$el.find("option[data-empty]");new SingleSelect({element:this,itemAttrDisplayed:"label",revertOnInvalid:true,ajaxOptions:{data:function(query){return{query:query,exclude:$el.val()}},url:contextPath+"/rest/api/2/groups/picker",query:true,formatResponse:function(data){var formattedData=JIRA.GroupPickerUtil.formatResponse(data);if($emptyValue.length&&$el.val()!==""){formattedData.unshift(new AJS.ItemDescriptor({value:"",label:$emptyValue.text(),highlighted:true}))}return formattedData}}})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initSingleGroupPickers(context)}})})();;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/userPickerUtil.js' */
(function($){JIRA.UserPickerUtil={formatResponse:function(data){var ret=[];$(data).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}}})(AJS.$);;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initSingleUserPickers.js' */
(function($){function createSingleUserPickers(ctx){var restPath="/rest/api/1.0/users/picker";$(".js-default-user-picker",ctx).each(function(){var $this=$(this);if($this.data("aui-ss")){return }var data={showAvatar:true},inputText=$this.data("inputValue");new AJS.SingleSelect({element:$this,submitInputVal:true,showDropdownButton:!!$this.data("show-dropdown-button"),errorMessage:AJS.format("There is no user \'\'{0}\'\'.","'{0}'"),ajaxOptions:{url:contextPath+restPath,query:true,data:data,formatResponse:JIRA.UserPickerUtil.formatResponse},inputText:inputText})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createSingleUserPickers(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/NoBrowseUserNamePicker.js' */
AJS.NoBrowseUserNamePicker=AJS.MultiSelect.extend({_getDefaultOptions:function(){return AJS.$.extend(true,this._super(),{errorMessage:"The requested user does not exist.",showDropdownButton:false,removeOnUnSelect:true,itemAttrDisplayed:"label"})},_handleCharacterInput:function(){},_setSuggestions:function(){},_handleServerError:function(smartAjaxResult){if(smartAjaxResult.status===404){this.showErrorMessage()}else{this._super()}},_deactivate:function(){this.validateAndAdd()},validateAndAdd:function(){var instance=this;if(AJS.$.trim(this.$field.val())===""){this.hideErrorMessage()}else{jQuery.ajax({url:contextPath+"/rest/api/2/user",data:{username:AJS.$.trim(instance.getQueryVal())},success:function(user){instance.hideErrorMessage();instance.$field.val("");instance.addItem(new AJS.ItemDescriptor({label:user.displayName,value:user.name}))},error:function(){instance.showErrorMessage()}})}},_handleSpace:function(){this.validate()},_handleServerSuggestions:function(){this.hideErrorMessage();this.handleFreeInput()},handleFreeInput:function(){var value=AJS.$.trim(this.$field.val());if(value!==""){this.addItem({value:value,label:value});this.model.$element.trigger("change")}this.$field.val("")},keys:{"Return":function(event){event.preventDefault();this.validateAndAdd()},"Spacebar":function(event){event.preventDefault();this.validateAndAdd()}}});;
;/* module-key = 'jira.webresources:user-pickers', location = '/includes/jira/field/initMultiUserPickers.js' */
(function(){function initMultiUserPicker(ctx){ctx.find(".js-default-multi-user-picker").each(function(){var $el=jQuery(this);if(AJS.params.currentUserCanBrowseUsers){new AJS.MultiSelect({element:this,itemAttrDisplayed:"label",showDropdownButton:false,removeOnUnSelect:true,submitInputVal:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker",query:true,data:function(query){return{showAvatar:true,query:query,exclude:$el.val()}},formatResponse:JIRA.UserPickerUtil.formatResponse}})}else{new AJS.NoBrowseUserNamePicker({element:this})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initMultiUserPicker(context)}})})();;
;/* module-key = 'jira.webresources:ie-imitation-placeholder', location = '/includes/jira/field/IEImitationPlaceholder.js' */
(function($){$.fn.ieImitationPlaceholder=function(){if($.browser.msie){var form=this,fields=form.find("[placeholder]");fields.focus(clearTextIfUnchanged);fields.blur(setTextFromPlaceholder);form.submit(clearAllIfUnchanged);fields.each(setTextFromPlaceholder);function setTextFromPlaceholder(){var field=$(this);if(field.val()===""){field.val(field.attr("placeholder"));field.addClass("input-placeholder")}}function clearTextIfUnchanged(){var field=$(this);if(field.val()===field.attr("placeholder")){field.val("");field.removeClass("input-placeholder")}}function clearAllIfUnchanged(){fields.each(clearTextIfUnchanged)}}}})(AJS.$);;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/ProjectIssueTypeSelect.js' */
JIRA.ProjectIssueTypeSelect=Class.extend({init:function(options){var val,instance=this;this.$project=options.project;this.issueTypeSelect=options.issueTypeSelect;this.$projectIssueTypesSchemes=options.projectIssueTypesSchemes;this.$issueTypeSchemeIssueDefaults=options.issueTypeSchemeIssueDefaults;this.projectIssueTypeSchemes=JSON.parse(this.$projectIssueTypesSchemes.html());this.issueTypesSchemeDefaults=JSON.parse(this.$issueTypeSchemeIssueDefaults.html()||"[]");if(instance.$project.length>0){val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val));this.$project.change(function(){var val=instance.$project.val();instance.setIssueTypeScheme(instance.getIssueTypeSchemeForProject(val))})}},getIssueTypeSchemeForProject:function(projectId){return this.projectIssueTypeSchemes[projectId]},getDefaultIssueTypeForScheme:function(issueTypeSchemeId){return this.issueTypesSchemeDefaults[issueTypeSchemeId]},setIssueTypeScheme:function(issueTypeSchemeId){var selectedIssueType=this.issueTypeSelect.model.getValue();this.issueTypeSelect.model.setFilterGroup(issueTypeSchemeId);if(!this.issueTypeSelect.model.setSelected(selectedIssueType,false)){this.setDefaultIssueType(issueTypeSchemeId)}this.issueTypeSelect.model.$element.data("project",this.$project.val())},setDefaultIssueType:function(issueTypeSchemeId){var defaultIssueType=this.getDefaultIssueTypeForScheme(issueTypeSchemeId),descriptor=this.issueTypeSelect.model.getDescriptor(defaultIssueType);if(!descriptor){descriptor=this.issueTypeSelect.model.getAllDescriptors()[0]}this.issueTypeSelect.setSelection(descriptor,false)}});;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initProjectIssueTypeSelect.js' */
(function(){var SuggestionCollectionModel=require("jira/ajs/select/suggestion-collection-model");function findProjectAndIssueTypeSelectAndConvertToPicker(ctx){var $ctx=ctx||jQuery("body");$ctx.find(".issuetype-field").each(function(index){var $project=$ctx.find(".project-field, .project-field-readonly"),$issueTypeSelect=jQuery(this),$projectIssueTypes=$ctx.find("#"+$issueTypeSelect.attr("id")+"-projects"),$defaultProjectIssueTypes=$ctx.find("#"+$issueTypeSelect.attr("id")+"-defaults"),issueTypeSelect=new AJS.SingleSelect({element:$issueTypeSelect,revertOnInvalid:true,model:SuggestionCollectionModel});issueTypeSelect.model.remove("");if($project.length>0){new JIRA.ProjectIssueTypeSelect({project:$project.eq(index),issueTypeSelect:issueTypeSelect,projectIssueTypesSchemes:$projectIssueTypes,issueTypeSchemeIssueDefaults:$defaultProjectIssueTypes})}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findProjectAndIssueTypeSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initIssueTypePickers.js' */
(function(){function createissueTypePicker(context){context.find(".issuetype-field").each(function(){var $select=jQuery(this);$select.bind("reset",function(){$select.find("option[value='']").remove()}).trigger("reset");new AJS.SingleSelect({element:this,revertOnInvalid:true})})}})();;
;/* module-key = 'jira.webresources:jira-project-issuetype-fields', location = '/includes/jira/field/initProjectPickers.js' */
(function(){var ScrollableSingleSelect=require("jira/ajs/select/scrollable-single-select");var SuggestionCollectionModel=require("jira/ajs/select/suggestion-collection-model");function createProjectPicker(context){context.find(".project-field").each(function(){new ScrollableSingleSelect({element:this,revertOnInvalid:true,pageSize:50,pagingThreshold:100,model:SuggestionCollectionModel})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createProjectPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/field-templates.soy' */
// This file was automatically generated from field-templates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Fields == 'undefined') { JIRA.Templates.Fields = {}; }


JIRA.Templates.Fields.username = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.escape) ? soy.$$escapeHtml(opt_data.displayName) : opt_data.displayName);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientUsername = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-username="', soy.$$escapeHtml(opt_data.username), '" title=', soy.$$escapeHtml(opt_data.username), '><span><span class="user-hover" rel="', soy.$$escapeHtml(opt_data.username), '"><img src="', soy.$$escapeHtml(opt_data.icon), '" title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('"><span title="');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('">');
  JIRA.Templates.Fields.username(opt_data, output);
  output.append('</span></span>', (! opt_data.readOnly) ? '<span class="remove-recipient item-delete"/>' : '', '</span></li>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Fields.recipientEmail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li data-email="', soy.$$escapeHtml(opt_data.email), '" title=', soy.$$escapeHtml(opt_data.email), '><span><img src="', soy.$$escapeHtml(opt_data.icon), '" title="', soy.$$escapeHtml(opt_data.email), '"><span title="', soy.$$escapeHtml(opt_data.email), '">', soy.$$escapeHtml(opt_data.email), '</span><span class="remove-recipient item-delete"/></span></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/IssuePicker.js' */
define("jira/field/issue-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){var IssuePicker=MultiSelect.extend({_formatResponse:function(response){var ret=[],canonicalBaseUrl=(function(){var uri=parseUri(window.location);return uri.protocol+"://"+uri.authority})();if(response&&response.sections){jQuery(response.sections).each(function(i,section){var groupDescriptor=new GroupDescriptor({weight:i,label:section.label,description:section.sub});if(section.issues&&section.issues.length>0){jQuery(section.issues).each(function(){groupDescriptor.addItem(new ItemDescriptor({highlighted:true,value:this.key,label:this.key+" - "+this.summaryText,icon:this.img?canonicalBaseUrl+contextPath+this.img:null,html:this.keyHtml+" - "+this.summary}))})}ret.push(groupDescriptor)})}return ret},_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{formatResponse:this._formatResponse}})},_launchPopup:function(){function getWithDefault(value,def){if(typeof value=="undefined"||value==null){return def}else{return value}}var url,urlParam,vWinUsers,options,instance=this;IssuePicker.callback=function(items){if(typeof items==="string"){items=JSON.parse(items)}instance._addMultipleItems(items,true);instance.$field.focus()};options=this.options.ajaxOptions.data;url=contextPath+"/secure/popups/IssuePicker.jspa?";urlParam={singleSelectOnly:"false",decorator:"popup",currentIssue:options.currentIssueKey||"",showSubTasks:getWithDefault(options.showSubTasks,false),showSubTasksParent:getWithDefault(options.showSubTaskParent,false)};if(options.currentProjectId){urlParam["currentProjectId"]=options.currentProjectId}url+=jQuery.param(urlParam);vWinUsers=window.open(url,"IssueSelectorPopup","status=no,resizable=yes,top=100,left=200,width="+this.options.popupWidth+",height="+this.options.popupHeight+",scrollbars=yes,resizable");vWinUsers.opener=self;vWinUsers.focus()},_createFurniture:function(disabled){var $popupLink;this._super(disabled);$popupLink=this._render("popupLink");this._assignEvents("popupLink",$popupLink);this.$container.addClass("jira-issue-picker");this.$container.addClass("hasIcon");this.$container.after($popupLink)},handleFreeInput:function(){var values=this.$field.val().toUpperCase().match(/\S+/g);if(values){this._addMultipleItems(jQuery.map(values,function(value){return{value:value,label:value}}))}this.$field.val("")},_events:{popupLink:{click:function(e){this._launchPopup();e.preventDefault()}}},_renders:{popupLink:function(){return jQuery("<a class='issue-picker-popup' />").attr({href:"#",title:this.options.popupLinkMessage}).text(""+this.options.popupLinkMessage+"")}}});IssuePicker.callback=null;return IssuePicker});AJS.namespace("jira.issuepicker",null,require("jira/field/issue-picker"));AJS.namespace("AJS.IssuePicker",null,require("jira/field/issue-picker"));AJS.namespace("JIRA.IssuePicker",null,require("jira/field/issue-picker"));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/LabelPicker.js' */
define("jira/field/label-picker",["jira/ajs/select/multi-select","jira/ajs/list/group-descriptor","jira/ajs/list/item-descriptor","jquery"],function(MultiSelect,GroupDescriptor,ItemDescriptor,jQuery){return MultiSelect.extend({_getDefaultOptions:function(){return jQuery.extend(true,this._super(),{ajaxOptions:{url:contextPath+"/includes/js/ajs/layer/labeldata.js",query:true,formatResponse:this._formatResponse},removeDuplicates:true,removeOnUnSelect:true,userEnteredOptionsMsg:"New Label"})},isValidItem:function(itemValue){return !/\s/.test(itemValue)},_handleServerSuggestions:function(data){if(data&&data.token){if(jQuery.trim(this.$field.val())!==data.token){return }}this._super(data)},_handleSpace:function(){if(jQuery.trim(this.$field.val())!==""){if(this.handleFreeInput()){this.hideSuggestions()}}},keys:{"Spacebar":function(event){this._handleSpace();event.preventDefault()}},_formatResponse:function(data){var optgroup=new GroupDescriptor({label:"Suggestions",type:"optgroup",styleClass:"labels-suggested"});if(data&&data.suggestions){jQuery.each(data.suggestions,function(){optgroup.addItem(new ItemDescriptor({value:this.label,label:this.label,html:this.html,highlighted:true}))})}return[optgroup]},handleFreeInput:function(){var values=jQuery.trim(this.$field.val()).match(/\S+/g);if(values){for(var value,i=0;value=values[i];i++){this.addItem({value:value,label:value})}this.model.$element.trigger("change")}this.$field.val("")}})});AJS.namespace("AJS.LabelPicker",null,require("jira/field/label-picker"));AJS.namespace("JIRA.LabelPicker",null,require("jira/field/label-picker"));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.js' */
(function($){JIRA.MultiUserListPicker=AJS.MultiSelect.extend({init:function(options){var restPath="/rest/api/1.0/users/picker";function formatResponse(response){var ret=[];$(response).each(function(i,suggestions){var groupDescriptor=new AJS.GroupDescriptor({weight:i,label:suggestions.footer});$(suggestions.users).each(function(){groupDescriptor.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});ret.push(groupDescriptor)});return ret}$.extend(options,{itemAttrDisplayed:"label",userEnteredOptionsMsg:"Email address",showDropdownButton:false,removeOnUnSelect:true,ajaxOptions:{url:contextPath+restPath,query:true,data:{showAvatar:true},formatResponse:formatResponse},suggestionsHandler:AJS.UserListSuggestHandler,itemGroup:new AJS.Group(),itemBuilder:function(descriptor){return new JIRA.MultiUserListPicker.Item({descriptor:descriptor,container:this.$selectedItemsContainer})}});this._super(options)},_createFurniture:function(disabled){this._super(disabled);if(this.options.description){this._render("description",this.options.description).insertAfter(this.$field)}},updateItemsIndent:$.noop,_renders:{selectedItemsWrapper:function(){return $('<div class="recipients"></div>')},selectedItemsContainer:function(){return $("<ol />")},description:function(description){return $("<div />").addClass("description").text(description)}}})}(AJS.$));;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/MultiUserListPicker.Item.js' */
JIRA.MultiUserListPicker.Item=AJS.Control.extend({init:function(options){this._setOptions(options);this.$lozenge=this._render("item");this.$removeButton=this.$lozenge.find(".remove-recipient");this._assignEvents("instance",this);this._assignEvents("lozenge",this.$lozenge);this._assignEvents("removeButton",this.$removeButton);this.$lozenge.prependTo(this.options.container)},_getDefaultOptions:function(){return{label:null,title:null,container:null,focusClass:"focused"}},_renders:{"item":function(){var descriptor=this.options.descriptor;var data;if(descriptor.noExactMatch()!==true){data={escape:false,username:descriptor.value(),icon:descriptor.icon(),displayName:AJS.escapeHtml(descriptor.label())};return AJS.$(JIRA.Templates.Fields.recipientUsername(data))}else{data={email:descriptor.value(),icon:AJS.Meta.get("default-avatar-url")};return AJS.$(JIRA.Templates.Fields.recipientEmail(data))}}},_events:{"instance":{"remove":function(){this.$lozenge.remove()}},"removeButton":{"click":function(e){e.stopPropagation();this.trigger("remove")}}}});;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCascadingSelects.js' */
(function(){function initCascadingSelect(el){AJS.$(el||document.body).find("div.aui-field-cascadingselect").add("tr.aui-field-cascadingselect").add("td.aui-field-cascadingselect").each(function(){var $container=AJS.$(this),parent=$container.find(".cascadingselect-parent"),parentOptions=parent.find("option"),oldClass="",child=$container.find(".cascadingselect-child"),childOptions=child.find("option"),selectedChild=child.find(":selected");function update(){var placeholder,currentClass=parent.find("option:selected").attr("class");if(currentClass!==oldClass){placeholder=jQuery("<span />").insertAfter(child);child.detach();child.find("option").each(function(i,elem){elem.parentNode.removeChild(this)});child.insertAfter(placeholder);placeholder.remove();childOptions.filter("."+parent.find("option:selected").attr("class")).appendTo(child);if(selectedChild.hasClass(parent.find("option:selected").attr("class"))){child.val(selectedChild.val())}else{child.val(child.find("option:first").val())}oldClass=currentClass}}parent.bind("cascadingSelectChanged",update).change(function(){AJS.$(this).trigger("cascadingSelectChanged")}).trigger("cascadingSelectChanged")})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initCascadingSelect(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initComponentPickers.js' */
(function(){JIRA.ComponentPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Component"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingDescriptor=_.find(allExistingDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingDescriptor){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Component.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.ComponentPicker({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid component.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-componentspicker.frother-control-renderer","td.aui-field-componentspicker.frother-control-renderer","tr.aui-field-componentspicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initMultiselectPickers.js' */
(function(){function createPicker($selectField){new AJS.MultiSelect({element:$selectField,itemAttrDisplayed:"label",errorMessage:"{0} is not a valid value.",maxInlineResultsDisplayed:15,submitInputVal:true,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}var DEFAULT_SELECTORS=["div.aui-field-multiselectpicker.frother-control-renderer"];function findComponentSelectAndConvertToPicker(context,selector){selector=selector||DEFAULT_SELECTORS.join(", ");AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findComponentSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initDatePickers.js' */
(function(){function initDatePicker(el){AJS.$(el||document.body).find("div.aui-field-datepicker").add("tr.aui-field-datepicker").add("td.aui-field-datepicker").each(function(){var $container=AJS.$(this),field=$container.find("input:text"),defaultCheckbox=$container.find("#useCurrentDate"),params=JIRA.parseOptionsFromFieldset($container.find("fieldset.datepicker-params"));params.context=el;Calendar.setup(params);function toggleField(){field.prop("disabled",defaultCheckbox.is(":checked"))}if(defaultCheckbox.length){toggleField();defaultCheckbox.click(toggleField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initDatePicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLegacyGroupPickers.js' */
(function(){function initLegacyGroupPicker(el){AJS.$(el||document.body).find("div.aui-field-grouppicker").add("tr.aui-field-grouppicker").add("td.aui-field-grouppicker").each(function(){var $container=AJS.$(this),trigger=$container.find("a.grouppicker-trigger"),url=trigger.attr("href");function openGroupPickerWindow(e){e.preventDefault();window.open(url,"GroupPicker","status=yes,resizable=yes,top=100,left=100,width=800,height=750,scrollbars=yes")}trigger.click(openGroupPickerWindow)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){initLegacyGroupPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initIssuePickers.js' */
(function(){var IssuePicker=require("jira/field/issue-picker");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");function initIssuePicker(el){$(el||document.body).find(".aui-field-issuepicker").each(function(){new IssuePicker({element:$(this),userEnteredOptionsMsg:"Enter issue key",uppercaseUserEnteredOnSelect:true})})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){initIssuePicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLabelPickers.js' */
define("jira/field/label-picker-factory",["jira/field/label-picker","jira/data/parse-options-from-fieldset","jquery","exports"],function(LabelPicker,parseOptionsFromFieldset,$,exports){exports.createPicker=function($fieldset,context){var opts=parseOptionsFromFieldset($fieldset),$select=$("#"+opts.id,context),issueId=opts.issueId,data={};if(/customfield_\d/.test(opts.id)){data.customFieldId=parseInt(opts.id.replace("customfield_",""),10)}new LabelPicker({element:$select,ajaxOptions:{url:contextPath+"/rest/api/1.0/labels"+(issueId?"/"+issueId:"")+"/suggest",data:data}})}});(function(){var LabelPickerFactory=require("jira/field/label-picker-factory");var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");var $=require("jquery");var FIELDSET_SELECTOR="fieldset.labelpicker-params";function locateFieldset(parent){var $parent=$(parent),$fieldset;if($parent.is(FIELDSET_SELECTOR)){$fieldset=$parent}else{$fieldset=$parent.find(FIELDSET_SELECTOR)}return $fieldset}function findLabelsFieldsetAndConvertToPicker(context,selector){selector=selector||".aui-field-labelpicker";$(selector,context).each(function(){var $fieldset=locateFieldset(this);if($fieldset.length>0){LabelPickerFactory.createPicker($fieldset,context)}})}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){findLabelsFieldsetAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initVersionPickers.js' */
(function(){JIRA.VersionPicker=AJS.MultiSelect.extend({init:function(options){this._super(options);this.suggestionsHandler=new AJS.OnlyNewItemsSuggestHandler(this.options,this.model)},_getDefaultOptions:function(opts){var canCreate=false;if(opts&&opts.element){canCreate=AJS.$(opts.element).data("create-permission")}if(canCreate){return AJS.$.extend(true,this._super(),{userEnteredOptionsMsg:"New Version"})}else{return this._super(opts)}},_selectionHandler:function(selected,e){var allExistingVersionDescriptors=this.model.getDisplayableSelectedDescriptors().concat(this.model.getDisplayableUnSelectedDescriptors());var selectedDescriptor=selected.data("descriptor");var existingVersion=_.find(allExistingVersionDescriptors,function(descriptor){return descriptor.label()===selectedDescriptor.label()});if(!existingVersion){selectedDescriptor.properties.value="nv_"+selectedDescriptor.value();JIRA.trigger("Issue.Version.new.selected",[selectedDescriptor.value()])}this._super(selected,e)}});function createPicker($selectField){new JIRA.VersionPicker({element:$selectField,itemAttrDisplayed:"label",removeOnUnSelect:false,submitInputVal:true,errorMessage:"{0} is not a valid version.",maxInlineResultsDisplayed:15,expandAllResults:true})}function locateSelect(parent){var $parent=AJS.$(parent),$selectField;if($parent.is("select")){$selectField=$parent}else{$selectField=$parent.find("select")}return $selectField}function findVersionSelectAndConvertToPicker(context,selector){selector=selector||".aui-field-versionspicker.frother-control-renderer";AJS.$(selector,context).each(function(){var $selectField=locateSelect(this);if($selectField.length){createPicker($selectField)}})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){findVersionSelectAndConvertToPicker(context)}})})();;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initCommentControls.js' */
(function($){function applyCommentControls($contexts){if($contexts.attr("id")==="addcomment"){$contexts=$contexts.find("#issue-comment-add")}$contexts.each(function(){var $context=$(this);var $commentLevel=$context.find("#commentLevel");if($commentLevel.length>0){new AJS.SecurityLevelSelect($commentLevel)}$context.find(".wiki-js-prefs").each(function(){JIRA.wikiPreview(this,$context).init()})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context){applyCommentControls(context)})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initLogWorkControls.js' */
(function($){JIRA.Events.VALIDATE_TIMETRACKING="validateTimeTracking";function toggleTimeTrackingContainer(context,activate){var $logWorkContainer=$(context).find("#worklog-logworkcontainer"),$timeTrackingContainer=$(context).find("#worklog-timetrackingcontainer"),$logWorkCheckbox=$(context).find("#log-work-activate");if(activate){$logWorkContainer.removeClass("hidden");$timeTrackingContainer.addClass("hidden");$logWorkCheckbox.prop("checked",true)}else{$logWorkContainer.addClass("hidden");$timeTrackingContainer.removeClass("hidden");$logWorkCheckbox.prop("checked",false)}}function applyLogworkControls(context){$("#log-work-adjust-estimate-new-value, #log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$("input[name=worklog_adjustEstimate]:checked,input[name=adjustEstimate]:checked",context).val()+"-value",context).removeAttr("disabled");$("input[name=worklog_adjustEstimate],input[name=adjustEstimate]",context).change(function(){$("#log-work-adjust-estimate-new-value,#log-work-adjust-estimate-manual-value",context).attr("disabled","disabled");$("#log-work-adjust-estimate-"+$(this).val()+"-value",context).removeAttr("disabled")});$("#delete-log-work-adjust-estimate-new-value").change(function(){$("#delete-log-work-adjust-estimate-new").prop("checked",true)});$("#delete-log-work-adjust-estimate-manual-value").change(function(){$("#delete-log-work-adjust-estimate-manual").prop("checked",true)});$(context).find("#log-work-activate").change(function(){toggleTimeTrackingContainer(context,$(this).is(":checked"))})}JIRA.bind(JIRA.Events.VALIDATE_TIMETRACKING,function(e,context){toggleTimeTrackingContainer(context,true)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){applyLogworkControls(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initPriorityPickers.js' */
(function($){function createPriorityPicker(context){context.find("select#priority").each(function(i,el){new AJS.SingleSelect({element:el,revertOnInvalid:true})})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){createPriorityPicker(context)}})})(AJS.$);;
;/* module-key = 'jira.webresources:jira-fields', location = '/includes/jira/field/initInlineAttach.js' */
(function(){var Events=require("jira/util/events");var Types=require("jira/util/events/types");var Reasons=require("jira/util/events/reasons");require("jira/jquery/plugins/attachment/inline-attach");function createInlineAttach(context){context.find("input[type=file]:not('.ignore-inline-attach')").inlineAttach()}Events.bind(Types.NEW_CONTENT_ADDED,function(e,context,reason){if(reason!==Reasons.panelRefreshed){createInlineAttach(context)}})})();;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/namespace.js' */
jQuery.namespace("JIRA.Forms");;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/util.js' */
Class.prototype.triggerEvent=function(c,a,b){jQuery(this).trigger(c,a);if(b&&this.globalEventNamespaces){jQuery.each(this.globalEventNamespaces,function(e,d){jQuery(AJS).trigger(d+"."+c,a)})}return this};Class.prototype.bind=function(a,b){jQuery(this).bind(a,b);return this};JIRA.makePropertyFunc=function(a){if(jQuery.isFunction(a)){return a}else{return function(){return a}}};JIRA.Dialog.getAttrFromActiveTrigger=function(b){var c=JIRA.Dialog.current,a=c.$activeTrigger;if(a){return a.attr(b)}};JIRA.Dialog.getIssueActionTitle=function(b){var a=JIRA.Dialog.getActionIssueKey();if(!a){return b}return b+" : "+a};JIRA.Dialog.getActionIssueKey=function(){var a=JIRA.Dialog.getAttrFromActiveTrigger("data-issueKey");if(!a&&JIRA.Issue){a=JIRA.Issue.getIssueKey()}if(!a&&JIRA.IssueNavigator){a=JIRA.IssueNavigator.getSelectedIssueKey()}if(!a&&JIRA.Issues){a=JIRA.Issues.Api.getSelectedIssueKey()}return a};JIRA.activateTabWithChild=function(e){var c,b,a,d=e.closest(".tabs-pane");if(d.length){b=d.closest(".aui-tabs");c=d.attr("id");a=b.find("a[href='#"+c+"']");a.click()}};JIRA.applyErrorsToForm=function(c,d){var b,a=[];jQuery.each(d,function(f,i){var h,e,g=c.find(":input[name='"+f+"']").last();if(g.length===1){if(!b){b=g}e=jQuery("<div class='error' />").attr("data-field",f).text(i);h=g.closest(".field-group, .group");h.find(".error").remove();h.append(e)}else{if(g.length===0){a.push(i)}}});if(a.length>0){JIRA.applyErrorMessageToForm(c,JIRA.Templates.Issue.undealtErrors({errors:a}))}JIRA.activateTabWithChild(c.find(".error:first"));if(b){b.focus()}};JIRA.extractScripts=function(b){var a=jQuery(b);return{html:a.not("script"),scripts:a.filter("script")}};JIRA.applyMessageToForm=function(a,c,b,e){var d=c.find(".aui-message-context");if(!d.length){d=jQuery("<div class='aui-message-context' />");if(JIRA.useLegacyDecorator()){d.prependTo(c.find(".content-body"))}else{d.prependTo(c.find(".form-body"))}}d.empty();AJS.messages[a](d,{shadowed:false,closeable:e,body:b})};JIRA.useLegacyDecorator=function(){return !JIRA.Version.isGreaterThanOrEqualTo("5.0")};JIRA.applyErrorMessageToForm=function(b,a){return JIRA.applyMessageToForm("error",b,a,false)};JIRA.applySuccessMessageToForm=function(b,a){return JIRA.applyMessageToForm("success",b,a,true)};;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/model.js' */
JIRA.Forms.Model=Class.extend({init:function(a){this.userFieldsResource=a.userFieldsResource;this.fieldsResource=a.fieldsResource;this.retainedFields=[];this._hasRetainFeature=false;this._hasVisibilityFeature=true},getFieldsResource:function(){return this.fieldsResource},getAtlToken:function(){return this.atlToken},getFormToken:function(){return this.formToken},getActiveFieldIds:function(){return this.getUserFields()},addFieldToRetainValue:function(a){if(this._hasRetainFeature){this.removeFieldToRetainValue(a);this.retainedFields.push(a)}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},clearRetainedFields:function(){this.retainedFields=[]},removeFieldToRetainValue:function(b){if(this._hasRetainFeature){var a=jQuery.inArray(b,this.retainedFields);if(a!=-1){this.retainedFields.splice(a,1)}}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},getFieldsWithRetainedValues:function(){if(this._hasRetainFeature){return this.retainedFields}else{throw new Error("getFieldsWithRetainedValues: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},hasRetainedValue:function(a){if(this._hasRetainFeature){return jQuery.inArray(a.id,this.retainedFields)!==-1}else{throw new Error("HasRetainedValue: cannot be called. Must enable retain feature first by specifiying [_hasRetainFeature=true]")}},refresh:function(c){var a=this,b=jQuery.Deferred(),d;if(c){d=c+"&retainValues=true"}JIRA.SmartAjax.makeRequest({url:this.getFieldsResource(),type:"POST",data:d,success:function(e){a.atlToken=e.atl_token;a.formToken=e.formToken;a.fields=e.fields;a.sortedTabs=e.sortedTabs;a.userPreferences=e.userPreferences},complete:function(f,g,e){if(e.successful){b.resolveWith(a,arguments)}else{a.triggerEvent("serverError",[e]);b.rejectWith(a,[e])}}});return b.promise()},setFields:function(a){this.fields=a},getConfigurableFields:function(){return this.getFields()},getFields:function(){var a=this,b=jQuery.Deferred();if(!this.fields){this.refresh().done(function(){b.resolve(a.fields)})}else{b.resolve(a.fields)}return b.promise()},_mungeTabs:function(b){var a=0,c=[];jQuery.each(b,function(d,e){a++;if(e.tab){if(!c[e.tab.position]){c[e.tab.position]=AJS.copyObject(e.tab)}if(e.tab.position===0){c[e.tab.position].isFirst=true}if(!c[e.tab.position].fields){c[e.tab.position].fields=[]}c[e.tab.position].fields.push(AJS.copyObject(e))}});return c},getTabs:function(){var a=this,b=jQuery.Deferred();this.getFields().done(function(c){var d=a._mungeTabs(c);b.resolve(d)});return b.promise()},getSortedTabs:function(){var a=jQuery.Deferred();if(!this.sortedTabs){this.refresh().done(function(){a.resolve(this.sortedTabs)})}else{a.resolve(this.sortedTabs)}return a.promise()},getUserFields:function(){var a=this,b=jQuery.Deferred();if(!this.userPreferences){this.refresh().done(function(){b.resolve(a.userPreferences.fields)})}else{b.resolve(a.userPreferences.fields)}return b.promise()},setUserFields:function(a){var b={};b.fields=a;return this.updateUserPrefs(b)},hasRetainFeature:function(){return !!this._hasRetainFeature},hasVisibilityFeature:function(){return !!this._hasVisibilityFeature},getUseConfigurableForm:function(){var a=this,b=jQuery.Deferred();if(!this.userPreferences){this.refresh().done(function(){b.resolve(a.userPreferences.useQuickForm)}).fail(function(){b.reject()})}else{b.resolve(a.userPreferences.useQuickForm)}return b.promise()},setUseConfigurableForm:function(a){var b={};b.useQuickForm=a;return this.updateUserPrefs(b)},updateUserPrefs:function(c){var b=jQuery.Deferred(),a=this;if(AJS.Meta.get("remote-user")===""){b.done();return b.promise()}if(!this.userPreferences){console.log("JIRA.Forms.Model: Cannot update user preferences if there are none to update");b.reject();return b.promise()}if(!c.fields){c.fields=this.userPreferences.fields}if(typeof c.showWelcomeScreen==="undefined"){c.showWelcomeScreen=this.userPreferences.showWelcomeScreen}if(typeof c.useQuickForm==="undefined"){c.useQuickForm=this.userPreferences.useQuickForm}return JIRA.SmartAjax.makeRequest({url:this.userFieldsResource,type:"POST",data:JSON.stringify(c),dataType:"json",contentType:"application/json",complete:function(e,f,d){if(d.successful){a.userPreferences=c}else{a.triggerEvent("serverError",[d])}}})}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/quickform.soy' */
// This file was automatically generated from quickform.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.QuickForm == 'undefined') { JIRA.Templates.QuickForm = {}; }


JIRA.Templates.QuickForm.field = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append(opt_data.editHtml);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.fieldPicker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="qf-picker"><div class="qf-picker-header"><dl><dt>', soy.$$escapeHtml("Show Fields:"), '</dt>', (opt_data.isConfigurable) ? '<dd><a class="qf-unconfigurable" href="#">' + soy.$$escapeHtml("All") + '</a></dd><dd>' + soy.$$escapeHtml("Custom") + '</dd>' : '<dd>' + soy.$$escapeHtml("All") + '</dd><dd><a class="qf-configurable" href="#">' + soy.$$escapeHtml("Custom") + '</a></dd>', '</dl></div><div class="qf-picker-content ', (! opt_data.isConfigurable) ? 'qf-picker-unconfigurable' : '', '"></div><div class="qf-picker-footer"></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.configurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.unconfigurablePickerButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span title="', soy.$$escapeHtml(opt_data.label), '" data-field-id="', soy.$$escapeHtml(opt_data.fieldId), '" class="qf-picker-button', (opt_data.isActive) ? ' qf-active' : '', '" href="#">', soy.$$escapeHtml(opt_data.label), (opt_data.required) ? '<span class="aui-icon icon-required"></span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.QuickForm.errorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.error({closeable: 'true', content: opt_data.message}, output);
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/field.js' */
JIRA.Forms.ConfigurableField=AJS.Control.extend({init:function(a){this.descriptor=a;this.$element=jQuery("<div />").attr("id","qf-field-"+this.getId())},focus:function(){this.$element.find(":input:first").focus()},highlight:function(){var a=this;this.$element.css("backgroundColor","#fff").animate({backgroundColor:"lightyellow"},function(){a.$element.animate({backgroundColor:"#fff"},function(){a.$element.css("backgroundColor","")})})},getLabel:function(){return this.descriptor.label},getId:function(){return this.descriptor.id},activate:function(b){var a;this.active=true;this.$element.addClass("qf-field-active").show();this.$element.find("textarea").trigger("refreshInputHeight");if(!b){a=this.render();this.$element.append(a.scripts);this.focus();JIRA.trigger(JIRA.Events.NEW_CONTENT_ADDED,[this.$element]);this.$element.scrollIntoView();this.triggerEvent("activated")}},hasVisibilityFeature:function(){return !!this.descriptor.hasVisibilityFeature},hasRetainFeature:function(){return !!this.descriptor.hasRetainFeature},isActive:function(){return this.active},disable:function(a){this.render();this.active=false;this.$element.removeClass("qf-field-active").hide();if(!a){this.triggerEvent("disabled")}},render:function(){var b=JIRA.Templates.QuickForm.field(this.descriptor),a=JIRA.extractScripts(b);this.$element.html(a.html).addClass("qf-field").data("model",this);return{element:this.$element,scripts:a.scripts}}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/picker.js' */
JIRA.Forms.FieldPicker=AJS.Control.extend({INLINE_DIALOG_ID:"field_picker_popup",init:function(){this.buttons=[]},switchToAll:function(a){this.isConfigurable=false;if(a!==true){this.hideCallback=function(){this.remove()};this.inlineDialog.hide();this.triggerEvent("switchedToAll")}},setForm:function(a){this.form=a},switchToCustom:function(a){this.isConfigurable=true;if(a!==true){this.hideCallback=function(){this.remove()};this.inlineDialog.hide();this.triggerEvent("switchedToCustom")}},hideCallback:function(){},bindInlineDialog:function(){var b=this,a=this.getInlineDialogTrigger();function c(f,d,e){b.render().done(function(g){if(f.find(".qf-picker").length===0){f.html(g);f.click(function(k){k.stopPropagation()})}var j=jQuery("#qf-field-picker-trigger:visible").offset().top-jQuery(window).scrollTop(),i=jQuery(window).height(),h=i-j-110;f.find(".qf-picker-content").css("maxHeight",h);e()})}if(this.inlineDialog){this.inlineDialog.remove()}this.inlineDialog=AJS.InlineDialog(a,this.INLINE_DIALOG_ID,c,{width:450,upfrontCallback:function(){a.parent().addClass("active")},hideCallback:function(){a.parent().removeClass("active")},nobind:true});a.click(function(d){if(jQuery("#inline-dialog-"+b.INLINE_DIALOG_ID).is(":visible")){b.inlineDialog.hide()}else{b.inlineDialog.show()}});return this.inlineDialog},getInlineDialogTrigger:function(){return this.form.$element.find("#qf-field-picker-trigger")},renderButtons:function(b){var a=this,c=jQuery('<ul class="qf-picker-buttons" />').appendTo(this.$content);jQuery.each(b,function(e,f){var g,d;if(a.isConfigurable){a.form.getFieldById(f.id).done(function(i){if(i&&i.hasVisibilityFeature()){var j=jQuery("<li />").appendTo(c);var h=new JIRA.Forms.FieldPicker.ConfigurableButton({field:i});h.render().appendTo(j);a.buttons.push(h)}})}else{d=new JIRA.Forms.FieldPicker.UnconfigurableButton(f);g=jQuery("<li />").appendTo(c);d.render().appendTo(g)}});if(c.children().length===0){c.addClass("qf-no-fields").append("<li><em>"+"No fields can be configured for this tab"+"</em></li>")}},renderContents:function(){var a=this,b=jQuery.Deferred();this.form.model.getSortedTabs().done(function(c){if(c.length===1){a.renderButtons(c[0].fields)}else{jQuery.each(c,function(d,e){if(e.fields.length>0){jQuery("<h4><span></span></h4>").appendTo(a.$content).find("span").text(e.label);a.renderButtons(e.fields)}})}b.resolveWith(a,[a.$element])});return b.promise()},show:function(){this.inlineDialog.show()},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.fieldPicker({isConfigurable:this.isConfigurable}));this.$content=this.$element.find(".qf-picker-content");this._assignEvents("switchToCustom",this.$element.find(".qf-configurable"));this._assignEvents("switchToAll",this.$element.find(".qf-unconfigurable"));return this.renderContents()},_events:{switchToCustom:{click:function(a){this.switchToCustom();a.preventDefault()}},switchToAll:{click:function(a){this.switchToAll();a.preventDefault()}}}});JIRA.Forms.FieldPicker.UnconfigurableButton=AJS.Control.extend({init:function(a){this.descriptor=a},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.unconfigurablePickerButton({required:this.descriptor.required,label:this.descriptor.label,fieldId:this.descriptor.id,isActive:true}));return this.$element}});JIRA.Forms.FieldPicker.ConfigurableButton=AJS.Control.extend({init:function(b){var a=this;this.field=b.field;this.field.bind("disabled",function(){a.$element.removeClass("qf-active")}).bind("activated",function(){a.$element.addClass("qf-active")})},toggle:function(){if(this.field.isActive()){this.field.disable()}else{this.field.activate()}},getId:function(){return this.field.getId()},render:function(){this.$element=jQuery(JIRA.Templates.QuickForm.configurablePickerButton({required:this.field.descriptor.required,label:this.field.getLabel(),fieldId:this.field.getId(),isActive:this.field.isActive()}));this._assignEvents("button",this.$element);return this.$element},_events:{button:{click:function(a){this.toggle();a.preventDefault()}}}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/form.js' */
JIRA.Forms.AbstractForm=AJS.Control.extend({submit:function(){var a=this;a.getForm().addClass("submitting");this.triggerEvent("submitting",[],true);return JIRA.SmartAjax.makeRequest({url:this.getAction(),type:"POST",beforeSend:function(){a.disable()},data:this.serialize(),complete:function(g,h,c){var e=c.data;a.getForm().find(".aui-message-context").remove();a.enable();a.getForm().find(".error").remove();if(c.successful){a.performAnalytics();if(e&&e.fields){a.invalidateFieldsCache();a.model.setFields(e.fields)}if(typeof e==="string"){var f=AJS.$(AJS.extractBodyFromResponse(e));var d=f.find("#atl_token").val();if(d){a.model.atlToken=d;a.getForm().find('input[name="atl_token"]').val(d)}var b=new JIRA.FormDialog({offsetTarget:"body",content:f});b._handleServerSuccess=function(){if(b.prev){b.prev._removeStackState();b.prev._resetWindowTitle();b._removeStackState()}b.hide();a.triggerEvent("sessionComplete",[],true);a.handleSubmitSuccess()};b._handleServerError=function(i){b.hide();a.handleSubmitError(i)};b.show()}else{a.handleSubmitSuccess(c.data)}}else{a.handleSubmitError(g)}a.getForm().removeClass("submitting")}})},disable:function(){this.getForm().find(":input").attr("disabled","disabled").trigger("disable");this.getForm().find(":submit").attr("disabled","disabled")},enable:function(){this.getForm().find(":input").removeAttr("disabled").trigger("enable");this.getForm().find(":submit").removeAttr("disabled")},getActiveFieldIds:function(){throw new Error("getActiveFieldIds: Abstract, must be implemented by sub class")},serialize:function(c){var a=this,b=this.getForm().serialize();if(this.model.isInMultipleMode&&this.model.isInMultipleMode()){b=b+"&multipleMode=true"}if(this.model.hasRetainFeature()){this.model.clearRetainedFields();jQuery.each(this.getActiveFieldIds(),function(e,d){a.model.addFieldToRetainValue(d,c)});jQuery.each(this.model.getFieldsWithRetainedValues(),function(d,e){b=b+"&fieldsToRetain="+e})}return b},invalidateFieldsCache:function(){delete this.fields},setInitialFocus:function(){this.getFormContent().find(":input:first").focus()},handleSubmitSuccess:function(){this.triggerEvent("submitted");AJS.reloadViaWindowLocation()},performAnalytics:function(){var a=function(d,e){var c="***** Analytics log ["+d+"]";if(e){c+="["+JSON.stringify(e)+"]"}AJS.log(c);if(AJS.EventQueue){AJS.EventQueue.push({name:d,properties:e||{}})}};var b=function(e){var c={};var f=_.filter(e,function(g){return !_.contains(["isCreateIssue","isEditIssue","atl_token","hasWorkStarted"],g.name)});var d=_.filter(f,function(g){return g.value!=""});_.each(d,function(h){var g=h.name;if(!_.has(c,g)){c[g]=[]}c[g].push(h.value)});return c};this.previousAnalytics=(function(k,o){var f=b(k);var m=_.keys(f);var g=_.keys(o.data);var j=_.difference(m,g);var n=_.difference(g,m);var l=_.intersection(g,m);var d=_.filter(l,function(p){return _.isEqual(o.data[p],f[p])});var c=_.difference(l,d);var i=o.count+1;var h=(JIRA.Dialog.current.options.id==="edit-issue-dialog");var e={"atlassian.numCreates":i,"edit.form":h};_.each(j,function(p){e[p]="added"});_.each(n,function(p){e[p]="removed"});_.each(d,function(p){e[p]="same"});_.each(c,function(p){e[p]="changed"});a("quick.create.fields",e);return{data:f,count:i}})(this.getForm().serializeArray(),this.previousAnalytics||{data:{},count:0})},handleSubmitError:function(d){var a=this;var f;try{f=JSON.parse(d.responseText)}catch(c){}if(f){if(f.errorMessages&&f.errorMessages.length){JIRA.applyErrorMessageToForm(this.getForm(),f.errorMessages[0])}if(f&&f.errors&&d.status===400){if(this.getFieldById){jQuery.each(f.errors,function(e){if(/^timetracking/.test(e)){a.getFieldById("timetracking").done(function(g){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[a.$element]);g.activate(true)})}else{if(/^worklog/.test(e)){a.getFieldById("worklog").done(function(g){JIRA.trigger(JIRA.Events.VALIDATE_TIMETRACKING,[a.$element]);g.activate(true)})}else{a.getFieldById(e).done(function(g){g.activate(true)})}}})}JIRA.applyErrorsToForm(this.getForm(),f.errors);this.triggerEvent("validationError",[this,f.errors],true)}var b=a.$element.find(".error");if(b.length){b[0].scrollIntoView(false)}}},getAction:function(){return this.action},getFormContent:function(){return this.$element.find("div.content")},getForm:function(){return this.$element.find("form")},createField:function(){throw new Error("JIRA.Forms.AbstractForm: You must implement [createField] method in subclass.")},_getActiveAttachments:function(a){var b=[];if(!a){return b}var d=a.split("&");for(var c=0;c<d.length;c++){var e=d[c].split("=");if(e[0]=="filetoconvert"){b.push(e[1])}}return b},_setActiveAttachments:function(b){var a=this.$element.find("input[name=filetoconvert]");a.each(function(){var d=jQuery(this);var c=_.contains(b,d.attr("value"));d.prop("checked",c)})},render:function(c){var b=jQuery.Deferred(),a=this;var d=a._getActiveAttachments(c);if(c){this.invalidateFieldsCache();this.model.refresh(c).done(function(){a._render().done(function(f,e){a.triggerEvent("rendered",[a.$element]);b.resolveWith(a,[a.$element,e])})})}else{a._render().done(function(f,e){a.triggerEvent("rendered",[a.$element]);b.resolveWith(a,[a.$element,e])})}b.always(function(){a._setActiveAttachments(d)});return b.promise()}});JIRA.Forms.AbstractConfigurableForm=JIRA.Forms.AbstractForm.extend({getFields:function(){var b=jQuery.Deferred(),a=this;if(!this.fields){this.fields=[];this.model.getConfigurableFields().done(function(c){jQuery.each(c,function(d,f){var e=a.createField(f);a.fields.push(e)});b.resolveWith(a,[a.fields])})}else{b.resolveWith(this,[this.fields])}return b.promise()},getActiveFieldIds:function(){var b=[],a=this.$element.find(".qf-field.qf-field-active:not(.qf-required)");jQuery.each(a,function(d,e){var c=jQuery(e);var f=c.data("model").getId();b.push(f);if(f==="attachment"){c.find(":checked").each(function(){b.push(this.id)})}});return b},createField:function(c){c.hasVisibilityFeature=this.model.hasVisibilityFeature(c);if(this.model.hasRetainFeature(c)){c.hasRetainFeature=true;c.retainValue=this.model.hasRetainedValue(c)}var a=this,b=new JIRA.Forms.ConfigurableField(c);if(c.hasVisibilityFeature){b.bind("activated",function(){a.model.setUserFields(a.getActiveFieldIds());b.highlight();a.triggerEvent("QuickForm.fieldAdded",[b])}).bind("disabled",function(){a.model.setUserFields(a.getActiveFieldIds());a.triggerEvent("QuickForm.fieldRemoved",[b])})}return b},getFieldById:function(c){var a=this,b=jQuery.Deferred();this.getFields().done(function(d){jQuery.each(d,function(e,f){if(f.getId()===c){b.resolveWith(a,[f])}});b.rejectWith(a,[])});return b.promise()},hasNoVisibleFields:function(){var a=jQuery.Deferred();a.resolve(this.getActiveFieldIds().length===0);return a.promise()},renderFormContents:function(){var c=jQuery.Deferred(),b=jQuery(),a=this;a.getFields().done(function(d){a.model.getActiveFieldIds().done(function(e){jQuery.each(d,function(){var f=this.render();b=b.add(f.scripts);a.getFormContent().append(f.element)});jQuery.each(e,function(g,f){jQuery.each(d,function(){if(this.getId()===f){this.activate(true)}})});jQuery.each(d,function(){if(!this.isActive()){this.disable(true)}});a.hasNoVisibleFields().done(function(g){if(g===true){for(var f=0;f<3;f++){if(d[f]){d[f].activate(true)}}}c.resolveWith(this,[a.$element,b])})})});return c.promise()}});JIRA.Forms.AbstractUnconfigurableForm=JIRA.Forms.AbstractForm.extend({getFieldsHtml:function(){var a=this,b=jQuery.Deferred(),c={};this.model.getTabs().done(function(d){if(d.length===1){c.fields=d[0].fields}else{c.tabs=d;c.hasTabs=true}b.resolveWith(a,[JIRA.Templates.Issue.issueFields(c)])});return b.promise()},getActiveFieldIds:function(){var b=[];this.model.getFields().done(function(c){jQuery.each(c,function(d,e){b.push(e.id)})});if(b.indexOf("attachment")){var a=this.$element.find("input[name=filetoconvert]").map(function(c,d){return d.id}).toArray();b.push.apply(b,a)}return b},getFields:function(){var b=jQuery.Deferred(),a=this;if(!this.fields){this.fields=[];this.model.getFields().done(function(c){jQuery.each(c,function(d,f){var e=a.createField(f);a.fields.push(e)});b.resolveWith(a,[a.fields])})}else{b.resolveWith(this,[this.fields])}return b.promise()}});JIRA.Forms.Error=AJS.Control.extend({getErrorMessageFromSmartAjax:function(a){var b,c;if(a.hasData&&a.status!==401){try{c=JSON.parse(a.data);if(c.errorMessages&&c.errorMessages.length>0){b=JIRA.Templates.QuickForm.errorMessage({message:c.errorMessages[0]})}else{b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}}catch(d){b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}}else{b=JIRA.SmartAjax.buildDialogErrorContent(a,true).html()}return b},render:function(b){var a=this.getErrorMessageFromSmartAjax(b);return this._render(a)}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-form', location = 'js/QuickForm/container.js' */
JIRA.Forms.Container=AJS.Control.extend({init:function(a){this.$element=jQuery("<div />").addClass("qf-container");this.options=JIRA.makePropertyFunc(a);this.fieldPicker=new JIRA.Forms.FieldPicker();this.successData=[]},decorateRenderers:function(){var a=this;if(!this.fieldPicker.decorated){this.fieldPicker.bind("switchedToAll",function(){a.unconfigurableForm.render(a.currentView.serialize(true)).done(function(){a.fieldPicker.show()})});this.fieldPicker.bind("switchedToCustom",function(){a.configurableForm.render(a.currentView.serialize(true)).done(function(){a.fieldPicker.show()})});this.fieldPicker.decorated=true}if(!this.configurableForm.decorated){this.configurableForm.bind("rendered",function(c,b){a.currentView=a.configurableForm;a.fieldPicker.switchToCustom(true);a.fieldPicker.setForm(a.configurableForm);a.fieldPicker.bindInlineDialog();a.applyGlobalDecorator(b);a.model.setUseConfigurableForm(true);a.triggerEvent("configurableFormRendered")});this.configurableForm.bind("submitted",function(c,b){a.successData.push(b);a.triggerEvent("configurableFormSubmitted")});this.configurableForm.decorated=true}if(!this.unconfigurableForm.decorated){this.unconfigurableForm.bind("rendered",function(c,b){a.fieldPicker.switchToAll(true);a.fieldPicker.setForm(a.unconfigurableForm);a.fieldPicker.bindInlineDialog();a.currentView=a.unconfigurableForm;a.applyGlobalDecorator(b);a.model.setUseConfigurableForm(false);a.triggerEvent("unconfigurableFormRendered")});this.unconfigurableForm.bind("submitted",function(c,b){a.successData.push(b);a.triggerEvent("unconfigurableFormSubmitted")});this.unconfigurableForm.decorated=true}},applyGlobalDecorator:function(c){function b(){if(a.currentView.setInitialFocus){a.currentView.setInitialFocus()}}var a=this;c.detach();this.$element.html(c);this.triggerEvent("contentRefreshed",[this.$element]);if(jQuery.browser.msie){window.setTimeout(b,0)}else{b()}},asDialog:function(b){var a=this,c;this.dialog=c=new JIRA.FormDialog({id:b.id,trigger:b.trigger,windowTitle:b.windowTitle,width:JIRA.Dialog.WIDTH_PRESETS.large,delayShowUntil:JIRA.Dialogs.waitForSavesToComplete,content:function(d){a.render().done(function(){d(a.$element)});a.triggerEvent("dialogShown")},submitHandler:function(f,d){f.preventDefault();a.currentView.submit().then(d,d)},stacked:true});if(b.id==="edit-issue-dialog"){jQuery(this.dialog).on("beforeShow",function(d){if(!jira.app.issue.getIssueKey()&&!jira.app.issuenavigator.isRowSelected()){d.preventDefault()}})}this.dialog._focusFirstField=function(){JIRA.FormDialog.prototype._focusFirstField.apply(this,["div.content :input:visible:first"])};this.bind("initialized",function(){this.unconfigurableForm.bind("sessionComplete",function(){c.hide()});this.configurableForm.bind("sessionComplete",function(){c.hide()})}).bind("contentRefreshed",function(){c.notifyOfNewContent()});c.bind("Dialog.hide",function(){if(a.successData.length){a.triggerEvent("sessionComplete",[a.successData],true);a.successData=[]}});a.$element.ajaxStart(function(){c.showFooterLoadingIndicator()}).ajaxStop(function(){c.hideFooterLoadingIndicator()});c.getQuickForm=function(){return a};c.dirtyFormWarning();return c},lazyInit:function(){var a=this,b=this.options.call(this);this.model=b.model;this.errorHandler=b.errorHandler;this.globalEventNamespaces=b.globalEventNamespaces;this.configurableForm=b.configurableForm;this.unconfigurableForm=b.unconfigurableForm;this.sessionComplete=b.sessionComplete;this.model.clearRetainedFields();this.configurableForm.invalidateFieldsCache();this.model.bind("serverError",function(d,c){a.$element.html(a.errorHandler.render(c));a.triggerEvent("contentRefreshed",[this.$element])});this.triggerEvent("initialized");this.decorateRenderers()},render:function(){var a=this,b=jQuery.Deferred();this.lazyInit();a.model.getUseConfigurableForm().done(function(c){if(c===true){a.configurableForm.render().done(function(e,d){b.resolveWith(a,[a.$element]);a.$element.append(d)})}else{a.unconfigurableForm.render().done(function(e,d){b.resolveWith(a,[a.$element,d]);a.$element.append(d)})}}).fail(function(){b.resolveWith(a,[a.$element])});return b.promise()}});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/create.js' */
JIRA.Forms.CreateIssueModel=JIRA.Forms.Model.extend({DEFAULT_NON_RETAINED_FIELDS:["summary","description","timetracking","timetracking_originalestimate","timetracking_remainingestimate","worklog","worklog_startDate","worklog_timeLogged","worklog_newEstimate","worklog_adjustmentAmount","attachment"],init:function(a){a=a||{};this.userFieldsResource=contextPath+"/rest/quickedit/1.0/userpreferences/create";this._hasRetainFeature=true;this._hasVisibilityFeature=true;this.retainedFields=[];this.initIssueType=a.issueType;this.initProjectId=a.projectId;this.parentIssueId=a.parentIssueId;this.nonRetainedFields=this.DEFAULT_NON_RETAINED_FIELDS;if(a.nonRetainedFields){this.nonRetainedFields=_.union(a.nonRetainedFields,this.DEFAULT_NON_RETAINED_FIELDS)}},getParentIssueId:function(){return this.parentIssueId},isInMultipleMode:function(){return this.multipleMode},setIsMultipleMode:function(a){this.multipleMode=a},getActiveFieldIds:function(){var a=this,b=jQuery.Deferred(),c=[];this.getUserFields().done(function(d){jQuery.each(d,function(f,e){c.push(e)});a.getRequiredFields().done(function(e){jQuery.each(e,function(g,f){if(jQuery.inArray(f.id,c)===-1){c.push(f.id)}});b.resolve(c)})});return b.promise()},hasVisibilityFeature:function(a){return !a.required},getFieldsResource:function(){var a=contextPath+"/secure/QuickCreateIssue!default.jspa?decorator=none";if(this.parentIssueId){return a+"&parentIssueId="+this.parentIssueId}if(this.initIssueType){a=a+"&issuetype="+this.initIssueType;delete this.initIssueType}if(this.initProjectId){a=a+"&pid="+this.initProjectId;delete this.initProjectId}return a},addFieldToRetainValue:function(d,b){var a=!_.contains(this.nonRetainedFields,d);var c=d.match(/^filetoconvert/)!==null;if(a||c||b){this._super(d)}},getRequiredFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.required){b.push(e)}});a.resolve(b)});return a.promise()},getConfigurableFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.id!=="project"&&e.id!=="issuetype"){b.push(e)}});a.resolve(b)});return a.promise()},getIssueSetupFields:function(){var a=jQuery.Deferred(),b=[];this.getFields().done(function(c){jQuery.each(c,function(d,e){if(e.id==="project"||e.id==="issuetype"){b.push(e)}});a.resolve(b)});return a.promise()}});JIRA.Forms.CreateIssueHelper=Class.extend({init:function(a){this.form=a},handleSubmitSuccess:function(d){function c(e,g,f){var h='<a href="'+f+'">'+e+" - "+AJS.escapeHTML(g)+"</a>";return AJS.format("Issue {0} has been successfully created",h)}var a=this,b=this.form.$element.find("#summary").val();d.summary=b;this.form.triggerEvent("submitted",[d,this]);this.form.triggerEvent("issueCreated",[d,this],true);if(a.form.model.isInMultipleMode()){this.form.render().done(function(){var e=c(d.issueKey,b,contextPath+"/browse/"+d.issueKey);JIRA.applySuccessMessageToForm(a.form.getForm(),e)})}else{this.form.triggerEvent("sessionComplete")}},getCreateAnotherCheckbox:function(){return this.form.$element.find("#qf-create-another")},isInMultipleMode:function(){return this.getCreateAnotherCheckbox().is(":checked")},getProjectField:function(){return this.form.$element.find(".issue-setup-fields #project")},getIssueTypeField:function(){return this.form.$element.find(".issue-setup-fields #issuetype")},serializeForToggle:function(c){if(!this.form.model.hasRetainFeature()){return this.form.getForm().serialize()}var e=this.form.model.prevActiveFields||[];var k=this.form.getForm().serializeArray();function i(l){return l.name=="filetoconvert"?l.name+"-"+l.value:l.name}var d=this.form.getActiveFieldIds();var f=jQuery.grep(k,function(l){return jQuery.inArray(i(l),d)!==-1});var a=jQuery.grep(e,function(l){return jQuery.inArray(i(l),d)===-1});var b=jQuery.map(a,function(l){return i(l)});var h=jQuery.merge(f,a);var g=jQuery.merge(d,b);this.form.model.prevActiveFields=jQuery.extend(true,[],h);if(c){g=this.executeProjectChangedSecuritySettingAction(g)}var j=jQuery.merge([{name:"retainValues",value:true}],h);jQuery.each(k,function(l,m){if(m.name==="pid"||m.name==="issuetype"){j.push(m)}});j.push({name:"toggle",value:true});jQuery.each(g,function(l,m){j.push({name:"fieldsToRetain",value:m})});j.push({name:"formToken",value:this.form.model.getFormToken()});return jQuery.param(j)},executeProjectChangedSecuritySettingAction:function(a){return _.reject(a,function(b){return b==="security"})},prepareFieldsToRetain:function(a,b){jQuery.each(a,function(c,d){b.push({name:"fieldsToRetain",value:d})});return b},setIssueType:function(){var a=this,b=this.serializeForToggle();this.form.invalidateFieldsCache();this.form.disable();this.form.render(b).done(function(){a.form.enable()})},setProjectId:function(){var a=this,b=this.serializeForToggle(true);this.form.invalidateFieldsCache();this.form.disable();this.form.render(b).done(function(){a.form.enable()})},saveFormDirtyStatus:function(){this.form.isDirty=this.form.getForm().isDirty()},restoreFormDirtyStatus:function(){if(this.form.isDirty){this.form.getForm().addClass(JIRA.DirtyForm.ClassNames.BY_DEFAULT)}},decorate:function(){var a=this;this.getProjectField().change(function(){a.saveFormDirtyStatus();JIRA.trigger("dialogBeforeContentChange",["projectId",this.value,JIRA.Dialog.current.options.id]);a.setProjectId(this.value)});this.getIssueTypeField().change(function(){a.saveFormDirtyStatus();JIRA.trigger("dialogBeforeContentChange",["issueType",this.value,JIRA.Dialog.current.options.id]);a.setIssueType(this.value)});this.getCreateAnotherCheckbox().change(function(){a.form.model.setIsMultipleMode(this.checked)})}});JIRA.Forms.CreateIssueError=JIRA.Forms.Error.extend({_render:function(a){return jQuery(JIRA.Templates.Issue.createIssueError({errorHtml:a,useLegacyDecorator:JIRA.useLegacyDecorator()}))}});JIRA.Forms.UnconfigurableCreateIssueForm=JIRA.Forms.AbstractUnconfigurableForm.extend({init:function(a){this._serialization={};this.globalEventNamespaces=a.globalEventNamespaces||[];this.model=a.model;this.helper=new JIRA.Forms.CreateIssueHelper(this);this.title=a.title;this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";this.$element=jQuery("<div class='qf-unconfigurable-form' />")},handleSubmitSuccess:function(a){this.helper.handleSubmitSuccess(a)},_render:function(){var b=jQuery.Deferred(),a=this;this.getFieldsHtml().done(function(c){a.model.getIssueSetupFields().done(function(f){var e=JIRA.Templates.Issue.createIssueForm({issueSetupFields:f,fieldsHtml:c,parentIssueId:a.model.getParentIssueId(),atlToken:a.model.getAtlToken(),formToken:a.model.getFormToken(),title:a.title,multipleMode:a.model.isInMultipleMode(),useLegacyDecorator:JIRA.useLegacyDecorator(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()}),d=JIRA.extractScripts(e);a.$element.empty().append(d.html);a.helper.restoreFormDirtyStatus();a.helper.decorate();b.resolveWith(a,[a.$element,d.scripts])})});return b.promise()}});JIRA.Forms.ConfigurableCreateIssueForm=JIRA.Forms.AbstractConfigurableForm.extend({init:function(a){this.model=a.model;this.helper=new JIRA.Forms.CreateIssueHelper(this);this.globalEventNamespaces=a.globalEventNamespaces||[];this.issueId=a.issueId;this.title=a.title;this._serialization={};this.action=contextPath+"/secure/QuickCreateIssue.jspa?decorator=none";this.$element=jQuery("<div />").addClass("qf-form qf-configurable-form")},handleSubmitSuccess:function(a){return this.helper.handleSubmitSuccess(a)},_render:function(){var b=jQuery.Deferred(),a=this;a.model.getIssueSetupFields().done(function(d){var c=JIRA.Templates.Issue.createIssueForm({issueSetupFields:d,atlToken:a.model.getAtlToken(),formToken:a.model.getFormToken(),isConfigurable:true,title:a.title,parentIssueId:a.model.getParentIssueId(),useLegacyDecorator:JIRA.useLegacyDecorator(),multipleMode:a.model.isInMultipleMode(),showFieldConfigurationToolBar:!JIRA.Users.LoggedInUser.isAnonymous(),modifierKey:AJS.Navigator.modifierKey()});a.$element.html(c);a.helper.decorate();a.renderFormContents().done(function(f,e){b.resolveWith(a,[a.$element,e])})});return b.promise()}});JIRA.Forms.createCreateIssueForm=function(a){a=a||{};return new JIRA.Forms.Container(function(){a.globalEventNamespaces=a.globalEventNamespaces||["QuickCreateIssue"];var e="Create Issue",b=new JIRA.Forms.CreateIssueModel({projectId:a.pid,issueType:a.issueType}),d=new JIRA.Forms.ConfigurableCreateIssueForm({model:b,title:e,globalEventNamespaces:a.globalEventNamespaces}),c=new JIRA.Forms.UnconfigurableCreateIssueForm({model:b,title:e,globalEventNamespaces:a.globalEventNamespaces});return{globalEventNamespaces:a.globalEventNamespaces,model:b,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:d,unconfigurableForm:c}})};JIRA.Forms.createSubtaskForm=(function(){var a=function a(c){return c.parentIssueId||JIRA.Issue.getIssueId()||JIRA.IssueNavigator.getSelectedIssueId()};var b=function b(c){c=c||{};return new JIRA.Forms.Container(function(){c.globalEventNamespaces=c.globalEventNamespaces||["QuickCreateSubtask"];var g=a(c),h=JIRA.Dialog.getIssueActionTitle("Create Subtask"),d=new JIRA.Forms.CreateIssueModel({parentIssueId:g,projectId:c.pid,issueType:c.issueType}),f=new JIRA.Forms.ConfigurableCreateIssueForm({model:d,title:h,globalEventNamespaces:c.globalEventNamespaces}),e=new JIRA.Forms.UnconfigurableCreateIssueForm({model:d,title:h,globalEventNamespaces:c.globalEventNamespaces});return{globalEventNamespaces:c.globalEventNamespaces,model:d,errorHandler:new JIRA.Forms.CreateIssueError(),configurableForm:f,unconfigurableForm:e}})};return b})();jQuery(function(){var a;jQuery(document).on("simpleClick",".create-issue, .create-issue-type",function(f){var b=jQuery(f.target);var d=b.is("a")?b:b.find("a");var g=parseUri(d.attr("href")).queryKey;var c={pid:g.pid,issueType:g.issuetype};c=jQuery.extend(c,{pid:b.attr("data-pid"),issueType:b.attr("data-issue-type")});JIRA.Forms.createCreateIssueForm(c).asDialog({trigger:document.createElement("a"),id:"create-issue-dialog",windowTitle:"Create Issue"}).show();f.preventDefault()});a=document.getElementById("stqc_show");if(a){a.onclick=null}jQuery(document).on("simpleClick",".issueaction-create-subtask",function(f){var b=jQuery(f.target);var d=b.is("a")?b:b.find("a");var c={parentIssueId:d.attr("data-issueid")};JIRA.Forms.createSubtaskForm(c).asDialog({windowTitle:function(){return JIRA.Dialog.getIssueActionTitle("Create Subtask")},trigger:document.createElement("a"),id:"create-subtask-dialog"}).show();f.preventDefault()})});;
;/* module-key = 'com.atlassian.jira.jira-quick-edit-plugin:quick-create-issue', location = 'js/Issue/issue.soy' */
// This file was automatically generated from issue.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Issue == 'undefined') { JIRA.Templates.Issue = {}; }


JIRA.Templates.Issue.editIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Edit Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.editIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" name="jiraform" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', opt_data.title, '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.issueId), '" /><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', (opt_data.commentField) ? opt_data.commentField.editHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="button" id="edit-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Update"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.issueFields = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.hasTabs) {
    output.append('<div class="aui-tabs horizontal-tabs" id="horizontal"><ul class="tabs-menu">');
    var tabList68 = opt_data.tabs;
    var tabListLen68 = tabList68.length;
    for (var tabIndex68 = 0; tabIndex68 < tabListLen68; tabIndex68++) {
      var tabData68 = tabList68[tabIndex68];
      output.append((tabData68) ? '<li class="menu-item ' + ((tabData68.isFirst) ? 'first active-tab' : '') + ' "><a href="#tab-' + soy.$$escapeHtml(tabData68.position) + '" ><strong>' + soy.$$escapeHtml(tabData68.label) + '</strong></a></li>' : '');
    }
    output.append('</ul>');
    var tabList82 = opt_data.tabs;
    var tabListLen82 = tabList82.length;
    for (var tabIndex82 = 0; tabIndex82 < tabListLen82; tabIndex82++) {
      var tabData82 = tabList82[tabIndex82];
      if (tabData82) {
        output.append('<div class="tabs-pane ', (tabData82.isFirst) ? 'active-pane' : '', '" id="tab-', soy.$$escapeHtml(tabData82.position), '">');
        var fieldList92 = tabData82.fields;
        var fieldListLen92 = fieldList92.length;
        for (var fieldIndex92 = 0; fieldIndex92 < fieldListLen92; fieldIndex92++) {
          var fieldData92 = fieldList92[fieldIndex92];
          output.append((fieldData92.editHtml) ? fieldData92.editHtml : '');
        }
        output.append('</div>');
      }
    }
    output.append('</div>');
  } else {
    var fieldList102 = opt_data.fields;
    var fieldListLen102 = fieldList102.length;
    for (var fieldIndex102 = 0; fieldIndex102 < fieldListLen102; fieldIndex102++) {
      var fieldData102 = fieldList102[fieldIndex102];
      output.append((fieldData102.editHtml) ? fieldData102.editHtml : '');
    }
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form name="jiraform" action="#" class="aui"><h2>', (opt_data.showFieldConfigurationToolBar) ? '<div class="qf-form-operations aui-toolbar"><div class="toolbar-split toolbar-split-right"><div class="toolbar-group"><span class="toolbar-item"><a href="#" class="toolbar-trigger" id="qf-field-picker-trigger"><span class="icon icon-tools"></span>' + soy.$$escapeHtml("Configure Fields") + '<span class="icon drop-menu"></span></a></span></div></div></div>' : '', soy.$$escapeHtml(opt_data.title), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-body', '">');
  if (opt_data.issueSetupFields) {
    output.append('<div class="issue-setup-fields">');
    var fieldList126 = opt_data.issueSetupFields;
    var fieldListLen126 = fieldList126.length;
    for (var fieldIndex126 = 0; fieldIndex126 < fieldListLen126; fieldIndex126++) {
      var fieldData126 = fieldList126[fieldIndex126];
      output.append('<div class="qf-field qf-field-', soy.$$escapeHtml(fieldData126.id), ' qf-required">', fieldData126.editHtml, '</div>');
    }
    output.append('</div>');
  }
  output.append((opt_data.parentIssueId) ? '<input type="hidden" name="parentIssueId" value="' + soy.$$escapeHtml(opt_data.parentIssueId) + '" />' : '', '<input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '" /><div class="content">', (opt_data.fieldsHtml) ? opt_data.fieldsHtml : '', '<!-- fields inserted here via javascript --></div></div><div class="buttons-container ', (opt_data.useLegacyDecorator) ? 'content-footer' : 'form-footer', '"><div class="buttons"><label for="qf-create-another" class="qf-create-another"><input id="qf-create-another" type="checkbox" ', (opt_data.multipleMode) ? 'checked="checked"' : '', ' />', soy.$$escapeHtml("Create another"), '</label><input accesskey="', soy.$$escapeHtml("s"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to submit this form","s",opt_data.modifierKey)), '" class="aui-button aui-button-primary" id="create-issue-submit" name="Edit" type="submit" value="', soy.$$escapeHtml("Create"), '" /><a href="#" accesskey="', soy.$$escapeHtml("`"), '" title="', soy.$$escapeHtml(AJS.format("Press {1}+{0} to cancel","`",opt_data.modifierKey)), '" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.createIssueError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Create Issue"), '</h2><div class="', (opt_data.useLegacyDecorator) ? 'content-body' : 'form-footer', '">', opt_data.errorHtml, '</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Issue.undealtErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were some errors when trying to create this issue"), '</div><ul>');
  var errorList191 = opt_data.errors;
  var errorListLen191 = errorList191.length;
  for (var errorIndex191 = 0; errorIndex191 < errorListLen191; errorIndex191++) {
    var errorData191 = errorList191[errorIndex191];
    output.append('<li>', soy.$$escapeHtml(errorData191), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:whats-new-resources', location = 'templates/whats-new.soy' */
// This file was automatically generated from whats-new.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.WhatsNew == 'undefined') { JIRA.Templates.WhatsNew = {}; }


JIRA.Templates.WhatsNew.whatsNewDialogPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="whats-new-dialog-text"><div class="whats-new-throbber hidden"></div><div class="whats-new-timeout hidden"><div class="aui-message warning"><p class="title"><span class="aui-icon icon-warning"></span><strong>', soy.$$escapeHtml("Oops."), '</strong></p><p>', AJS.format("We\u2019re having trouble downloading the \x3ca target\x3d\x22_blank\x22 href\x3d\x22{0}\x22\x3eWhat\u2019s New content\x3c/a\x3e from the Atlassian website. This may be because you have a slow internet connection or that no internet connection is available.",opt_data.whatsNewFullLink), '</p></div></div></div><iframe id="whats-new-iframe" class="hidden" scrolling="no" frameborder="0" src="', soy.$$escapeHtml(opt_data.whatsNewHelpLink), '"></iframe>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.WhatsNew.whatsNewDialogTipPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="dialog-tip"><input id="dont-show-whats-new" type="checkbox" name="dontshow"', (opt_data.dontShowAgain) ? ' checked="checked"' : '', '><label for="dont-show-whats-new" type="checkbox"><span class="checkbox-label">', (opt_data.isOnDemand) ? soy.$$escapeHtml("Don\u2019t show again") : soy.$$escapeHtml("Don\u2019t show again. You will still be able to access this dialog through the \u2018Help\u2019 Menu in the application header."), '</span></label></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:whats-new-resources', location = 'js/whats-new.js' */
Raphael.spinner=function(k,f,h){var o=h||"#fff",n=f*13/60,s=f*35/60,p=f,d=p+n,c=p+n,m=Raphael(k,p*2+n*2,p*2+n*2),l=[],e=[],u=2*Math.PI/12,j={stroke:o,"stroke-width":n,"stroke-linecap":"round"};for(var q=0;q<12;q++){var g=u*q-Math.PI/2,b=Math.cos(g),a=Math.sin(g);e[q]=q/12;l[q]=m.path([["M",d+s*b,c+s*a],["L",d+p*b,c+p*a]]).attr(j)}var t;(function v(){e.unshift(e.pop());for(var r=0;r<12;r++){l[r].attr("opacity",e[r])}m.safari();t=setTimeout(v,80)})();return function(){clearTimeout(t);m.remove()}};var dim=AJS.dim;AJS.dim=function(){try{dim.apply(this,arguments)}catch(a){}};AJS.toInit(function(l){var i=l("#whats-new-menu-link"),e,c,a,m,h,g,k=function(p){var o=!l(this).attr("checked");var n=contextPath+"/rest/whatsnew/1.0/show";l.ajax({url:n,data:{},type:o?"POST":"DELETE",success:function(){AJS.log("whatsnew > toggleDontShow > isWelcomeDialogShownForUser set to: "+o)}})},d=function(){if(!c){return}g&&clearTimeout(g);f();AJS.setVisible(c,true)},j=function(o,q){var r;var p=new AJS.Dialog({width:855,height:545,id:"whats-new-dialog",onCancel:function(){p.hide().remove();g&&clearTimeout(g)}});r=o.frameSrc;if(typeof(r)=="undefined"||r===""){r=o.fullLink}var s="What\u2019s New in JIRA";p.addHeader(s);var n=JIRA.Templates.WhatsNew.whatsNewDialogPanel({whatsNewHelpLink:r,whatsNewFullLink:AJS.Meta.get("whatsnew-full-link")});p.addPanel("default",n);p.addCancel("Close",function(){p.hide().remove();g&&clearTimeout(g);return false});a=p.popup.element;if(o.remoteUser){p.page[p.curpage].buttonpanel.append(JIRA.Templates.WhatsNew.whatsNewDialogTipPanel({isOnDemand:AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.CoreFeatures.ON_DEMAND"),dontShowAgain:(!q)}));a.find("#dont-show-whats-new").change(k)}c=a.find("iframe");c.load(d);m=a.find(".whats-new-timeout");return p},f=function(){if(h){h();h=null}e.addClass("hidden")},b=function(){l.getJSON(contextPath+"/rest/whatsnew/1.0/dialog",function(n){l.getJSON(contextPath+"/rest/whatsnew/1.0/show",function(o){j(n,o.isShownForUser).show();e=a.find(".whats-new-throbber.hidden");e.removeClass("hidden");h=Raphael.spinner(e[0],80,"#666")});g=setTimeout(function(){c=null;f();AJS.setVisible(m,true)},10000)})};i.click(function(n){n.preventDefault();b()});if(AJS.Meta.getBoolean("show-whats-new")){AJS.Popups.DisplayController.request({name:"jira-whats-new-dialog",weight:100,show:function(){b()}})}});;
;/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:welcome-screen-resources', location = 'templates/welcome.soy' */
// This file was automatically generated from welcome.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.WelcomeScreen == 'undefined') { JIRA.Templates.WelcomeScreen = {}; }


JIRA.Templates.WelcomeScreen.welcomeScreenPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-group"><div class="welcome-screen-splash aui-item"><h1><span class="assistive">JIRA</span></h1></div><div class="welcome-screen-content-container aui-item"><div class="welcome-screen-content">', (opt_data.theirName) ? '<h1>' + soy.$$escapeHtml(AJS.format("Welcome, {0}!",opt_data.theirName)) + '</h1>' : '<h1>' + soy.$$escapeHtml("Welcome!") + '</h1>', '<p>', soy.$$escapeHtml("To begin working with JIRA, you need to create a project."), '</p><ul class="welcome-screen-options aui-group"><li class="aui-item">');
  JIRA.Templates.WelcomeScreen.welcomeScreenAction({type: 'demoproject', href: '/secure/CreateDemoProject.jspa?atl_token=' + opt_data.atl_token, title: "Start with a demo project", description: "Get started with a pre-populated project to get an idea of what you can do in JIRA.", cssClass: ''}, output);
  output.append('</li><li class="aui-item">');
  JIRA.Templates.WelcomeScreen.welcomeScreenAction({type: 'blankproject', href: '/secure/admin/AddProject!default.jspa?nextAction=browseprojects', title: "Create a blank project", description: "Start with an empty project to begin managing your issues.", cssClass: 'add-project-trigger'}, output);
  output.append('</li></ul></div><div class="welcome-screen-alternate-options"><p>', AJS.format("{0}I\x27\x27ll skip this{1}, I know what I\x27\x27m doing.",opt_data.cancelLinkHtml,'</a>'), '</p></div></div></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.WelcomeScreen.welcomeScreenAction = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class="welcome-screen-action ', soy.$$escapeHtml(opt_data.cssClass), '" data-type="', soy.$$escapeHtml(opt_data.type), '" href="', soy.$$escapeHtml(""), soy.$$escapeHtml(opt_data.href), '"><h3>', soy.$$escapeHtml(opt_data.title), '</h3>', (opt_data.description) ? '<p>' + soy.$$escapeHtml(opt_data.description) + '</p>' : '', '</a>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.welcome.jira-welcome-plugin:welcome-screen-resources', location = 'js/welcome.js' */
(function(d){var c=contextPath+"/rest/welcome/1.0/show/welcome",b=contextPath+"/rest/welcome/1.0/show/browseprojects",e="welcome-screen-cancel-trigger";function a(){return JIRA.Templates.WelcomeScreen.welcomeScreenPanel({theirName:AJS.Meta.get("remote-user-fullname")||"",cancelLinkHtml:'<a class="'+e+'" href="'+contextPath+'/">',atl_token:atl_token()})}JIRA.Dialogs.demoProject=new JIRA.FormDialog({id:"demo-project-dialog",trigger:"a.welcome-screen-action[data-type='demoproject']",stayVisibleOnRedirect:true,onContentRefresh:function(){jQuery(".overflow-ellipsis").textOverflow()}});d(document).bind("focusShifterTip.show",function(f){if(AJS.Meta.getBoolean("suppress-focus-shifter-tip")){f.preventDefault()}});AJS.toInit(function(j){var g;var f=function(){var k=new AJS.Dialog({width:860,height:500,id:"welcome-dialog",onCancel:function(){}});k.addPanel("default",a());JIRA.bind("Dialog.beforeHide",i);j("a",k.popup.element).click(function(l){JIRA.unbind("Dialog.beforeHide",i)});j("."+e,k.popup.element).click(h);j(".welcome-screen-action",k.popup.element).click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"welcomescreen.action",properties:{type:this.getAttribute("data-type")}});j.ajax({url:c,type:"DELETE",success:function(){AJS.log("welcome dialog > action clicked > don't show dialog anymore")}});k.hide().remove()});return k},i=function(k){if(JIRA.Dialog&&JIRA.Dialog.current&&g&&JIRA.Dialog.current.$popup==g.popup.element){k.preventDefault()}},h=function(k){k.preventDefault();g.hide().remove();AJS.EventQueue&&AJS.EventQueue.push({name:"welcomescreen.dismiss"});j.ajax({url:c,type:"DELETE",success:function(){AJS.log("welcome dialog > don't show dialog anymore")}})};if(AJS.Meta.getBoolean("show-welcome-screen")){}j(".browse-projects-info-dismiss").click(function(){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectsinfo.dismisstext"});j.ajax({url:b,type:"DELETE",success:function(){AJS.log("browse projects > dismiss clicked > don't show info panel anymore")}});j("#browse-projects-info").fadeOut()});AJS.bind("messageClose",function(l,k){if(k.attr("id")=="browse-projects-info"){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectsinfo.closebutton"});j.ajax({url:b,type:"DELETE",success:function(){AJS.log("browse projects > close button clicked > don't show info panel anymore")}})}})})})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'path.js' */
(function(){AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.basename=function(a){return a.split(/\//).pop()};JIRA.AttachImagesPlugin.dirname=function(a){var b=JIRA.AttachImagesPlugin.basename(a);return a.substring(0,a.length-b.length)}})();;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'resource-uris.js' */
(function(){AJS.namespace("JIRA.AttachImagesPlugin");var a=null,b="com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources.resource-uris";JIRA.AttachImagesPlugin.resourceUris={_resetForTesting:function(){a=null},get:function(c){if(a===null){a=WRM.data.claim(b)||{}}return a[c]}}})();;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'templates/soy/attach-screenshot-form.soy' */
// This file was automatically generated from attach-screenshot-form.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Html5Screenshot == 'undefined') { JIRA.Templates.Html5Screenshot = {}; }


JIRA.Templates.Html5Screenshot.attachScreenshotForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2 class="dialog-title">', soy.$$escapeHtml("Attach Screenshot"), '</h2><form action="ShowAttachScreenshotFormAction.jspa" class="aui" method="post" id="attach-screenshot-form" data-attach-secure-token="', soy.$$escapeHtml(opt_data.attachUserToken), '" data-submit-secure-token="', soy.$$escapeHtml(opt_data.submitUserToken), '"><input type="hidden" name="id" value="', soy.$$escapeHtml(opt_data.id), '"/><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '"><input type="hidden" name="formToken" value="', soy.$$escapeHtml(opt_data.formToken), '"><input type="hidden" name="filetoconvert" value=""><div class="attach-screenshot-padding"><div class="attach-screenshot-container"><div id="attach-screenshot-inner-container"><div class="mod-content"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Take a screenshot:"), '</dt>', (opt_data.userPlatform == 'pc') ? '<dd>' + "\x3ckbd\x3ePrtScn\x3c/kbd\x3e" + '</dd>' : '<dd>' + "\x3ckbd\x3e\x26#8963; Ctrl\x3c/kbd\x3e + \x3ckbd\x3e\x26#8984; Cmd\x3c/kbd\x3e + \x3ckbd\x3e\x26#8679; Shift\x3c/kbd\x3e + \x3ckbd\x3e3\x3c/kbd\x3e" + '</dd>', '</dl></li><li><dl><dt>', soy.$$escapeHtml("Paste the image:"), '</dt>', (opt_data.userPlatform == 'pc') ? '<dd>' + "\x3ckbd\x3eCtrl\x3c/kbd\x3e + \x3ckbd\x3ev\x3c/kbd\x3e" + '</dd>' : '<dd>' + "\x3ckbd\x3e\x26#8984; Cmd\x3c/kbd\x3e + \x3ckbd\x3ev\x3c/kbd\x3e" + '</dd>', '</dl></li></ul></div><input type="text" id="attach-screenshot-fake-input"><div class="attach-screenshot-padding attach-screenshot-padding-inner"><div id="attach-screenshot-image-container" class="attach-screenshot-image-container"><div class="attach-screenshot-placeholder"><div class="mod-content"><ul class="item-details"><li><dl><dt id="attach-screenshot-placeholder-message">', soy.$$escapeHtml("Your image will be pasted here"), '</dt></dl></li></ul></div></div></div></div><div id=\'attach-max-size\' class="hidden">', soy.$$escapeHtml(opt_data.maxSize), '</div></div></div></div><fieldset><div><legend><span>', soy.$$escapeHtml("Attach Screenshot"), '</span></legend><div id="attach-screenshot-filename-group" class="field-group"><div id="attach-screenshot-progress-container"></div><label for="attachscreenshotname">', soy.$$escapeHtml("File name"), ' <span class="aui-icon icon-required">', soy.$$escapeHtml("Required"), '</span></label><input class="text" type="text" id="attachscreenshotname" name="attachscreenshotname" title="File Name" value="', soy.$$escapeHtml(opt_data.nextScreenshotName), '"><div class="description">', soy.$$escapeHtml("A file name to be used as attached image name"), '</div></div></div></fieldset><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button" id="attach-screenshot-html5-upload">', soy.$$escapeHtml("Upload"), '</button><a href="#" class="cancel">', soy.$$escapeHtml("Cancel"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'base64decode.js' */
(function(){AJS.namespace("JIRA.AttachImagesPlugin");function a(b){return b>64&&b<91?b-65:b>96&&b<123?b-71:b>47&&b<58?b+4:b===43?62:b===47?63:0}JIRA.AttachImagesPlugin.base64decode=function(d){var k=d.replace(/[^A-Za-z0-9\+\/]/g,""),e=k.length,b=e*3+1>>2,i=new Uint8Array(b);for(var h,f,g=0,c=0,j=0;j<e;j++){f=j&3;g|=a(k.charCodeAt(j))<<18-6*f;if(f===3||e-j===1){for(h=0;h<3&&c<b;h++,c++){i[c]=g>>>(16>>>h&24)&255}g=0}}return i}})();;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'utility.js' */
(function(a){AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.isPasteEvent=function(e,b){var c=86,d=(b||navigator.platform).indexOf("Mac")!==-1;return e.which===c&&(d?e.metaKey:e.ctrlKey)};JIRA.AttachImagesPlugin.browserIsSupported=function(b){var d=document.documentElement.className.split(/\s+/),e=(b||navigator.platform).indexOf("Mac")!==-1,c=a.inArray("safari",d)!==-1;return !(e&&c)}})(jQuery);;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'requireDeployJava.js' */
AJS.namespace("JIRA.AttachImagesPlugin");(function(b){var a=null;JIRA.AttachImagesPlugin.requireDeployJava=function(){var c;if(a!==null){return a}c=b.Deferred();a=c.promise();b('<iframe style="display: none !important; visibility: hidden !important; opacity: 0"/>').attr("src",JIRA.AttachImagesPlugin.resourceUris.get("deployJava.html")).one("load",function(){c.resolve(this.contentWindow.deployJava,this.contentWindow)}).one("error",c.reject.bind(c)).appendTo("body");return a};JIRA.AttachImagesPlugin.requireDeployJava._resetForTesting=function(){a=null}})(AJS.$);;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'polyfill.js' */
(function(e,b){AJS.namespace("JIRA.AttachImagesPlugin");var f,d,g,c;function a(){var h=e.Deferred();return h.reject.apply(h,arguments)}(function(){var j=document.documentElement.className.split(/\s+/),l=e.inArray("msie",j)>-1,m=e.inArray("msie-gt-7",j)>-1,k=e.inArray("msie-gt-8",j)>-1,i=e.inArray("msie-gt-9",j)>-1,h=e.inArray("msie-gt-10",j)>-1;f=l&&m&&!k;d=l&&k&&!i;g=l&&i&&!h})();JIRA.AttachImagesPlugin.polyfill=new (function(){var i;var j=b.bind(function(m){if(JIRA.AttachImagesPlugin.isPasteEvent(m)){c.reload();var l=c.getClipboardData();if(l){var k=c.getClipboardData(this.pasteImageWidth,this.pasteImageHeight);if(k.length>this.dataURILimit){var n=this.dataURILimit/k.length;k=c.getClipboardData(this.pasteImageWidth*n,this.pasteImageHeight*n)}i.trigger("polyPaste",[l,k])}}},this);this.install=b.once(function(k){i=e(k);return JIRA.AttachImagesPlugin.requireDeployJava().pipe(function(o,l){var n,r,m,p="1.7.0_06",q;if(o.getJREs().length===0){return a("java-absent")}else{if(!o.versionCheck(p+"+")){return a("java-version")}}m=!o.versionCheck("1.7.0_45+");q=JIRA.AttachImagesPlugin.resourceUris.get(m?"clipboard-legacy.jar":"clipboard.jar");n={id:"JIRA HTML5 Images Applet",codebase:JIRA.AttachImagesPlugin.dirname(q),code:"com.atlassian.plugins.jira.screenshot.applet.ScreenshotApplet.class",archive:JIRA.AttachImagesPlugin.basename(q),width:0,height:0};r={permissions:"all-permissions"};o.runApplet(n,r,p);c=l.document.getElementById(n.id);try{if(!c||!c.isSecurityOk()){return a("java-security")}}catch(s){return a("java-security")}i.on("keydown",j);return h},function(){return a("unknown")}).pipe(null,function(m){var l;if(m==="unknown"){l="A problem occurred while running Java."}else{if(m==="java-version"){l=AJS.format("You need to {0}upgrade Java{1}.",'<a href="//java.com">',"</a>")}else{if(m==="java-absent"){l=AJS.format("You need to install {0}Java{1}.",'<a href="//java.com">',"</a>")}else{if(m==="java-security"){l=AJS.format("Your Java security settings are blocking this feature. Please upgrade to the latest {0}Java{1}.",'<a href="//java.com">',"</a>")}}}}return a(m,l)})});this.isRequired=function(){return f||d||g};this.isRequiredForBinaryAjax=function(){return f||d};this.pasteImageWidth=510;this.pasteImageHeight=280;this.dataURILimit=f?32000:Number.MAX_VALUE;function h(n,l){var m=document.cookies,k=e.Deferred();c.doMultipartRequest(l,"UTF-8",window.navigator.userAgent,k);k.always(function(){document.cookies=m});return k}this.proxyAjaxRequest=function(k,l){return function(){var m=JIRA.SmartAjax.makeRequest;JIRA.SmartAjax.makeRequest=function(n){var o=b.reduce(b.keys(n.data),function(s,q){s.push(q,n.data[q]);return s},[]);o.push("secureToken",l());var p=c.doAjaxRequest(n.url,"UTF-8",window.navigator.userAgent,e.Deferred(),o);p.abort=e.noop;p.then(function(s){var r=b.filter(arguments,function(w,v){return v>0});r[0]="Status";r=b.reduce(b.reduce(r,function(y,x,v){var w=(v/2)<<0;(y[w]||(y[w]=[])).push(x);return y},[]),function(w,v){w[v[0]]=v[1];return w},{});var t={getResponseHeader:function(v){return r[v]}};var u="success";var q=new JIRA.SmartAjax.SmartAjaxResult(t,0,"success",s,true);n.complete(t,u,q)});return p};k.apply(this,arguments);JIRA.SmartAjax.makeRequest=m}}})})(AJS.$,_);;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'html5.js' */
AJS.namespace("JIRA.AttachImagesPlugin");JIRA.AttachImagesPlugin.handler=(function(){var a;AJS.EventQueue=AJS.EventQueue||[];a={REQUEST_TIMEOUT_MILLIS:5*60*1000,screenshotFileUpload:{},screenshotFileUploadUri:null,$document:undefined,$window:undefined,$container:undefined,$fakeInput:undefined,uploadError:false,uploadErrorMsg:"",progressView:{hidden:false,progress:0,old:0,progressBarContainer:undefined,progressEl:undefined,container:undefined,options:undefined,staticProgress:undefined,initProgress:function(){this.container=this.buildContainer();this.progressEl=this.buildProgress();this.container.append(this.progressEl);this.options={showPercentage:false,height:"2px"};this.progressBarContainer=AJS.$("#attach-screenshot-progress-container");this.progressBarContainer.empty();this.progressBarContainer.append(this.container);this.staticProgress=this.container;this.hidden=true},finish:function(){this.value(100)},progressHandler:function(d){var c=Math.round(d.loaded*100/d.total);a.progressView.value(c)},value:function(c){if(c>100){c=100}else{if(c<0){c=0}}if(this.hidden){this.progressEl.show();this.hidden=false}if(this.old!==c){this.progressEl.progressBar(c,this.options);if(c>=100){this.progressEl.fadeOut()}this.old=c}},buildContainer:function(){return AJS.$("<div>").addClass("file-progress")},buildProgress:function(){return AJS.$("<div>").attr("id","attach-screenshot-upload-progress")}},dialogView:{pasteCatcher:{},presenter:undefined,getMaxSize:function(){return AJS.$("#attach-max-size").text()},getFileSize:function(){if(AJS.$.isPlainObject(this.presenter.screenshotFileUpload)&&_.isEmpty(this.presenter.screenshotFileUpload)){return 0}return this.presenter.screenshotFileUpload.size},cleanGeneralErrors:function(){AJS.$("#error-attach-screenshot-image").closest(".field-group").remove()},cleanFileErrors:function(){AJS.$("#error-attachScreenshotFileName").remove()},displayErrors:function(c){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if("compatibility" in c){AJS.$("#attach-screenshot-inner-container").before(aui.message.error({content:c.compatibility}))}if("fileName" in c){AJS.$("#attach-screenshot-filename-group").append('<div class="error" id="error-attach-screenshot-filename" data-field="attachscreenshotname">'+c.fileName+"</div>")}if("fileUpload" in c){AJS.$("#attach-screenshot-inner-container").append('<div class="field-group attach-screenshot-image-error"><div class="error" id="error-attach-screenshot-image">'+c.fileUpload+"</div></div>")}},appendBlobImage:function(c){var e=window.URL||window.webkitURL;var d=e.createObjectURL(c);this.presenter.screenshotFileUpload=c;this.createImage(d)},createImage:function(f){var d=new Image();d.onload=function(){};d.src=f;this.presenter.screenshotToUpload=d;var e=AJS.$(d);e.addClass("attach-screenshot-pasted-image");var c=AJS.$("#attach-screenshot-image-container");c.empty();c.append(e);this.presenter.$fakeInput.focus();a.imageCreatedHandler()},checkInput:function(){var d,c=a.dialogView.pasteCatcher.childNodes[0];if(c){if("IMG"===c.tagName){d=c.src}a.dialogView.pasteCatcher.innerHTML=""}if(!d){a.$fakeInput.focus()}return d},onPaste:function(e){a.dialogView.cleanFileErrors();a.dialogView.cleanGeneralErrors();if(e&&e.clipboardData&&e.clipboardData.items){var c=e.clipboardData.items;if(c){for(var d=0;d<c.length;d++){if(c[d].type.indexOf("image")!==-1){this.appendBlobImage(c[d].getAsFile())}}}}else{setTimeout(function(){var f=this.checkInput();if(f){a.screenshotFileUpload=a.decodeBase64DataUri(f);a.dialogView.createImage(f)}}.bind(this),0)}},getFakeInput:function(){return AJS.$("#attach-screenshot-fake-input")},getContainer:function(){return AJS.$("#attach-screenshot-image-container")},getIssueKey:function(){return AJS.$("input[name='id']").val()},getDocument:function(){return AJS.$(document)},getWindow:function(){return AJS.$(window)},getFileNameInput:function(){return AJS.$("#attachscreenshotname")},hasPngExtension:function(d){var c=/\.png$/i;return c.test(d)},setFileToConvert:function(c){AJS.$("input[name='filetoconvert']").val(c)},buildPasteCatcher:function(){if(!document.getElementById("attach-screenshot-form")){return}var c=document.createElement("div");c.setAttribute("contenteditable","true");c.style.width=0;c.style.height=0;c.style.position="absolute";c.style.top="-5000px";document.getElementById("attach-screenshot-form").appendChild(c);return c},_getFormSubmits:function(){return AJS.$("#attach-screenshot-form").find("button.aui-button")},disable:function(){this._getFormSubmits().attr("disabled","disabled");return this},enable:function(){this._getFormSubmits().removeAttr("disabled");return this},isEnabled:function(){return !this._getFormSubmits().attr("disabled")},initDialog:function(c){this.pasteCatcher={};this.presenter=c;if(!JIRA.AttachImagesPlugin.polyfill.isRequired()){this.pasteCatcher=this.buildPasteCatcher()}}},initScreenshotPasteHandler:function(){var c=a.dialogView;a.screenshotFileUpload={};a.resetUploadErrors();a.dialogView.initDialog(a.getPresenter());a.$document=c.getDocument();a.$window=c.getWindow();a.$container=c.getContainer();a.$fakeInput=c.getFakeInput();a.bindOnce(a.$container,"click",a.setFocusOnClickHandler);a.bindOnce(a.$fakeInput,"focus",a.showFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"blur",a.hideFocusOnFieldHandler);a.bindOnce(a.$fakeInput,"keydown",a.keyDownHandler);if(!JIRA.AttachImagesPlugin.browserIsSupported()){c.displayErrors({compatibility:AJS.format("Your browser is not supported. Consider using an alternative supported browser such as {0}Google Chrome{1} or {2}Firefox{3}.",'<a href="//www.google.com/chrome/browser/">',"</a>",'<a href="//www.mozilla.org/firefox/">',"</a>")})}else{if(JIRA.AttachImagesPlugin.polyfill.isRequired()){JIRA.AttachImagesPlugin.polyfill.install(document).done(function(d){a.bindOnce(a.$document,"polyPaste",a.polyPasteHandler);if(JIRA.AttachImagesPlugin.polyfill.isRequiredForBinaryAjax()){a.executeAjaxUpload=d}}).fail(function(e,d){c.displayErrors({compatibility:d})})}else{a.bindOnce(a.$window,"paste",a.pasteHandler)}}},resetUploadErrors:function(){a.uploadError=false;a.uploadErrorMsg=undefined},setUploadError:function(c){a.uploadError=true;a.uploadErrorMsg=c},bindOnce:function(e,c,d){e.unbind(c,d);e.bind(c,d)},showFocusOnFieldHandler:function(){a.$container.addClass("focus")},hideFocusOnFieldHandler:function(){a.$container.addClass("focus")},setFocusOnClickHandler:function(){a.$fakeInput.focus()},pasteHandler:function(c){if(!a.dialogView.isEnabled()){return}a.dialogView.onPaste(c.originalEvent)},polyPasteHandler:function(d,c,e){if(!a.dialogView.isEnabled()){return}a.screenshotFileUpload={length:0};a.screenshotFileUploadUri=c;a.dialogView.createImage(e)},keyDownHandler:function(c){if(JIRA.AttachImagesPlugin.isPasteEvent(c)){if(a.dialogView.pasteCatcher.focus){a.dialogView.pasteCatcher.focus()}}},getPresenter:function(){return a},imageCreatedHandler:function(){a.doAjaxUpload(this.dialogView.getIssueKey())},getMimeType:function(){if(a.screenshotFileUploadUri){return"image/jpeg"}return"image/png"},createData:function(){if(JIRA.AttachImagesPlugin.polyfill.isRequired()&&!JIRA.AttachImagesPlugin.polyfill.isRequiredForBinaryAjax()){return this.decodeBase64DataUri(a.screenshotFileUploadUri)}return a.screenshotFileUpload},hasCharacter:function(d,e){return d.indexOf(e)!=-1},decodeBase64DataUri:function(d){var f=";base64,",e=d.slice(0,d.indexOf(f))+f,c=d.substring(e.length);return JIRA.AttachImagesPlugin.base64decode(c)},validateFileSize:function(f){var c=a.dialogView.getFileSize();var e=a.dialogView.getMaxSize();if(c>e){var d=AJS.InlineAttach.Text.fileSize(e,c);f.fileUpload=AJS.format("Screenshot is too large to attach. Attachment is {0} but the largest allowed attachment is {1}.",d[1],d[0])}},validateFormData:function(c,e){var d={};if(AJS.$.isPlainObject(c)&&_.isEmpty(c)){d.fileUpload="Please paste the image you wish to upload"}a.validateFileSize(d);if(a.uploadError){d.fileUpload="The error occurred during image upload - you will need to try the pasting image again. Sorry for the inconvenience."}if(""==e){d.fileName="You must specify a filename of the image."}if(this.hasCharacter(e,"\\")||this.hasCharacter(e,"/")||this.hasCharacter(e,'"')||this.hasCharacter(e,":")||this.hasCharacter(e,"?")||this.hasCharacter(e,"*")||this.hasCharacter(e,"<")||this.hasCharacter(e,"|")||this.hasCharacter(e,">")){d.fileName="Filename must not contain the characters \'\\\', \'/\', \'\"\', \':\', \'?\', \'*\', \'\u003c\', \'|\', \'\u003e\'"}return d},doAjaxUpload:function(c,j){a.dialogView.disable();var i=[];a.validateFileSize(i);if(!_.isEmpty(i)){a.dialogView.displayErrors(i);a.dialogView.enable();return}var g=a.createData(),h=a.getMimeType(),e=AJS.$("#attach-screenshot-form").data("attach-secure-token"),d=AJS.$("#attach-screenshot-form").find("input[name='formToken']").attr("value");var f=AJS.contextPath()+"/rest/internal/1.0/AttachTemporaryFile"+(JIRA.AttachImagesPlugin.polyfill.isRequired()?"/secure?":"?")+"filename="+encodeURIComponent(j)+"&atl_token="+encodeURIComponent(atl_token())+"&issueId="+encodeURIComponent(this.dialogView.getIssueKey())+(e?("&secureToken="+encodeURIComponent(e)):"")+(d?("&formToken="+encodeURIComponent(d)):"");a.resetUploadErrors();a.executeAjaxUpload(g,f,h).progress(function(k){if(k=="init"){a.progressView.initProgress()}}).done(function(k){if(typeof k=="string"){k=JSON.parse(k)}a.dialogView.setFileToConvert(k.id)}).fail(function(m,o,n,k){var l;if(k.statusText=="abort"){l="The call to the JIRA server did not complete within the timeout period.  We are unsure of the result of this operation."}else{l=JIRA.SmartAjax.buildSimpleErrorContent(k,{alert:false})}a.setUploadError(l);a.dialogView.displayErrors({fileUpload:l})}).always(function(){var k=AJS.$.Deferred();if(JIRA.AttachImagesPlugin.polyfill.isRequired()){a.reloadSecureToken(k)}else{k.resolve()}k.then(function(){a.dialogView.enable();a.progressView.finish()})}).progress(function(k){if(k!="init"){a.progressView.progressHandler(k)}})},executeAjaxUpload:function(e,d,f){var c=AJS.$.Deferred();JIRA.SmartAjax.makeRequest({type:"POST",url:d,contentType:f,processData:false,data:e,timeout:a.REQUEST_TIMEOUT_MILLIS,success:c.resolve.bind(c),error:c.reject.bind(c),xhr:function(){var g=AJS.$.ajaxSettings.xhr();c.notify("init");g.upload.addEventListener("progress",c.notify.bind(c));return g}});c.always(function(){AJS.$.ajaxSettings.xhr().removeEventListener("progress",a.progressView.progressHandler)});return c},reloadSecureToken:function(c){var d=AJS.contextPath()+"/secure/ShowAttachScreenshotFormAction!default.jspa?id="+encodeURIComponent(this.dialogView.getIssueKey())+"&inline=true&decorator=dialog&_="+(new Date().getTime());AJS.$.get(d).then(function(e){var f=AJS.$(e).find("#attach-screenshot-form").data("attach-secure-token");if(f){AJS.$("#attach-screenshot-form").data("attach-secure-token",f);c.resolve(f)}else{c.reject()}},_.bind(c.reject,c))}};var b=JIRA.FormDialog.extend({options:{}});JIRA.ScreenshotDialog=b;AJS.$(document).ready(function(){var d=AJS.$.Deferred();if(!JIRA.AttachImagesPlugin.browserIsSupported()||!JIRA.AttachImagesPlugin.polyfill.isRequired()){d.resolve()}JIRA.Dialogs.attachScreenshotDialog=new b({id:"attach-screenshot-dialog",trigger:"a.issueaction-attach-screenshot-html5",isIssueDialog:true,onContentRefresh:function c(){this.$form.bind("before-submit",function e(f){var g=a.validateFormData(a.screenshotFileUpload,AJS.$.trim(a.dialogView.getFileNameInput().val()));if(a.dialogView.getFileSize()==0){f.preventDefault();return false}else{if(!_.isEmpty(g)){a.dialogView.displayErrors(g);f.preventDefault();return false}}return true})},delayShowUntil:function(){if(JIRA.AttachImagesPlugin.polyfill.isRequired()){JIRA.AttachImagesPlugin.polyfill.install(document).done(function(){b.prototype._submitForm=JIRA.AttachImagesPlugin.polyfill.proxyAjaxRequest(b.prototype._submitForm,function(){return AJS.$("#attach-screenshot-form").data("submit-secure-token")})}).always(function(){d.resolve()})}return d}});AJS.$(document).bind("dialogContentReady",function(f,e){if(e===JIRA.Dialogs.attachScreenshotDialog&&document.getElementById("attach-screenshot-form")!==null){a.initScreenshotPasteHandler()}});AJS.$(document).ready(function(){AJS.$(document).on("click","#attach-screenshot-html5",function(){AJS.EventQueue.push({name:"attach.screenshot.html5.display",properties:{}})})})});return a})();;
;/* module-key = 'com.atlassian.plugins.jira-html5-attach-images:jira-html5-attach-images-resources', location = 'applet/deployJava.js' */
var deployJava=function(){var l={core:["id","class","title","style"],i18n:["lang","dir"],events:["onclick","ondblclick","onmousedown","onmouseup","onmouseover","onmousemove","onmouseout","onkeypress","onkeydown","onkeyup"],applet:["codebase","code","name","archive","object","width","height","alt","align","hspace","vspace"],object:["classid","codebase","codetype","data","type","archive","declare","standby","height","width","usemap","name","tabindex","align","border","hspace","vspace"]};var b=l.object.concat(l.core,l.i18n,l.events);var m=l.applet.concat(l.core);function g(o){if(!d.debug){return}if(console.log){console.log(o)}else{alert(o)}}function k(p,o){if(p==null||p.length==0){return true}var r=p.charAt(p.length-1);if(r!="+"&&r!="*"&&(p.indexOf("_")!=-1&&r!="_")){p=p+"*";r="*"}p=p.substring(0,p.length-1);if(p.length>0){var q=p.charAt(p.length-1);if(q=="."||q=="_"){p=p.substring(0,p.length-1)}}if(r=="*"){return(o.indexOf(p)==0)}else{if(r=="+"){return p<=o}}return false}function e(){var o="//java.com/js/webstart.png";try{return document.location.protocol.indexOf("http")!=-1?o:"http:"+o}catch(p){return"http:"+o}}function n(p){var o="http://java.com/dt-redirect";if(p==null||p.length==0){return o}if(p.charAt(0)=="&"){p=p.substring(1,p.length)}return o+"?"+p}function j(q,p){var o=q.length;for(var r=0;r<o;r++){if(q[r]===p){return true}}return false}function c(o){return j(m,o.toLowerCase())}function i(o){return j(b,o.toLowerCase())}function a(o){if("MSIE"!=deployJava.browserName){return true}if(deployJava.compareVersionToPattern(deployJava.getPlugin().version,["10","0","0"],false,true)){return true}if(o==null){return false}return !k("1.6.0_33+",o)}var d={debug:null,version:"20120801",firefoxJavaVersion:null,myInterval:null,preInstallJREList:null,returnPage:null,brand:null,locale:null,installType:null,EAInstallEnabled:false,EarlyAccessURL:null,oldMimeType:"application/npruntime-scriptable-plugin;DeploymentToolkit",mimeType:"application/java-deployment-toolkit",launchButtonPNG:e(),browserName:null,browserName2:null,getJREs:function(){var t=new Array();if(this.isPluginInstalled()){var r=this.getPlugin();var o=r.jvms;for(var q=0;q<o.getLength();q++){t[q]=o.get(q).version}}else{var p=this.getBrowser();if(p=="MSIE"){if(this.testUsingActiveX("1.7.0")){t[0]="1.7.0"}else{if(this.testUsingActiveX("1.6.0")){t[0]="1.6.0"}else{if(this.testUsingActiveX("1.5.0")){t[0]="1.5.0"}else{if(this.testUsingActiveX("1.4.2")){t[0]="1.4.2"}else{if(this.testForMSVM()){t[0]="1.1"}}}}}}else{if(p=="Netscape Family"){this.getJPIVersionUsingMimeType();if(this.firefoxJavaVersion!=null){t[0]=this.firefoxJavaVersion}else{if(this.testUsingMimeTypes("1.7")){t[0]="1.7.0"}else{if(this.testUsingMimeTypes("1.6")){t[0]="1.6.0"}else{if(this.testUsingMimeTypes("1.5")){t[0]="1.5.0"}else{if(this.testUsingMimeTypes("1.4.2")){t[0]="1.4.2"}else{if(this.browserName2=="Safari"){if(this.testUsingPluginsArray("1.7.0")){t[0]="1.7.0"}else{if(this.testUsingPluginsArray("1.6")){t[0]="1.6.0"}else{if(this.testUsingPluginsArray("1.5")){t[0]="1.5.0"}else{if(this.testUsingPluginsArray("1.4.2")){t[0]="1.4.2"}}}}}}}}}}}}}if(this.debug){for(var q=0;q<t.length;++q){g("[getJREs()] We claim to have detected Java SE "+t[q])}}return t},installJRE:function(r,p){var o=false;if(this.isPluginInstalled()&&this.isAutoInstallEnabled(r)){var q=false;if(this.isCallbackSupported()){q=this.getPlugin().installJRE(r,p)}else{q=this.getPlugin().installJRE(r)}if(q){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}}return q}else{return this.installLatestJRE()}},isAutoInstallEnabled:function(o){if(!this.isPluginInstalled()){return false}if(typeof o=="undefined"){o=null}return a(o)},isCallbackSupported:function(){return this.isPluginInstalled()&&this.compareVersionToPattern(this.getPlugin().version,["10","2","0"],false,true)},installLatestJRE:function(q){if(this.isPluginInstalled()&&this.isAutoInstallEnabled()){var r=false;if(this.isCallbackSupported()){r=this.getPlugin().installLatestJRE(q)}else{r=this.getPlugin().installLatestJRE()}if(r){this.refresh();if(this.returnPage!=null){document.location=this.returnPage}}return r}else{var p=this.getBrowser();var o=navigator.platform.toLowerCase();if((this.EAInstallEnabled=="true")&&(o.indexOf("win")!=-1)&&(this.EarlyAccessURL!=null)){this.preInstallJREList=this.getJREs();if(this.returnPage!=null){this.myInterval=setInterval("deployJava.poll()",3000)}location.href=this.EarlyAccessURL;return false}else{if(p=="MSIE"){return this.IEInstall()}else{if((p=="Netscape Family")&&(o.indexOf("win32")!=-1)){return this.FFInstall()}else{location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""))}}return false}}},runApplet:function(p,u,r){if(r=="undefined"||r==null){r="1.1"}var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(this.returnPage==null){this.returnPage=document.location}if(o!=null){var q=this.getBrowser();if(q!="?"){if(this.versionCheck(r+"+")){this.writeAppletTag(p,u)}else{if(this.installJRE(r+"+")){this.refresh();location.href=document.location;this.writeAppletTag(p,u)}}}else{this.writeAppletTag(p,u)}}else{g("[runApplet()] Invalid minimumVersion argument to runApplet():"+r)}},writeAppletTag:function(r,w){var o="<applet ";var q="";var t="</applet>";var x=true;if(null==w||typeof w!="object"){w=new Object()}for(var p in r){if(!c(p)){w[p]=r[p]}else{o+=(" "+p+'="'+r[p]+'"');if(p=="code"){x=false}}}var v=false;for(var u in w){if(u=="codebase_lookup"){v=true}if(u=="object"||u=="java_object"||u=="java_code"){x=false}q+='<param name="'+u+'" value="'+w[u]+'"/>'}if(!v){q+='<param name="codebase_lookup" value="false"/>'}if(x){o+=(' code="dummy"')}o+=">";document.write(o+"\n"+q+"\n"+t)},versionCheck:function(p){var v=0;var x="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?(\\*|\\+)?$";var y=p.match(x);if(y!=null){var r=false;var u=false;var q=new Array();for(var t=1;t<y.length;++t){if((typeof y[t]=="string")&&(y[t]!="")){q[v]=y[t];v++}}if(q[q.length-1]=="+"){u=true;r=false;q.length--}else{if(q[q.length-1]=="*"){u=false;r=true;q.length--}else{if(q.length<4){u=false;r=true}}}var w=this.getJREs();for(var t=0;t<w.length;++t){if(this.compareVersionToPattern(w[t],q,r,u)){return true}}return false}else{var o="Invalid versionPattern passed to versionCheck: "+p;g("[versionCheck()] "+o);alert(o);return false}},isWebStartInstalled:function(r){var q=this.getBrowser();if(q=="?"){return true}if(r=="undefined"||r==null){r="1.4.2"}var p=false;var t="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var o=r.match(t);if(o!=null){p=this.versionCheck(r+"+")}else{g("[isWebStartInstaller()] Invalid minimumVersion argument to isWebStartInstalled(): "+r);p=this.versionCheck("1.4.2+")}return p},getJPIVersionUsingMimeType:function(){for(var p=0;p<navigator.mimeTypes.length;++p){var q=navigator.mimeTypes[p].type;var o=q.match(/^application\/x-java-applet;jpi-version=(.*)$/);if(o!=null){this.firefoxJavaVersion=o[1];if("Opera"!=this.browserName2){break}}}},launchWebStartApplication:function(r){var o=navigator.userAgent.toLowerCase();this.getJPIVersionUsingMimeType();if(this.isWebStartInstalled("1.7.0")==false){if((this.installJRE("1.7.0+")==false)||((this.isWebStartInstalled("1.7.0")==false))){return false}}var u=null;if(document.documentURI){u=document.documentURI}if(u==null){u=document.URL}var p=this.getBrowser();var q;if(p=="MSIE"){q='<object classid="clsid:8AD9C840-044E-11D1-B3E9-00805F499D93" width="0" height="0"><PARAM name="launchjnlp" value="'+r+'"><PARAM name="docbase" value="'+u+'"></object>'}else{if(p=="Netscape Family"){q='<embed type="application/x-java-applet;jpi-version='+this.firefoxJavaVersion+'" width="0" height="0" launchjnlp="'+r+'"docbase="'+u+'" />'}}if(document.body=="undefined"||document.body==null){document.write(q);document.location=u}else{var t=document.createElement("div");t.id="div1";t.style.position="relative";t.style.left="-10000px";t.style.margin="0px auto";t.className="dynamicDiv";t.innerHTML=q;document.body.appendChild(t)}},createWebStartLaunchButtonEx:function(q,p){if(this.returnPage==null){this.returnPage=q}var o="javascript:deployJava.launchWebStartApplication('"+q+"');";document.write('<a href="'+o+'" onMouseOver="window.status=\'\'; return true;"><img src="'+this.launchButtonPNG+'" border="0" /></a>')},createWebStartLaunchButton:function(q,p){if(this.returnPage==null){this.returnPage=q}var o="javascript:if (!deployJava.isWebStartInstalled(&quot;"+p+"&quot;)) {if (deployJava.installLatestJRE()) {if (deployJava.launch(&quot;"+q+"&quot;)) {}}} else {if (deployJava.launch(&quot;"+q+"&quot;)) {}}";document.write('<a href="'+o+'" onMouseOver="window.status=\'\'; return true;"><img src="'+this.launchButtonPNG+'" border="0" /></a>')},launch:function(o){document.location=o;return true},isPluginInstalled:function(){var o=this.getPlugin();if(o&&o.jvms){return true}else{return false}},isAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().isAutoUpdateEnabled()}return false},setAutoUpdateEnabled:function(){if(this.isPluginInstalled()){return this.getPlugin().setAutoUpdateEnabled()}return false},setInstallerType:function(o){this.installType=o;if(this.isPluginInstalled()){return this.getPlugin().setInstallerType(o)}return false},setAdditionalPackages:function(o){if(this.isPluginInstalled()){return this.getPlugin().setAdditionalPackages(o)}return false},setEarlyAccess:function(o){this.EAInstallEnabled=o},isPlugin2:function(){if(this.isPluginInstalled()){if(this.versionCheck("1.6.0_10+")){try{return this.getPlugin().isPlugin2()}catch(o){}}}return false},allowPlugin:function(){this.getBrowser();var o=("Safari"!=this.browserName2&&"Opera"!=this.browserName2);return o},getPlugin:function(){this.refresh();var o=null;if(this.allowPlugin()){o=document.getElementById("deployJavaPlugin")}return o},compareVersionToPattern:function(v,p,r,t){if(v==undefined||p==undefined){return false}var w="^(\\d+)(?:\\.(\\d+)(?:\\.(\\d+)(?:_(\\d+))?)?)?$";var x=v.match(w);if(x!=null){var u=0;var y=new Array();for(var q=1;q<x.length;++q){if((typeof x[q]=="string")&&(x[q]!="")){y[u]=x[q];u++}}var o=Math.min(y.length,p.length);if(t){for(var q=0;q<o;++q){if(y[q]<p[q]){return false}else{if(y[q]>p[q]){return true}}}return true}else{for(var q=0;q<o;++q){if(y[q]!=p[q]){return false}}if(r){return true}else{return(y.length==p.length)}}}else{return false}},getBrowser:function(){if(this.browserName==null){var o=navigator.userAgent.toLowerCase();g("[getBrowser()] navigator.userAgent.toLowerCase() -> "+o);if((o.indexOf("msie")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="MSIE";this.browserName2="MSIE"}else{if(o.indexOf("trident")!=-1||o.indexOf("Trident")!=-1){this.browserName="MSIE";this.browserName2="MSIE"}else{if(o.indexOf("iphone")!=-1){this.browserName="Netscape Family";this.browserName2="iPhone"}else{if((o.indexOf("firefox")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Firefox"}else{if(o.indexOf("chrome")!=-1){this.browserName="Netscape Family";this.browserName2="Chrome"}else{if(o.indexOf("safari")!=-1){this.browserName="Netscape Family";this.browserName2="Safari"}else{if((o.indexOf("mozilla")!=-1)&&(o.indexOf("opera")==-1)){this.browserName="Netscape Family";this.browserName2="Other"}else{if(o.indexOf("opera")!=-1){this.browserName="Netscape Family";this.browserName2="Opera"}else{this.browserName="?";this.browserName2="unknown"}}}}}}}}g("[getBrowser()] Detected browser name:"+this.browserName+", "+this.browserName2)}return this.browserName},testUsingActiveX:function(o){var q="JavaWebStart.isInstalled."+o+".0";if(typeof ActiveXObject=="undefined"||!ActiveXObject){g("[testUsingActiveX()] Browser claims to be IE, but no ActiveXObject object?");return false}try{return(new ActiveXObject(q)!=null)}catch(p){return false}},testForMSVM:function(){var p="{08B0E5C0-4FCB-11CF-AAA5-00401C608500}";if(typeof oClientCaps!="undefined"){var o=oClientCaps.getComponentVersion(p,"ComponentID");if((o=="")||(o=="5,0,5000,0")){return false}else{return true}}else{return false}},testUsingMimeTypes:function(p){if(!navigator.mimeTypes){g("[testUsingMimeTypes()] Browser claims to be Netscape family, but no mimeTypes[] array?");return false}for(var q=0;q<navigator.mimeTypes.length;++q){s=navigator.mimeTypes[q].type;var o=s.match(/^application\/x-java-applet\x3Bversion=(1\.8|1\.7|1\.6|1\.5|1\.4\.2)$/);if(o!=null){if(this.compareVersions(o[1],p)){return true}}}return false},testUsingPluginsArray:function(p){if((!navigator.plugins)||(!navigator.plugins.length)){return false}var o=navigator.platform.toLowerCase();for(var q=0;q<navigator.plugins.length;++q){s=navigator.plugins[q].description;if(s.search(/^Java Switchable Plug-in (Cocoa)/)!=-1){if(this.compareVersions("1.5.0",p)){return true}}else{if(s.search(/^Java/)!=-1){if(o.indexOf("win")!=-1){if(this.compareVersions("1.5.0",p)||this.compareVersions("1.6.0",p)){return true}}}}}if(this.compareVersions("1.5.0",p)){return true}return false},IEInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):""));return false},done:function(p,o){},FFInstall:function(){location.href=n(((this.returnPage!=null)?("&returnPage="+this.returnPage):"")+((this.locale!=null)?("&locale="+this.locale):"")+((this.brand!=null)?("&brand="+this.brand):"")+((this.installType!=null)?("&type="+this.installType):""));return false},compareVersions:function(r,t){var p=r.split(".");var o=t.split(".");for(var q=0;q<p.length;++q){p[q]=Number(p[q])}for(var q=0;q<o.length;++q){o[q]=Number(o[q])}if(p.length==2){p[2]=0}if(p[0]>o[0]){return true}if(p[0]<o[0]){return false}if(p[1]>o[1]){return true}if(p[1]<o[1]){return false}if(p[2]>o[2]){return true}if(p[2]<o[2]){return false}return true},enableAlerts:function(){this.browserName=null;this.debug=true},poll:function(){this.refresh();var o=this.getJREs();if((this.preInstallJREList.length==0)&&(o.length!=0)){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}if((this.preInstallJREList.length!=0)&&(o.length!=0)&&(this.preInstallJREList[0]!=o[0])){clearInterval(this.myInterval);if(this.returnPage!=null){location.href=this.returnPage}}},writePluginTag:function(){var o=this.getBrowser();if(o=="MSIE"){document.write('<object classid="clsid:CAFEEFAC-DEC7-0000-0001-ABCDEFFEDCBA" id="deployJavaPlugin" width="0" height="0" style="position: absolute; top: -5000px;"></object>')}else{if(o=="Netscape Family"&&this.allowPlugin()){this.writeEmbedTag()}}},refresh:function(){navigator.plugins.refresh(false);var o=this.getBrowser();if(o=="Netscape Family"&&this.allowPlugin()){var p=document.getElementById("deployJavaPlugin");if(p==null){this.writeEmbedTag()}}},writeEmbedTag:function(){var o=false;if(navigator.mimeTypes!=null){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.mimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+this.mimeType+'" hidden="true" />');o=true}}}if(!o){for(var p=0;p<navigator.mimeTypes.length;p++){if(navigator.mimeTypes[p].type==this.oldMimeType){if(navigator.mimeTypes[p].enabledPlugin){document.write('<embed id="deployJavaPlugin" type="'+this.oldMimeType+'" hidden="true" />')}}}}}}};d.writePluginTag();if(d.locale==null){var h=null;if(h==null){try{h=navigator.userLanguage}catch(f){}}if(h==null){try{h=navigator.systemLanguage}catch(f){}}if(h==null){try{h=navigator.language}catch(f){}}if(h!=null){h.replace("-","_");d.locale=h}}return d}();;
;/* module-key = 'is.origo.jira.tempo-plugin:tempo-bar', location = 'com/tempoplugin/js/tempo.bar.js' */
var tempobar=tempobar||{};tempobar=(function(i){var B='<span class="issue"><span class="image"><a><img width="16" height="16" border="0" align="absmiddle"></a></span><span class="key"><a></a></span><span id="issue-tracker-summary-id" class="summary"><a></a></span></span>';var d=contextPath+"/rest/api/2/issue/";var x=contextPath+"/secure/TempoAddHours!default.jspa";var n=1000;var D=null;var p=null;var f="Tempo.TRACKER_ISTRACKING_";var c="Tempo.TRACKER_PREV_DURATION_";var E="Tempo.TRACKER_CYCLE_START_";var H="Tempo.TRACKER_INITIAL_START_";var C="Tempo.TRACKER_ISSUE_ID_";var m="Tempo.TRACKER_PAUSED_";var o="Tempo.SHOW_TRACKER_";var F="Tempo.EXPAND_TRACKER_";var G;function s(J){return AJS.Cookie.read(J+AJS.params.loggedInUser)}function u(J,K){return AJS.Cookie.save(J+AJS.params.loggedInUser,K)}function t(J){return AJS.Cookie.erase(J+AJS.params.loggedInUser)}function b(){return s(f)==="true"&&Number(s(E))>0}function k(){return(s(m)==="true")}function w(){return(s(o)==="true")}function y(){return(s(F)==="true")}function r(){return Number(s(c))+(new Date().getTime()-new Date(Number(s(E))).getTime())/1000}function a(M,N){if(M===null||M===undefined||M<=0){return"0m"}var L=Math.round(M);var O=L%60;var K;var J=Math.floor(L/3600);if(N){K=Math.floor(L/60)%60}else{K=Math.round(L/60)%60;if(K===0){J=Math.round(L/3600)}}var P="";if(J>0){P=P+J+"h"}if(K>=0){if(J>0){P=P+" "}P=P+K+"m"}if(N&&O){P=P+" "+O+"s"}return P.toString()}function q(){if(k()){var J=Number(s(c));if(J===null||J===undefined){J=0}return J}return r()}function e(K){var J=d+K;i.get(J,function(L){G={id:L.id,key:L.key,iconUrl:L.fields.issuetype.iconUrl,href:contextPath+"/browse/"+L.key,summary:L.fields.summary};l()})}function l(){if(w()&&!AJS.params.printable){var L=D.find("span.clock");L.show().text(a(q(),true));var M=s(C);if(M&&!G){e(M)}else{if(M&&G){var J=D.find("span.issue");var K=J.find("img");K.attr("src",G.iconUrl);J.find("span a").attr("href",G.href);J.find("span.key a").text(G.key).attr("data-id",G.id);J.find("span.summary a").text(G.summary);J.find("span.summary a").attr("title",G.summary);J.show()}}D.show()}if(b()&&!k()){clearTimeout(p);p=setTimeout(function(){l()},n)}}function z(K){var J=i("<a>",{href:"#","class":"tracker-button button aui-button aui-button-subtle",text:"",title:K});J.prepend('<span class="label"></span>');J.prepend('<span class="icon"></span>');return J}function g(){i(document).click()}function j(){var J=jira.app.issue.getIssueId()||AJS.$(".tempo-bar-start").data("issueid");if(J){u(C,J)}G=null}function v(){t(f);t(H);t(E);t(c);t(C);t(m)}function I(){t(o);t(F);v()}function h(){if(y()){i("#tempo-bar").removeClass("tempo-bar-expanded");i("#tempo-tracker-slider-id").removeClass("tracker-expanded");i("#issue-tracker-summary-id").addClass("hidden-actions");i(".tracker-button span.label").text("");u(F,"false")}else{i("#tempo-bar").addClass("tempo-bar-expanded");i("#tempo-tracker-slider-id").addClass("tracker-expanded");i("#issue-tracker-summary-id").removeClass("hidden-actions");i(".play span.label").text("Start");i(".pause span.label").text("Pause");i(".stop span.label").text("Stop");u(F,"true")}}function A(){if(AJS.params.loggedInUser===""){return}var O=i("<div>").attr("id","tempo-bar");var K=i("<div>").attr("id","tempo-tracker-slider-id");var M=i("<a>").attr("title","View timesheets and log work").attr("href",contextPath+"/secure/TempoUserBoard!timesheet.jspa").addClass("tempo-bar-logo").text("TEMPO");O.append(K).append(M).hide();if(b()||k()){i(O).find("#tempo-bar").addClass("tempo-bar-expanded tracker-not-started");i(O).find("#tempo-tracker-slider-id").addClass("tempo-tracker-slider aui-button aui-button-subtle");if(y()){i(O).find("#tempo-tracker-slider-id").addClass("tracker-expanded")}}var L=i('<span id="tempo-tracker-clock-id" class="clock"></span>');if(!b()&&!y()){L.addClass("hide-clock")}L.appendTo(O);i("#tempo-tracker-slider-id").live("click",function(){h()});var J=i("<a>",{id:"tempo-bar-close",href:contextPath+"/secure/TempoTrackerConfirmation!default.jspa?returnUrl="+document.URL,"class":"tempoaction-open-dialog-form aui-button aui-button-subtle",text:"Close Tracker",title:"Close Tracker"});J.bind("click",function(){if(!b()){I();O.hide();return false}return true});J.appendTo(O);var R=i('<ul id="tempo-tracker-actions" class="action-buttons ops aui-buttons"></ul>');var N=z("Start Tracker");N.addClass("play first last");R.append(N);var Q=z("Pause Tracker");Q.addClass("pause first");R.append(Q);var S=z("Stop Tracker");S.addClass("stop issueaction-tempo-add-hours-on-issue last");R.append(S);N.bind("click",function(T){if(!b()){u(f,"true");u(H,new Date().getTime());u(E,new Date().getTime());u(c,"0");i("#tempo-tracker-clock-id").removeClass("hide-clock");i("#tempo-tracker-slider-id").addClass("tempo-tracker-slider aui-button aui-button-subtle");j();l()}else{u(E,new Date().getTime());t(m);l()}i(".play span.label").text("");Q.show();N.hide();S.show();T.preventDefault()});Q.bind("click",function(T){Q.hide();N.removeClass("last").show();if(b()){u(c,r());u(m,"true")}T.preventDefault()});S.bind("click",function(){if(b()){clearTimeout(p);var T=new Date(Number(s(H)));var U=x+"?tracker=true&systemTimeStamp="+T.getTime();l();if(G&&G.key){U+="&key="+G.key}S.attr("href",U+"&time="+a(q(),false));h();return true}return false});R.appendTo(O);var P=i(B).hide();P.appendTo(O);O.appendTo("body");if(!y()){i("#issue-tracker-summary-id").addClass("hidden-actions")}i("a.tempo-bar-show").click(function(){u(o,"true");i("#tempo-tracker-slider-id").removeClass("tempo-tracker-slider aui-button aui-button-subtle");l();g();return false});i("a.tempo-bar-start").live("click",function(){j();if(b()){l()}else{u(o,"true");N.trigger("click")}g();return false});D=O;if(b()&&!k()){Q.show();N.hide()}else{Q.hide();N.removeClass("last").show()}if(!b()){i(".play span.label").text("Start");S.hide();N.addClass("last")}l()}return{init:A,clearTracker:I,stopTracker:v}}(AJS.$));AJS.$(function(){tempobar.init()});;
;/* module-key = 'is.origo.jira.tempo-plugin:tempo-global', location = 'com/tempoplugin/js/tempo.global.js' */
var tempo=(function(x){var E="%e/%b/%y";var s="%e/%b/%y %H:%M";var n="Period is invalid";var d="You must be logged in to JIRA to perform this action. Session might have timed out!";var f="(|.*?(\\s+|\\())({0})(.*)";x.extend(x.expr[":"],{focus:function(M){return M==document.activeElement}});x.fn.fixDirtyForm=function(){x(this).addClass("ajs-dirty-warning-exempt");if(AJS.DIRTY_FORM_VALUE){return this.data(AJS.DIRTY_FORM_VALUE,null)}return this};x.fn.cleanFormValidation=function(){var M=x(this);var N=M.find("ul.error-list");M.find(":input:visible").removeClass("error-field").removeClass("valid");N.empty();return this};x.fn.resetFormFields=function(){var M=x(this);M.find(".resetable :checkbox").attr("checked",false);M.find(".resetable select, .resetable textarea, .resetable input[type=text]").val("");M.find(".enddate").hide();M.find("select.tempoDynamicDropDown").empty();M.find("select.tempoDynamicDropDown").attr("selectedValue","");return this};var C=AJS.SingleSelect.extend({submitForm:function(){if(!this.suggestionsVisible){this.handleFreeInput();if(this.options.submitHandler){this.options.submitHandler()}}},setFieldWidth:function(N,M){M=M||N;this.$container.css({width:N,minWidth:N});this.$field.width(N);this.dropdownController.$layer.css({width:M,minWidth:M})},setDropdownWidthForTimesheet:function(M){if(M&&M.timesheet&&this.$container){this.setFieldWidth(205,500)}}});x.fn.tempoFormatAccountPicker=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-account-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.type+"-"+this.key,label:this.name,html:this.html,allowDuplicate:false}))});N.push(S)})});return N};x.fn.tempoAccountPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/accounts/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatAccountPicker}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFilterPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/filters/picker",query:true,minQueryLength:1,data:O,formatResponse:function(R){var S=[];if(N&&N.timesheet){M.setDropdownWidthForTimesheet(N);var Q=new AJS.GroupDescriptor({weight:0,id:"tempo-default-suggested",replace:true});Q.addItem(new AJS.ItemDescriptor({value:"-1001",label:"User Timesheet",allowDuplicate:false}))}x(R).each(function(U,T){var V=new AJS.GroupDescriptor({weight:U+1,id:"tempo-report-filter-suggested-"+1,replace:true,label:"Filters"});x(T.filters).each(function(){var W=this.name;if(this.description){W+=" ("+this.description+")"}V.addItem(new AJS.ItemDescriptor({value:""+this.id,label:W,allowDuplicate:false}))});S.push(Q);S.push(V)});return S}}})};x.fn.tempoFormatAdvancedSearchResponse=function(M){var N=[];x(M).each(function(O,P){x(P.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){var T=new AJS.ItemDescriptor({value:""+this.id,label:this.name,html:this.html,allowDuplicate:false});S.addItem(T)});N.push(S)})});return N};x.fn.tempoAdvancedTimesheetPicker=function(N){var P=x(this);var O={};var M=new C({element:P,showDropdownButton:true,matchingStrategy:f,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/search/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatAdvancedSearchResponse}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFormatIssueResponse=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-issue-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.key,label:this.key+" - "+this.name,allowDuplicate:false,title:this.name,icon:contextPath+this.icon}))});N.push(S)})});return N};x.fn.tempoIssuePicker=function(O){var M;if(O!=null&&O.type!=null){M=O.type}else{M=""}var Q=x(this);var P={};var N=new C({submitHandler:O?O.submitHandler:null,element:Q,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/issues/picker/"+M,query:true,minQueryLength:1,data:P,formatResponse:x.fn.tempoFormatIssueResponse}});N.setDropdownWidthForTimesheet(O)};x.fn.tempoFormatProjectResponse=function(M){var N=[];x(M).each(function(P,O){x(O.group).each(function(R,Q){var S=new AJS.GroupDescriptor({weight:R,id:"tempo-report-project-search-"+R,replace:true,label:Q.title});x(Q.item).each(function(){S.addItem(new AJS.ItemDescriptor({value:this.id+"",label:this.name+" ("+this.key+")",html:this.html,icon:contextPath+this.icon,title:this.name,allowDuplicate:false}))});N.push(S)})});return N};x.fn.tempoSingleProjectPicker=function(N){var P=x(this);var O={};var M=new C({element:P,matchingStrategy:f,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/projects/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatProjectResponse}});M.setDropdownWidthForTimesheet(N)};x.fn.tempoFormatUserResponse=function(M){return[new AJS.GroupDescriptor({items:_.map(_.sortBy(M.users,"label"),function(N){return new AJS.ItemDescriptor({highlighted:true,html:N.html,label:N.displayName,value:""+N.name,title:N.displayName,icon:N.avatarUrl})})})]};x.fn.tempoSingleUserPicker=function(M){var N;if(M!=null&&M.type!=null){N=M.type}else{N=""}x(this).each(function(R){var Q=x(this);var P={showAvatar:true};var O=new C({submitHandler:M?M.submitHandler:null,element:Q,showDropdownButton:true,matchingStrategy:f,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/users/picker/"+N,query:true,minQueryLength:1,data:P,formatResponse:x.fn.tempoFormatUserResponse}});O.setDropdownWidthForTimesheet(M);Q.data("userPicker",O);Q.bind("change",function(){var T=Q.closest("form");var S=T.find(":input[name=user]").val();var V=T.find("input[name=date]");var U=T.find("input[name=enddate]");g(T,S,V,U)})})};x.fn.tempoFormatTeamResponse=function(M){var N=[];x(M).each(function(P,O){var Q=new AJS.GroupDescriptor({weight:P,id:"tempo-report-team-search",replace:true});x(O.teams).each(function(){Q.addItem(new AJS.ItemDescriptor({value:""+this.id,label:this.name,html:this.html,allowDuplicate:false}))});N.push(Q)});return N};x.fn.tempoSingleTeamPicker=function(N){var P=x(this);var O={};var M=new C({element:P,matchingStrategy:f,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/teams/picker",query:true,minQueryLength:1,data:O,formatResponse:x.fn.tempoFormatTeamResponse}})};x.fn.tempoSingleActivityPicker=function(N){var P=x(this);var O={projectId:function(){return x("#tempo-report-project").val()}};var M=new C({element:P,showDropdownButton:true,removeOnUnSelect:false,matchingStrategy:f,submitInputVal:true,noQueryNoRequest:false,ajaxOptions:{url:contextPath+"/rest/tempo-rest/2.0/activities/picker",query:true,minQueryLength:1,data:O,formatResponse:function(Q){var R=[];x(Q).each(function(S,T){x(T.group).each(function(V,U){var W=new AJS.GroupDescriptor({weight:V,id:"tempo-report-activity-search"+V,replace:true,label:U.title});x(U.item).each(function(){var X=new AJS.ItemDescriptor({value:this.type+"-"+this.id,label:this.name,html:this.html,allowDuplicate:false});W.addItem(X)});R.push(W);M.setDropdownWidthForTimesheet(N)})});return R}}})};x.fn.tempoMultiUserPicker=function(M){var N;if(M!=null){N=M.type}else{N=""}x(this).each(function(R){var Q=x(this);var P={showAvatar:true};var O=new AJS.MultiSelect({element:Q,showDropdownButton:true,removeOnUnSelect:false,submitInputVal:true,noQueryNoRequest:true,ajaxOptions:{url:contextPath+"/rest/api/1.0/users/picker"+N,query:true,minQueryLength:3,data:P,formatResponse:function(T){var S=[];x(T).each(function(V,U){var W=new AJS.GroupDescriptor({weight:V,label:U.footer});x(U.users).each(function(){W.addItem(new AJS.ItemDescriptor({value:this.name,label:this.displayName,html:this.html,icon:this.avatarUrl,allowDuplicate:false,highlighted:true}))});S.push(W)});return S}}});Q.data("userPicker",O);Q.bind("change",function(){var T=Q.closest("form");var S=T.find(":input[name=user]").val();var V=T.find("input[name=date]");var U=T.find("input[name=enddate]");g(T,S,V,U)})})};x.fn.tempoDatePicker=function(M){x(this).each(function(){var W=x(this);var S=W.find("input");var Q=W.find("img,span.icon-date");var V=S.attr("id");var R=Q.attr("id");var T=W.hasClass("ISO8061WeekNumbers");var U=W.hasClass("showStartTime");var O=E;if(U){O=s}Calendar.setup({context:W,firstDay:0,inputField:V,button:R,align:"Tl",singleClick:true,ifFormat:O,daFormat:O,showsTime:U,timeFormat:"24",useISO8601WeekNumbers:T,electric:false});if(M.validate){var N=S.closest(".tempo-datepicker");var P=N.closest("form");Q.bind("click",function(){Q.data("cal",window.calendar)}).closest("a").bind("keyup",function(X){if(X.keyCode==32){Q.trigger("click")}});S.bind("blur",function(){var X=Q.data("cal");if(X){X.callCloseHandler()}}).bind("change",function(){P.cleanFormValidation();var Y=P.find("input[name=planning]").val()=="true";var X=P.find(":input[name=user]").val();if(!X){X=P.find("select.dialog-user-picker").val()}var Z=i(S,X,Y);var ab=N.find(":checkbox").is(":checked");if(Z){var ad=N.find("input[name=date]");var ac=N.find("input[name=enddate]");var aa=P.find("input.availability");if(ab){if(this.name=="date"){if(ac.val()==""){return}Z=i(ac,X,Y)}else{Z=i(ad,X,Y)}if(Z){Z=u(ad.val(),ac.val(),P.find("input[name=startTimeEnabled]").val()==="true");if(!Z){P.find("ul.error-list").append(x("<li/>").text(n))}else{P.find("input[name=time]").trigger("change");g(P,X,ad,ac)}}}else{g(P,X,ad,ac)}}return true})}});return this};function g(O,M,S,R){if(!M){return}var Q=O.find("input.availability");if(Q.length===1){var N=contextPath+"/rest/tempo-rest/2.0/user/getUser";if(!O.find(".showperiod").is(":checked")||R.val()==""){R=S}var P={from:S.val(),to:R.val(),username:M};x.ajax({url:N,cache:false,data:P,success:function(T){O.find("input.availability").val(T.availableString);O.find("input.workingdays").val(T.workDaysString)},error:function(U,T,V){alert(T)}})}}function j(O,S,P){if(P!=""){var M=O.find(":input[name=issue]");if(M.val()!=""){var R=O.find("input[name=date]");var Q=O.find("input[name=enddate]");var N=O.find("input[name=user]").val();if(!N){N=O.find("select.dialog-user-picker").val()}if(!Q.is(":visible")){Q=R}x.ajax({data:{username:N},async:false,url:contextPath+"/rest/tempo-rest/1.0/worklogs/remainingEstimate/calculate/"+M.val()+"/"+J(R.val())+"/"+J(Q.val())+"/"+P,cache:false,success:function(T){S.val(T);if(S.is(":focus")){S.select()}},error:function(U,T,V){if(V=="Unauthorized"){alert(d)}else{alert(T)}}})}}}x.fn.tempoTimePicker=function(){x.each(x(this),function(){var M=x(this);var P=M.closest("form");var N=P.find(":input[name=issue]");var Q=M.find(":input[name=time]");var S=M.find("input[name=remainingEstimate]");var R=M.find("input[name=billedTime]");var O=P.find("div.tempo-datepicker");Q.bind("blur",function(U){if(N.find("option").val()&&N.val()==null){var T=N.find("option").val();N.val(T);x("select.tempo-issue-picker").trigger("change")}if(S.length>0||R.length>0){if(R.length>0){R.val(this.value)}if(S.length>0){j(P,S,this.value)}}});O.bind("change",function(){if(O.find("div.enddate").is(":visible")){Q.trigger("blur")}})});return this};function p(Q,P,M){if(P.error!=undefined&&P.error!=null&&P.error!=""){alert("Error in TDD query: "+P.error);return}Q.empty();var N=Q.attr("selectedValue");var O=N;x.each(P.values,function(R,S){x("<option/>").val(S.key).text(S.value).appendTo(Q);if(S.key==N&&S.key!=""){O=S.value}});if(N){Q.val(N)}if(N&&Q.val()!=N){O=N+" - "+"Unknown account";x("<option/>").val(N).text(O).appendTo(Q);Q.val(N)}if(O!=""){Q.siblings("span.edit-select").text(O)}}var w={};var B={};function m(P,N){var O=B[N];if(O==null){var M=!tempo.isEmptyString(P.attr("issueKey"));O=x.ajax({async:M,url:encodeURI(N),dataType:"jsonp",success:function(Q){w[N]=Q},error:function(R,Q,S){alert("Got error in TDD query: "+R+", status: "+Q+", error: "+S+", element: "+P.attr("id")+", URL:"+N)}});B[N]=O}return O}function G(M,P){var N=w[M];if(N==null){var O=m(P,M);O.done(function(Q){p(P,Q,M)})}else{p(P,N,M)}}var b={};var h={};function o(M,P){var N=M+":"+P;var O=h[N];if(O==null){O=x.ajax({async:true,cache:false,url:contextPath+"/rest/tempo-rest/1.0/worklogs/customFieldValue/"+M+"/"+P,success:function(Q){b[N]=Q}});h[N]=O}return O}function D(N,O,M){return N.replace("{"+O+"}",M)}function a(N,R,M,Q){var O=b[N];if(O==null){var P=o(M,Q);P.done(function(S){if(!tempo.isEmptyString(S)){G(D(N,Q,S),R)}})}else{if(!tempo.isEmptyString(O)){G(D(N,Q,O),R)}}}x.fn.populateDynamicDropdown=function(M){x(this).each(function(){var W=x(this);var P=M;if(P==null){P=W.attr("issueKey")}var O=W.attr("externalURL");if(tempo.isEmptyString(O)){return}if(O.indexOf("{")>0){if(tempo.isEmptyString(P)){return}var T=O.indexOf("{")+1;var R=O.indexOf("}");var N=O.substr(T,(R-T));var S=W.attr("id");var V=S.substr(0,S.indexOf("_"));var U=P;var Q=x("#"+V+N);if(Q.length>0){U=Q.val()}else{if(N!="IssueKey"){a(O,W,P,N);return}}if(tempo.isEmptyString(U)){return}O=D(O,N,U)}G(O,W)});return this};function J(M){return M.replace(/\//g,"-")}var F={};function i(N,M,O){var P=false;var Q=M+"_"+N.val()+"_"+O;if(F[Q]){P=F[Q]}else{x.ajax({type:"POST",url:contextPath+"/rest/tempo-rest/1.0/worklogs/validation/date/full",async:false,data:{date:N.val(),formFieldId:N.attr("name"),user:M,planning:O},success:function(R){P=H(R,N.closest("form"))}});F[Q]=P}return P}function u(O,N,M){var Q=Date.parseDate(O,E);if(M){Q=Date.parseDate(O,s)}var P=Date.parseDate(N,E);return Q.getTime()<=P.getTime()}function H(M,N){var P=N.find("ul.error-list");var O=true;x(M).find("submit-result").each(function(){var Q=x(this);if(Q.attr("valid")=="false"){Q.find("errors").each(function(){var R=x(this);P.append(x("<li/>").text(R.find("errorMessage").text()))});O=false}});return O}function v(N,M){tb_show(this.innerHTML,"#TB_inline?height="+M+"&amp;width=780&amp;inlineId="+N+"&amp;modal=true")}var L={dirty:false,locked:false,popup_title:{}};var c=x('<div id="tempo-blanket"/>').css("z-index","2000").css("height","100%").hide();var z={show:function(M){c.addClass("aui-blanket").css("z-index",M||"2000").show();if(x.fancybox){x.fancybox.showActivity()}else{x("div.aui-loading").show()}},hide:function(){c.removeClass("aui-blanket").css("z-index","2000").hide();x("div.aui-loading").hide();if(x.fancybox){x.fancybox.hideActivity()}}};var K=function(M){z.show();if(M){window.location=M}else{window.location.reload()}return this};function q(){x("#submitSearch").addClass("refresh-required")}function r(P){if(tempo.state.locked){return}tempo.spinner.show("9000");tempo.state.locked=true;x(":button").attr("disabled",true);var O=x(this).find("form");var R=O.find("ul.error-list");var M=O.find("input[name=user]").val();if(!M){M=x(O.find("select.dialog-user-picker").val()).get(0)}var Q=O.serialize();var N=O.attr("action");N=N.replace("{issueKey}",O.find(":input[name=issue]").val());N=N.replace("{id}",O.find("input[name=id]").val());N=N.replace("{type}",O.find("input[name=type]").val());x.ajax({async:true,type:"POST",url:N,data:Q,success:function(S){O.cleanFormValidation();x(S).find("submit-result").each(function(){var T=x(this);if(T.attr("valid")=="false"){T.find("errors").each(function(){var W=x(this);var X=W.find("formFieldId").text();x('[name="'+X+'"]',O).addClass("error-field");R.append(x("<li/>").text(W.find("errorMessage").text()))})}else{tempo.state.dirty=true;O.fixDirtyForm();if(O.find("input[name=tracker]").val()=="true"){tempobar.stopTracker()}if(P.type=="add-close"||P.type=="update"||P.type=="move"||P.type=="split"){tempo.reload();return}else{O.resetFormFields();if(O.find(":input[name=planning]").val()=="true"){var V=O.find("input[name=date]");var U=O.find("input[name=enddate]");g(O,M,V,U)}else{tempo.issue.get(O.find(":input[name=issue]").val(),O)}O.find("select.tempoDynamicDropDown").populateDynamicDropdown(O.find(":input[name=issue]").val())}}});x(":button").attr("disabled",false);tempo.spinner.hide();tempo.state.locked=false},error:function(S,U,T){if(T=="Unauthorized"){alert(d)}else{if(U=="timeout"){alert("Add hours failed - Service timed out - Please try again")}else{alert(tempo.extractErrorMessage(S.responseText))}}x(":button").attr("disabled",false);tempo.spinner.hide();tempo.state.locked=false},dataType:"xml"})}function k(M){return M==undefined||M==null||M.length==0}function t(M){return M.match(/(.*)\((.*)\).*/)}var I=function(){};var y=AJS||JIRA?{Dropdown:AJS.Dropdown?AJS.Dropdown:AJS.DropDown,formatSuccess:jira.app.fragments?jira.app.fragments.issueActionsFragment:JIRA.FRAGMENTS.issueActionsFragment,FormPopup:AJS.FormPopup||(JIRA?JIRA.FormDialog:I),containDropdown:AJS.containDropdown||(JIRA?JIRA.containDropdown:I),sessionStorage:(jira.app.session?jira.app.session.storage:JIRA.SessionStorage)}:{};function A(N){var M=AJS.$(N).find("message").text();if(M){return M}return N}function l(){var P=x(this).closest("form");P.find(".enddate").toggle(this.checked);P.find("input[name=date]").trigger("change");var N=P.find("label.timepicker-label");var O=N.attr("tmp");var M=N.text();N.attr("tmp",M);N.text(O)}function e(O){var Q=x("#timesheet-mlink");if(Q.length>0){if(jira.app.issue.getIssueKey()){var M=(O.planning==true)?"TempoAllocateTime!default.jspa?type=issue&id=":"TempoAddHours!default.jspa?id=";var N=contextPath+"/secure/"+M+jira.app.issue.getIssueId();var R=x("<a>").attr("href",N).addClass("issueaction-tempo-add-hours-on-issue hidden");x("header").first().append(R);R.click().remove()}else{var P=(O.planning==true)?x("#tempo-plan-button"):x("#tempo-add-button");if(P.length===1){P.click()}else{window.location=Q.attr("href")}}}}return{$:x,DATE_FORMAT:E,DATE_TIME_FORMAT:s,MATCHING_STRATEGY:f,spinner:z,reload:K,requireReload:q,state:L,submit:r,changeDateFormatForRest:J,calculateRemainingEstimate:j,widget:y,isEmptyString:k,extractUser:t,blanket:c,extractErrorMessage:A,processValidationResult:H,thickbox:{open:v,close:function(){tb_removeNoRefresh()}},shortcutOpenDialog:e,showHoursLabel:l}})(AJS.$);tempo.$(function(h){h("a#log-work-link").bind("click",function(m){j(m)});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(n,m){h(m).find("a#log-work-link").bind("click",function(o){j(o)})});function j(o){var m=h("a#issue-view-tempo-panel-log-work");if(m.length===1){o.preventDefault();o.stopPropagation();var n=contextPath+"/secure/TempoAddHours!default.jspa?id="+jira.app.issue.getIssueId();h(this).attr("href",n).addClass("issueaction-tempo-add-hours-on-issue");m.trigger("click")}}f();function f(){var n=h("span.more-license-details").last();var m=n.parent().find("ul.license-details");m.hide();n.bind("click",function(){m.toggle();n.toggleClass("active")})}var d=new tempo.widget.FormPopup({id:"tempo-medium-form",trigger:"a.tempoaction-open-medium-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"medium",onContentRefresh:function(){var m=this.get$popupContent()}});var a=new tempo.widget.FormPopup({id:"tempo-small-form",trigger:"a.tempoaction-open-small-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"small",onContentRefresh:function(){var m=this.get$popupContent()}});var b=new tempo.widget.FormPopup({id:"tempo-large-form",trigger:"a.tempoaction-open-large-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},width:750,onContentRefresh:function(){var m=this.get$popupContent();f()}});var l=new tempo.widget.FormPopup({id:"tempo-add-hours-issue-dialog",trigger:"a.issueaction-tempo-add-hours-on-issue",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var n=this.get$popupContent();var m=n.find("form").attr("data-form-type");h(n).siblings().first().addClass(m);i(h(n[0]));this._focusFirstField=function(){h(":input[name=time]",n).trigger("focus")}}});new tempo.widget.FormPopup({id:"tempo-grace-form",trigger:"a.tempoaction-open-dialog-form",ajaxOptions:{data:{inline:true,decorator:"dialog"}},initCallback:function(){hideFunction=this.hide},widthClass:"medium",onContentRefresh:function(){var m=this.get$popupContent();h("div.datepicker",m).tempoDatePicker({validate:true})}});new tempo.widget.FormPopup({id:"tempo-planning-create-team",trigger:"a.tempo-planning-create-team",ajaxOptions:{data:{inline:true,decorator:"dialog"}},widthClass:"medium",onContentRefresh:function(){var n=this.get$popupContent();var m=this;h("div.datepicker",n).tempoDatePicker({validate:false});h("input.button",n).bind("click",function(){var o=h(this).closest("form");h("form",n).each(function(){if(this.id!=o.attr("id")){h(this).find("input:hidden").remove()}})});this._focusFirstField=function(){h(":input[name=time]",n).trigger("focus")};i(h(n[0]))}});function i(o){h("select.tempoDynamicDropDown",o).bind("change",function(){});h("select.tempo-issue-picker-logwork",o).tempoIssuePicker();h("select.plan-user-picker",o).tempoSingleUserPicker();h("div.datepicker",o).tempoDatePicker({validate:true});h("div.tempo-timepicker",o).tempoTimePicker();h("#tempo-logwork-issue-cancel",o).bind("click",function(){if(tempo.state.dirty){tempo.reload()}});h("div.dialog-panel-form",o).attr("title","");var n=h("input.tempo-show-period",o);if(n.attr("checked")){tempo.showHoursLabel.apply(n[0])}n.bind("click",tempo.showHoursLabel);h(o).bind("add-close",tempo.submit).bind("add",tempo.submit);h(o).bind("before-submit",function(p){p.preventDefault()});h(o).submit(function(p){p.preventDefault();h("#issue-add-button").click();return false});h("#issue-add-button",o).bind("click",function(q){var p=h(o).find("form *:input#issue-add-another");if(p.attr("checked")){h(o).trigger("add");h(o).find("form:first *:input[type!=hidden]:first").focus()}else{h(o).trigger("add-close")}return false});var m=h("#tempo-log-work input.tempoIssueKey",o).val();if(m){h("#tempo-log-work form select.tempoDynamicDropDown",o).populateDynamicDropdown(m)}}var g=h('#gh_column_contents a.item-link[href*="/TempoAllocateTime!default.jspa"]');if(g.length>0){var k=h("<a/>").addClass("issueaction-tempo-add-hours-on-issue");k.appendTo("body");g.bind("click",function(m){k.attr("href",this.href);k.trigger("click");return false})}var c=h("<a/>").addClass("tempo-planning-create-team");c.appendTo("body");var e=h('#gh_column_contents a.item-link[href*="/AllocateTeam!default.jspa"]');e.bind("click",function(m){c.attr("href",this.href);c.trigger("click");return false});h("select.tempo-user-picker-admin").tempoSingleUserPicker({type:"admins"});h("select.tempo-user-picker-user").tempoSingleUserPicker();h("select.tempo-worklog-validation-picker").tempoIssuePicker();AJS.$("select.tempoDynamicDropDown").bind("change",function(){});AJS.$("select.issue-select").bind("change",function(){});tempo.blanket.appendTo("body")});;
;/* module-key = 'is.origo.jira.tempo-plugin:tempo-global', location = 'com/tempoplugin/js/tempo.issue.js' */
tempo.issue=(function(f){function a(k,h,i){k.find("select.tempoDynamicDropDown").populateDynamicDropdown(h);var m=i.attr("issue-internal")==="true";if(m){k.find("div.remaining-and-billed-hours-container").hide()}else{k.find("div.remaining-and-billed-hours-container").show();var j=k.find("input.remaining");j.val(i.attr("remaining_estimate"));k.find("span.originalEstimate").text(i.attr("original_estimate"));k.find("span.remainingEstimate").text(i.attr("remaining_estimate"));k.find("span.totalSpent").text(i.attr("hours_spent"));var l=k.find(":input[name=time]");if(l.length>0&&l.val()!==""){tempo.calculateRemainingEstimate(k,j,l.val())}}}function g(h,j,m){j.cleanFormValidation();var l=j.find("input[name=user]").val();if(j.find("select.dialog-user-picker").val()){l=f(j.find("select.dialog-user-picker").val()).get(0)}var k=j.find("ul.error-list");if(l!==""){var i=contextPath+"/rest/tempo-rest/2.0/issue/"+h+"/"+true;f.ajax({url:i,data:{username:l},cache:false,success:function(n){f(n).find("issue").each(function(){var o=f(this);if(o.attr("issue-valid")==="false"){var p=f(this).find("error");k.append(f("<li/>").text(p.attr("message")))}else{if(!m){a(j,h,o)}}})}})}}function d(i,l){var m=l.find(".tempo-subtask-container");var h=l.find("select.tempo-subtask-picker");m.addClass("hidden");h.empty();h.append(f("<option>",{value:i}).text("Select Sub-task"));var k=contextPath+"/rest/tempo-rest/2.0/issues/picker/subTasks/"+i;var j=parseInt(l.find("select.tempo-subtask-picker").attr("data-counter"),10);f.ajax({url:k,cache:false,success:function(n){f(n).find("item").each(function(){var o=f(this);h.append(f("<option>",{value:o.attr("key")}).text(o.attr("key")+" "+o.attr("name")))});if(f(n).find("item").size()===0){m.addClass("hidden");l.find(".tempo-issue-container").removeClass("highlighted")}else{if(j===3){m.removeClass("hidden");l.find(".tempo-issue-container").addClass("highlighted");l.find(".tempo-subtask-container").removeClass("highlighted")}}}})}function c(h){return h!==undefined&&h!==""&&h.match(/^\w+-\d+$/)}function b(j){var i=f(this).closest("form").cleanFormValidation();var h;if(i.find("select.tempo-issue-picker").val()!==null){h=f(i.find("select.tempo-issue-picker").val()).get(0)}var k=f(j.currentTarget).hasClass("dialog-user-picker");if(c(h)){if(i.find("select.tempo-subtask-picker").length!==0&&!k){d(h,i);f("select.tempo-subtask-picker").trigger("change")}else{g(h,i,k)}}}function e(k){var j=f(this).closest("form").cleanFormValidation();var h=f(j.find("select.tempo-issue-picker").val()).get(0);var i=parseInt(j.find("select.tempo-subtask-picker").attr("data-counter"),10);if(f(this).children().length>1){if(i===3&&(this.value===j.find("select.tempo-issue-picker").val()[0])){j.find(".tempo-issue-container").addClass("highlighted");j.find(".tempo-subtask-container").removeClass("highlighted")}else{j.find(".tempo-issue-container").removeClass("highlighted");j.find(".tempo-subtask-container").addClass("highlighted");h=j.find("select.tempo-subtask-picker").val()}}var l=f(k.currentTarget).hasClass("dialog-user-picker");if(c(h)){g(h,j,l)}}f("select.tempo-issue-picker").live("change",b);f("select.sub-issue-select").live("change",e);f("select.dialog-user-picker").live("change",b);f("select.tempo-filter-dropdown").live("change",function(i){var h=i.target.value;f(this).closest("form").find("select.tempo-issue-picker-filter").parent().html("<label for='tempo-issue-picker-filter'>"+"Issue"+"</label><select id='tempo-issue-picker' class='tempo-issue-picker tempo-issue-picker-filter' name='issue'/>");f("select.tempo-issue-picker-filter").tempoIssuePicker({type:"filter/"+h})});return{get:g,select:b,valid:c}}(AJS.$));;
;/* module-key = 'com.atlassian.jira.jira-header-plugin:websudoflag', location = 'js/WebSudoFlag.js' */
AJS.$(function ($) {
    var Browser = require('jira/util/browser');

    function dropWebSudo(successCallback) {
        $.ajax({
            type: "DELETE",
            url: contextPath + "/rest/auth/1/websudo",
            contentType: "application/json",
            success: successCallback
        });
    }

    var webSudoFlagData = WRM.data.claim('com.atlassian.jira.jira-header-plugin:websudoflag.message');
    if (webSudoFlagData) {
        var flag = require('jira/flag');
        var message = AJS.format("You have temporary access to administrative functions. {0}Drop access{1} if you no longer require it.", '<a href="#" class="websudo-dismiss-trigger">', '</a>');
        message += "&nbsp;" + JIRA.Templates.Links.helpLink({
            isLocal: false,
            url: webSudoFlagData.helpUrl,
            title: webSudoFlagData.helpTitle
        });

        var $webSudoFlag = $(flag.showMsg('', message, {type: "info", dismissalKey: "flags.jira.websudo"}));
        $webSudoFlag.find(".websudo-dismiss-trigger").click(function (e) {
            e.preventDefault();
            if (webSudoFlagData.isProtectedPage) {
                dropWebSudo(function () {
                    Browser.reloadViaWindowLocation(contextPath + "/secure/MyJiraHome.jspa");
                });
            }
            else {
                dropWebSudo(function () {
                    $webSudoFlag.find(".icon-close").click();
                });
            }
        });
    }
});
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/urls.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-advertising.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-installer.js' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-advertising.soy' */
;
;/* module-key = 'com.atlassian.jira.plugins.greenhopper-marketing-plugin:gh-advertising-resources', location = '/js/greenhopper-installer.soy' */
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/IssuePicker.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.AdminHelper");JIRA.AdminHelper.IssuePicker=AJS.SingleSelect.extend({init:function(a){function b(c){if(!c.sections){return[]}var d=[];AJS.$(c.sections).each(function(e,g){var f=new AJS.GroupDescriptor({weight:e,label:g.label});AJS.$(g.issues).each(function(j,h){f.addItem(new AJS.ItemDescriptor({value:h.key,label:h.key+" - "+h.summaryText,html:h.keyHtml+" - "+h.summary,icon:contextPath+h.img}))});d.push(f)});return d}AJS.$.extend(a,{errorMessage:"Please select an issue",ajaxOptions:{url:contextPath+"/rest/api/1.0/issues/picker?currentJQL=project!=null",query:true,formatResponse:b}});this._super(a)}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/common.soy' */
// This file was automatically generated from common.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.AdminHelper == 'undefined') { JIRA.Templates.AdminHelper = {}; }
if (typeof JIRA.Templates.AdminHelper.Common == 'undefined') { JIRA.Templates.AdminHelper.Common = {}; }


JIRA.Templates.AdminHelper.Common.statusImage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.status == 'green') ? '<span class="icon adminhelper-icon-tick"></span> ' : '<span class="icon adminhelper-icon-cross"></span> ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.warningImage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="icon adminhelper-icon-warning"></span> ');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.loadingStatus = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="status-loading" />');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.AdminHelper.Common.statusLineRow = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<tr class="statusRow ', (opt_data.hideFailedStatuses && opt_data.statusLine.status == 'red') ? 'hidden' : '', '" data-status="', soy.$$escapeHtml(opt_data.statusLine.status), '"><td>');
  JIRA.Templates.AdminHelper.Common.statusImage({status: opt_data.statusLine.status}, output);
  output.append('</td><td>');
  var summaryList23 = opt_data.statusLine.summary;
  var summaryListLen23 = summaryList23.length;
  for (var summaryIndex23 = 0; summaryIndex23 < summaryListLen23; summaryIndex23++) {
    var summaryData23 = summaryList23[summaryIndex23];
    output.append('<p>', summaryData23, '</p>');
  }
  output.append('</td><td>');
  if (opt_data.statusLine.details.length == 1) {
    var detailList32 = opt_data.statusLine.details;
    var detailListLen32 = detailList32.length;
    for (var detailIndex32 = 0; detailIndex32 < detailListLen32; detailIndex32++) {
      var detailData32 = detailList32[detailIndex32];
      output.append(detailData32);
    }
  } else {
    var detailList37 = opt_data.statusLine.details;
    var detailListLen37 = detailList37.length;
    for (var detailIndex37 = 0; detailIndex37 < detailListLen37; detailIndex37++) {
      var detailData37 = detailList37[detailIndex37];
      output.append('<p>', detailData37, '</p>');
    }
  }
  output.append('</td></tr>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/whereismycf-dialog.soy' */
// This file was automatically generated from whereismycf-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.WhereIsMyCf == 'undefined') { JIRA.Templates.Dialogs.WhereIsMyCf = {}; }


JIRA.Templates.Dialogs.WhereIsMyCf.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui ajs-dirty-warning-exempt"><div class="form-body"><div id="whereismycf-suggestions" class="aui-list" /><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find your field"), '</div><div class="field-status-placeholder"></div></div><div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">', soy.$$escapeHtml("Close"), '</a></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.WhereIsMyCf.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.project), '">', soy.$$escapeHtml(opt_data.project), '</dd></dl><dl><dt>', soy.$$escapeHtml("Issue type"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.issueType), '">', soy.$$escapeHtml(opt_data.issueType), '</dd></dl><dl><dt>', soy.$$escapeHtml("Screen"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.operation), '">', soy.$$escapeHtml(opt_data.operation), '</dd></dl><dl><dt>', soy.$$escapeHtml("Field"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.fieldName), '">', soy.$$escapeHtml(opt_data.fieldName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  output.append((opt_data.status == 'green') ? soy.$$escapeHtml(AJS.format("The \x27\x27{0}\x27\x27 field should be present on the form you are viewing",opt_data.fieldName)) : soy.$$escapeHtml(AJS.format("The \x27\x27{0}\x27\x27 field is not present on the form you are viewing",opt_data.fieldName)), '</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the \x27\x27{0}\x27\x27 field status",opt_data.fieldName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList57 = opt_data.statusLines;
    var statusLineListLen57 = statusLineList57.length;
    for (var statusLineIndex57 = 0; statusLineIndex57 < statusLineListLen57; statusLineIndex57++) {
      var statusLineData57 = statusLineList57[statusLineIndex57];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData57}, output);
    }
    output.append('<tbody></table>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.WhereIsMyCf.errorPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ajaxerror"><div class="aui-message ', soy.$$escapeHtml(opt_data.errorClass), '">');
  if (opt_data.errorMessages.length == 1) {
    var msgList69 = opt_data.errorMessages;
    var msgListLen69 = msgList69.length;
    for (var msgIndex69 = 0; msgIndex69 < msgListLen69; msgIndex69++) {
      var msgData69 = msgList69[msgIndex69];
      output.append('<p>', soy.$$escapeHtml(msgData69), '</p>');
    }
  } else {
    output.append('<ul>');
    var msgList76 = opt_data.errorMessages;
    var msgListLen76 = msgList76.length;
    for (var msgIndex76 = 0; msgIndex76 < msgListLen76; msgIndex76++) {
      var msgData76 = msgList76[msgIndex76];
      output.append('<li>', soy.$$escapeHtml(msgData76), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div></div>', (! opt_data.noCloseLink) ? '<div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a></div></div>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/whereismycf-dialog.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.WhereIsMyCf");JIRA.WhereIsMyCf.WhereIsMyCfDialog=JIRA.Dialog.extend({OPERATION_CREATE:0,OPERATION_EDIT:1,OPERATION_VIEW:2,_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"whereismycf-dialog",widthClass:"large",stacked:true})},_setContent:function(b,d){var a=this;if(b){this._super(b,d)}else{this._super(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.searchPage()),true)}this.get$popupContent().find(".cancel").click(function(f){a.hide();f.preventDefault()});if(JIRA.Dialog.current===this){var c=new JIRA.setFocus.FocusConfiguration();c.context=this.get$popup()[0];c.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(c);JIRA.setFocus.triggerFocus()}},_formatActionsResponse:function(a){var b=[];if(a){var c=new AJS.GroupDescriptor({showLabel:false,label:"Fields"});AJS.$(a).each(function(){var d=new AJS.ItemDescriptor({label:this.customFieldName});d.properties.cfId=this.customFieldId;c.addItem(d)});b.push(c)}return b},decorateContent:function(){var b=this,a=JIRA.Meta.getIssueKey();this.addHeading("Where is my field?");this.queryControl=new AJS.QueryableDropdownSelect({id:"whereismycf",element:this.$content.find("#whereismycf-suggestions"),ajaxOptions:{minQueryLength:1,dataType:"json",url:contextPath+"/rest/whereismycf/1.0/fields/all",formatResponse:this._formatActionsResponse},showDropdownButton:true,loadOnInit:true});this.queryControl._handleServerError=function(g){var h=JIRA.SmartAjax.buildSimpleErrorContent(g);var f=g.status===401?"warning":"error";b._setContent(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.errorPage({errrorMessage:h,errorClass:f})),false)};var c=this.queryControl.listController.options.selectionHandler;this.queryControl.listController.options.selectionHandler=function(f){c.call(this,f);b.get$popupContent().find(".field-status-results").remove();b.get$popupContent().find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));var g=this.getFocused().data("descriptor");AJS.trigger("analyticsEvent",{name:"adminhelper.whereismycf.field.select"});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/fields/{0}?{1}",g.properties.cfId,b.options.context.asRequestParams()),complete:function(j,k,i){if(i.successful){b.queryControl.$field.val("").css("color","black");b.get$popupContent().find(".status-loading").remove();var h=i.data;b.get$popupContent().find(".field-status-placeholder").append(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.resultPage({fieldName:g.label(),issueType:h.issueType,issueKey:h.issueKey,project:h.projectName,operation:h.operation,status:h.status,statusLines:d(h.statusLines),baseUrl:contextPath})))}else{e(b,i)}b._positionInCenter()}});return false};function d(i){if(i.length==0){return i}function g(l){var k=[];AJS.$.each(l,function(m,n){k.push(h(n))});return k}function h(l){if(l.parameters.length==0){return AJS.escapeHTML(l.message)}else{var k=f(l.parameters);k.splice(0,0,AJS.escapeHTML(l.message));return AJS.format.apply(this,k)}}function f(l){var k=[];AJS.$.each(l,function(m,n){if(n.type=="plain"){k.push(AJS.escapeHTML(n.value))}else{if(n.type=="link"){k.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(n.href),AJS.escapeHTML(n.text)))}else{if(n.type=="newline"){k.push("<br/>")}else{if(n.type=="tagstart"){k.push("<"+n.tagName+">")}else{if(n.type=="tagend"){k.push("</"+n.tagName+">")}else{throw"Unrecognized parameter type: "+n.type}}}}}});return k}var j=[];AJS.$.each(i,function(m,k){var l={};l.status=k.status;l.summary=g(k.summary);l.details=g(k.details);j.push(l)});return j}function e(g,h){var j=[];var i=JIRA.SmartAjax.buildSimpleErrorContent(h);if(i){j.push(i)}else{if(h.data&&h.data.errorMessages){j.push(h.data.errorMessages)}if(h.data&&h.data.errors){j.push(h.data.errors)}}var f=h.status===401?"warning":"error";g._setContent(AJS.$(JIRA.Templates.Dialogs.WhereIsMyCf.errorPage({errorMessages:j,errorClass:f})),false)}},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.WhereIsMyCf.IssueContext=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},asRequestParams:function(){function a(c){return typeof(c)!="undefined"}var b="atl_token="+atl_token();if(a(this.options.issueKey)){b+="&issueKey="+this.options.issueKey}if(a(this.options.projectKey)){b+="&projectKey="+this.options.projectKey}if(a(this.options.projectId)){b+="&projectId="+this.options.projectId}if(a(this.options.issueOperation!==undefined)){b+="&issueOperation="+this.options.issueOperation}if(a(this.options.issueTypeId)){b+="&issueTypeId="+this.options.issueTypeId}return b}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/whereismycf.js' */
if(AJS.Meta.get("is-admin")){(function(g){var d="Where is my field?";JIRA.WhereIsMyCf.dialog=new JIRA.WhereIsMyCf.WhereIsMyCfDialog;g(document).delegate(".whereismycf-trigger","click",function(i){i.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.whereismycf.dialog.open"});JIRA.WhereIsMyCf.dialog.show(c())});g(document).bind("showLayer",function(j,l,k){if(l=="inlineDialog"&&k.popup.attr("id")=="inline-dialog-field_picker_popup"){if(k.popup.find(".whereismycf-qfpicker-link").length==0){var i=g("<a href='#' class='whereismycf-qfpicker-link'>"+d+"</a>").appendTo(k.popup.find(".qf-picker-header dl"));i.click(function(m){m.preventDefault();k.hide();h();JIRA.WhereIsMyCf.dialog.show(b())})}}});function h(){AJS.InlineDialog.current=null}function f(){var i=JIRA.Issue.getIssueKey();if(!i&&JIRA.IssueNavigator){i=JIRA.IssueNavigator.getSelectedIssueKey()}return i}function c(){return new JIRA.WhereIsMyCf.IssueContext({issueKey:f(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_VIEW})}function b(){var i=JIRA.Dialog.current;if(i.options.id=="create-issue-dialog"){return a(i)}else{if(i.options.id=="edit-issue-dialog"){return e(i)}else{throw"Uknown current dialog ID: "+i.options.id}}}function a(i){var j=i.get$popupContent();return new JIRA.WhereIsMyCf.IssueContext({projectId:j.find("#project").val(),issueTypeId:j.find("#issuetype").val(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_CREATE})}function e(i){var j=i.get$popupContent();return new JIRA.WhereIsMyCf.IssueContext({issueKey:f(),issueTypeId:j.find("#issuetype").val(),issueOperation:JIRA.WhereIsMyCf.dialog.OPERATION_EDIT})}})(AJS.$)};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/permission-helper-dialog.soy' */
// This file was automatically generated from permission-helper-dialog.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.PermissionHelper == 'undefined') { JIRA.Templates.Dialogs.PermissionHelper = {}; }


JIRA.Templates.Dialogs.PermissionHelper.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="permissionhelper-search-form aui ajs-dirty-warning-exempt"><div class="content-area-container"><div class="form-body"><div id="error-message-placeholder"></div><div class="action-description">', soy.$$escapeHtml("Discover why a user does or does not have certain permissions..."), '</div><div class="field-group"><label for="permissionhelper-user">', soy.$$escapeHtml("User"), '</label><select id="permissionhelper-user" name="permissionhelper-user" class="single-user-picker js-default-user-picker" data-container-class="long-field"></select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a user, leave blank for Anonymous user"), '</div></div><div class="field-group ', (opt_data.currentIssueKey) ? 'hidden' : '', '"><label for="permissionhelper-issue">', soy.$$escapeHtml("Issue"), '</label><select class="aui-field-select select" name="permissionhelper-issue" id="permissionhelper-issue"></select><div class="description">', soy.$$escapeHtml("Begin typing to find an issue"), '</div></div><div class="field-group"><label for="permissionhelper-permission">', soy.$$escapeHtml("Permission"), '</label><select class="aui-field-select select" name="permissionhelper-permission" id="permissionhelper-permission">');
  var permissionGroupList20 = opt_data.permissionGroups;
  var permissionGroupListLen20 = permissionGroupList20.length;
  for (var permissionGroupIndex20 = 0; permissionGroupIndex20 < permissionGroupListLen20; permissionGroupIndex20++) {
    var permissionGroupData20 = permissionGroupList20[permissionGroupIndex20];
    output.append('<optgroup label="', soy.$$escapeHtml(permissionGroupData20.name), '">');
    var permissionList24 = permissionGroupData20.permissions;
    var permissionListLen24 = permissionList24.length;
    for (var permissionIndex24 = 0; permissionIndex24 < permissionListLen24; permissionIndex24++) {
      var permissionData24 = permissionList24[permissionIndex24];
      output.append('<option ', (permissionData24.id == 10) ? 'selected="selected"' : '', ' value="', soy.$$escapeHtml(permissionData24.id), '">', soy.$$escapeHtml(permissionData24.name), '</option>');
    }
    output.append('</optgroup>');
  }
  output.append('</select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a permission or press down to see all"), '</div></div></div><div class="form-body field-status-placeholder" /></div><div class="buttons-container form-footer"><div class="buttons"><input class="button search" type="submit" id="permission-helper-submit" value="', soy.$$escapeHtml("Submit"), '">', (! opt_data.noCloseLink) ? '<a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a>' : '', '</div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.PermissionHelper.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Permission name"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.permissionName), '">', soy.$$escapeHtml(opt_data.permissionName), '</dd></dl><dl><dt>', soy.$$escapeHtml("User"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.userDisplayName), '">', (opt_data.username != '') ? '<a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/secure/admin/user/ViewUser.jspa?name=' + soy.$$escapeHtml(opt_data.username) + '">' + soy.$$escapeHtml(opt_data.userDisplayName) + '</a>' : soy.$$escapeHtml(opt_data.userDisplayName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.projectName), '"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/browse/', soy.$$escapeHtml(opt_data.projectKey), '">', soy.$$escapeHtml(opt_data.projectName), '</a></dd></dl><dl><dt>', soy.$$escapeHtml("Permission scheme"), ': </dt><dd title="blah"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/project-config/', soy.$$escapeHtml(opt_data.projectKey), '/permissions">', soy.$$escapeHtml(opt_data.permissionSchemeName), '</a></dd></dl>', (opt_data.issueKey) ? '<dl><dt>' + soy.$$escapeHtml("Issue") + ': </dt><dd title="' + soy.$$escapeHtml(opt_data.issueKey) + '"><a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/browse/' + soy.$$escapeHtml(opt_data.issueKey) + '">' + soy.$$escapeHtml(opt_data.issueKey) + '</a></dd></dl>' : '', '<dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  output.append((opt_data.status == 'green') ? soy.$$escapeHtml(AJS.format("{0} has the \x27\x27{1}\x27\x27 permission",opt_data.userDisplayName,opt_data.permissionName)) : soy.$$escapeHtml(AJS.format("{0} does not have the \x27\x27{1}\x27\x27 permission",opt_data.userDisplayName,opt_data.permissionName)), '</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the \x27\x27{0}\x27\x27 permission",opt_data.permissionName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList127 = opt_data.statusLines;
    var statusLineListLen127 = statusLineList127.length;
    for (var statusLineIndex127 = 0; statusLineIndex127 < statusLineListLen127; statusLineIndex127++) {
      var statusLineData127 = statusLineList127[statusLineIndex127];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData127, hideFailedStatuses: opt_data.hideFailedStatuses}, output);
    }
    output.append('<tbody></table><div class="toggle-conditions-container"><a class="show-failed-conditions" ', (opt_data.hideFailedStatuses == false || opt_data.allGreenStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Show failed conditions"), '</a><a class="hide-failed-conditions" ', (opt_data.hideFailedStatuses == true || opt_data.allFailedStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Hide failed conditions"), '</a></div>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.PermissionHelper.errorPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ajaxerror"><div class="aui-message ', soy.$$escapeHtml(opt_data.errorClass), '">');
  if (opt_data.errorMessages.length == 1) {
    var msgList152 = opt_data.errorMessages;
    var msgListLen152 = msgList152.length;
    for (var msgIndex152 = 0; msgIndex152 < msgListLen152; msgIndex152++) {
      var msgData152 = msgList152[msgIndex152];
      output.append('<p>', soy.$$escapeHtml(msgData152), '</p>');
    }
  } else {
    output.append('<ul>');
    var msgList159 = opt_data.errorMessages;
    var msgListLen159 = msgList159.length;
    for (var msgIndex159 = 0; msgIndex159 < msgListLen159; msgIndex159++) {
      var msgData159 = msgList159[msgIndex159];
      output.append('<li>', soy.$$escapeHtml(msgData159), '</li>');
    }
    output.append('</ul>');
  }
  output.append('</div></div><div class="buttons-container form-footer"><div class="buttons"><a href="#" class="cancel" id="aui-dialog-close">', soy.$$escapeHtml("Close"), '</a></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper-ui.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.PermissionHelper");JIRA.PermissionHelper.PERMISSIONS=WRM.data.claim("com.atlassian.jira.plugins.jira-admin-helper-plugin:permissions-provider.permissions-data");JIRA.PermissionHelper.PermissionHelperUi={initUi:function(d,b,c){i();var l={};l.searchButton=d.find("input.search");l.searchForm=d.find("form.permissionhelper-search-form");var k=function(o){o.preventDefault();var m=h(d,b);d.find(".error").remove();var n=false;if(!m.params().issueKey){e(AJS.$("#permissionhelper-issue",d),"Please select an issue");n=true}if(!m.params().permissionId){e(AJS.$("#permissionhelper-permission"),"Please select a valid permission");n=true}if(n){return}d.find("#error-message-placeholder").empty();d.find(".field-status-results").remove();d.find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.check",data:{permissionId:m.params().permissionId}});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/permissions?username={0}&issueKey={1}&permissionId={2}",m.params().username,m.params().issueKey,m.params().permissionId),complete:function(s,u,q){d.find(".status-loading").remove();if(q.successful){var t=q.data;var r=j(t.statusLines);var p=AJS.$(JIRA.Templates.Dialogs.PermissionHelper.resultPage({permissionName:t.permissionName,username:t.username,userDisplayName:t.userDisplayName,issueKey:t.issueKey,projectKey:t.projectKey,projectName:t.projectName,status:t.status,statusLines:r,hideFailedStatuses:g(r),allFailedStatuses:!g(r),allGreenStatuses:a(r),baseUrl:contextPath,permissionSchemeName:t.permissionSchemeName}));d.find(".field-status-placeholder").append(p);if(c){c()}p.delegate(".show-failed-conditions","click",function(v){console.log("SHOWING");v.preventDefault();AJS.$(".statusRow[data-status='red']").show();AJS.$(".show-failed-conditions").hide();AJS.$(".hide-failed-conditions").show();JIRA.PermissionHelper.dialog._positionInCenter()});p.delegate(".hide-failed-conditions","click",function(v){console.log("HIDING");v.preventDefault();AJS.$(".statusRow[data-status='red']").hide();AJS.$(".hide-failed-conditions").hide();AJS.$(".show-failed-conditions").show();JIRA.PermissionHelper.dialog._positionInCenter()})}else{f(d,q)}}})};l.searchForm.submit(k);l.searchButton.click(k);function e(m,n){m.parent().append(AJS.$("<div>").addClass("error").text(n))}function h(m,n){return{permissionId:function(){var o=m.find("#permissionhelper-permission option:selected");if(o.length>0){return o.val()}else{return 10}},paramsForRequest:function(){return n.asRequestParams(this._paramsFromContents())},params:function(){return n.params(this._paramsFromContents())},_paramsFromContents:function(){var r={};var q=m.find("#permissionhelper-user option:selected");if(q.length==1){r.username=q.val()}else{r.username=""}var p=m.find("#permissionhelper-issue option:selected");if(p.length>0){r.issueKey=p.val()}var o=m.find("#permissionhelper-permission option:selected");if(o.length>0){r.permissionId=o.val()}return r}}}function j(p){if(p.length==0){return p}function n(s){var r=[];AJS.$.each(s,function(t,u){r.push(o(u))});return r}function o(s){if(s.parameters.length==0){return AJS.escapeHTML(s.message)}else{var r=m(s.parameters);r.splice(0,0,AJS.escapeHTML(s.message));return AJS.format.apply(this,r)}}function m(s){var r=[];AJS.$.each(s,function(t,u){if(u.type=="plain"){r.push(AJS.escapeHTML(u.value))}else{if(u.type=="link"){r.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(u.href),AJS.escapeHTML(u.text)))}else{if(u.type=="newline"){r.push("<br/>")}else{if(u.type=="tagstart"){r.push("<"+u.tagName+">")}else{if(u.type=="tagend"){r.push("</"+u.tagName+">")}else{throw"Unrecognized parameter type: "+u.type}}}}}});return r}var q=[];AJS.$.each(p,function(t,r){var s={};s.status=r.status;s.required=r.required;s.summary=n(r.summary);s.details=n(r.details);q.push(s)});return q}function g(o){var m=false;var n=false;AJS.$.each(o,function(q,p){if(p.status=="green"){m=true}else{if(p.required){n=true}}});return n?false:m}function a(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="red"){m=true}});return !m}function f(p,o){var m=false;var r=[];if(o.data){var q=JSON.parse(o.data);if(q.errorMessages&&q.errorMessages.length){r.push(q.errorMessages);m=true}if(q.errors){if(q.errors.issue){e(AJS.$("#permissionhelper-issue",p),q.errors.issue);m=true}if(q.errors.user){e(AJS.$("#permissionhelper-user",p),q.errors.user);m=true}if(q.errors.permission){e(AJS.$("#permissionhelper-permission",p),q.errors.permission);m=true}}}if(!m){r.push(JIRA.SmartAjax.buildSimpleErrorContent(o))}var n=l.searchForm.find("#error-message-placeholder");AJS.$.each(r,function(s,t){AJS.messages.error(n,{body:t,closeable:false})})}function i(){new JIRA.AdminHelper.IssuePicker({element:AJS.$("#permissionhelper-issue"),itemAttrDisplayed:"label",width:500});new AJS.SingleSelect({element:AJS.$("#permissionhelper-permission"),itemAttrDisplayed:"label",width:500})}return l}}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper-dialog.js' */
if(AJS.Meta.get("is-admin")){JIRA.PermissionHelper.PermissionHelperDialog=JIRA.Dialog.extend({_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"permission-helper-dialog",widthClass:"large",stacked:true})},_setContent:function(c,f){var a=this;if(c){this._super(c,f)}else{var e=this.context().issueKey()||"";var b=this.context().permissionId()||"";this._super(AJS.$(JIRA.Templates.Dialogs.PermissionHelper.searchPage({currentIssueKey:e,currentPermissionId:b,permissionGroups:JIRA.PermissionHelper.PERMISSIONS})),true)}this.get$popupContent().find(".cancel").click(function(g){a.hide();g.preventDefault()});if(JIRA.Dialog.current===this){var d=new JIRA.setFocus.FocusConfiguration();d.context=this.get$popup()[0];d.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(d);JIRA.setFocus.triggerFocus()}},decorateContent:function(){var a=this;this.addHeading("Permission Helper");JIRA.PermissionHelper.PermissionHelperUi.initUi(this.get$popupContent(),this.context(),function(){a._positionInCenter()})},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.PermissionHelper.Context=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},permissionId:function(a){if(a){this.options.permissionId=a}else{return this.options.permissionId}},params:function(a){var b=AJS.$.extend({},this.options);if(this._exists(a)){AJS.$.extend(b,a)}return b},asRequestParams:function(a){var c=this.params(a);var b="atl_token="+atl_token();if(this._exists(c.username)){b+="&username="+c.username}if(this._exists(c.issueKey)){b+="&issueKey="+c.issueKey}if(this._exists(c.projectKey)){b+="&projectKey="+c.projectKey}if(this._exists(c.projectId)){b+="&projectId="+c.projectId}if(this._exists(c.issueOperation!==undefined)){b+="&issueOperation="+c.issueOperation}if(this._exists(c.issueTypeId)){b+="&issueTypeId="+c.issueTypeId}return b},_exists:function(a){return typeof(a)!="undefined"}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/permission-helper.js' */
if(AJS.Meta.get("is-admin")){(function(d){var c="Permission Helper";JIRA.PermissionHelper.dialog=new JIRA.PermissionHelper.PermissionHelperDialog;d(document).delegate(".permissionhelper-trigger","click",function(e){e.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.dialog.open"});JIRA.PermissionHelper.dialog.show(a())});d(function(){var e=d("#permission-helper-admin-page");if(e.length==1){b();AJS.trigger("analyticsEvent",{name:"adminhelper.permhelper.adminpage.open"});e.append(d(JIRA.Templates.Dialogs.PermissionHelper.searchPage({noCloseLink:true,permissionGroups:JIRA.PermissionHelper.PERMISSIONS})));e.trigger(JIRA.Events.NEW_CONTENT_ADDED,[e]);JIRA.PermissionHelper.PermissionHelperUi.initUi(e,new JIRA.PermissionHelper.Context());d("#permissionhelper-user-field").focus()}});function a(){var e=JIRA.Issue.getIssueKey();if(!e&&JIRA.IssueNavigator){e=JIRA.IssueNavigator.getSelectedIssueKey()}return new JIRA.PermissionHelper.Context({issueKey:e,issueOperation:JIRA.PermissionHelper.dialog.OPERATION_VIEW})}function b(){var e=d("#permission-helper-admin-page");e.prepend(d("<h2>").attr("id","admin-page-heading").text(c))}})(AJS.$)};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'templates/notification-helper.soy' */
// This file was automatically generated from notification-helper.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Dialogs == 'undefined') { JIRA.Templates.Dialogs = {}; }
if (typeof JIRA.Templates.Dialogs.NotificationHelper == 'undefined') { JIRA.Templates.Dialogs.NotificationHelper = {}; }


JIRA.Templates.Dialogs.NotificationHelper.searchPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="notificationhelper-search-form aui ajs-dirty-warning-exempt"><div class="content-area-container"><div class="form-body"><div id="error-message-placeholder"></div><div class="action-description">', soy.$$escapeHtml("Find out why users receive, or do not receive notifications for this issue"), '</div><div class="field-group"><label for="notificationhelper-user">', soy.$$escapeHtml("User"), '</label><select id="notificationhelper-user" name="notificationhelper-user" class="single-user-picker js-default-user-picker" data-container-class="long-field"></select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a user"), '</div></div><div class="field-group ', (opt_data.currentIssueKey) ? 'hidden' : '', '"><label for="notificationhelper-issue">', soy.$$escapeHtml("Issue"), '</label><select class="aui-field-select select" name="notificationhelper-issue" id="notificationhelper-issue"></select><div class="description">', soy.$$escapeHtml("Begin typing to find an issue"), '</div></div><div class="field-group"><label for="notificationhelper-event">', soy.$$escapeHtml("Notification Event"), '</label><select class="aui-field-select select" name="notificationhelper-event" id="notificationhelper-event">');
  var eventList20 = opt_data.events;
  var eventListLen20 = eventList20.length;
  for (var eventIndex20 = 0; eventIndex20 < eventListLen20; eventIndex20++) {
    var eventData20 = eventList20[eventIndex20];
    output.append('<option ', (eventData20.id == opt_data.defaultEventId) ? 'selected="selected"' : '', ' value="', soy.$$escapeHtml(eventData20.id), '">', soy.$$escapeHtml(eventData20.name), '</option>');
  }
  output.append('</select><div class=\'description\'>', soy.$$escapeHtml("Begin typing to find a notification event or press down to see all"), '</div></div></div><div class="form-body field-status-placeholder" /></div><div class="buttons-container form-footer"><div class="buttons"><input class="button search" type="submit" id="permission-helper-submit" value="', soy.$$escapeHtml("Submit"), '">', (! opt_data.noCloseLink) ? '<a href="#" class="cancel" id="aui-dialog-close">' + soy.$$escapeHtml("Close") + '</a>' : '', '</div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Dialogs.NotificationHelper.resultPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="field-status-results"><div class="aui-message"><ul class="item-details"><li><dl><dt>', soy.$$escapeHtml("Event"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.eventName), '">', soy.$$escapeHtml(opt_data.eventName), '</dd></dl><dl><dt>', soy.$$escapeHtml("User"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.userDisplayName), '">', (opt_data.username != '') ? '<a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/secure/admin/user/ViewUser.jspa?name=' + soy.$$escapeHtml(opt_data.username) + '">' + soy.$$escapeHtml(opt_data.userDisplayName) + '</a>' : soy.$$escapeHtml(opt_data.userDisplayName), '</dd></dl><dl><dt>', soy.$$escapeHtml("Project"), ': </dt><dd title="', soy.$$escapeHtml(opt_data.projectName), '"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/browse/', soy.$$escapeHtml(opt_data.projectKey), '">', soy.$$escapeHtml(opt_data.projectName), '</a></dd></dl><dl><dt>', soy.$$escapeHtml("Scheme"), ': </dt><dd title="blah"><a href="', soy.$$escapeHtml(opt_data.baseUrl), '/plugins/servlet/project-config/', soy.$$escapeHtml(opt_data.projectKey), '/notifications">', soy.$$escapeHtml(opt_data.notificationSchemeName), '</a></dd></dl>', (opt_data.issueKey) ? '<dl><dt>' + soy.$$escapeHtml("Issue") + ': </dt><dd title="' + soy.$$escapeHtml(opt_data.issueKey) + '"><a href="' + soy.$$escapeHtml(opt_data.baseUrl) + '/browse/' + soy.$$escapeHtml(opt_data.issueKey) + '">' + soy.$$escapeHtml(opt_data.issueKey) + '</a></dd></dl>' : '', '<dl><dt>', soy.$$escapeHtml("Status"), ': </dt><dd>');
  JIRA.Templates.AdminHelper.Common.statusImage(opt_data, output);
  if (opt_data.status == 'green') {
    output.append(soy.$$escapeHtml(AJS.format("{0} receives notifications for the \x27\x27{1}\x27\x27 event",opt_data.userDisplayName,opt_data.eventName)));
    if (opt_data.userNotifyOwnChanges == false) {
      output.append('<br>');
      JIRA.Templates.AdminHelper.Common.warningImage(null, output);
      output.append(soy.$$escapeHtml(AJS.format("{0} does not get notified of their own changes.",opt_data.userDisplayName)), ' <a target="_blank" href="https://confluence.atlassian.com/display/JIRA/Managing+your+User+Profile#ManagingyourUserProfile-Preferences">', soy.$$escapeHtml("Learn more"), '</a>.');
    }
  } else {
    output.append(soy.$$escapeHtml(AJS.format("{0} does not receive notifications for the \x27\x27{1}\x27\x27 event",opt_data.userDisplayName,opt_data.eventName)));
  }
  output.append('</dd></dl></li></ul></div>');
  if (opt_data.statusLines.length == 0) {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml(AJS.format("There are no details available about the notifications for the \x27\x27{0}\x27\x27 event",opt_data.eventName)), '</p></div>');
  } else {
    output.append('<table class="status-table aui"><thead><tr><th width="10%">', soy.$$escapeHtml("Status"), '</th><th width="30%">', soy.$$escapeHtml("Summary"), '</th><th width="60%">', soy.$$escapeHtml("Details"), '</th></tr></thead><tbody>');
    var statusLineList129 = opt_data.statusLines;
    var statusLineListLen129 = statusLineList129.length;
    for (var statusLineIndex129 = 0; statusLineIndex129 < statusLineListLen129; statusLineIndex129++) {
      var statusLineData129 = statusLineList129[statusLineIndex129];
      JIRA.Templates.AdminHelper.Common.statusLineRow({statusLine: statusLineData129, hideFailedStatuses: opt_data.hideFailedStatuses}, output);
    }
    output.append('<tbody></table><div class="toggle-conditions-container"><a class="show-failed-conditions" ', (opt_data.hideFailedStatuses == false || opt_data.allGreenStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Show failed conditions"), '</a><a class="hide-failed-conditions" ', (opt_data.hideFailedStatuses == true || opt_data.allFailedStatuses == true) ? 'style="display: none"' : '', '>', soy.$$escapeHtml("Hide failed conditions"), '</a></div>');
  }
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper-ui.js' */
if(AJS.Meta.get("is-admin")){AJS.namespace("JIRA.NotificationHelper");JIRA.NotificationHelper.NOTIFICATION_EVENTS=WRM.data.claim("com.atlassian.jira.plugins.jira-admin-helper-plugin:notification-event-provider.notification-event-data");JIRA.NotificationHelper.defaultEventId=function(){var a;AJS.$(JIRA.NotificationHelper.NOTIFICATION_EVENTS).each(function(){if(this.isDefault){a=this.id}});return a};JIRA.NotificationHelper.NotificationHelperUi={initUi:function(c,k,b){g();var l={};l.searchButton=c.find("input.search");l.searchForm=c.find("form.notificationhelper-search-form");var i=function(o){o.preventDefault();var m=f(c,k);c.find(".error").remove();var n=false;if(!m.params().username){d(AJS.$("#notificationhelper-user",c),"Please select a user");n=true}if(!m.params().issueKey){d(AJS.$("#notificationhelper-issue",c),"Please select an issue");n=true}if(!m.params().eventId){d(AJS.$("#notificationhelper-event",c),"Please select a valid notification event");n=true}if(n){return}c.find("#error-message-placeholder").empty();c.find(".field-status-results").remove();c.find(".field-status-placeholder").append(AJS.$(JIRA.Templates.AdminHelper.Common.loadingStatus()));AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.check",data:{eventId:m.params().eventId}});JIRA.SmartAjax.makeRequest({url:contextPath+AJS.format("/rest/whereismycf/1.0/notifications?username={0}&issueKey={1}&eventId={2}",m.params().username,m.params().issueKey,m.params().eventId),complete:function(t,u,r){c.find(".status-loading").remove();if(r.successful){var p=r.data;var s=h(p.statusLines);var q=AJS.$(JIRA.Templates.Dialogs.NotificationHelper.resultPage({eventName:p.eventName,username:p.username,userDisplayName:p.userDisplayName,userNotifyOwnChanges:p.userNotifyOwnChanges,issueKey:p.issueKey,projectKey:p.projectKey,projectName:p.projectName,status:p.status,statusLines:s,notificationSchemeName:p.notificationSchemeName,hideFailedStatuses:j(s),allFailedStatuses:!j(s),allGreenStatuses:a(s),baseUrl:contextPath}));c.find(".field-status-placeholder").append(q);if(b){b()}q.delegate(".show-failed-conditions","click",function(v){v.preventDefault();AJS.$(".statusRow[data-status='red']").show();AJS.$(".show-failed-conditions").hide();AJS.$(".hide-failed-conditions").show();if(b){b()}});q.delegate(".hide-failed-conditions","click",function(v){v.preventDefault();AJS.$(".statusRow[data-status='red']").hide();AJS.$(".hide-failed-conditions").hide();AJS.$(".show-failed-conditions").show();if(b){b()}})}else{e(c,r)}}})};l.searchForm.submit(i);l.searchButton.click(i);function d(m,n){m.parent().append(AJS.$("<div>").addClass("error").text(n))}function f(m,n){return{eventId:function(){var o=m.find("#notificationhelper-event option:selected");if(eventId.length>0){return o.val()}else{return JIRA.NotificationHelper.defaultEventId()}},paramsForRequest:function(){return n.asRequestParams(this._paramsFromContents())},params:function(){return n.params(this._paramsFromContents())},_paramsFromContents:function(){var r={};var p=m.find("#notificationhelper-user option:selected");if(p.length==1){r.username=p.val()}var o=m.find("#notificationhelper-issue option:selected");if(o.length>0){r.issueKey=o.val()}var q=m.find("#notificationhelper-event option:selected");if(q.length>0){r.eventId=q.val()}return r}}}function h(p){if(p.length==0){return p}function n(s){var r=[];AJS.$.each(s,function(t,u){r.push(o(u))});return r}function o(s){if(s.parameters.length==0){return AJS.escapeHTML(s.message)}else{var r=m(s.parameters);r.splice(0,0,AJS.escapeHTML(s.message));return AJS.format.apply(this,r)}}function m(s){var r=[];AJS.$.each(s,function(t,u){if(u.type=="plain"){r.push(AJS.escapeHTML(u.value))}else{if(u.type=="link"){r.push(AJS.format("<a href=''{0}'' target=''_blank''>{1}</a>",AJS.escapeHTML(u.href),AJS.escapeHTML(u.text)))}else{if(u.type=="newline"){r.push("<br/>")}else{if(u.type=="tagstart"){r.push("<"+u.tagName+">")}else{if(u.type=="tagend"){r.push("</"+u.tagName+">")}else{throw"Unrecognized parameter type: "+u.type}}}}}});return r}var q=[];AJS.$.each(p,function(t,r){var s={};s.status=r.status;s.summary=n(r.summary);s.details=n(r.details);q.push(s)});return q}function j(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="green"){m=true;return false}});return m}function a(n){var m=false;AJS.$.each(n,function(p,o){if(o.status=="red"){m=true}});return !m}function e(p,o){var m=false;var r=[];if(o.data){var q=JSON.parse(o.data);if(q.errorMessages&&q.errorMessages.length){r.push(q.errorMessages);m=true}if(q.errors){if(q.errors.issue){d(AJS.$("#notificationhelper-issue",p),q.errors.issue);m=true}if(q.errors.user){d(AJS.$("#notificationhelper-user",p),q.errors.user);m=true}if(q.errors.event){d(AJS.$("#notificationhelper-event",p),q.errors.event);m=true}}}if(!m){r.push(JIRA.SmartAjax.buildSimpleErrorContent(o))}var n=l.searchForm.find("#error-message-placeholder");AJS.$.each(r,function(s,t){AJS.messages.error(n,{body:t,closeable:false})})}function g(){new JIRA.AdminHelper.IssuePicker({element:AJS.$("#notificationhelper-issue"),itemAttrDisplayed:"label",width:500});new AJS.SingleSelect({element:AJS.$("#notificationhelper-event"),itemAttrDisplayed:"label",width:500})}return l}}};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper-dialog.js' */
if(AJS.Meta.get("is-admin")){JIRA.NotificationHelper.NotificationHelperDialog=JIRA.Dialog.extend({_getDefaultOptions:function(){return AJS.$.extend(this._super(),{cached:false,id:"permission-helper-dialog",widthClass:"large",stacked:true})},_setContent:function(b,e){var a=this;if(b){this._super(b,e)}else{var d=this.context().issueKey()||"";this._super(AJS.$(JIRA.Templates.Dialogs.NotificationHelper.searchPage({currentIssueKey:d,events:JIRA.NotificationHelper.NOTIFICATION_EVENTS,defaultEventId:JIRA.NotificationHelper.defaultEventId()})),true)}this.get$popupContent().find(".cancel").click(function(f){a.hide();f.preventDefault()});if(JIRA.Dialog.current===this){var c=new JIRA.setFocus.FocusConfiguration();c.context=this.get$popup()[0];c.parentElementSelectors=[".form-body"];JIRA.setFocus.pushConfiguration(c);JIRA.setFocus.triggerFocus()}},decorateContent:function(){var a=this;this.addHeading("Notification Helper");JIRA.NotificationHelper.NotificationHelperUi.initUi(this.get$popupContent(),this.context(),function(){a._positionInCenter()})},show:function(a){if(a){this.context(a)}if(!this.options.context){throw"This class must be initialized with 'context' parameter before calling show()"}this._super()},context:function(a){if(a){this.options.context=a}else{return this.options.context}},hide:function(a){if(this._super(a)===false){return false}JIRA.setFocus.popConfiguration()}});JIRA.NotificationHelper.Context=Class.extend({init:function(a){this.options=a||{}},issueKey:function(a){if(a){this.options.issueKey=a}else{return this.options.issueKey}},eventId:function(a){if(a){this.options.permissionId=a}else{return this.options.eventId}},params:function(a){var b=AJS.$.extend({},this.options);if(this._exists(a)){AJS.$.extend(b,a)}return b},asRequestParams:function(a){var c=this.params(a);var b="atl_token="+atl_token();if(this._exists(c.username)){b+="&username="+c.username}if(this._exists(c.issueKey)){b+="&issueKey="+c.issueKey}if(this._exists(c.projectKey)){b+="&projectKey="+c.projectKey}if(this._exists(c.projectId)){b+="&projectId="+c.projectId}if(this._exists(c.issueOperation!==undefined)){b+="&issueOperation="+c.issueOperation}if(this._exists(c.issueTypeId)){b+="&issueTypeId="+c.issueTypeId}return b},_exists:function(a){return typeof(a)!="undefined"}})};;
;/* module-key = 'com.atlassian.jira.plugins.jira-admin-helper-plugin:whereismycf-resources', location = 'js/notification-helper.js' */
if(AJS.Meta.get("is-admin")){(function(d){var c="Notification Helper";JIRA.NotificationHelper.dialog=new JIRA.NotificationHelper.NotificationHelperDialog;d(document).delegate(".notificationhelper-trigger","click",function(e){e.preventDefault();AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.dialog.open"});JIRA.NotificationHelper.dialog.show(a())});d(function(){var e=d("#notification-helper-admin-page");if(e.length==1){b();AJS.trigger("analyticsEvent",{name:"adminhelper.notihelper.adminpage.open"});e.append(d(JIRA.Templates.Dialogs.NotificationHelper.searchPage({noCloseLink:true,events:JIRA.NotificationHelper.NOTIFICATION_EVENTS,defaultEventId:JIRA.NotificationHelper.defaultEventId()})));e.trigger(JIRA.Events.NEW_CONTENT_ADDED,[e]);JIRA.NotificationHelper.NotificationHelperUi.initUi(e,new JIRA.NotificationHelper.Context());d("#notificationhelper-user-field").focus()}});function a(){var e=JIRA.Issue.getIssueKey();if(!e&&JIRA.IssueNavigator){e=JIRA.IssueNavigator.getSelectedIssueKey()}return new JIRA.NotificationHelper.Context({issueKey:e,issueOperation:JIRA.NotificationHelper.dialog.OPERATION_VIEW})}function b(){var e=d("#notification-helper-admin-page");e.prepend(d("<h2>").attr("id","admin-page-heading").text(c))}})(AJS.$)};;
;/* module-key = 'com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics', location = 'browser-metrics-legacy.js' */
(function(){var a=window.BrowserMetrics||{};var b=window.WRM||{};a.isFunction=function(c){return !!(c&&c.constructor&&c.call&&c.apply)};a.isEnabled=function(){if(a.enabled===undefined){var c="com.atlassian.plugins.browser.metrics.browser-metrics-plugin:browser-metrics.feature-data-provider-legacy";a.enabled=a.isFunction(b.data)?b.data(c):b.data.claim(c)}return a.enabled};window.BrowserMetrics=a}());(function(){var b=window.BrowserMetrics||{};if(b.isEnabled()){var f=5;var e=12000;var c=function(g){return Math.round(g)};var a=function(g){return Math.round(g*100)/100};var d=function(k){var h=(function(){var n=/^(\w+):\/\/([^\/]*)(.*)$/;return function(p){var o=p.match(n);if(!o){return{path:p}}return{scheme:o[1],host:o[2],path:o[3]}}}());var i=(function(){var n=["secureConnectionStart","requestStart","responseStart","responseEnd","domContentLoadedEventStart","domContentLoadedEventEnd","loadEventEnd"];return function(o){if(k.performance&&k.performance.getEntries){Array.prototype.forEach.call(k.performance.getEntries(),function(u){if(u.name.match("experimental/main.js")){o("experimentalMainJsDuration",u.duration)}})}if(k.performance){var s=k.performance.timing;var p=s.navigationStart;if(p){for(var r=0;r<n.length;++r){var q=n[r];var t=s[q];if(t){o(q,t-p)}}}}}}());var g=(function(){var o=[{key:"LOGIN",pattern:/^\/login.*/i},{key:"J-DASH",pattern:/^\/secure\/dashboard\.jspa.*/i},{key:"J-ISSUE",pattern:/^\/browse\/\w+\-\w+.*/i},{key:"J-NAV",pattern:/^\/issues.*/i},{key:"J-RAPID",pattern:/secure\/rapidboard\.jspa/i},{key:"SD-AGENT",pattern:/^(\/\w+)?\/servicedesk\/agent\/.*/i},{key:"SD-CUSTOMER",pattern:/^(\/\w+)?\/servicedesk\/customer\/.*/i},{key:"C-DASH",pattern:/^\/wiki(\/)?(\?.*|#.*)?$/i},{key:"C-DASH",pattern:/^\/wiki\/dashboard\.action.*$/i},{key:"C-SPACE",pattern:/^\/wiki\/display\/\w+(\?.*|#.*)?$/i},{key:"C-PAGE",pattern:/^\/wiki\/display\/\w+\/.*/i},{key:"C-PAGE",pattern:/^\/wiki\/pages\/viewpage\.action.*/i},{key:"C-BLOG",pattern:/^\/wiki\/display\/~\w+\/\d+\/\d+\/\d+\/.*/i},{key:"C-EDITOR",pattern:/^\/wiki\/pages\/editpage\.action.*/i},{key:"C-CREATE",pattern:/^\/wiki\/pages\/createpage\.action.*/i}];return function n(){var r=h(k.location.href).path;for(var p=0;p<o.length;++p){var q=o[p];if(r.match(q.pattern)){return q.key}}return null}}());function j(){var n=g();if(n){i(function(p,r){var o="browser.metrics."+p,q={version:f,page:n,value:r>e?"x":Math.ceil((r)/100),rawValue:c(r)};AJS.Analytics?AJS.Analytics.triggerPrivacyPolicySafeEvent(o,q):AJS.trigger("analyticsEvent",{name:o,data:q})})}}function m(){try{j()}catch(n){if(window.console){window.console.log("Error reporting browser metrics: "+n)}}}function l(){if(k.performance.timing.loadEventEnd){m()}else{setTimeout(l,1000)}}if(k.performance&&k.performance.timing){l()}};if(!window.ATL_PERF){window.ATL_PERF={}}window.ATL_PERF.initPageLoad=d}}());(function(){var b=window.BrowserMetrics||{};if(b.isEnabled()){var e=5;var d=12000;var a=function(f){return Math.round(f*100)/100};var c=function(g){var l={};function h(){return g.performance&&g.performance.now?g.performance.now():new Date().getTime()}function n(o){return o===Object(o)}function k(o){if(n(o)){return o.eventName+"."+o.eventType}else{return o}}function m(o){if(n(o)){return o.eventName}else{return o}}function j(o){if(n(o)){return o.eventType}else{return""}}function f(o){var p=k(o);l[p]=h()}function i(r,u){var v=k(r);if(!l[v]){throw ("Error logging browser metrics event end: no start event for key '"+v+"'")}var t=h()-l[v];l[v]=null;var o=m(r),q=j(r);var p="browser.metrics.e."+o+(u?"."+u:""),s={version:e,value:t>d?"x":Math.ceil((t)/100),rawValue:a(t),eventType:q};g.AJS.Analytics?g.AJS.Analytics.triggerPrivacyPolicySafeEvent(p,s):g.AJS.trigger("analyticsEvent",{name:p,data:s})}return{start:f,end:i}};if(!window.ATL_PERF){window.ATL_PERF={}}window.ATL_PERF.initEvents=c}}());(function(){var a=window.BrowserMetrics||{};if(a.isEnabled()){if(Math.random()<0.1){window.ATL_PERF&&window.ATL_PERF.initPageLoad&&window.ATL_PERF.initPageLoad(window)}window.ATL_PERF&&window.ATL_PERF.initEvents&&(function(){window.BrowserMetrics=window.ATL_PERF.initEvents(window)}())}}());;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/js/DemoProjectTemplate.js' */
JPT.DemoProjectTemplate={};JPT.DemoProjectTemplate.init=function init(){AJS.$("body").on("com.atlassian.jira-core-project-templates:jira-sample-item",function(b,a){JPT.DemoProjectTemplate.createDemoProject(a)})};JPT.DemoProjectTemplate.createDemoProject=function createDemoProject(a){a.addPanel("DemoProjectTemplate",JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject(),"");$demoProjectForm=AJS.$("<form></form>");$demoProjectForm.attr("action",contextPath+"/secure/CreateDemoProject.jspa");$demoProjectAtlTokenField=AJS.$("<input type='hidden' name='atl_token' value='' />");$demoProjectAtlTokenField.val(atl_token());$demoProjectForm.append($demoProjectAtlTokenField);$demoProjectForm.appendTo(JPT.DialogController.$dialogElement);$demoProjectForm.submit()};AJS.$(JPT.DemoProjectTemplate.init);;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/CoreProjectTemplates.soy' */
// This file was automatically generated from CoreProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderLoadingSampleProject = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'demo-loading-container\'><span class=\'icon throbber loading\'/><span class=\'demo-loading-message\'>', soy.$$escapeHtml("Loading Demo Project"), '</span></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira-core-project-templates:jira-sample-project-resources', location = '/soy/IssueTrackingTemplates.soy' */
// This file was automatically generated from IssueTrackingTemplates.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ProjectTemplates == 'undefined') { JIRA.Templates.ProjectTemplates = {}; }
if (typeof JIRA.Templates.ProjectTemplates.CoreTemplates == 'undefined') { JIRA.Templates.ProjectTemplates.CoreTemplates = {}; }


JIRA.Templates.ProjectTemplates.CoreTemplates.renderIssueTrackingExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation({description: "This project provides you with a quick and easy way to get JIRA up and running for simple issue tracking. Select this project to keep things simple. You can optionally configure these later."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.CoreTemplates.renderProjectManagementExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation({description: "This project provides you with a quick and easy way to get JIRA up and running for project management. You can optionally configure these later."}, output);
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ProjectTemplates.CoreTemplates.renderExplanation = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-tracking-info"><div class="left-info"><p>', soy.$$escapeHtml(opt_data.description), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li></ul></div><div class="right-info issue-tracking-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:issue-link-confluence-js', location = 'js/issuelink-confluence.js' */
(function($){var settings={getCurrentAppId:function(context){return $("#issue-link-confluence-app-id",context).val()},shouldExecute:function(context){return $("#confluence-page-link",context).length!==0},getIssueId:function(context){return $("input[name=id]",context).val()}};JIRA.bind(JIRA.Events.NEW_PAGE_ADDED,function(e,context){IssueLinkAppLinks.init(settings,context)})})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'js/ConfluencePageSearch.js' */
AJS.$(function($){var confluenceSearchDialog=new JIRA.FormDialog({id:"confluence-page-search-dialog",trigger:"#confluence-page-link .confluence-search-trigger",widthClass:"large",height:"565px",content:function(render){var dialog=this;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/applink",complete:function(xhr,textStatus,smartAjaxResult){if(smartAjaxResult.successful){var appLinks=smartAjaxResult.data.applicationLinks;render(JIRA.Templates.ConfluencePageSearch.result({appLinks:appLinks}));initAppLinks(dialog).done(function(context,helper){initSearchDialog(context,helper);$("#link-search-text",context).focus()})}else{AJS.messages.error("#search-results-table",{body:"The JIRA server could not be contacted. This may be a temporary glitch or the server may be down.",closeable:false});render()}}})},submitHandler:function(e,callback){e.preventDefault();$("#search-panel-button").click().removeAttr("disabled");callback()}});function initSearchDialog($dialog,helper){$("#confluence-app-link",$dialog).change(function(){var authenticationRequired=helper.selectServer($(this).val()).authenticationRequired;if(!authenticationRequired){populateSpaces($dialog,$(this).val(),helper)}$("#search-results-table",$dialog).empty();setSearchControlsEnabled(true,$dialog)});$("#search-panel-button",$dialog).click(function(){$("#search-results-table",$dialog).empty();var searchText=$("#link-search-text",$dialog).val();searchText=$.trim(searchText);if(searchText){doSearch(searchText,$dialog)}else{AJS.messages.info("#search-results-table",{body:"Please enter search value.",closeable:false})}return false})}var spaceAjaxId=0;function populateSpaces($context,appId,helper){$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.allSpacesOption());var myAjaxId=++spaceAjaxId;JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/space?appId="+appId,complete:function(xhr,textStatus,smartAjaxResult){if(myAjaxId!==spaceAjaxId){return }if(smartAjaxResult.successful){var spaces=smartAjaxResult.data.spaces;$("select#search-panel-space",$context).html(JIRA.Templates.ConfluencePageSearch.spaceOptions({spaces:spaces}))}else{if(smartAjaxResult.status===401){helper.setAuthenticationRequired(appId,true)}else{setSearchControlsEnabled(false,$context);var msg;if(smartAjaxResult.status===403){msg="Content on the Confluence site could not be accessed because the Confluence server\'s \'Remote API\' feature is disabled. The Confluence system administrator must enable this \'Remote API\' feature for JIRA to successfully access this content."}else{msg="Unable to gather information from the selected Confluence instance."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}}}})}function setSearchControlsEnabled(enabled,$context){if(enabled){$("#link-search-text",$context).removeAttr("disabled");$("#search-panel-space",$context).removeAttr("disabled");$("#search-panel-button",$context).removeAttr("disabled")}else{$("#link-search-text",$context).attr("disabled","disabled");$("#search-panel-space",$context).attr("disabled","disabled");$("#search-panel-button",$context).attr("disabled","disabled")}}function setLoadingIconVisible(visible,$context){$("#link-search-loading",$context).toggleClass("hidden",!visible)}function doSearch(searchText,$context){setLoadingIconVisible(true,$context);var appLinkId=$("#confluence-app-link",$context).val();var spaceKey=$("#search-panel-space option:selected",$context).val();JIRA.SmartAjax.makeRequest({url:contextPath+"/rest/confluenceIssueLink/1/confluence/search?query="+searchText+"&appId="+appLinkId+"&spaceKey="+spaceKey+"&maxResults=10",complete:function(xhr,textStatus,smartAjaxResult){setLoadingIconVisible(false,$context);if(smartAjaxResult.successful){var results=smartAjaxResult.data.result;var resultHtml=JIRA.Templates.ConfluencePageSearch.resultsTable({results:results});$("#search-results-table",$context).html(resultHtml)}else{var msg;if(smartAjaxResult.hasData){msg="The JIRA server was contacted but has returned an error response. We are unsure of the result of this operation."}else{msg="The JIRA server could not be contacted. This may be a temporary glitch or the server may be down."}AJS.messages.error("#search-results-table",{body:msg,closeable:false})}$("#confluence-searchresult tbody tr",$context).click(function(){var linkUrl=$(this).children().first().data("url");$("#confluence-page-url").val(linkUrl);$("#link-issue-dialog .error").hide();confluenceSearchDialog.hide();$("#link-issue-dialog").show();$("#confluence-page-url").focus().select()})}})}function initAppLinks(dialog){var settings={getCurrentAppId:function(context){return $("#confluence-app-link",context).val()},shouldExecute:function(context){return $("#confluence-app-link",context).length!==0},onAuthenticationSuccessCallback:function(context,currentAppId,helper){populateSpaces(context,currentAppId,helper)},getIssueId:function(context){return $("#confluence-page-link input[name=id]").val()}};return IssueLinkAppLinks.init(settings,dialog.$popup).done(function(context,helper){populateSpaces(context,settings.getCurrentAppId(context),helper)})}});;
;/* module-key = 'com.atlassian.jira.jira-issue-link-confluence-plugin:confluence-page-resource', location = 'templates/dialog/searchresult.soy' */
// This file was automatically generated from searchresult.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.ConfluencePageSearch == 'undefined') { JIRA.Templates.ConfluencePageSearch = {}; }


JIRA.Templates.ConfluencePageSearch.result = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<h2>', soy.$$escapeHtml("Find a Confluence page"), '</h2><form class="aui search-form" id="confluence-page-search-form" action="#" method="post"><div class="field-group"><label for="confluence-app-link">', soy.$$escapeHtml("Server"), ':</label>');
  if (opt_data.appLinks.length == 1) {
    output.append('<span class="field-value">', soy.$$escapeHtml(opt_data.appLinks[0].name), '</span><input id="confluence-app-link" class="hidden" type="hidden" name="appId" value="', soy.$$escapeHtml(opt_data.appLinks[0].id), '"/>');
  } else {
    output.append('<select id="confluence-app-link" class="select medium-field" name="appId">');
    var appLinkList17 = opt_data.appLinks;
    var appLinkListLen17 = appLinkList17.length;
    for (var appLinkIndex17 = 0; appLinkIndex17 < appLinkListLen17; appLinkIndex17++) {
      var appLinkData17 = appLinkList17[appLinkIndex17];
      output.append('<option value="', soy.$$escapeHtml(appLinkData17.id), '">', soy.$$escapeHtml(appLinkData17.name), '</option>');
    }
    output.append('</select>');
  }
  output.append('</div><div class="issue-link-applinks-authentication-message applinks-message-bar"></div><div class="hidden"><input class="issue-link-applinks-application-type" type="hidden" value="com.atlassian.applinks.api.application.confluence.ConfluenceApplicationType"/></div><div class="issue-link-oauth-toggle field-group"><label for="link-search-text" id="linkSearch-label">', soy.$$escapeHtml("Search"), ':</label><input id="link-search-text" type="text" tabindex="0" class="text" name="linkSearch" size="50" /> <select tabindex="0" class="search-space select" id="search-panel-space"><option value="">', soy.$$escapeHtml("All Spaces"), '</option></select> <input type="submit" tabindex="0" class="aui-button" id="search-panel-button" value="', soy.$$escapeHtml("Search"), '"/><span id="link-search-loading" class="icon loading throbber hidden"/></div><div class="message-panel hidden"></div><div id="search-results-table" class="data-table"></div><div class="buttons-container form-footer"><div class="buttons"><button class="aui-button aui-button-link cancel" id="confluence-link-cancel" title="', soy.$$escapeHtml("Press Esc to close"), '">', soy.$$escapeHtml("Close"), '</button></div></div></form>');
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.resultsTable = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.results.length > 0) {
    output.append('<table id="confluence-searchresult" class="aui"><thead><tr><th width="180px">', soy.$$escapeHtml("Title"), '</th><th width="550px">', soy.$$escapeHtml("Excerpt"), '</th></tr></thead><tbody>');
    var resultList44 = opt_data.results;
    var resultListLen44 = resultList44.length;
    for (var resultIndex44 = 0; resultIndex44 < resultListLen44; resultIndex44++) {
      var resultData44 = resultList44[resultIndex44];
      output.append('<tr title="', soy.$$escapeHtml(resultData44.title), '"><td class="title" data-url="', soy.$$escapeHtml(resultData44.url), '">', soy.$$escapeHtml(resultData44.title), '</td><td class="excerpt">', soy.$$escapeHtml(resultData44.excerpt), '</td></tr>');
    }
    output.append('</tbody></table>');
  } else {
    output.append('<div class="aui-message info"><span class="aui-icon icon-info"></span><p>', soy.$$escapeHtml("Search returned no results."), '</p></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.spaceOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option>');
  var spaceList64 = opt_data.spaces;
  var spaceListLen64 = spaceList64.length;
  for (var spaceIndex64 = 0; spaceIndex64 < spaceListLen64; spaceIndex64++) {
    var spaceData64 = spaceList64[spaceIndex64];
    output.append('<option value="', soy.$$escapeHtml(spaceData64.key), '">', soy.$$escapeHtml(spaceData64.name), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.ConfluencePageSearch.allSpacesOption = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="">', soy.$$escapeHtml("All Spaces"), '</option><option value="" disabled="disabled">', soy.$$escapeHtml("Loading..."), '</option>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-feedback-plugin:shared-resources', location = '/js/shared/Link.js' */
(function(){var c;var a=function(d){return AJS.Meta.getBoolean(d)===true};var b=Class.extend({suppress:function(){c=true;return undefined},isSuppressed:function(){if(c===true){return true}return a("disable-issue-collector")}});JIRA=JIRA||{};JIRA.Feedback=JIRA.Feedback||{};JIRA.Feedback.Link=new b()})();;
;/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/templates/feedback-link.soy' */
// This file was automatically generated from feedback-link.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Feedback == 'undefined') { JIRA.Feedback = {}; }
if (typeof JIRA.Feedback.Plugin == 'undefined') { JIRA.Feedback.Plugin = {}; }


JIRA.Feedback.Plugin.subtleLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'jira-feedback-link-container float subtle-style\'><a class=\'js-feedback-link jira-feedback-link\' href=\'#\'>', soy.$$escapeHtml("Got Feedback?"), '</a></div>');
  return opt_sb ? '' : output.toString();
};


JIRA.Feedback.Plugin.footerLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class=\'jira-feedback-link-container footer-style\'><a class="aui-button jira-feedback-link ">', soy.$$escapeHtml("Got Feedback?"), '</a></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/js/jic-bootstrap.js' */
(function($){var ATL_JQ=function(){return $.apply($,arguments)};var baseUrl="https://jira.atlassian.com";var css=".atlwdg-blanket {background: black;height: 100%;left: 0;opacity: .5;position: fixed;top: 0;width: 100%;z-index: 1000000;}.atlwdg-popup {background: white;border: 1px solid #666;position: fixed;top: 50%;left: 50%;z-index: 10000011;}.atlwdg-popup.atlwdg-box-shadow {-moz-box-shadow: 10px 10px 20px rgba(0,0,0,0.5);-webkit-box-shadow: 10px 10px 20px rgba(0,0,0,0.5);box-shadow: 10px 10px 20px rgba(0,0,0,0.5);background-color: white;}.atlwdg-hidden {display: none;}.atlwdg-trigger {position: fixed;background: #013466;padding: 5px;border: 2px solid white;border-top: none;font-weight: bold;color: white !important;display: block;white-space: nowrap;text-decoration: none !important;font-family: arial, FreeSans, Helvetica, sans-serif;font-size: 12px;box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-webkit-box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);-moz-box-shadow: 5px 5px 10px rgba(0, 0, 0, 0.5);border-radius: 0 0 5px 5px;-moz-border-radius: 0 0 5px 5px;}.atlwdg-trigger.atlwdg-TOP {left: 45%;top: 0;}.atlwdg-trigger.atlwdg-RIGHT {left: 100%;top: 40%;-webkit-transform-origin: top left;-webkit-transform: rotate(90deg);-moz-transform: rotate(90deg);-moz-transform-origin: top left;-ms-transform: rotate(90deg);-ms-transform-origin: top left;}.atlwdg-trigger.atlwdg-SUBTLE {right: 0;bottom: 0;border: 1px solid #ccc;border-bottom: none;border-right: none;background-color: #f5f5f5;color: #444;font-size: 11px;padding: 6px;box-shadow: -1px -1px 2px rgba(0, 0, 0, 0.5);border-radius: 2px 0 0 0;}.atlwdg-loading {position: absolute;top: 220px;left: 295px;}";var cssIE=".atlwdg-trigger {position: absolute;}.atlwdg-blanket {position: absolute;filter: alpha(opacity=50);width: 110%;}.atlwdg-popup {position: absolute;}.atlwdg-trigger.atlwdg-RIGHT {left: auto;right: 0;filter: progid:DXImageTransform.Microsoft.BasicImage(rotation=1);}";ATL_JQ.isQuirksMode=function(){return document.compatMode!="CSS1Compat"};ATL_JQ.IssueDialog=function(options){var $body=$("body"),that=this,showDialog=function(){that.show();return false};this.options=options;this.frameUrl=baseUrl+"/rest/collectors/1.0/template/form/"+this.options.collectorId+"?os_authType=none";$("head").append("<style type='text/css'>"+css+"</style>");if(this.options.triggerPosition==="CUSTOM"){var oldTriggerFunction;if(this.options.triggerFunction){try{oldTriggerFunction=eval("("+this.options.triggerFunction+")")}catch(ex){}}$(function(){try{var newTriggerFunction;if(window.ATL_JQ_PAGE_PROPS&&((window.ATL_JQ_PAGE_PROPS.triggerFunction)||(window.ATL_JQ_PAGE_PROPS[this.options.collectorId]&&window.ATL_JQ_PAGE_PROPS[this.options.collectorId].triggerFunction))){newTriggerFunction=window.ATL_JQ_PAGE_PROPS.triggerFunction||window.ATL_JQ_PAGE_PROPS[this.options.collectorId].triggerFunction}else{newTriggerFunction=oldTriggerFunction}if($.isFunction(newTriggerFunction)){newTriggerFunction(showDialog)}}catch(ex){}})}else{if($.isFunction(this.options.triggerPosition)){try{this.options.triggerPosition(showDialog)}catch(ex){}}else{if(this.options.triggerPosition&&this.options.triggerText){var triggerClass="atlwdg-trigger atlwdg-"+this.options.triggerPosition;var $trigger=$("<a href='#' id='atlwdg-trigger'/>").addClass(triggerClass).text(this.options.triggerText);$body.append($trigger);$trigger.click(showDialog)}}}var $iframeContainer=$("<div id='atlwdg-container'/>").addClass("atlwdg-popup atlwdg-box-shadow atlwdg-hidden");var $blanket=$("<div id='atlwdg-blanket' class='atlwdg-blanket'/>").hide();$body.append($blanket).append($iframeContainer);if($.browser.msie&&(ATL_JQ.isQuirksMode()||$.browser.version<9)){$("head").append("<style type='text/css'>"+cssIE+"</style>");var triggerAdjuster=function(e){};if(this.options.triggerPosition==="TOP"){triggerAdjuster=function(e){$("#atlwdg-trigger").css("top",$(window).scrollTop()+"px")}}else{if(this.options.triggerPosition==="RIGHT"){triggerAdjuster=function(e){var $trigger=$("#atlwdg-trigger");$trigger.css("top",($(window).height()/2-$trigger.outerWidth()/2+$(window).scrollTop())+"px");if(!ATL_JQ.isQuirksMode()&&$.browser.version==="8.0"){$trigger.css("right",-($trigger.outerHeight()-$trigger.outerWidth())+"px")}}}else{if(this.options.triggerPosition==="SUBTLE"){var outerHeight=$trigger.outerHeight();triggerAdjuster=function(e){var $window=$(window);$trigger.css("top",($window.scrollTop()+$window.height()-outerHeight)+"px")}}}}$(window).bind("scroll resize",triggerAdjuster);triggerAdjuster()}};ATL_JQ.IssueDialog.prototype={hideDialog:undefined,updateContainerPosition:function(){var width=810,height=450;$("#atlwdg-container").css({height:height+"px",width:width+"px","margin-top":-Math.round(height/2)+"px","margin-left":-Math.round(width/2)+"px"});$("#atlwdg-frame").height("100%").width("100%")},show:function(){var that=this,$iframeContainerElem=$("#atlwdg-container"),$body=$("body"),$iframeElem=$('<iframe id="atlwdg-frame" frameborder="0" src="'+this.frameUrl+'"></iframe>'),$loadingImage=$('<img class="atlwdg-loading" style="display:none;" src="https://jira.atlassian.com/images/throbber/loading_barber_pole_horz.gif">');hideDialog=function(e){if(e.keyCode===27){that.hide()}};$iframeContainerElem.append($loadingImage);var throbberTimeout=setTimeout(function(){$loadingImage.show()},300);$body.css("overflow","hidden").keydown(hideDialog);window.scroll(0,0);var feedbackString="";if(this.options.collectFeedback){var feedback=this.options.collectFeedback();for(var prop in feedback){if(feedback.hasOwnProperty(prop)&&feedback[prop]!==undefined&&feedback[prop]!==""&&typeof feedback[prop]==="string"){feedbackString+="*"+prop+"*: "+feedback[prop]+"\n"}}}var fieldValues={};if(this.options.fieldValues&&!$.isEmptyObject(this.options.fieldValues)){$.extend(fieldValues,this.options.fieldValues)}$iframeElem.load(function(){var message={feedbackString:feedbackString,fieldValues:fieldValues};$iframeElem[0].contentWindow.postMessage(JSON.stringify(message),"https://jira.atlassian.com");$(window).bind("message",function(e){if(e.originalEvent.data&&e.originalEvent.data==="cancelFeedbackDialog"){that.hide()}})});$iframeElem.load(function(e){clearTimeout(throbberTimeout);$loadingImage.hide();$iframeElem.show()});var currentMilis=new Date().getTime();var dummyElement=document.createElement("a");dummyElement.href="https://jira.atlassian.com";$iframeContainerElem.append($iframeElem);this.updateContainerPosition();$iframeContainerElem.show();$("#atlwdg-blanket").show()},hide:function(){$("body").css("overflow","auto").unbind("keydown",hideDialog);$("#atlwdg-container").hide().empty();$("#atlwdg-blanket").hide()}};var filterStrings=function(obj,recursingIn){for(var key in obj){if(!obj.hasOwnProperty(key)){continue}var value=obj[key];if(recursingIn===undefined&&$.isArray(value)){filterStrings(value,key);continue}if(typeof value!=="string"){var paramName=recursingIn===undefined?key:recursingIn+":"+key;console.log("bootstrap.js:filterStrings ignoring key for value '"+paramName+"'; typeof must be string");delete obj[key]}}return obj};window.JIRAS_OWN_ATL_JQ=ATL_JQ})(jQuery);var JSON;if(!JSON){JSON={}}(function(){function f(n){return n<10?"0"+n:n}if(typeof Date.prototype.toJSON!=="function"){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf()}}var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==="string"?c:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+string+'"'}function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==="object"&&typeof value.toJSON==="function"){value=value.toJSON(key)}if(typeof rep==="function"){value=rep.call(holder,key,value)}switch(typeof value){case"string":return quote(value);case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==="[object Array]"){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||"null"}v=partial.length===0?"[]":gap?"[\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"]":"["+partial.join(",")+"]";gap=mind;return v}if(rep&&typeof rep==="object"){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==="string"){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?": ":":")+v)}}}}v=partial.length===0?"{}":gap?"{\n"+gap+partial.join(",\n"+gap)+"\n"+mind+"}":"{"+partial.join(",")+"}";gap=mind;return v}}if(typeof JSON.stringify!=="function"){JSON.stringify=function(value,replacer,space){var i;gap="";indent="";if(typeof space==="number"){for(i=0;i<space;i+=1){indent+=" "}}else{if(typeof space==="string"){indent=space}}rep=replacer;if(replacer&&typeof replacer!=="function"&&(typeof replacer!=="object"||typeof replacer.length!=="number")){throw new Error("JSON.stringify")}return str("",{"":value})}}if(typeof JSON.parse!=="function"){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==="object"){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v}else{delete value[k]}}}}return reviver.call(holder,key,value)}text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})}if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){j=eval("("+text+")");return typeof reviver==="function"?walk({"":j},""):j}throw new SyntaxError("JSON.parse")}}}());;
;/* module-key = 'com.atlassian.jira.jira-feedback-plugin:bootstrap-resources', location = '/js/jira-feedback-plugin.js' */
AJS.$(function(f){var d="d3de7fb5";var g="c612fb25";var e=AJS.Meta.get("version-number");var c=!(f.browser.msie&&parseInt(f.browser.version,10)<9);var b=function(){if(!c){return false}if(AJS.DarkFeatures.isEnabled("com.atlassian.jira.config.CoreFeatures.ON_DEMAND")){return g}if(AJS.params.baseURL&&AJS.params.baseURL.indexOf("sandbox.onjira.com")>=0){return d}if(AJS.Meta.get("is-beta")||AJS.Meta.get("is-rc")||AJS.Meta.get("is-snapshot")||AJS.Meta.get("is-milestone")){return d}if(f(".licensemessagered:contains('JIRA evaluation license')").length>0){return d}return false};var a=b();if(!JIRA.Feedback.Link.isSuppressed()&&a){h();JIRA.bind(JIRA.Events.LAYOUT_RENDERED,i);JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,i)}function i(o,l,n){if((o.type==="newContentAdded"&&n==="pageLoad")||(o.type==="layoutRendered"&&l==="list-view")){var m=f(".navigator-sidebar").hasClass("collapsed");var k=f(".jira-feedback-link-container");k.remove();k=h();if(m&&k.hasClass("subtle-style")){k.addClass("left noborder")}}}function j(){var k=f("#footer-build-information").text();var m=function(){return{Location:window.location.href,"User-Agent":navigator.userAgent,Referrer:document.referrer,"Screen Resolution":screen.width+" x "+screen.height,"JIRA Version":e,"JIRA Footer Version":k}};var l=new JIRAS_OWN_ATL_JQ.IssueDialog({collectorId:a,collectFeedback:m});l.show()}function h(){var m=f("#footer .atlassian-footer:visible").eq(0);var l;if(m.length>0){l=m;l.append(JIRA.Feedback.Plugin.footerLink())}else{l=f("body");l.append(JIRA.Feedback.Plugin.subtleLink())}var k=l.find(".jira-feedback-link-container");k.on("click",".jira-feedback-link",j);return k}});;
;/* module-key = 'com.atlassian.stp.jira-stp-plugin:resources', location = '/js/ace-stp-jira.js' */
var ace=ace||{};ace.stp=ace.stp||{};ace.stp.Jira=function(e){AJS.toInit(function(){if(b()){try{ace.stp.Menu.init();a();c()}catch(f){AJS.log("ACE STP Menu - Could not load: "+f.message);d()}}});function a(){e("#system-help-menu").hide()}function d(){e("#ace-stp-menu").hide()}function b(){return e("#ace-stp-menu").length===1}function c(){e(document).on("showLayer",function(h,g,f){if(g==="inlineDialog"&&f.id==="ace-stp-menu-dialog"){f._validateClickToClose=function(){return false}}})}}(AJS.$);;
;/* module-key = 'com.atlassian.stp.jira-stp-plugin:resources', location = '/ace-stp/menu/js/ace-stp-menu.min.js' */
var ace=ace||{};ace.stp=ace.stp||{},ace.stp.LookAndFeel=function(a){"use strict";function b(){var b=a(".aui-header")[0],d=ace.stp.CrossOriginMessenger.createMessage(ace.stp.MessageTypes.lookAndFeel,{linkColor:c("<a></a>","color"),headerColor:c("<h1></h1>","color"),buttonTextColor:c('<a class="aui-button aui-button-primary aui-style"></a>',"color",b),buttonBackgroundColor:c('<a class="aui-button aui-button-primary aui-style"></a>',"background-color",b),buttonBackgroundGradient:c('<a class="aui-button aui-button-primary aui-style"></a>',"background-image",b)}),e=ace.stp.Util.getFrameBaseUrl(),f=a("#ace-stp-iframe")[0].contentWindow;ace.stp.CrossOriginMessenger.sendMessage(f,e,d)}function c(b,c,d){d=d||"body";var e=a(b).hide().appendTo(d),f=e.css(c);return e.remove(),f}return{sendLookAndFeel:b}}(AJS.$);var ace=ace||{};ace.stp=ace.stp||{},ace.stp.Menu=function(a){"use strict";function b(){ace.stp.CrossOriginMessenger.addListener(ace.stp.MessageTypes.stpInitialized,ace.stp.Util.getFrameBaseUrl(),c),ace.stp.CrossOriginMessenger.addListener(ace.stp.MessageTypes.featureLoaded,ace.stp.Util.getFrameBaseUrl(),h),ace.stp.CrossOriginMessenger.addListener(ace.stp.MessageTypes.analyticsEvent,ace.stp.Util.getFrameBaseUrl(),i),l(),q=m(),q.show(),q.hide(),ace.stp.Notification.init()}function c(b){u===!1&&(d(a("#ace-stp-menu-link"),q),u=!0,r=b.payload.zoneId,ace.stp.LookAndFeel.sendLookAndFeel())}function d(a,b){a.on("click",function(){b.is(":visible")?(b.hide(),f()):(g(),v=0,e())})}function e(){k({name:"ace.stp.open.icon",data:{icon:ace.stp.Notification.getActiveIconClass(),referrer:document.URL}}),k({name:"ace.stp.open",data:{referrer:document.URL,zoneId:r,bannerId:s,campaignId:t}})}function f(){k({name:"ace.stp.close",data:{numClicks:v,referrer:document.URL,zoneId:r,bannerId:s,campaignId:t}})}function g(){var b=ace.stp.CrossOriginMessenger.createMessage(ace.stp.MessageTypes.dialogOpened,{}),c=ace.stp.Util.getFrameBaseUrl(),d=a("#ace-stp-iframe")[0].contentWindow;ace.stp.CrossOriginMessenger.sendMessage(d,c,b)}function h(a){s=a.payload.bannerId,t=a.payload.campaignId}function i(a){j(a.payload.name),k(a.payload)}function j(a){(a===ace.stp.AnalyticEventTypes.majorClick||a===ace.stp.AnalyticEventTypes.minorClick)&&v++}function k(a){("undefined"==typeof a.data.referrer||null===a.data.referrer)&&(a.data.referrer=document.URL),AJS.trigger("analyticsEvent",a)}function l(){var b=a("<iframe>",{src:ace.stp.Util.getFrameUrl()+"?domain="+ace.stp.Util.getBaseUrl(),id:"ace-stp-iframe",frameborder:0,scrolling:"no"});return b.addClass("ace-stp-frame"),b.width(649),b.height(370),b}function m(){return AJS.InlineDialog(a("#ace-stp-menu-link"),"ace-stp-menu-dialog",function(a,b,c){0===a.find("#ace-stp-section").length&&(a.append(n()),a.click(function(a){"A"===a.target.tagName&&setTimeout(function(){ace.stp.Menu.hideDialog()},50)})),c()},{hideCallback:function(){ace.stp.Notification.dismissMessage()},width:905,closeOnTriggerClick:!0,hideDelay:null})}function n(){var b='<div id="ace-stp-section"><div id="ace-stp-help-section"><h1 class="ace-stp-heading">Help</h1><form id="ace-stp-search-form" class="aui" target="_blank" method="get" action="https://confluence.atlassian.com/dosearchsite.action"><span id="ace-stp-icon-search" class="aui-icon aui-icon-large"></span><input id="ace-stp-search-form-input" name="queryString" class="text" type="text" placeholder="Ask a question"><input id="ace-stp-search-space" type="hidden" name="where" value="AOD"></form><ul id="ace-stp-help-links"></ul></div><div id="ace-stp-message-section"></div></div>',c=a(b);return c.find("#ace-stp-message-section").append(l()),c.find("#ace-stp-help-links").append(a("#jira-help").children()),o(c.find("#ace-stp-search-form")),c}function o(a){a.on("submit",function(){k({name:ace.stp.AnalyticEventTypes.search,data:{zoneId:r}})})}function p(){q.hide()}var q,r,s,t,u=!1,v=0;return{init:b,hideDialog:p}}(AJS.$);var ace=ace||{};ace.stp=ace.stp||{},ace.stp.NotificationClasses={help:"ace-stp-icon-help",message:"ace-stp-icon-message",newMessage:"ace-stp-icon-message-new",dismissedMessage:"ace-stp-icon-message-dismiss"},ace.stp.Notification=function(a){"use strict";function b(){p=new ace.stp.StorageManager.instance(q,r),o=g(m().type),o!==ace.stp.NotificationClasses.help&&j(),d()}function c(){(o===ace.stp.NotificationClasses.message||o===ace.stp.NotificationClasses.newMessage)&&f(ace.stp.NotificationTypes.dismissedMessage)}function d(){ace.stp.CrossOriginMessenger.addListener(ace.stp.MessageTypes.messageNotification,ace.stp.Util.getFrameBaseUrl(),function(a){e(a.payload)})}function e(a){return void 0===a.type?void AJS.log("ACE STP Menu - Message Notification - Invalid Payload: "+JSON.stringify(a)):void f(a.type)}function f(a){var b=g(a);b===ace.stp.NotificationClasses.newMessage?i(o,b,1500):h(b),l({type:k(a)})}function g(a){var b=ace.stp.NotificationClasses[a];return void 0===b?(AJS.log("ACE STP Menu - Message Notification - Invalid Notification Type: "+a),null):b}function h(a){o=a,j()}function i(a,b,c){window.setTimeout(function(){o===a&&h(b)},c)}function j(){a.each(ace.stp.NotificationClasses,function(b,c){a("#ace-stp-menu-icon").removeClass(c)}),a("#ace-stp-menu-icon").addClass(o)}function k(a){return a===ace.stp.NotificationTypes.newMessage?ace.stp.NotificationTypes.message:a===ace.stp.NotificationTypes.dismissedMessage?ace.stp.NotificationTypes.help:a}function l(a){p.setItem(s,JSON.stringify(a))}function m(){var a=JSON.parse(p.getItem(s));return null===a&&(a={type:ace.stp.NotificationTypes.help}),a}function n(){return o}var o,p,q="com.atlassian",r="ace",s="stp.jira.notification";return{init:b,updateIcon:f,dismissMessage:c,getActiveIconClass:n}}(AJS.$);var ace=ace||{};ace.stp=ace.stp||{},ace.stp.Util=function(){"use strict";function a(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")}function b(){return ace.stp.Cookie.getCookieUrl(e,d)}function c(){var a=document.createElement("a");return a.href=b(),a.protocol+"//"+a.hostname+(a.port?":"+a.port:"")}var d="https://ace-cdn.atlassian.com/stp/current/dialog/ace-stp-dialog-jira.html",e="ace.stp.menu.jira.frame.url";return{getBaseUrl:a,getFrameUrl:b,getFrameBaseUrl:c}}();var ace=ace||{};ace.stp=ace.stp||{},ace.stp.Cookie=function(){"use strict";function a(a,c){var d=b(a);return null!==d?d:c}function b(a){for(var b=a+"=",c=document.cookie.split(";"),d=0;d<c.length;d++){for(var e=c[d];" "===e.charAt(0);)e=e.substring(1,e.length);if(0===e.indexOf(b))return e.substring(b.length,e.length)}return null}return{getCookieUrl:a,readCookie:b}}();var ace=ace||{};ace.stp=ace.stp||{},ace.stp.CrossOriginMessenger=function(){"use strict";function a(a,b){return JSON.stringify({type:a,payload:b,source:j})}function b(a,b,c){a.postMessage(c,b)}function c(a,b,c){k.push({type:a,domain:d(b),callback:c})}function d(a){return a.replace(/(^https:\/\/.*):443$/,"$1").replace(/(^http:\/\/.*):80$/,"$1")}function e(a){var b=f(a.data);g(b)&&h(b,a.origin)}function f(a){try{return JSON.parse(a)}catch(b){return void 0}}function g(a){return a&&a.source===j}function h(a,b){_.invoke(_.chain(k).where({type:a.type}).filter(i(b)).value(),"callback",a)}function i(a){return function(b){return 0===a.indexOf(b.domain)}}var j="ace.stp.CrossOriginMessenger",k=[];return window.addEventListener("message",e,!1),{createMessage:a,sendMessage:b,addListener:c}}();var ace=ace||{};ace.stp=ace.stp||{},ace.stp.StorageManager=function(){"use strict";var a="#",b=/\d+#/,c=function(a,b){this.prefix=a,this.id=b,this.namespace=this.prefix+"."+this.id;try{this.localStorageSupported="localStorage"in window&&null!==window.localStorage}catch(c){}};return c.prototype={getPrefix:function(b){var c=1e3*(b||0);return c?+new Date+c+a:""},getItem:function(a){if(!this.localStorageSupported)return null;var c=localStorage.getItem(this.namespace+"."+a),d=b.exec(c);return d===!0&&(c=c.replace(d[0],""),+new Date>d[0].replace("#",""))?(localStorage.removeItem(this.namespace+"."+a),null):c},contains:function(a){return!!this.getItem(a)},setItem:function(a,b,c){this.localStorageSupported&&(b=this.getPrefix(c)+b,localStorage.setItem(this.namespace+"."+a,b))},removeItem:function(a){this.localStorageSupported&&localStorage.removeItem(this.namespace+"."+a)}},{instance:c}}();var ace=ace||{};ace.stp=ace.stp||{},ace.stp.MessageTypes={stpInitialized:"stp initialized",analyticsEvent:"analytics event",dialogOpened:"dialog opened",messageNotification:"message notification",featureLoaded:"feature loaded",lookAndFeel:"look and feel"},ace.stp.NotificationTypes={help:"help",message:"message",newMessage:"newMessage",dismissedMessage:"dismissedMessage"},ace.stp.AnalyticEventTypes={majorClick:"ace.stp.click.major",minorClick:"ace.stp.click.minor",search:"ace.stp.search",openStp:"ace.stp.open",openIcon:"ace.stp.open.icon",closeStp:"ace.stp.close"};;
;/* module-key = 'com.tempoplugin.tempo-teams:tempo-teams-atl-resources', location = 'com/tempoplugin/team/ui/customfield/edit_team_customfield.js' */
JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(c,b){var a=function(f){var d=AJS.$("select.tempo-customfield");_.each(d,function(g){var e=AJS.$("#"+g.id+"-single-select");if(e.length===0){new AJS.SingleSelect({element:g})}})};AJS.$(".select.tempo-customfield").ready(a)});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-analytics-tracker', location = 'includes/js/rapid/AnalyticsTracker.js' */
if(typeof GH==="undefined"){window.GH={}}GH.AnalyticsTracker=function(b,d,a){if(_.isUndefined(b)){throw new Error("You must specify a category")}this.params={};this.params.category=b;var c=0;if(!_.isUndefined(d)){this.params.action=d;c++;if(!_.isUndefined(a)){this.params.label=a;c++}}this.requiredArgumentNames=["action","label","value"].slice(c);this.useAsync=true};GH.AnalyticsTracker.prototype.setAsync=function(a){this.useAsync=a;return this};GH.AnalyticsTracker.prototype.trigger=function(){if(this.requiredArgumentNames.length<arguments.length){AJS.log("Warning: too many arguments passed in. Needed at most "+this.requiredArgumentNames.length+" but got "+arguments.length)}var c=_.clone(this.params);for(var b=0;b<arguments.length&&!_.isUndefined(this.requiredArgumentNames[b]);b++){c[this.requiredArgumentNames[b]]=arguments[b]}this._validateParams(c);var a="gh.analytics.async";AJS.$(AJS).trigger(a,c)};GH.AnalyticsTracker.prototype._validateParams=function(b){var a=["category","action","label"];_.each(a,function(c){if(!_.isUndefined(b[c])&&!_.isString(b[c])){b[c]=b[c].toString()}else{if(_.isUndefined(b[c])){b[c]=""}}});_.each(["category","action"],function(c){b[c]=b[c].replace(/\s+/g,"")});if(!_.isUndefined(b.value)){b.value=parseInt(b.value,10);if(isNaN(b.value)){b.value=undefined}}};;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/ui/help/HelpAnalytics.js' */
AJS.$(function(){var a=function(c){if(GH&&GH.AnalyticsTracker){return new GH.AnalyticsTracker(c).setAsync(false)}else{return{trigger:function(){}}}};AJS.$("#gh_view_help").click(function(c){a("gh.gethelp").trigger("usermenu","docs");return b(AJS.$(this))});AJS.$("#gh_view_agile_answers").click(function(c){a("gh.gethelp").trigger("usermenu","answers");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement").click(function(c){a("gh.myjirahome").trigger("usermenu","enabled");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-enablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-disablement-ondemand").click(function(c){a("gh.myjirahome").trigger("usermenu","disable");return b(AJS.$(this))});AJS.$("#greenhopper-my-jira-home-set").click(function(c){a("gh.myjirahome").trigger("usermenu","set");return b(AJS.$(this))});AJS.$("#beta_gh\\.configuration\\.rapid\\.removal").click(function(f){var c=AJS.$(this),d=c.attr("checked")?"on":"off";a("gh.labs.feature").trigger("rapid_removal",d);return true});AJS.$(document).delegate("#js-classic-link_lnk","click",function(c){a("gh.agile.menu").trigger("classic");return true});var b=function(c){if(c.attr("target")=="_blank"){return true}else{setTimeout('document.location = "'+c.attr("href")+'"',100);return false}}});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-help-analytics', location = 'includes/js/rapid/Analytics.js' */
if(typeof GH==="undefined"){window.GH={}}(function(c,g,e,d){d.AnalyticsEnabled=true;var b="gh.analytics.async";function f(){g(document).on(b,function(i,h){a(h)})}function a(i){var j={};var h=i.category;if(!e.isUndefined(i.action)){h=h+"."+i.action}if(!e.isUndefined(i.label)){j.label=i.label}if(!e.isUndefined(i.value)){j.value=i.value}c.trigger("analytics",{name:h,data:j})}f()})(AJS,AJS.$,_,GH);;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-globalissueoperations', location = 'includes/js/gh-globalissueoperations.js' */
(function(){var c=new GH.AnalyticsTracker("gh.issueaction.gotorapidboard").setAsync(false);var b=JIRA.FormDialog.extend({_performRedirect:function(e){c.trigger("direct");window.location.href=e}});var d=new b({id:"gh-rapidboard-dialog",trigger:"a.issueaction-greenhopper-rapidboard-operation",ajaxOptions:function(){return JIRA.Dialogs.getDefaultAjaxOptions.apply(this,arguments)}});var a=function(f,g){var h="";var e=AJS.$(f);if(e.hasClass("js-rapidboard-operation-sprint")){h="sprint."}else{if(e.hasClass("js-rapidboard-operation-issue")){h="issue."}}h+=g;return h};AJS.$(function(){AJS.$(document).on("simpleClick",".issueaction-greenhopper-rapidboard-operation",function(f){f.preventDefault();var e=a(f.currentTarget,"open");c.trigger(e);d.show()});AJS.$(document).on("simpleClick",".js-select-rapidboard",function(f){var e=a(f.currentTarget,"chosen");c.trigger(e)})})})();;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/gh-namespace.js' */
if(typeof GH!=="object"){window.GH={}}GH.namespace=function(d,c,e){var f=d.split(".");c=c||window;for(var b=0,g=f.length-1;b<g;b++){var a=c[f[b]];c=(a!=null)?a:c[f[b]]={}}c[f[b]]=e||c[f[b]]||{};return c[f[b]]};;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/initFieldPickers.js' */
(function(c){function b(d){c(".js-epic-picker",d).each(function(){var f=c(this);var e=new JIRA.EpicPicker({element:f});c(document).trigger(JIRA.EpicPicker.READY_EVENT,e)})}function a(d){c(".js-sprint-picker",d).each(function(){var f=c(this);var e=new JIRA.SprintPicker({element:f});c(document).trigger(JIRA.SprintPicker.READY_EVENT,e)})}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(g,d,f){if(f!==JIRA.CONTENT_ADDED_REASON.panelRefreshed){b(d);a(d)}})})(AJS.$);;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/EpicPicker.js' */
JIRA.EpicPicker=AJS.SingleSelect.extend({init:function(n){var f=n.element;var c;var m=this;AJS.$.extend(n,{submitInputVal:true,showDropdownButton:true,removeDuplicates:true,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/epics",query:true,data:b,formatResponse:d,error:i}});g();function b(o){return{searchQuery:o,projectKey:AJS.$(f).attr("data-project-key"),maxResults:10}}function k(u,p,r){u=soy.$$escapeHtml(u);p=soy.$$escapeHtml(p);r=soy.$$escapeHtml(r);var v=r.toUpperCase();var q=u.toUpperCase();var w=p.toUpperCase();var v=(v+"").replace(/([\\\.\+\*\?\[\^\]\$\(\)\{\}\=\!\<\>\|\:])/g,"\\$1");var o=new RegExp("("+v+")","gi");var s=q.search(o);var t;if(s>-1){t=u.slice(s,s+r.length);u=u.replace(t,"<em>"+t+"</em>")}s=w.search(o);if(s>-1){t=p.slice(s,s+r.length);p=p.replace(t,"<em>"+t+"</em>")}return u+" - ("+p+")"}function d(p){if(!p.epicNames){return[]}var r=[];var q=p.epicNames;var v;var u=m.getQueryVal();var t=a(u.length,q.length,p.total);for(var s=0,o=q.length;s<o;s++){v=q[s];t.addItem(j(v,u))}r.push(t);return r}function j(r,q){var p=r.key;var s=r.name;var o=k(s,p,q);return new AJS.ItemDescriptor({value:"key:"+p,fieldText:s,label:o,html:o,allowDuplicate:false,highlighted:true})}function a(o,q,p){return new AJS.GroupDescriptor({weight:1,id:"epic-names",label:o===0?"Suggestions":AJS.format("Showing {0} of {1} matching epics",q,p),replace:true})}function i(q,r,p){var o=AJS.$(f);o.siblings(".ghx-error").remove();o.before(GH.tpl.rapid.notification.renderAuiMessage({message:("Error"+": "+p),type:"error",className:"ghx-error aui-ss"}))}function h(q){var o="";var p=false;if(q&&q.length>0){o=AJS.format("Epic with key \'\'{0}\'\' does not exist.",q);p=true}return{isError:p,message:o}}function l(p){var o,q;c.apply(m,[p]);p=p||AJS.$.trim(m.$field.val());q=m.model.getDescriptor(p);if(!q&&m.$container.hasClass("aui-ss-editing")){o=h(p);if(o.isError){m.options.errorMessage=o.message;m.showErrorMessage(p)}else{m.hideErrorMessage()}}}function e(){AJS.$(m.$field[0].form).submit()}function g(){m._super(n);c=m.handleFreeInput;m.handleFreeInput=l}}});JIRA.EpicPicker.READY_EVENT="gh.epic-picker.ready";;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.js' */
JIRA.SprintPicker=AJS.SingleSelect.extend({init:function(e){var m={ACTIVE:"ACTIVE",FUTURE:"FUTURE",CLOSED:"CLOSED"};var i=10;var k,n;var s=e.element.data("saved-state"),r=e.element.data("saved-id");var g,p=this;var d=AJS.SelectSuggestHandler.extend({formatSuggestions:function(v,w){v=this._super(v,w);if(w.length===0){v[v.length-1].footerText("Start typing for sprints.")}return v}});AJS.$.extend(e,{submitInputVal:false,showDropdownButton:true,removeOnUnSelect:false,maxInlineResultsDisplayed:i,ajaxOptions:{url:contextPath+"/rest/greenhopper/1.0/sprint/picker",query:true,formatResponse:t}});o();function h(w){var v=k.apply(this,arguments);v.find("a").append(GH.tpl.customfields.sprintpicker.renderSuggestionMeta(w.properties));return v}function u(x){var w=this.getSelectedDescriptor(),v;if(!x&&!w){b(null)}j();this.hideErrorMessage();if(!w){v=c(x)}else{v=q(w)}if(v.message){this.options.errorMessage=v.message;n.apply(this,arguments);this.$errorMessage.addClass("inline-edit-error")}if(v.needsScopeChangeWarning){l()}}function c(x){var w=null,v=false;if(x&&x.length>0){if(s){w=AJS.format("{0} is not a valid sprint name. This issue will be returned to the backlog.",x);if(s===m.ACTIVE){v=true}}else{w=AJS.format("{0} is not a valid sprint name.",x)}}else{if(s===m.ACTIVE){v=true}}return{message:w,needsScopeChangeWarning:v}}function q(w){var v=false;if(s===m.ACTIVE){if(r!=w.properties.value){v=true}}else{if(s===m.FUTURE){if(w.properties.stateKey===m.ACTIVE){v=true}}else{if(!s){if(w.properties.stateKey===m.ACTIVE){v=true}}}}return{message:null,needsScopeChangeWarning:v}}function l(){if(!g){g=AJS.$(GH.tpl.rapid.notification.renderAuiMessage({type:"warning",className:"ghx-sprint-picker-scope-warning",icon:true,title:"Sprint scope will be affected by this action."}));var v=p.$container.closest(".inline-edit-fields");if(v.size()>0){v.closest(".editable-field").append(g)}else{p.$container.closest(".field-group").append(g)}}g.show()}function j(){if(g){g.remove();g=null}}function t(v){if(!v.suggestions&&!v.allMatches){return[]}var x=new AJS.GroupDescriptor({weight:0,label:"Suggestions"});var w=new AJS.GroupDescriptor({weight:1,label:"All sprints"});_.each(a(v.suggestions),function(y){x.addItem(f(y,true))});_.each(a(v.allMatches),function(y){w.addItem(f(y,false))});return[x,w]}function f(x,w){var v=soy.$$escapeHtml(x.name);return new AJS.ItemDescriptor({value:x.id.toString(),label:x.name,html:v,stateKey:x.stateKey,boardName:x.boardName,allowDuplicate:false,isSuggestion:w})}function a(v){return _.sortBy(v,function(w){return w.name.toLowerCase()})}function b(v){if(GH.SprintConfig){AJS.$(GH).trigger("QuickEdit.fieldChange",{fieldId:GH.SprintConfig.getSprintFieldId(),fieldChangeData:{original:r,updated:v?v.properties.value:null}})}}function o(){p._super(e);k=p.listController._renders.suggestion;n=p.showErrorMessage;p.listController._renders.suggestion=h;p.showErrorMessage=u;e.element.bind("selected",function(x,w,v){v.showErrorMessage(v.getQueryVal());b(w)});p.suggestionsHandler=new d(p.options,p.model)}}});JIRA.SprintPicker.READY_EVENT="gh.sprint-picker.ready";;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/field/SprintPicker.soy' */
// This file was automatically generated from SprintPicker.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.customfields == 'undefined') { GH.tpl.customfields = {}; }
if (typeof GH.tpl.customfields.sprintpicker == 'undefined') { GH.tpl.customfields.sprintpicker = {}; }


GH.tpl.customfields.sprintpicker.renderSuggestionMeta = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.boardName && ! opt_data.isSuggestion) {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithBoardName(opt_data, output);
    output.append(')</span>');
  } else {
    output.append('<span class=\'ghx-sprint-picker-meta\'> (');
    GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName(opt_data, output);
    output.append(')</span>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithoutBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml("Active sprint") : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml("Future sprint") : '');
  return opt_sb ? '' : output.toString();
};


GH.tpl.customfields.sprintpicker.renderMetaWithBoardName = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.stateKey == 'ACTIVE') ? soy.$$escapeHtml(AJS.format("Active sprint in {0}",opt_data.boardName)) : (opt_data.stateKey == 'FUTURE') ? soy.$$escapeHtml(AJS.format("Future sprint in {0}",opt_data.boardName)) : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.js' */
GH.namespace("GH.Notification");GH.Notification={};GH.Notification.autoHideEnabled=true;GH.Notification.showErrors=function(d,a){var b=GH.Notification.prepareNotificationDiv();var c=GH.tpl.rapid.notification.renderErrorMessages(d);if(typeof a=="undefined"){a=true}AJS.messages.error(b,{title:"Error",body:c,closeable:a});if(GH.Notification._divStyle(b)){b.css(GH.Notification._divStyle(b))}b.show()};GH.Notification.showWarnings=function(f,e){var b={autoHide:true,autoHideDelay:5000,preRendered:false,showTitle:false};e=_.extend({},b,e);var c=GH.Notification.prepareNotificationDiv();var a;if(!e.preRendered){a=GH.tpl.rapid.notification.renderErrorMessages({errors:f})}else{a=f}var d={body:a,closeable:true};if(e.showTitle){d.title="Warning"}AJS.messages.warning(c,d);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(e.autoHide&&GH.Notification.autoHideEnabled){setTimeout(function(){c.hide()},e.autoHideDelay)}};GH.Notification.showWarning=function(b){var a=GH.Notification.prepareNotificationDiv();AJS.messages.warning(a,{body:b,closeable:true});if(GH.Notification._divStyle(a)){a.css(GH.Notification._divStyle(a))}a.show()};GH.Notification.clear=function(){GH.Notification.prepareNotificationDiv().hide()};GH.Notification.handleDateFormatMismatchError=function(c){var b='<a href="'+GH.Ajax.CONTEXT_PATH+'/secure/admin/AdvancedApplicationProperties.jspa">';b+="Advanced Settings";b+="</a>";var a=AJS.format("It appears your JIRA date format settings are misconfigured. Please check the {0} and ensure that \'\'jira.date.time.picker.java.format\'\' and \'\'jira.date.time.picker.javascript.format\'\' have matching output.",b);GH.Notification.showWarnings(a,{autoHide:false,preRendered:true})};GH.Notification.auiMessage=function(b){var a=_.extend({type:"generic",icon:true,messageHtml:false},b);return GH.tpl.rapid.notification.renderAuiMessage({type:a.type,title:a.title,icon:a.icon,messageHtml:a.messageHtml,message:a.message})};GH.Notification.Handler={_defaultNotificationHandler:function(){var a=AJS.$("<div/>");AJS.$(".global-msg").remove();a.addClass("global-msg").appendTo("body");return a},_defaultDivStyleHandler:function(a){return{marginLeft:-a.outerWidth()/2,top:20}},setCustomDivStyleHandler:function(a){this._customDivStyleHandler=a;this._useDefault=false},_useDefault:true,setCustomNotificationHandler:function(a){this._customNotificationHandler=a;this._useDefault=false},removeCustomHandlers:function(){this._useDefault=true},getNotificationHandler:function(){if(!this._useDefault&&this._customNotificationHandler!=null){return this._customNotificationHandler}else{return this._defaultNotificationHandler}},getDivStyleHandler:function(){if(!this._useDefault&&this._customDivStyleHandler!=null){return this._customDivStyleHandler}else{return this._defaultDivStyleHandler}}};GH.Notification._divStyle=function(b){var a=GH.Notification.Handler.getDivStyleHandler();return a(b)};GH.Notification.prepareNotificationDiv=function(){var a=GH.Notification.Handler.getNotificationHandler();return a()};GH.Notification.showSuccess=function(d,b){clearTimeout(GH.Notification.current);var a={timeout:5000,closeable:true,shadowed:true};b=_.extend(a,b,{body:d});var c=GH.Notification.prepareNotificationDiv();AJS.messages.success(c,b);if(GH.Notification._divStyle(c)){c.css(GH.Notification._divStyle(c))}c.show();if(GH.Notification.autoHideEnabled){GH.Notification.current=setTimeout(function(){AJS.$(".global-msg").hide()},b.timeout)}};GH.Notification.showIssueMessage=function(d){var c=JIRA.SessionStorage;var b=null;var a=null;if(!d){d=c.getItem("selectedIssueId")}if(d){a=c.getItem("selectedIssueKey");b=c.getItem("selectedIssueMsg");GH.Notification.showIssueMessageImpl(d,b,a)}c.removeItem("selectedIssueId");c.removeItem("selectedIssueKey");c.removeItem("selectedIssueMsg")};GH.Notification.showIssueMessageImpl=function(d,c,a){if(!c){c="thanks_issue_updated"}var b=AJS.params[c];if(b&&a){b=AJS.format(b,a);GH.Notification.showSuccess(b)}};GH.Notification.addPageLoadMessage=function(c,a){var b=GH.storage.get("gh.pageloadmessages",true)||[];b.push({message:c,type:a||"success"});GH.storage.put("gh.pageloadmessages",b,true)};GH.Notification._displayPageLoadMessages=function(){var c=GH.storage.get("gh.pageloadmessages",true);if(c){var a=c[0].type;var b="";_.each(c,function(d){if(b.length>0){b+="<br>"}b+=d.message});switch(a){case"warning":GH.Notification.showWarning(b);break;case"success":default:GH.Notification.showSuccess(b);break}GH.storage.put("gh.pageloadmessages",null,true)}};GH.Notification.showBoardUpdatedMessage=function(){GH.Notification.clearBoardUpdatedMessage();var b=AJS.$.Deferred();var a=AJS.$(GH.tpl.rapid.notification.renderGHtvMessage()).appendTo("#gh");a.data("deferred",b);a.find(".js-refresh-now").click(function(c){c.preventDefault();a.removeData("deferred");GH.Notification.clearBoardUpdatedMessage();b.resolve()});a.find(".js-ignore-refresh").click(function(c){c.preventDefault();GH.Notification.clearBoardUpdatedMessage()});AJS.$(".ghx-feedback").css({visibility:"hidden"});return b.promise()};GH.Notification.clearBoardUpdatedMessage=function(){var a=AJS.$("#ghx-update-message");if(a.length){var b=a.data("deferred");if(b&&b.reject){b.reject()}a.remove()}AJS.$(".ghx-feedback").css({visibility:""})};GH.Notification.isBoardUpdatedMessageVisible=function(){var a=AJS.$("#ghx-update-message");return a.length>0};AJS.$(document).ready(function(){GH.Notification.showIssueMessage();if(GH.storage){GH.Notification._displayPageLoadMessages()}});;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-custom-field-pickers', location = 'includes/js/rapid/ui/notification/Notification.soy' */
// This file was automatically generated from Notification.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.rapid == 'undefined') { GH.tpl.rapid = {}; }
if (typeof GH.tpl.rapid.notification == 'undefined') { GH.tpl.rapid.notification = {}; }


GH.tpl.rapid.notification.renderErrorMessages = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.errors.length > 1) {
    output.append('<ul>');
    var errorList6 = opt_data.errors;
    var errorListLen6 = errorList6.length;
    for (var errorIndex6 = 0; errorIndex6 < errorListLen6; errorIndex6++) {
      var errorData6 = errorList6[errorIndex6];
      output.append('<li>', (errorData6.noAutoescape) ? errorData6.message : soy.$$escapeHtml(errorData6.message), '</li>');
    }
    output.append('</ul>');
  } else {
    var errorList18 = opt_data.errors;
    var errorListLen18 = errorList18.length;
    for (var errorIndex18 = 0; errorIndex18 < errorListLen18; errorIndex18++) {
      var errorData18 = errorList18[errorIndex18];
      output.append('<p>', (errorData18.noAutoescape) ? errorData18.message : soy.$$escapeHtml(errorData18.message), '</p>');
    }
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderContextualErrors = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var errorList29 = opt_data.errors;
  var errorListLen29 = errorList29.length;
  for (var errorIndex29 = 0; errorIndex29 < errorListLen29; errorIndex29++) {
    var errorData29 = errorList29[errorIndex29];
    output.append('<div class="ghx-error">', soy.$$escapeHtml(errorData29.message), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderMessageHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="ghx-body-warning">', soy.$$escapeHtml(AJS.format("This version of {0} is not a supported browser.",opt_data.browser)), ' <a href="', soy.$$escapeHtml(opt_data.docsUrl), '">', soy.$$escapeHtml("See our documentation for the list of supported browsers."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderAuiMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message ', soy.$$escapeHtml(opt_data.type), (opt_data.className) ? ' ' + soy.$$escapeHtml(opt_data.className) : '', '">', (opt_data.title) ? '<p class="title">' + ((opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + '<strong>' + soy.$$escapeHtml(opt_data.title) + '</strong></p>' : '', (opt_data.message) ? '<p>' + ((! opt_data.title && opt_data.icon) ? '<span class="aui-icon icon-' + soy.$$escapeHtml(opt_data.type) + '"></span>' : '') + ((opt_data.messageHtml) ? opt_data.message : soy.$$escapeHtml(opt_data.message)) + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


GH.tpl.rapid.notification.renderGHtvMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="ghx-update-message" class="ghx-tv-message"><p>', soy.$$escapeHtml("This board has been updated"), ': <a href="" class="js-refresh-now">', soy.$$escapeHtml("Refresh"), '</a><span class="ghx-divider">&bull;</span><a href="" class="js-ignore-refresh">', soy.$$escapeHtml("Ignore"), '</a></p></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.pyxis.greenhopper.jira:gh-globalkeyboardshortcuts', location = 'includes/js/gh-globalkeyboardshortcuts.js' */
(function(b){b.namespace("gh.app.globalkeyboardshortcuts");var a=gh.app.globalkeyboardshortcuts;a.findSelectedIssueId=function(){var c;if(jira&&jira.app&&jira.app.issuenavigator&&jira.app.issuenavigator.getSelectedIssueId){c=jira.app.issuenavigator.getSelectedIssueId()}if(!c&&jira&&jira.app&&jira.app.issue&&jira.app.issue.getIssueId){c=jira.app.issue.getIssueId()}return c};a.goToAgile=function(){var c=(contextPath?contextPath:"")+"/secure/GreenHopper.jspa";window.location.href=c};a.followLink=function(c){var d=b(c);if(d.length>0&&(d[0].nodeName.toLowerCase()==="a"||d[0].nodeName.toLowerCase()==="link")){d.click();window.location.href=d.attr("href")}};a.sendToTop=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToTop){GH.Shortcut.sendToTop(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/first",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToTop"+(d?d:""),count:1})};a.sendToBottom=function(d,e){if(window.GH&&GH.RapidBoard&&GH.Shortcut&&GH.Shortcut.sendToBottom){GH.Shortcut.sendToBottom(d);a.closeDialogAndPopMessage();return}if(d!="Action"){return}var c=e||a.findSelectedIssueId();if(!contextPath){contextPath=""}JIRA.SmartAjax.makeRequest({type:"post",contentType:"application/json",url:contextPath+"/rest/greenhopper/1.0/rank/global/last",data:JSON.stringify({issueId:c}),success:a.handleRankSuccess});AJS.$(AJS).trigger("gh.global.rankissues",{action:"rankToBottom"+(d?d:""),count:1})};a.closeDialogAndPopMessage=function(){if(JIRA.IssueNavigator.isNavigator()){AJS.reloadViaWindowLocation()}else{if(JIRA.Dialog&&JIRA.Dialog.current){JIRA.Dialog.current.hide()}if(window.GH){if(GH.Message&&GH.Message.showIssueMessage){GH.Message.showIssueMessage()}else{if(GH.RapidBoard&&GH.Notification&&GH.Notification.showIssueMessage){GH.Notification.showIssueMessage()}}if(window.Boards){Boards.refreshAll()}}else{if(JIRA.IssueNavigator&&JIRA.IssueNavigator.Shortcuts&&JIRA.IssueNavigator.Shortcuts.flashIssueRow){JIRA.IssueNavigator.Shortcuts.flashIssueRow()}}}};a.handleRankSuccess=function(c,e,d){a.storeSuccessMessage(c.issueId,c.issueKey,"thanks_issue_updated");a.closeDialogAndPopMessage()};a.storeSuccessMessage=function(e,c,d){var f=JIRA.SessionStorage;f.setItem("selectedIssueId",e);f.setItem("selectedIssueKey",c);f.setItem("selectedIssueMsg",d)};AJS.$(function(){AJS.$(document).delegate(".issueaction-greenhopper-rank-top-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToTop("Action",d)});AJS.$(document).delegate(".issueaction-greenhopper-rank-bottom-operation","click",function(c){c.preventDefault();var d=AJS.$(this).attr("data-issueid");a.sendToBottom("Action",d)})})})(AJS.$);;
;/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.js' */
;
;/* module-key = 'com.pyxis.greenhopper.jira:sprintmigration-banner', location = 'includes/js/sprintmigration/SprintMigrationBanner.soy' */
;
;/* module-key = 'com.pyxis.greenhopper.jira:project-template-resources', location = '/projecttemplates/soy/ProjectTemplates.soy' */
// This file was automatically generated from ProjectTemplates.soy.
// Please don't edit this file by hand.

if (typeof GH == 'undefined') { var GH = {}; }
if (typeof GH.tpl == 'undefined') { GH.tpl = {}; }
if (typeof GH.tpl.projecttemplates == 'undefined') { GH.tpl.projecttemplates = {}; }


GH.tpl.projecttemplates.kanbanInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Constrain work-in-progress and manage your task flow.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.scrumInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Manage your product development with backlogs, stories, and sprints.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon story"></span><span class="issuetype-name">' + soy.$$escapeHtml("Story") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon epic"></span><span class="issuetype-name">' + soy.$$escapeHtml("Epic") + '</span></span></li>'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.softwareDevelopmentInfoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  GH.tpl.projecttemplates.infoPage({description: "Track development tasks and bugs. Optionally connect your source and build managers.", extraIssueTypes: '<li><span class="issuetype-list-label"><span class="issuetype-icon improvement"></span><span class="issuetype-name">' + soy.$$escapeHtml("Improvement") + '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon newfeature"></span><span class="issuetype-name">' + soy.$$escapeHtml("New Feature") + '</span></span></li>'}, output);
  return opt_sb ? '' : output.toString();
};


GH.tpl.projecttemplates.infoPage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><div class="left-info"><p>', soy.$$escapeHtml(opt_data.description), '</p><h3>', soy.$$escapeHtml("Issue Types"), '</h3><ul class="project-template-issuetype-list"><li><span class="issuetype-list-label"><span class="issuetype-icon bug"></span><span class="issuetype-name">', soy.$$escapeHtml("Bug"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon task"></span><span class="issuetype-name">', soy.$$escapeHtml("Task"), '</span></span></li><li><span class="issuetype-list-label"><span class="issuetype-icon subtask"></span><span class="issuetype-name">', soy.$$escapeHtml("Sub-task"), '</span></span></li>', opt_data.extraIssueTypes, '</ul></div><div class="right-info workflow-screenshot"></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugin.ext.bamboo:bamboo-soy-resources', location = 'templates/plugins/bamboo/components.soy' */
// This file was automatically generated from components.soy.
// Please don't edit this file by hand.

if (typeof bamboo == 'undefined') { var bamboo = {}; }
if (typeof bamboo.components == 'undefined') { bamboo.components = {}; }


bamboo.components.pageHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param3 = new soy.StringBuilder();
  if (opt_data.headerImageContent) {
    aui.page.pageHeaderImage({content: opt_data.headerImageContent}, param3);
  }
  aui.page.pageHeaderMain({content: opt_data.headerMainContent}, param3);
  if (opt_data.headerActionsContent) {
    aui.page.pageHeaderActions({content: opt_data.headerActionsContent}, param3);
  }
  aui.page.pageHeader({content: param3.toString()}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.icon = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="bamboo-icon bamboo-icon-', soy.$$escapeHtml(opt_data.type), '"', (opt_data.text && opt_data.showTitle) ? ' title="' + soy.$$escapeHtml(opt_data.text) + '"' : '', '>', (opt_data.text) ? '<span>' + soy.$$escapeHtml(opt_data.text) + '</span>' : '', '</span>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.buildDetail = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<dl><dt class="', soy.$$escapeHtml(opt_data.keyClass), '">', soy.$$escapeHtml(opt_data.key), '</dt><dd>', opt_data.value, '</dd></dl>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifacts = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul id="shared-artifacts">');
  var artifactList42 = opt_data.artifacts;
  var artifactListLen42 = artifactList42.length;
  for (var artifactIndex42 = 0; artifactIndex42 < artifactListLen42; artifactIndex42++) {
    var artifactData42 = artifactList42[artifactIndex42];
    bamboo.components.artifactItem(soy.$$augmentData(artifactData42, {id: artifactData42.name, url: artifactData42.link.href}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.artifactItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li>');
  bamboo.components.icon({type: 'artifact-shared'}, output);
  output.append(' <a id="artifact-', soy.$$escapeHtml(opt_data.id), '" href="', soy.$$escapeHtml(opt_data.url), '">', soy.$$escapeHtml(opt_data.name), '</a><span class="filesize">(', soy.$$escapeHtml(opt_data.prettySizeDescription), ')</span></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labels = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="labels">');
  var labelList63 = opt_data.labels;
  var labelListLen63 = labelList63.length;
  for (var labelIndex63 = 0; labelIndex63 < labelListLen63; labelIndex63++) {
    var labelData63 = labelList63[labelIndex63];
    bamboo.components.labelItem(soy.$$augmentData(labelData63, {url: opt_data.baseBambooUrl + '/browse/label/' + labelData63.name}), output);
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.labelItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="lozenge" href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.name), '"><span>', soy.$$escapeHtml(opt_data.name), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


bamboo.components.errorResponseMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  bamboo.components.auiWarning({body: (opt_data.errorMessage.messageBody) ? '<p>' + soy.$$escapeHtml(opt_data.errorMessage.messageBody) + '</p>' : (opt_data.errorMessage.oauthCallback) ? '<p><a href="' + opt_data.errorMessage.oauthCallback + '&amp;redirectUrl=' + opt_data.oAuthDanceReturnUrl + '">' + soy.$$escapeHtml("Log in \x26 approve") + '</a></p>' : '<p>' + soy.$$escapeHtml(opt_data.errorMessage.message) + '</p>'}, output);
  return opt_sb ? '' : output.toString();
};


bamboo.components.auiWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message warning"><span class="aui-icon icon-warning"></span>', opt_data.body, '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.administration.atlassian-admin-quicksearch-jira:admin-quicksearch-webresources', location = 'com/atlassian/administration/quicksearch/jira/js/adminQuickNav.js' */
/**
 * Shifter group for admin search
 */
JIRA.Shifter && JIRA.Shifter.register(function() {
    var suggestionsDeferred = jQuery.Deferred();

    function formatItem(item) {
        return {
            label: item.label,
            value: item.linkUrl,
            keywords: item.aliases
        };
    }

    function getItemsInSection(section) {
        return _.map(section.items, formatItem).concat(_.map(section.sections, getItemsInSection));
    }

    function formatResponse(data) {
        return _.flatten(getItemsInSection(data));
    }

    JIRA.SmartAjax.makeRequest({
        dataType: 'json',
        url: AJS.contextPath() + '/rest/adminquicksearch/latest/links/default'
    })
    .pipe(formatResponse)
    .done(function(suggestions) {
        suggestionsDeferred.resolve(suggestions);
    })
    .fail(function() {
        suggestionsDeferred.reject();
    });

    return {
        id: 'admin',
        name: "Administration",
        weight: 500,
        getSuggestions: function() {
            return suggestionsDeferred;
        },
        onSelection: function(value) {
            window.location = value;
            return jQuery.Deferred();
        }
    };
});
;
;/* module-key = 'com.atlassian.jira.ext.calendar:browse-project-tip', location = 'com/atlassian/jira/ext/calendar/resources/js/BrowseProjectTip.js' */
AJS.toInit(function(d){var c=WRM.data.claim("com.atlassian.jira.ext.calendar:tipDataProvider.tip").suppressTip;if(!c){var a="browse-project-calendar-info";var b=function(e){if(e.length){var f=d("<div/>");AJS.messages.info(f,{body:AJS.format("This calendar shows when issues are due to be completed. This is set by the {0} field for an issue.","Due Date"),closeable:true});f.find(".aui-message").attr("id",a);e.prepend(f)}};JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(i,g,h){var f;if(g.attr("id")=="project-tab"){f=d(".issues-calendar-container",g)}else{f=d("#project-tab .issues-calendar-container",g)}b(f)});b(d("#project-tab .issues-calendar-container"));AJS.bind("messageClose",function(g,f){if(f.attr("id")==a){AJS.EventQueue&&AJS.EventQueue.push({name:"browseprojectcalendarinfo.closebutton"});d.ajax({data:{tipKey:"browseProjectCalendarTab"},type:"POST",url:contextPath+"/rest/calendar-plugin/1.0/suppressedTips"})}})}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:jira-browser-metrics', location = '/js/analytics/dialog-ids.js' */
define("jira/analytics/browser-metrics/dialog-checker",[],function(){allowedIdsArray=["about-dialog","add-basicuser-dialog","add-developer-dialog","add-field-configuration-dialog","add-field-configuration-scheme-dialog","add-field-dialog","add-field-screen-dialog","add-field-screen-scheme-dialog","add-incoming-mail-handler-dialog","add-issue-type-dialog","add-issue-type-field-configuration-association-dialog","add-issue-type-screen-scheme-configuration-association-dialog","add-issue-type-screen-scheme-dialog","add-new-issue-type-to-scheme-dialog","add-screen-scheme-item-dialog","add-subtask-type-dialog","add-workflow-dialog","add_workflowscheme-dialog","assign-dialog","assign-issue-types-dialog","assign-to-me-link-handler","attach-file-dialog","attach-screenshot-dialog","auditing-settings-dialog","clone-issue-dialog","comment-add-dialog","configure_wallboard_dialog","confluence-page-search-dialog","copy_classic default workflow-dialog","copy-filter-dialog","copy_jira-dialog","create-issue-dialog","create-issue-dialog.issueType","create-issue-dialog.projectId","create-request-dialog","create-service-desk-dialog","create-status-dialog","create-story-dialog","create-story-dialog.issueType","create-story-dialog.projectId","create-subtask-dialog","create-subtask-dialog.issueType","create-team-dialog","create_user-dialog","credits-dialog","delete-attachment-dialog","delete-comment-dialog","delete-dshboard","delete-filter-dialog","delete-issue-dialog","delete-issue-link-dialog","delete-log-work-dialog","delete-metric","delete-queue","delete-status-dialog","deleteuser_link-dialog","devstatus-branch-detail-dialog","devstatus-build-detail-dialog","devstatus-commit-detail-dialog","devstatus-cta-dialog","devstatus-deployment-detail-dialog","devstatus-pullrequest-detail-dialog","devstatus-review-detail-dialog","discard-draft-dialog","discard_draft_workflow-dialog","edit-attachments-dialog","edit-comment","editgroups_admin-dialog","editgroups_link-dialog","editgroups_sysadmin-dialog","edit-issue-dialog","edit-labels-dialog","edit-log-work-dialog","edit-status-dialog","edituser_link_admin-dialog","edit-workflow-dialog","gh-rapidboard-dialog","inline-issue-create-dialog","invite_user-dialog","issue-actions-dialog","issue-tab-error-dialog","jim-create-project-dialog","keyboard-shortcuts-dialog","link-issue-dialog","log-work-dialog","manage-attachment-dialog","metric-pre-save-dialog","modal-field-view","permission-helper-dialog","project-avatar-cropper","project-avatar-picker","project-config-details-project-category-dialog","project-config-project-edit-dialog","project-config-project-edit-lead-and-default-assignee-dialog","project-email-dialog","publish_draft_workflow-dialog","queue-dirty-edits","QuickCreateIssue.error","QuickCreateIssue.success","QuickCreateSubtask.error","QuickCreateSubtask.success","QuickEdit.error","QuickEdit.success","remote-jira-search-dialog","rename-filter-dialog","report-dirty-edits","save-filter-dialog","sd-add-default-value","sd-add-remove-agent-dialog","sd-remove-field-dialog","server-error-dialog","report-delete-confirm","tempo-add-hours-issue-dialog","tempo-add-internal-activity-form","tempo-core-medium-form","tempo-delete-form-dialog","tempo-grace-form","tempo-large-form","tempo-medium-form","tempo-move-form-dialog","tempo-pdf-form","tempo-small-form","tempo-split-form-dialog","tempo-user-settings-dialog","user-avatar-picker","user-defaults-edit-dialog","versionsMergeDialog","view-workflow-dialog","view-workflow-dialog-project-admin","view-workflow-dialog-workflow-schemes","wait-migrate-dialog","whereismycf-dialog","workflow-text-view"];var a={};allowedIdsArray.forEach(function(c){a[c]=true});var b=[{key:"component-delete-dialog",pattern:/^component-\d+-delete-dialog$/i},{key:"version-delete-dialog",pattern:/^version-\d+-delete-dialog$/i},{key:"workflow-transition-dialog",pattern:/^workflow-transition-\d+-dialog$/i}];return{transformDialogId:function(c){if(!c){return undefined}if(a[c]){return c}for(var d=0;d<b.length;++d){var e=b[d];if(c.match(e.pattern)){return e.key}}return undefined}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-browser-metrics:jira-browser-metrics', location = '/js/analytics/browser-metrics.js' */
require(["jira/analytics/browser-metrics/dialog-checker","jira/util/events","jquery"],function(c,a,b){b(function(){var e={startEvent:function(g){try{window.BrowserMetrics&&BrowserMetrics.start(g)}catch(h){console.log(h)}},endEvent:function(g,i){try{window.BrowserMetrics&&BrowserMetrics.end(g,i)}catch(h){console.log(h)}}};var f={openDialogs:{},start:function(){a.bind("dialogContentReady",function(k,i){var h=c.transformDialogId(i.options.id);if(!h){return}var j=f.openDialogs[h];if(j){if(!j.initialized){e.endEvent("jira.dialog.open."+h);j.initialized=true}else{if(j.action){e.endEvent("jira.dialog.change."+h+"."+j.action);j.action=undefined}}}});a.bind("beforeShow",function(j,h){var i=c.transformDialogId(h);if(!i){return}if(f.openDialogs[i]===undefined){f.openDialogs[i]={initialized:false};e.startEvent("jira.dialog.open."+i)}});a.bind("Dialog.hide",function(l,j,k,h){var i=c.transformDialogId(h);if(!i){return}delete f.openDialogs[i]});a.bind("dialogBeforeContentChange",function(l,k,j,h){var i=c.transformDialogId(h);if(!i){return}if(f.openDialogs[i]){f.openDialogs[i].action=k;e.startEvent("jira.dialog.change."+i+"."+k)}});function g(i,j){var h=c.transformDialogId(i);if(!h){return}a.bind(i+".submitting",function(){e.startEvent("jira.dialog."+h)});a.bind(i+"."+j,function(){e.endEvent("jira.dialog."+h,"success")});a.bind(i+".validationError",function(){e.endEvent("jira.dialog."+h,"error")})}["QuickCreateIssue","QuickCreateSubtask"].forEach(function(h){g(h,"issueCreated")});g("QuickEdit","issueEdited")}};var d={start:function(){a.bind("aui-dropdown2-show-before",function(g,h){e.startEvent("jira.header.menu."+h)});a.bind("aui-dropdown2-show-after",function(g,h){e.endEvent("jira.header.menu."+h)})}};if(window.BrowserMetrics!==undefined&&AJS.BrowserMetrics===undefined){[f,d].forEach(function(g){g.start()})}})});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/jira-amd.js' */
define("dndattachment/JIRA",function(){return JIRA});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/aui-amd.js' */
define("dndattachment/aui",function(){return AJS});define("dndattachment/aui/dialog",function(){return AJS.Dialog});define("dndattachment/aui/inline-dialog",function(){return AJS.InlineDialog});define("dndattachment/aui/message",function(){return AJS.messages});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/jquery-amd.js' */
define("dndattachment/jquery",["dndattachment/aui"],function(a){return a.$});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/i18n.js' */
define("dndattachment/i18n",function(){var a={"dnd.attachment.unsupported.browser":"Drag and Drop of attachments is currently only available for the following browsers:","dnd.attachment.file.is.too.large":"File exceeds maximum size limit set by the administrator ({0}).","dnd.attachment.upload.in.progress":"Upload in progress, please wait."};return function(b){if(a[b]){return a[b]}else{throw"Unknown key: "+b}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/Parser.js' */
define("dndattachment/Parser",["dndattachment/aui","dndattachment/jquery"],function(a,b){var c="-dui-type-parsed";var e="*[duiType]:not(."+c+")";function d(g){var f=b(g).find(e).add(g.filter(e));var h=f.addClass(c).map(function(j,k){var i=new b.Deferred();require([b(k).attr("duiType")],function(l){if(typeof l=="function"){i.resolve(new l(k))}else{i.reject()}});return i});return b.when.apply(window,b.makeArray(h))}JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(h,f,g){d(f)});if(b.isReady){d(b("body"))}else{b(function(){d(b("body"))})}return{parse:d}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/IssueDropZone.js' */
define("dndattachment/IssueDropZone",["dndattachment/jquery","dndattachment/Parser","dndattachment/aui","dndattachment/JIRA","dndattachment/i18n","dndattachment/TemporaryAttachments"],function(f,h,b,a,e,d){var c=5000;var g=Class.extend({eventGroup:"issuedropzone",progressBarType:"dndattachment/UploadProgressBar",init:function(i){this.$node=f(i);if(!this.isSupportedBrowser()){return this.renderUnsupported()}this.uploadLimit=this.$node.data("upload-limit");this.uploadSize=this.$node.data("upload-size");this.pendingQueue=[];this.render();this.connectListeners();this.queueEvent("init")},queueTask:function(i){this.pendingQueue.push(i);i.always(function(){this.pendingQueue.splice(this.pendingQueue.indexOf(i),1)}.bind(this));this.markDirty(true);f.when.apply(window,this.pendingQueue).then(_.debounce(this.checkMarkDirty,false,true).bind(this))},render:function(){this.$node.html(a.Templates.DnDAttachmentPlugin.IssueDropZone({}));this.fileInput=this.$node.find(".issue-drop-zone__file");this.fileLabel=this.fileInput.parent("label.issue-drop-zone__button");if(a.Events.LOCK_PANEL_REFRESHING){a.trigger(a.Events.LOCK_PANEL_REFRESHING,["drag-and-drop-attachment-panel"])}},connectListeners:function(){this.fileInput.change(function(j){this.uploadFiles(this.fileInput[0].files);this.queueEvent("fileInput",{count:this.fileInput[0].files.length});this.fileInput.attr("value",null)}.bind(this));if(f("html.mozilla")[0]&&(parseInt(f.browser.version,10)<22)){this.fileLabel.on("click",function(j){if(j.currentTarget===this.fileLabel[0]&&j.target.nodeName!=="INPUT"){this.fileInput.click()}}.bind(this))}var i=this.$node.find(">*");i.on("dragover drop",function(j){j.preventDefault();j.stopPropagation();this.$node.addClass("dragover");if(j.dataTransfer&&j.dataTransfer.files&&j.dataTransfer.files.length>0){this.uploadFiles(j.dataTransfer.files);this.queueEvent("fileDrop",{count:j.dataTransfer.files.length})}if(j.type=="drop"){this.$node.removeClass("dragover")}}.bind(this));i.on("dragleave",function(){this.$node.removeClass("dragover")}.bind(this))},createUploadProgressBar:function(){return h.parse(f('<div duiType="'+this.progressBarType+'" class="upload-progress-bar"></div>').data("upload-size",this.uploadSize).insertAfter(this.$node))},uploadFiles:function(j){var l=[];var i=_.map(j,function(n){var m=new f.Deferred();this.createUploadProgressBar().then(function(o){this.trigger("progressBarInserted",o);l.push(o);o.uploadFile(n,this.uploadLimit).then(m.resolve.bind(m),m.resolve.bind(m)).done(function(){this.trigger("uploadFinished",o)}.bind(this))}.bind(this));return m}.bind(this));var k=f.when.apply(window,i);k.done(function(){var m=_.filter(i.length==1?[arguments]:arguments,function(n){return n&&n[0]&&n[0].id>0}).map(function(n){return n[0].id});if(m.length==0){return}this.commitUpload(m).then(function(){_.delay(function(){l.some(function(n){if(n.getAutoDestroy()){n.destroy();this.queueEvent("autoDestroy")}}.bind(this))}.bind(this),c)}.bind(this))}.bind(this));this.queueTask(k);return k},loadFiles:function(i){i.forEach(function(j){this.createUploadProgressBar().then(function(k){k.setFileID(j.id);k.setFileName(j.name);k.setFileSize(j.size);k.setProgress(1);k.setFinished();var l=d.getAttachment(j.id);if(l&&l.file){k.loadThumbnail(l.file)}else{}this.trigger("uploadFinished",k)}.bind(this))},this)},commitUpload:function(j){var i=new f.Deferred();a.SmartAjax.makeRequest({type:"POST",url:contextPath+"/secure/AttachFile.jspa",data:{inline:true,id:a.Issue.getIssueId(),filetoconvert:j,atl_token:atl_token()},success:i.resolve.bind(i),error:i.reject.bind(i)});i.then(function(){if(a.Events.REFRESH_ISSUE_PAGE){a.trigger(a.Events.REFRESH_ISSUE_PAGE,[a.Issue.getIssueId()])}a.trace("jira.issue.dnd.attached")});this.queueTask(i);this.queueEvent("commitUpload",{count:j.length});return i},isSupportedBrowser:function(){if(f("html.webkit")[0]||f("html.safari")[0]){if(!(parseFloat(f.browser.version)>=533)){return false}}else{if(f("html.mozilla")[0]){if(!(parseFloat(f.browser.version)>=1.9)){return false}}else{if(f("html.msie")[0]){if(!(parseFloat(f.browser.version)>=10)){return false}}else{return false}}}return true},renderUnsupported:function(){this.$node.addClass("issue-drop-zone__not-supported").text(e("dnd.attachment.unsupported.browser")).append("<ul><li>FireFox 3.6+</li><li>Chrome 5+</li><li>Safari 5</li></ul>")},markDirty:function(i){this.$node.addClass(a.DirtyForm.ClassNames.SANCTIONED);this.$node.toggleClass(a.DirtyForm.ClassNames.EXEMPT,!i);this.$node.attr("value",false);this.$node.attr("defaultValue",true)},checkMarkDirty:function(){if(this.pendingQueue.length==0){this.markDirty(false)}},queueEvent:function(i,j){b.trigger("analytics",{name:"issue.dnd.attachment."+this.eventGroup+"."+i,data:j||{}})}});return g});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/FormDropZone.js' */
define("dndattachment/FormDropZone",["dndattachment/Parser","dndattachment/IssueDropZone","dndattachment/jquery","dndattachment/aui","dndattachment/i18n"],function(f,e,d,a,c){var b=e.extend({eventGroup:"formdropzone",init:function(){this._super.apply(this,arguments);this.bind("uploadFinished",this.onUploadFinished.bind(this));this.$containerNode=this.getContainerNode();this.$formNode=this.$node.parents("form");this.$inputNode=d('<input name="dnd-dropzone" type="hidden" />').insertAfter(this.$node);this.$fieldNode=this.$node.parents(".field-group");this.$fieldNode.addClass("long-field");this.$dragoverMask=d('<div class="attach-files-drop-zone__dragover-mask" />');this.$dragoverMask.appendTo(this.$containerNode);this.connectDialogEvents();this.connectFormEvents()},onUploadFinished:function(h,i){var g=d('<input type="checkbox" name="filetoconvert"/>').addClass("upload-progress-bar__checkbox").attr("value",i.fileID).attr("id","filetoconvert-"+i.fileID).prop("checked",true).insertBefore(i.$node);i.bind("onDestroy",function(){g.prop("checked",false)});setTimeout(function(){i.$node.addClass("upload-progress-bar__upload-ready");i.setIcon("aui-iconfont-close-dialog")},1000)},commitUpload:function(g){this.queueEvent("commitUpload",{count:g.length});return new d.Deferred()},getContainerNode:function(){return this.$node.parents(".jira-dialog-content")},connectDialogEvents:function(){this.$containerNode.on("dragover drop",function(g){g.preventDefault();g.stopPropagation();this.$containerNode.addClass("attach-files-drop-zone__dragover");if(g.dataTransfer&&g.dataTransfer.files&&g.dataTransfer.files.length>0){this.queueEvent("fileDrop",{count:g.dataTransfer.files.length});this.uploadFiles(g.dataTransfer.files)}if(g.type=="drop"){this.$containerNode.removeClass("attach-files-drop-zone__dragover")}}.bind(this));this.$containerNode.on("dragleave",function(){this.$containerNode.removeClass("attach-files-drop-zone__dragover")}.bind(this))},connectFormEvents:function(){this.$formNode.on("before-submit",function(g){if(this.isDirty){g.preventDefault();var h={};h[this.$inputNode.attr("name")]=c("dnd.attachment.upload.in.progress");JIRA.applyErrorsToForm(this.$formNode,h);this.$formNode.find(".error").toArray().some(function(i){i.scrollIntoView()})}}.bind(this))},markDirty:function(g){e.prototype.markDirty.apply(this,arguments);this.isDirty=g;JIRA.trace(g?"jira.issue.dnd.isdirty":"jira.issue.dnd.isclear")}});return b});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/AttachFilesDropZone.js' */
define("dndattachment/AttachFilesDropZone",["dndattachment/FormDropZone","dndattachment/jquery"],function(a,b){var c=a.extend({eventGroup:"attachfiledropzone",init:function(){this._super.apply(this,arguments);this.bind("progressBarInserted",function(d,f){var e=new b.Deferred();this.queueTask(e);f.result.done(e.resolve.bind(e));f.bind("onDestroy",function(){e.resolve()})}.bind(this))},checkMarkDirty:function(){if(this.pendingQueue.length<=1){this.markDirty(false)}}});return c});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/CreateIssueDropZone.js' */
define("dndattachment/CreateIssueDropZone",["dndattachment/jquery","dndattachment/FormDropZone","dndattachment/UploadProgressBar"],function(d,c,b){var a=c.extend({eventGroup:"createissuedropzone",progressBarType:"dndattachment/ProjectUploadProgressBar",getContainerNode:function(){return d(this.$node.parents(".jira-dialog-content")[0]||this.$node.parents("form#issue-create").parents(".aui-page-panel-content")[0])}});return a});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/ProjectUploadProgressBar.js' */
define("dndattachment/ProjectUploadProgressBar",["dndattachment/UploadProgressBar"],function(a){return a.extend({progressBarType:"dndattachment/ProjectUploadProgressBar",getProjectId:function(){return this.$node.parents("form").find("*[name=pid]").val()},getUploadParams:function(b){var c=a.prototype.getUploadParams.apply(this,arguments);if(this.getProjectId()){c.projectId=this.getProjectId()}return c}})});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/TemporaryAttachments.js' */
define("dndattachment/TemporaryAttachments",[],function(){var a={};return{getAttachment:function(b){return a[b]},putAttachment:function(d,b){var c={id:d,name:b.name,type:b.type,file:b};a[d]=c;return c}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/UploadProgressBar.js' */
define("dndattachment/UploadProgressBar",["dndattachment/jquery","dndattachment/Parser","dndattachment/FileIconUtil","dndattachment/JIRA","dndattachment/aui","dndattachment/i18n","dndattachment/TemporaryAttachments"],function(e,c,f,b,i,d,h){var g=["aui-iconfont-error","aui-iconfont-success","aui-iconfont-close-dialog"];function a(k,l){i.trigger("analytics",{name:"issue.dnd.attachment.uploadprogress."+k,data:l||{}})}var j=Class.extend({autoDestroy:true,init:function(k){this.result=new e.Deferred();this.$node=e(k);this.uploadSize=this.$node.data("upload-size");this.render()},render:function(){this.$node.html(b.Templates.DnDAttachmentPlugin.UploadProgressBar({}));this.$node.find(".upload-progress-bar__control button").on("click",function(){this.destroy();a("buttonClick")}.bind(this))},destroy:function(){this.setAutoDestroy(false);this.trigger("onDestroy");this.$node.animate({opacity:0},{duration:250,complete:function(){this.$node.slideUp(250,function(){if(this.objectURL){window.URL.revokeObjectURL(this.objectURL)}this.$node.remove()}.bind(this))}.bind(this)})},setAutoDestroy:function(k){this.autoDestroy=k},getAutoDestroy:function(){return this.autoDestroy},getUploadParams:function(l){var m={filename:l.name,size:l.size,atl_token:atl_token()};_.extend(m,this.getEntityParams());var k=this.$node.parents("form").find('input[name="formToken"]').attr("value");if(k){m.formToken=k}return m},getEntityParams:function(){var k={};var m=b.Issue.getIssueId();var l=this.$node.parents("form").find('*[name="pid"]').attr("value");if(l){k.projectId=l}else{if(m){k.issueId=m}}return k},setFileID:function(k){this.fileID=k},setFileName:function(k){this.$node.find(".upload-progress-bar__file-name").text(k)},setFileSize:function(k){if(k>=0){this.$node.find(".upload-progress-bar__file-size").html(i.InlineAttach.Text.fileSize(k))}},uploadFile:function(l,m){this.setFileName(l.name);this.setFileSize(i.InlineAttach.Text.fileSize(l.size));this.loadThumbnail(l);var k=this.result;k.fail(this.reportError.bind(this));if(l.size>m){k.reject(d("dnd.attachment.file.is.too.large").replace("{0}",this.uploadSize),true);return k}this.upload=new i.InlineAttach.AjaxUpload({file:l,params:this.getUploadParams(l),url:i.InlineAttach.AjaxPresenter.DEFAULT_URL,progress:function(n){k.notify(n/l.size)},success:function(o,n){if(o.id!==undefined&&o.name!==undefined){k.notify(1);k.resolve(o,n,l)}else{k.reject(o,n,l)}},error:function(o,n){k.reject("Internal error",n)}});this.monitorUpload(k);this.checkSession().then(function(){this.upload.upload()}.bind(this)).fail(function(){k.reject("Unauthorized",401)});this.$node.find(".upload-progress-bar__control button").on("click",function(){this.upload.abort();k.reject()}.bind(this));k.done(function(n){h.putAttachment(n.id,l);this.setFileID(n.id);b.trace("jira.issue.dnd.uploaded")}.bind(this));return k},monitorUpload:function(k){k.progress(this.setProgress.bind(this));k.done(this.setFinished.bind(this));k.fail(function(){this.$node.addClass("UploadProgressBar_uploadFailed")}.bind(this))},setProgress:function(k){var l=this.$node.find(".upload-progress-bar__progress-bar");l.toggleClass("UploadProgressBar_progressUnknown",k===false);if(k>=0){l.find(".upload-progress-bar__bar").css("width",100*k+"%")}},setFinished:function(){this.$node.addClass("upload-progress-bar__upload-finished");this.$node.find(".upload-progress-bar__control button .aui-icon").addClass("aui-iconfont-success").removeClass("aui-iconfont-close-dialog")},loadThumbnail:function(k){if(k.type.match(/image.*/)){this.objectURL=window.URL.createObjectURL(k)}var l=this.objectURL||f.getIconURL(f.matchExtension(k.name),k.type);e("<img/>").attr("src",l).appendTo(this.$node.find(".upload-progress-bar__thumbnail"))},reportError:function(k){if(typeof k=="object"&&k.errorMessage){k=k.errorMessage}this.setIcon("aui-iconfont-error");this.$node.addClass("upload-progress-bar__upload-error");this.$node.find(".upload-progress-bar__bar").css("width","100%");this.$node.find(".upload-progress-bar__error-message").text(k);this.setAutoDestroy(false);a("error",{message:k})},setIcon:function(l){var k=this.$node.find(".upload-progress-bar__control button .aui-icon");if(!g.some(function(m){k.toggleClass(m,m==l);return m==l})){throw"Unknown icon"}},checkSession:function(){var k=new e.Deferred();i.$.ajax({type:"GET",url:contextPath+"/rest/auth/1/session",contentType:"application/json"}).done(function(){k.resolve()}).fail(function(){this.checkPermissions().done(function(l){k.resolve()}).fail(function(){k.reject()})}.bind(this));return k},checkPermissions:function(){var k=new e.Deferred();i.$.ajax({type:"GET",url:contextPath+"/rest/api/2/mypermissions",contentType:"application/json",data:this.getEntityParams()}).done(function(l){if(l.permissions.CREATE_ATTACHMENT.havePermission){k.resolve()}else{k.reject()}}).fail(function(){k.reject()});return k}});return j});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'js/FileIconUtil.js' */
define("dndattachment/FileIconUtil",function(){function a(h,g,e,f){this.extension=h;this.mimeType=g;this.iconFile=e;this.iconURL=contextPath+"/images/icons/attach/"+e;this.extensionName=f}var b=[new a(".pdf","application/pdf","pdf.gif","PDF File"),new a(".gif","image/gif","image.gif","GIF File"),new a(".png","image/png","image.gif","PNG File"),new a(".jpeg","image/jpeg","image.gif","JPEG File"),new a(".xml","text/xml","xml.gif","XML File"),new a(".html","text/html","html.gif","HTML File"),new a(".java","","java.gif","Java Source File"),new a(".jar","","java.gif","Java Archive File"),new a(".txt","text/plain","text.gif","Text File"),new a(".zip","application/zip","zip.gif","Zip Archive"),new a(".gz","application/x-gzip-compressed","zip.gif","GZip Archive")].concat([".doc",".docx","docm","dotx","dotm"].map(function(e){return new a(e,"application/msword","word.gif","Microsoft Word")})).concat([".xls","xlsx","xlsm","xltx","xltm","xlsb","xlam"].map(function(e){return new a(e,"application/vnd.ms-excel","excel.gif","Microsoft Excel")})).concat(["pptx","pptm","potx","potm","ppam","ppsx","ppsm"].map(function(e){return new a(e,"application/vnd.ms-powerpoint","powerpoint.gif","Microsoft PowerPoint")}));var c=/(\.([a-z]+))$/g;var d=new a("","","file.gif","Unknown format");return{getIcon:function(f,e){return b.filter(function(g){return g.extension==f||g.mimeType==e})[0]||d},getIconURL:function(g,f){var e=this.getIcon(g,f);return e&&e.iconURL},matchExtension:function(f){var e=f.match(c);return e&&e[0]}}});;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/IssueDropZone.soy' */
// This file was automatically generated from IssueDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.IssueDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="issue-drop-zone__target"></div><span class="issue-drop-zone__text">', soy.$$escapeHtml("Drop files here to attach them"), '<br/>', soy.$$escapeHtml("or"), '</span><label class="issue-drop-zone__button aui-button">', soy.$$escapeHtml("Select files"), '<input class="issue-drop-zone__file ignore-inline-attach" type="file" multiple /></label>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/AttachFilesDropZone.soy' */
// This file was automatically generated from AttachFilesDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.AttachFilesDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div duiType="dndattachment/AttachFilesDropZone" class="issue-drop-zone" data-upload-limit="', soy.$$escapeHtml(opt_data.jiraAttachmentSize), '" data-upload-size="', soy.$$escapeHtml(opt_data.uploadLimit), '"></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/CreateIssueDropZone.soy' */
// This file was automatically generated from CreateIssueDropZone.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.CreateIssueDropZone = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div duiType="dndattachment/CreateIssueDropZone" class="issue-drop-zone" data-upload-limit="', soy.$$escapeHtml(opt_data.jiraAttachmentSize), '" data-upload-size="', soy.$$escapeHtml(opt_data.uploadLimit), '"></div>', (opt_data.description) ? '<div class="description">' + soy.$$escapeHtml(opt_data.description) + '</div>' : '');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript', location = 'templates/UploadProgressBar.soy' */
// This file was automatically generated from UploadProgressBar.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.DnDAttachmentPlugin == 'undefined') { JIRA.Templates.DnDAttachmentPlugin = {}; }


JIRA.Templates.DnDAttachmentPlugin.UploadProgressBar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="upload-progress-bar__thumbnail"> </div><span class="upload-progress-bar__file-name"> </span><span class="upload-progress-bar__file-size"> </span><div class="upload-progress-bar__progress-bar"><span class="upload-progress-bar__bar"> </span></div><div class="upload-progress-bar__control"><button type="button" class="aui-button aui-button-subtle aui-button-compact"><span class="aui-icon aui-icon-small aui-iconfont-close-dialog">Cancel upload</span></button></div><div class="upload-progress-bar__error-message"></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript-init', location = 'js/initIssueDropZone.js' */
require(["dndattachment/Parser","dndattachment/jquery","dndattachment/IssueDropZone","dndattachment/aui","dndattachment/FileIconUtil"],function(a,b,g,i,d){if(!g.prototype.isSupportedBrowser()){return}var e="com.atlassian.jira.plugins.jira-dnd-attachment-plugin:drag-and-drop-attachment-javascript.upload-limit";var f=_.isFunction(WRM.data)?WRM.data(e):WRM.data.claim(e);function j(l,p){var k=l.find(".field-group.file-input-list");if(k.size()==0){return}if(k.find('*[duiType*="'+p+'"]').length>0){return}var n=k.find("input[name=filetoconvert]:checked").map(function(q,r){return{id:r.value,name:b(r).siblings("label").text()}}).toArray();var m=k.find(".description:last-child").html();k.empty();var o=b(JIRA.Templates.DnDAttachmentPlugin[p]({uploadLimit:i.InlineAttach.Text.fileSize(f),jiraAttachmentSize:f,description:m}));a.parse(o.appendTo(k)).then(function(q){if(q!=null){q.loadFiles(n)}})}function h(k,l){k.onContentReady(function(m){j(k.$popupContent,l)})}var c=function(){if(JIRA.Dialogs.attachFile){h(JIRA.Dialogs.attachFile,"AttachFilesDropZone")}var k=["create-issue-dialog","create-subtask-dialog","edit-issue-dialog"];var l=_.map(l,function(n){return"#"+n}).join(",");b(i).on("Dialog.show",function(p,n,o){if(_.contains(k,n.attr("id"))){h(o,"CreateIssueDropZone")}});JIRA.bind(JIRA.Events.NEW_CONTENT_ADDED,function(p,n,o){if(n.parents(l).size()>0){j(n,"CreateIssueDropZone")}});var m=b("form#issue-create, form#issue-edit");if(m.size()>0){j(m,"CreateIssueDropZone")}};if(b.isReady){c()}else{i.$(c)}b.event.props.push("dataTransfer")});;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.soy' */
// This file was automatically generated from appswitcher.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher == 'undefined') { navlinks.templates.appswitcher = {}; }


navlinks.templates.appswitcher.linkSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.list.length > 0) {
    output.append('<div class="aui-nav-heading sidebar-section-header">', soy.$$escapeHtml(opt_data.title), '</div><ul class="aui-nav nav-links">');
    var linkList8 = opt_data.list;
    var linkListLen8 = linkList8.length;
    for (var linkIndex8 = 0; linkIndex8 < linkListLen8; linkIndex8++) {
      var linkData8 = linkList8[linkIndex8];
      navlinks.templates.appswitcher.applicationsItem(linkData8, output);
    }
    output.append('</ul>');
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.applicationsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(opt_data.link), '" class="interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.shortcutsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(opt_data.link), '" class="interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span>', (opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '', '</a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-error">', "Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.sidebarContents = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-page-panel-nav"><nav class="aui-navgroup aui-navgroup-vertical"><div class="app-switcher-section app-switcher-applications"><div class="aui-nav-heading">', soy.$$escapeHtml("Application Links"), '</div><div class="app-switcher-loading">', "Loading\x26hellip;", '</div></div><div class="app-switcher-section app-switcher-shortcuts"><div class="aui-nav-heading">', soy.$$escapeHtml("Shortcuts"), '</div><div class="app-switcher-loading">', "Loading\x26hellip;", '</div></div></nav></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">', soy.$$escapeHtml("Linked Applications"), '</span>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.projectHeaderSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-title">');
  aui.avatar.avatar({size: 'large', avatarImageUrl: opt_data.avatarUrl, isProject: true, title: opt_data.name}, output);
  output.append('<div class="sidebar-project-name">', soy.$$escapeHtml(opt_data.name), '</div></div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.cogDropdown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var dropdownList__soy74 = new soy.StringBuilder();
  navlinks.templates.appswitcher.dropdownList({list: opt_data.links}, dropdownList__soy74);
  dropdownList__soy74 = dropdownList__soy74.toString();
  aui.dropdown2.dropdown2({menu: {'id': opt_data.id, 'content': dropdownList__soy74, 'extraClasses': 'aui-style-default sidebar-customize-section'}, trigger: {'showIcon': false, 'content': '<span class="aui-icon aui-icon-small aui-iconfont-configure"></span>', 'container': '#app-switcher'}}, output);
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.dropdownList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="sidebar-admin-links">');
  var linkList82 = opt_data.list;
  var linkListLen82 = linkList82.length;
  for (var linkIndex82 = 0; linkIndex82 < linkListLen82; linkIndex82++) {
    var linkData82 = linkList82[linkIndex82];
    output.append('<li class="nav-link"><a href="', soy.$$escapeHtml(linkData82.href), '" title="', soy.$$escapeHtml(linkData82.title), '"><span class="nav-link-label">', soy.$$escapeHtml(linkData82.label), '</span></a></li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.switcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (true) {
    if (AJS.DarkFeatures.isEnabled('rotp.sidebar')) {
      var sidebarContents__soy97 = new soy.StringBuilder();
      navlinks.templates.appswitcher.sidebarContents(null, sidebarContents__soy97);
      sidebarContents__soy97 = sidebarContents__soy97.toString();
      var triggerContent__soy99 = new soy.StringBuilder();
      navlinks.templates.appswitcher.trigger(null, triggerContent__soy99);
      triggerContent__soy99 = triggerContent__soy99.toString();
      navlinks.templates.appswitcher.sidebar({sidebar: {'id': 'app-switcher', 'content': sidebarContents__soy97}, trigger: {'showIcon': false, 'content': triggerContent__soy99}}, output);
      output.append('<script>\n                (function (NL) {\n                    var initialise = function () {\n                        new NL.SideBar({\n                            sidebarContents: \'#app-switcher\'\n                        });\n                    };\n                    if (NL.SideBar) {\n                        initialise();\n                    } else {\n                        NL.onInit = initialise;\n                    }\n                }(window.NL = (window.NL || {})));\n                window.NL.isUserAdmin = ', soy.$$escapeHtml(false), '<\/script>');
    } else {
      navlinks.templates.appswitcher_old.switcher(null, output);
    }
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher.sidebar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml(opt_data.sidebar.id), '" class="sidebar-trigger app-switcher-trigger" aria-owns="', soy.$$escapeHtml(opt_data.sidebar.id), '" aria-haspopup="true">', opt_data.trigger.content, '</a><div id=', soy.$$escapeHtml(opt_data.sidebar.id), ' class="app-switcher-sidebar aui-style-default sidebar-offscreen">', opt_data.sidebar.content, '</div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher.js' */
(function(c,a){a.SideBar=function(d){var e=this;this.$sidebar=null;d=c.extend({sidebarContents:null},d);this.getLinks=function(){return c.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateAppLinks).fail(this.showAppSwitcherError)};this.populateProjectHeader=function(g,f){e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").after(navlinks.templates.appswitcher.projectHeaderSection({avatarUrl:f,name:g}))};this.getProjectData=function(){var f=c(".project-shortcut-dialog-trigger"),g=f.data("key"),h=f.data("entity-type");if(f.size()==0||!g||!h){c(".app-switcher-shortcuts").remove();return}var j,i;i=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/local/"+g,cache:false,data:{entityType:h},dataType:"json"});j=c.ajax({url:AJS.contextPath()+"/rest/project-shortcuts/1.0/remote/"+g,cache:false,data:{entityType:h},dataType:"json"});c.when(i,j).then(function(l,k){e.updateProjectShortcuts(l,k,{key:g,entityType:h,name:f.data("name"),avatarUrl:f.find("img").prop("src")})},e.showProjectShortcutsError)};this.getSidebar=function(){if(!this.$sidebar){this.$sidebar=c(d.sidebarContents)}return this.$sidebar};this.addApplicationsCog=function(){c(".app-switcher-applications .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-applications-admin-dropdown",links:[{href:AJS.contextPath()+"/plugins/servlet/customize-application-navigator",label:"Customize navigator",title:"Add new entries, hide existing or restrict who sees what"},{href:AJS.contextPath()+"/plugins/servlet/applinks/listApplicationLinks",label:"Manage application links",title:"Link to more Atlassian applications"}]}))};this.addProjectShortcutsCog=function(f,h){var g=[{href:AJS.contextPath()+"/plugins/servlet/custom-content-links-admin?entityKey="+f,label:"Customize shortcuts",title:""}];if(e.entityMappings[h]){g.push({href:e.generateEntityLinksUrl(f,e.entityMappings[h]),label:"Manage product links",title:""})}e.getSidebar().find(".app-switcher-shortcuts .aui-nav-heading").before(navlinks.templates.appswitcher.cogDropdown({id:"sidebar-project-shortcuts-admin-dropdown",links:g}))};this.updateAppLinks=function(f){c(function(){e.getSidebar().find(".app-switcher-applications").html(navlinks.templates.appswitcher.linkSection({title:"Application Links",list:f}));if(a.isUserAdmin){e.addApplicationsCog()}e.bindAnalyticsHandlers(e.getSidebar(),f)})};this.updateProjectShortcuts=function(i,g,h){var j=i[0].shortcuts,f=g[0].shortcuts;e.getSidebar().find(".app-switcher-shortcuts").html(navlinks.templates.appswitcher.linkSection({title:"Shortcuts",list:j.concat(f)}));if(a.isUserAdmin){e.addProjectShortcutsCog(h.key,h.entityType)}e.populateProjectHeader(h.name,h.avatarUrl);e.bindAnalyticsHandlers(e.getSidebar(),data)};this.entityMappings={"confluence.space":"com.atlassian.applinks.api.application.confluence.ConfluenceSpaceEntityType","jira.project":"com.atlassian.applinks.api.application.jira.JiraProjectEntityType","bamboo.project":"com.atlassian.applinks.api.application.bamboo.BambooProjectEntityType","stash.project":"com.atlassian.applinks.api.application.stash.StashProjectEntityType"};this.generateEntityLinksUrl=function(f,g){if(g===e.entityMappings["confluence.space"]){return AJS.contextPath()+"/spaces/listentitylinks.action?typeId="+g+"&key="+f}else{return AJS.contextPath()+"/plugins/servlet/applinks/listEntityLinks/"+g+"/"+f}};this.showAppSwitcherError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-applications .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.showProjectShortcutsError=function(){c(function(){var f=e.getSidebar();f.find(".app-switcher-shortcuts .app-switcher-loading").replaceWith(navlinks.templates.appswitcher.error());f.off(".appswitcher").on("click.appswitcher",".app-switcher-retry",c.proxy(e.retryLoading,e))})};this.retryLoading=function(f){this.getSidebar().html(navlinks.templates.appswitcher.sidebarContents());this.getLinks();this.getProjectData();f&&f.stopPropagation()};this.bindAnalyticsHandlers=function(f,g){};this.getLinks();c(this.getProjectData);this.toggleSidebar=function(h){var i=e.getSidebar(),g=c("body"),f=c(window.document);if(!g.hasClass("app-switcher-open")){var k=c("#header");i.css("left",-i.width());i.parent("body").length||i.appendTo("body");b({data:i});i.animate({left:0},300);function j(l){var n=l.target&&c(l.target),m=l.keyCode;if(l.originalEvent===h.originalEvent){return}if(n&&!m&&!(n.closest(i).length||n.closest(k).length)&&h.which==1&&!(l.shiftKey||l.ctrlKey||l.metaKey)){e.toggleSidebar()}else{if(m===27){e.toggleSidebar()}}}f.on("click.appSwitcher",j);f.on("keydown.appSwitcher",j);f.on("scroll.appSwitcher",i,b)}else{f.off(".appSwitcher")}g.toggleClass("app-switcher-open")};c("#header").on("click",".app-switcher-trigger",this.toggleSidebar)};function b(f){var d=c(document).scrollTop(),g=c("#header"),e=(g.height()+g.offset().top)-d;if(e>=0){f.data.css({top:e,position:"fixed"})}else{f.data.css({top:0,left:0,position:"fixed"})}}if(a.onInit){a.onInit()}}(jQuery,window.NL=(window.NL||{})));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.js' */
(function(e,c){c.AppSwitcher=function(f){var g=AJS.contextPath()+"/plugins/servlet/customize-application-navigator";var h=this;this.$dropdown=null;f=e.extend({dropdownContents:null},f);this.getLinks=function(){return e.ajax({url:AJS.contextPath()+"/rest/menu/latest/appswitcher",cache:false,dataType:"json"}).done(this.updateDropdown).fail(this.showError)};this.getDropdown=function(){if(!this.$dropdown){this.$dropdown=e(f.dropdownContents)}return this.$dropdown};this.updateDropdown=function(i){e(function(){h.getDropdown().html(navlinks.templates.appswitcher_old.applications({apps:i,showAdminLink:c.isUserAdmin,adminLink:g}));h.bindAnalyticsHandlers(h.getDropdown(),i);h.processSuggestionApps(i)})};this.bindAnalyticsHandlers=function(i,j){};this.processSuggestionApps=function(i){e.ajax({type:"GET",dataType:"json",contentType:"application/json; charset=UTF-8",url:AJS.contextPath()+"/rest/menu/latest/isAppSuggestionAvailable"}).done(function(j){if(j===true){h.handleSuggestionApps(i)}})};this.handleSuggestionApps=function(k){var l=_.map(k,function(m){return m.applicationType.toLowerCase()});$suggestionApps=e("<div id='app-switcher-suggestion-apps' class='aui-dropdown2-section'/>");$suggestionApps.html(navlinks.templates.appswitcher_old.suggestionApps);var j=$suggestionApps.find(".suggestion-apps");var i=false;_.each(a,function(m){if(!_.contains(l,m.appName)){i=true;j.append(navlinks.templates.appswitcher_old.suggestionApp({appName:m.appName,appDesc:m.appDesc}))}});if(!i){return}e("#app-switcher").append($suggestionApps);e(".app-discovery-suggestion-app").click(function(){AJS.trigger("analytics",{name:"appswitcher.discovery.user.select."+e(this).find("a").attr("id").toLowerCase()});window.open(e(this).find("a").attr("title"),"_blank")});e(".app-discovery-suggestion-app").hover(function(){e(this).find("a").removeClass("active").removeClass("aui-dropdown2-active")});e(".app-discovery-cancel-button").click(function(){AJS.trigger("analytics",{name:"appswitcher.discovery.nothanks.button.click"});d(b,"true");$suggestionApps.remove()})};this.showError=function(){e(function(){h.getDropdown().html(navlinks.templates.appswitcher_old.error()).off(".appswitcher").on("click.appswitcher",".app-switcher-retry",e.proxy(h.retryLoading,h))})};this.retryLoading=function(i){this.getDropdown().html(navlinks.templates.appswitcher_old.loading());this.getLinks();i&&i.stopPropagation()};this.getLinks()};var b="key-no-thanks";var a=[{appName:"jira",appDesc:"Issue & Project Tracking Software"},{appName:"confluence",appDesc:"Collaboration and content sharing"},{appName:"bamboo",appDesc:"Continuous integration"}];var d=function(f,g){e.ajax({url:AJS.contextPath()+"/rest/menu/latest/userdata/",type:"PUT",contentType:"application/json",data:JSON.stringify({key:f,value:g})})};if(c.onInit){c.onInit()}}(jQuery,window.NL=(window.NL||{})));;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/appswitcher_old.soy' */
// This file was automatically generated from appswitcher_old.soy.
// Please don't edit this file by hand.

if (typeof navlinks == 'undefined') { var navlinks = {}; }
if (typeof navlinks.templates == 'undefined') { navlinks.templates = {}; }
if (typeof navlinks.templates.appswitcher_old == 'undefined') { navlinks.templates.appswitcher_old = {}; }


navlinks.templates.appswitcher_old.applications = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.apps, listClass: 'nav-links', showDescription: opt_data.showDescription}, output);
  if (opt_data.custom) {
    navlinks.templates.appswitcher_old.applicationsSection({list: opt_data.custom, showDescription: opt_data.showDescription}, output);
  }
  if (opt_data.showAdminLink) {
    navlinks.templates.appswitcher_old.adminSection(opt_data, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.applicationsSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.list.length > 0) {
    var param19 = new soy.StringBuilder('<ul', (opt_data.listClass) ? ' class="' + soy.$$escapeHtml(opt_data.listClass) + '"' : '', '>');
    var linkList27 = opt_data.list;
    var linkListLen27 = linkList27.length;
    for (var linkIndex27 = 0; linkIndex27 < linkListLen27; linkIndex27++) {
      var linkData27 = linkList27[linkIndex27];
      navlinks.templates.appswitcher_old.applicationsItem(soy.$$augmentData(linkData27, {showDescription: opt_data.showDescription}), param19);
    }
    param19.append('</ul>');
    aui.dropdown2.section({content: param19.toString()}, output);
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.applicationsItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="nav-link', (opt_data.self) ? ' nav-link-local' : '', '"><a href="', soy.$$escapeHtml(opt_data.link), '" class="aui-dropdown2-radio interactive', (opt_data.self) ? ' checked' : '', '" title="', soy.$$escapeHtml(opt_data.link), '"><span class="nav-link-label">', soy.$$escapeHtml(opt_data.label), '</span>', (opt_data.showDescription && opt_data.description) ? '<span class="nav-link-description">' + soy.$$escapeHtml(opt_data.description) + '</span>' : '', '</a></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.adminSection = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.dropdown2.section({content: '<ul class="nav-links"><li><a class="nav-link-edit-wrapper" href="' + soy.$$escapeHtml(opt_data.adminLink) + '"><span class="nav-link-edit">' + "Configure\x26hellip;" + '</span></a></li></ul>'}, output);
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.error = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-error">', "Something went wrong, please \x3cspan class\x3d\x22app-switcher-retry\x22\x3etry again\x3c/span\x3e.", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.loading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="app-switcher-loading">', "Loading\x26hellip;", '</div>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.trigger = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="aui-icon aui-icon-small aui-iconfont-appswitcher">', soy.$$escapeHtml("Linked Applications"), '</span>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.switcher = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (true) {
    var loadingContent__soy81 = new soy.StringBuilder();
    navlinks.templates.appswitcher_old.loading(null, loadingContent__soy81);
    loadingContent__soy81 = loadingContent__soy81.toString();
    var triggerContent__soy83 = new soy.StringBuilder();
    navlinks.templates.appswitcher_old.trigger(null, triggerContent__soy83);
    triggerContent__soy83 = triggerContent__soy83.toString();
    aui.dropdown2.dropdown2({menu: {'id': 'app-switcher', 'content': loadingContent__soy81, 'extraClasses': 'aui-style-default'}, trigger: {'showIcon': false, 'content': triggerContent__soy83, 'extraClasses': 'app-switcher-trigger'}}, output);
    output.append('<script>\n            (function (NL) {\n                var initialise = function () {\n                    // For some milestones of AUI, the atlassian soy namespace was renamed to aui. Handle that here by ensuring that window.atlassian is defined.\n                    window.atlassian = window.atlassian || window.aui;\n                    new NL.AppSwitcher({\n                        dropdownContents: \'#app-switcher\'\n                    });\n                };\n                if (NL.AppSwitcher) {\n                    initialise();\n                } else {\n                    NL.onInit = initialise;\n                }\n            }(window.NL = (window.NL || {})));\n            window.NL.isUserAdmin = ', soy.$$escapeHtml(false), '<\/script>');
  }
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.suggestionApp = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="app-discovery-suggestion-app"><a id="', soy.$$escapeHtml(opt_data.appName), '" href="#" class="app-discovery-link aui-icon-container app-discovery-', soy.$$escapeHtml(opt_data.appName), '-product-icon" title="https://www.atlassian.com/software/', soy.$$escapeHtml(opt_data.appName), '"/><div class="app-discovery-small">', soy.$$escapeHtml(opt_data.appDesc), '</div></li>');
  return opt_sb ? '' : output.toString();
};


navlinks.templates.appswitcher_old.suggestionApps = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class=\'nav-links suggestion-apps\'><li><span class=\'app-discovery-suggest-title nav-link-label\'><h6>', soy.$$escapeHtml("Try other Atlassian apps"), '</h6></span></li></ul><div class=\'buttons-container app-discovery-suggest-apps-buttons\'><div class=\'buttons\'><button class=\'aui-button aui-button-link app-discovery-cancel-button\' name=\'cancel\' accesskey=\'c\' href=\'#\'>', soy.$$escapeHtml("Don\x27t show this again"), '</button></div></div>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.plugins.atlassian-nav-links-plugin:rotp-menu', location = 'appswitcher/inline-dialog.js' */
(function(d){AJS.CustomInlineDialog=AJS.CustomInlineDialog||function(B,n,r,p){p=p||[];if(p.hasOwnProperty("getArrowAttributes")){getArrowAttributesDeprecationLogger()}if(p.hasOwnProperty("getArrowPath")){getArrowPathDeprecationLogger();if(p.hasOwnProperty("gravity")){getArrowPathWithGravityDeprecationLogger()}}if(p.hasOwnProperty("onTop")){onTopDeprecationLogger();if(p.onTop&&p.gravity===undefined){p.gravity="s"}}if(typeof n==="undefined"){n=String(Math.random()).replace(".","");if(d("#inline-dialog-"+n+", #arrow-"+n+", #inline-dialog-shim-"+n).length){throw"GENERATED_IDENTIFIER_NOT_UNIQUE"}}var z=d.extend(false,AJS.CustomInlineDialog.opts,p);if(z.gravity==="w"){z.offsetX=p.offsetX===undefined?10:p.offsetX;z.offsetY=p.offsetY===undefined?0:p.offsetY}var v=function(){return window.Raphael&&p&&(p.getArrowPath||p.getArrowAttributes)};var j;var q;var K;var u=false;var A=false;var I=false;var J;var x;var g=d('<div id="inline-dialog-'+n+'" class="aui-inline-dialog"><div class="aui-inline-dialog-contents contents"></div><div id="arrow-'+n+'" class="aui-inline-dialog-arrow arrow"></div></div>');var m=d("#arrow-"+n,g);var G=g.find(".contents");if(!v()){g.find(".aui-inline-dialog-arrow").addClass("aui-css-arrow")}if(!z.displayShadow){G.addClass("aui-inline-dialog-no-shadow")}if(z.autoWidth){G.addClass("aui-inline-dialog-auto-width")}else{G.css("width",z.width+"px")}G.mouseover(function(O){clearTimeout(q);g.unbind("mouseover")}).mouseout(function(){E()});var D=function(){if(!j){j={popup:g,hide:function(){E(0)},id:n,show:function(){y()},persistent:z.persistent?true:false,reset:function(){function S(U,T){U.css(T.popupCss);if(v()){if(T.gravity==="s"){T.arrowCss.top-=d.browser.msie?10:9}if(!U.arrowCanvas){U.arrowCanvas=Raphael("arrow-"+n,16,16)}var V=z.getArrowPath,W=d.isFunction(V)?V(T):V;U.arrowCanvas.path(W).attr(z.getArrowAttributes())}else{m.removeClass("aui-bottom-arrow aui-left-arrow aui-right-arrow");if(T.gravity==="s"&&!m.hasClass("aui-bottom-arrow")){m.addClass("aui-bottom-arrow")}else{if(T.gravity==="n"){}else{if(T.gravity==="w"){m.addClass("aui-left-arrow")}else{if(T.gravity==="e"){m.addClass("aui-right-arrow")}}}}}m.css(T.arrowCss)}var P=AJS.$(window).height();var Q=Math.round(P*0.75);g.children(".aui-inline-dialog-contents").css("max-height",Q);var O=z.calculatePositions(g,x,J,z);if(O.hasOwnProperty("displayAbove")){displayAboveDeprecationLogger();O.gravity=O.displayAbove?"s":"n"}S(g,O);g.fadeIn(z.fadeTime,function(){});if(d.browser.msie&&~~(d.browser.version)<10){var R=d("#inline-dialog-shim-"+n);if(!R.length){d(g).prepend(d('<iframe class = "inline-dialog-shim" id="inline-dialog-shim-'+n+'" frameBorder="0" src="javascript:false;"></iframe>'))}R.css({width:G.outerWidth(),height:G.outerHeight()})}}}}return j};var y=function(){if(g.is(":visible")){return}K=setTimeout(function(){if(!I||!A){return}z.addActiveClass&&d(B).addClass("active");u=true;if(!z.persistent){H()}AJS.CustomInlineDialog.current=D();d(document).trigger("showLayer",["inlineDialog",D()]);D().reset()},z.showDelay)};var E=function(O){if(typeof O=="undefined"&&z.persistent){return}A=false;if(u&&z.preHideCallback.call(g[0].popup)){O=(O==null)?z.hideDelay:O;clearTimeout(q);clearTimeout(K);if(O!=null){q=setTimeout(function(){l();z.addActiveClass&&d(B).removeClass("active");g.fadeOut(z.fadeTime,function(){z.hideCallback.call(g[0].popup)});if(g.arrowCanvas){g.arrowCanvas.remove();g.arrowCanvas=null}u=false;A=false;d(document).trigger("hideLayer",["inlineDialog",D()]);AJS.CustomInlineDialog.current=null;if(!z.cacheContent){I=false;w=false}},O)}}};var F=function(R,P){var O=d(P);z.upfrontCallback.call({popup:g,hide:function(){E(0)},id:n,show:function(){y()}});g.each(function(){if(typeof this.popup!="undefined"){this.popup.hide()}});if(z.closeOthers){d(".aui-inline-dialog").each(function(){!this.popup.persistent&&this.popup.hide()})}x={target:O};if(!R){J={x:O.offset().left,y:O.offset().top}}else{J={x:R.pageX,y:R.pageY}}if(!u){clearTimeout(K)}A=true;var Q=function(){w=false;I=true;z.initCallback.call({popup:g,hide:function(){E(0)},id:n,show:function(){y()}});y()};if(!w){w=true;if(d.isFunction(r)){r(G,P,Q)}else{d.get(r,function(T,S,U){G.html(z.responseHandler(T,S,U));I=true;z.initCallback.call({popup:g,hide:function(){E(0)},id:n,show:function(){y()}});y()})}}clearTimeout(q);if(!u){y()}return false};g[0].popup=D();var w=false;var t=false;var s=function(){if(!t){d(z.container).append(g);t=true}};var o=d(B);if(z.onHover){if(z.useLiveEvents){if(o.selector){d(document).on("mousemove",o.selector,function(O){s();F(O,this)}).on("mouseout",o.selector,function(){E()})}else{AJS.log("Warning: inline dialog trigger elements must have a jQuery selector when the useLiveEvents option is enabled.")}}else{o.mousemove(function(O){s();F(O,this)}).mouseout(function(){E()})}}else{if(!z.noBind){if(z.useLiveEvents){if(o.selector){d(document).on("click",o.selector,function(O){s();if(M()){g.hide()}else{F(O,this)}return false}).on("mouseout",o.selector,function(){E()})}else{AJS.log("Warning: inline dialog trigger elements must have a jQuery selector when the useLiveEvents option is enabled.")}}else{o.click(function(O){s();if(M()){g.hide()}else{F(O,this)}return false}).mouseout(function(){E()})}}}var M=function(){return u&&z.closeOnTriggerClick};var H=function(){k();f()};var l=function(){C();N()};var i=false;var h=n+".inline-dialog-check";var k=function(){if(!i){d("body").bind("click."+h,function(P){var O=d(P.target);if(O.closest("#inline-dialog-"+n+" .contents").length===0){E(0)}});i=true}};var C=function(){if(i){d("body").unbind("click."+h)}i=false};var L=function(O){if(O.keyCode===27){E(0)}};var f=function(){d(document).on("keydown",L)};var N=function(){d(document).off("keydown",L)};g.show=function(P,O){if(P){P.stopPropagation()}s();if(z.noBind&&!(B&&B.length)){F(P,O===undefined?P.target:O)}else{F(P,B)}};g.hide=function(){E(0)};g.refresh=function(){if(u){D().reset()}};g.getOptions=function(){return z};return g};function c(g){var f=d(g);var h=d.extend({left:0,top:0},f.offset());return{left:h.left,top:h.top,width:f.outerWidth(),height:f.outerHeight()}}function b(h,j,t,f){var m=AJS.$.isFunction(f.offsetX)?f.offsetX(h,j,t,f):f.offsetX;var l=AJS.$.isFunction(f.offsetY)?f.offsetY(h,j,t,f):f.offsetY;var q=AJS.$.isFunction(f.arrowOffsetX)?f.arrowOffsetX(h,j,t,f):f.arrowOffsetX;var p=AJS.$.isFunction(f.arrowOffsetY)?f.arrowOffsetY(h,j,t,f):f.arrowOffsetY;var s=f.container.toLowerCase()!=="body";var g=AJS.$(f.container);var o=s?AJS.$(f.container).parent():AJS.$(window);var r=s?g.offset():{left:0,top:0};var k=s?o.offset():{left:0,top:0};var i=j.target;var u=i.offset();var n=i[0].getBBox&&i[0].getBBox();return{screenPadding:10,arrowMargin:5,window:{top:k.top,left:k.left,scrollTop:o.scrollTop(),scrollLeft:o.scrollLeft(),width:o.width(),height:o.height()},scrollContainer:{width:g.width(),height:g.height()},trigger:{top:u.top-r.top,left:u.left-r.left,width:n?n.width:i.outerWidth(),height:n?n.height:i.outerHeight()},dialog:{width:h.width(),height:h.height(),offset:{top:l,left:m}},arrow:{height:h.find(".arrow").outerHeight(),offset:{top:p,left:q}}}}function e(f,p,G,r){var n=b(f,p,G,r);var j=n.screenPadding;var k=n.window;var t=n.trigger;var D=n.dialog;var i=n.arrow;var z=n.scrollContainer;var E={top:t.top-k.scrollTop,left:t.left-k.scrollLeft};var A=Math.floor(t.height/2);var v=Math.floor(D.height/2);var u=Math.floor(i.height/2);var C=E.left-D.offset.left-j;var H=z.width-E.left-t.width-D.offset.left-j;var B=C>=D.width;var h=H>=D.width;var l=!h&&B?"e":"w";var o=E.top+A-u;var q=k.height-o-i.height;j=Math.min(j,o-n.arrowMargin);j=Math.min(j,q-n.arrowMargin);var g=E.top+A;var x=Math.max(g-j,0);var F=Math.max(k.height-g-j,0);var y=v-D.offset.top>x;var m=v+D.offset.top>F;var w;var s;if(y){w={top:k.scrollTop+j,left:l==="w"?t.left+t.width+D.offset.left:t.left-D.width-D.offset.left};s={top:(t.top+A)-(w.top+u)}}else{if(m){w={top:k.scrollTop+k.height-D.height-j,left:l==="w"?t.left+t.width+D.offset.left:t.left-D.width-D.offset.left};s={top:(t.top+A)-(w.top+u)}}else{w={top:t.top+A-v+D.offset.top,left:l==="w"?t.left+t.width+D.offset.left:t.left-D.width-D.offset.left};s={top:v-u+i.offset.top}}}return{gravity:l,popupCss:w,arrowCss:s}}function a(g,o,z,s){var x=AJS.$.isFunction(s.offsetX)?s.offsetX(g,o,z,s):s.offsetX;var v=AJS.$.isFunction(s.offsetY)?s.offsetY(g,o,z,s):s.offsetY;var m=AJS.$.isFunction(s.arrowOffsetX)?s.arrowOffsetX(g,o,z,s):s.arrowOffsetX;var l=AJS.$.isFunction(s.arrowOffsetY)?s.arrowOffsetY(g,o,z,s):s.arrowOffsetY;var f=c(window);var p=c(o.target);var y=c(g);var j=c(g.find(".aui-inline-dialog-arrow"));var i=p.left+p.width/2;var u=(window.pageYOffset||document.documentElement.scrollTop)+f.height;var k=10;y.top=p.top+p.height+~~v;y.left=p.left+~~x;var r=f.width-(y.left+y.width+k);j.left=i-y.left+~~m;j.top=-(j.height/2);var n=p.top>y.height;var h=(y.top+y.height)<u;var q=(!h&&n)||(n&&s.gravity==="s");if(q){y.top=p.top-y.height-(j.height/2);j.top=y.height}if(s.isRelativeToMouse){if(r<0){y.right=k;y.left="auto";j.left=z.x-(f.width-y.width)}else{y.left=z.x-20;j.left=z.x-y.left}}else{if(r<0){y.right=k;y.left="auto";var w=f.width-y.right;var t=w-y.width;j.right="auto";j.left=i-t-j.width/2}else{if(y.width<=p.width/2){j.left=y.width/2;y.left=i-y.width/2}}}return{gravity:q?"s":"n",displayAbove:q,popupCss:{left:y.left,top:y.top,right:y.right},arrowCss:{left:j.left,top:j.top,right:j.right}}}AJS.CustomInlineDialog.opts={onTop:false,responseHandler:function(g,f,h){return g},closeOthers:true,isRelativeToMouse:false,addActiveClass:true,onHover:false,useLiveEvents:false,noBind:false,fadeTime:100,persistent:false,hideDelay:10000,showDelay:0,width:300,offsetX:0,offsetY:10,arrowOffsetX:0,arrowOffsetY:0,container:"body",cacheContent:true,displayShadow:true,autoWidth:false,gravity:"n",closeOnTriggerClick:false,preHideCallback:function(){return true},hideCallback:function(){},initCallback:function(){},upfrontCallback:function(){},calculatePositions:function(f,i,j,h){h=h||{};var g=h.gravity==="w"?e:a;return g(f,i,j,h)},getArrowPath:function(f){if(f.gravity==="s"){return"M0,8L8,16,16,8"}else{return"M0,8L8,0,16,8"}},getArrowAttributes:function(){return{fill:"#fff",stroke:"#ccc"}}}})(AJS.$);;
;/* module-key = 'com.atlassian.jira.jira-header-plugin:jira-header', location = 'soy/headerDropdown.soy' */
// This file was automatically generated from headerDropdown.soy.
// Please don't edit this file by hand.

if (typeof JIRA == 'undefined') { var JIRA = {}; }
if (typeof JIRA.Templates == 'undefined') { JIRA.Templates = {}; }
if (typeof JIRA.Templates.Menu == 'undefined') { JIRA.Templates.Menu = {}; }
if (typeof JIRA.Templates.Menu.Dropdowns == 'undefined') { JIRA.Templates.Menu.Dropdowns = {}; }


JIRA.Templates.Menu.Dropdowns.dropdown2Fragment = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var sectionList3 = opt_data.sections;
  var sectionListLen3 = sectionList3.length;
  for (var sectionIndex3 = 0; sectionIndex3 < sectionListLen3; sectionIndex3++) {
    var sectionData3 = sectionList3[sectionIndex3];
    var hasItems__soy4 = sectionData3.items && sectionData3.items.length > 0;
    output.append('<div class="aui-dropdown2-section">', (hasItems__soy4 && sectionData3.label) ? '<strong>' + soy.$$escapeHtml(sectionData3.label) + '</strong>' : '', '<ul class=\'aui-list-truncate\'', (sectionData3.id) ? ' id="' + soy.$$escapeHtml(sectionData3.id) + '"' : '', (sectionData3.style) ? ' class="' + soy.$$escapeHtml(sectionData3.style) + '"' : '', '>');
    if (hasItems__soy4) {
      var itemList25 = sectionData3.items;
      var itemListLen25 = itemList25.length;
      for (var itemIndex25 = 0; itemIndex25 < itemListLen25; itemIndex25++) {
        var itemData25 = itemList25[itemIndex25];
        JIRA.Templates.Menu.Dropdowns.dropdown2Item(itemData25, output);
      }
    }
    output.append('</ul></div>');
  }
  return opt_sb ? '' : output.toString();
};


JIRA.Templates.Menu.Dropdowns.dropdown2Item = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '"' : '', (opt_data.style) ? ' class="' + soy.$$escapeHtml(opt_data.style) + '"' : '', '><a href="', soy.$$escapeHtml(opt_data.url), '"', (opt_data.id) ? ' id="' + soy.$$escapeHtml(opt_data.id) + '_lnk"' : '', (opt_data.title) ? ' title="' + soy.$$escapeHtml(opt_data.title) + '"' : '', ' class="', (opt_data.iconUrl) ? 'aui-icon-container' : '', (opt_data.parameters && opt_data.parameters['class']) ? ' ' + soy.$$escapeHtml(opt_data.parameters['class']) : '', '"');
  if (opt_data.parameters) {
    var keyList66 = soy.$$getMapKeys(opt_data.parameters);
    var keyListLen66 = keyList66.length;
    for (var keyIndex66 = 0; keyIndex66 < keyListLen66; keyIndex66++) {
      var keyData66 = keyList66[keyIndex66];
      output.append((keyData66 != 'class') ? ' ' + soy.$$escapeHtml(keyData66) + '="' + soy.$$escapeHtml(opt_data.parameters[keyData66]) + '"' : '');
    }
  }
  output.append('>', (opt_data.iconUrl) ? '<img class="icon" src="' + soy.$$escapeHtml(opt_data.iconUrl) + '" />' : '', soy.$$escapeHtml(opt_data.label), '</a></li>');
  return opt_sb ? '' : output.toString();
};
;
;/* module-key = 'com.atlassian.jira.jira-header-plugin:jira-header', location = 'js/init-dropdown2.js' */
;(function() {
    var SmartAjax = require('jira/ajs/ajax/smart-ajax');
    var Events = require('jira/util/events');
    var $ = require('jquery');

    /**
     * Binds analytics events to capture opening / closing of any dropdown menus, and clicking of any menu items therein.
     * Passes the id of the link element as a parameter
     */
    function bindHeaderDropdown2Analytics() {
        $("nav.aui-header a.aui-dropdown2-trigger").each(function() {
            var $ddtrigger = $(this);
            var id = $ddtrigger.attr("id");
            if (id) {
                var $dd = $("#" + $ddtrigger.attr("aria-owns"));
                $dd.on("aui-dropdown2-show", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.opened",
                        data: {
                            id: id
                        }
                    });
                });
                $dd.on("aui-dropdown2-hide", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.closed",
                        data: {
                            id: id
                        }
                    });
                });
                $dd.on("click", "a", function() {
                    AJS.trigger("analytics", {
                        name: "jira.header.menu.item.clicked",
                        data: {
                            id: this.id,
                            menu_id: id
                        }
                    });
                });
            }
        });
    }

    /**
     * Binds all the header implementations of Dropdown2. Including global nav and user profile.
     */
    function bindHeaderDropdown2() {
        $(".jira-ajax-menu").each(function () {
            var $ddtrigger = $(this);
            var $dd = $("#" + $ddtrigger.attr("aria-owns"));
            var $ajaxkey = $dd.data("aui-dropdown2-ajax-key");

            if ($ajaxkey) {
                $dd.bind("aui-dropdown2-show", function (event, options) {
                    Events.trigger('aui-dropdown2-show-before', event.target.id);
                    $dd.empty();
                    $dd.addClass("aui-dropdown2-loading");
                    SmartAjax.makeRequest({
                        url: contextPath + "/rest/api/1.0/menus/" + $ajaxkey,
                        data: {
                            inAdminMode: AJS.Meta.getBoolean("in-admin-mode")
                        },
                        dataType: "json",
                        cache: false,
                        success: function (data) {
                            $dd.removeClass("aui-dropdown2-loading");
                            $dd.html(JIRA.Templates.Menu.Dropdowns.dropdown2Fragment(data));

                            if (options && options.selectFirst) {
                                $dd.find("a:not(.disabled)").filter(":first").addClass("active")
                            }
                            Events.trigger('aui-dropdown2-show-after', event.target.id);
                        }
                    });
                });
            }
        });
    }

    $(function () {
        bindHeaderDropdown2();
        bindHeaderDropdown2Analytics();
    });

    AJS.namespace('JIRA.Dropdowns.bindHeaderDropdown2', null, bindHeaderDropdown2);
})();
;
